/*! For license information please see inkmap-worker.js.LICENSE.txt */
(()=>{var q={3772:function(q,Y,H){"use strict";var et=this&&this.__assign||function(){return et=Object.assign||function(q){for(var Y,H=1,et=arguments.length;H<et;H++)for(var it in Y=arguments[H])Object.prototype.hasOwnProperty.call(Y,it)&&(q[it]=Y[it]);return q},et.apply(this,arguments)},it=this&&this.__importDefault||function(q){return q&&q.__esModule?q:{default:q}};Object.defineProperty(Y,"__esModule",{value:!0}),Y.OlStyleParser=void 0;var nt=H(2075),st=it(H(553)),ot=it(H(188)),lt=it(H(7539)),mt=it(H(8443)),_t=it(H(8958)),vt=it(H(1280)),bt=it(H(283)),Mt=it(H(1345)),Et=it(H(4548)),Rt=it(H(5393)),It=H(8375),Pt=it(H(2661)),Tt=H(9839),Ft=function(){function t(q){this.unsupportedProperties={Symbolizer:{MarkSymbolizer:{avoidEdges:"none",blur:"none",fillOpacity:"none",offsetAnchor:"none",pitchAlignment:"none",pitchScale:"none",visibility:"none"},FillSymbolizer:{antialias:"none",fillOpacity:{support:"none",info:"Use opacity instead."},graphicFill:"none",visibility:"none"},IconSymbolizer:{allowOverlap:"none",anchor:"none",avoidEdges:"none",color:"none",haloBlur:"none",haloColor:"none",haloWidth:"none",keepUpright:"none",offsetAnchor:"none",optional:"none",padding:"none",pitchAlignment:"none",rotationAlignment:"none",textFit:"none",textFitPadding:"none",visibility:"none"},LineSymbolizer:{blur:"none",gapWidth:"none",gradient:"none",miterLimit:"none",roundLimit:"none",spacing:"none",visibility:"none",graphicFill:"none",graphicStroke:"none",perpendicularOffset:"none"},RasterSymbolizer:"none"},Function:{double2bool:{support:"none",info:"Always returns false"},atan2:{support:"none",info:"Currently returns the first argument"},rint:{support:"none",info:"Currently returns the first argument"},numberFormat:{support:"none",info:"Currently returns the first argument"},strAbbreviate:{support:"none",info:"Currently returns the first argument"}}},this.title="OpenLayers Style Parser",this.olIconStyleCache={},this.OlStyleConstructor=lt.default,this.OlStyleImageConstructor=mt.default,this.OlStyleFillConstructor=Mt.default,this.OlStyleStrokeConstructor=_t.default,this.OlStyleTextConstructor=vt.default,this.OlStyleCircleConstructor=bt.default,this.OlStyleIconConstructor=Et.default,this.OlStyleRegularshapeConstructor=Rt.default,this.isOlParserStyleFct=function(q){return"function"==typeof q},q&&(this.OlStyleConstructor=q.style.Style,this.OlStyleImageConstructor=q.style.Image,this.OlStyleFillConstructor=q.style.Fill,this.OlStyleStrokeConstructor=q.style.Stroke,this.OlStyleTextConstructor=q.style.Text,this.OlStyleCircleConstructor=q.style.Circle,this.OlStyleIconConstructor=q.style.Icon,this.OlStyleRegularshapeConstructor=q.style.RegularShape)}return t.prototype.getPointSymbolizerFromOlStyle=function(q){var Y;if(q.getImage()instanceof this.OlStyleCircleConstructor){var H=q.getImage(),et=H.getFill(),it=H.getStroke(),nt=H.getDisplacement();Y={kind:"Mark",wellKnownName:"circle",color:et?Pt.default.getHexColor(et.getColor()):void 0,opacity:et?Pt.default.getOpacity(et.getColor()):void 0,radius:0!==H.getRadius()?H.getRadius():5,strokeColor:it?it.getColor():void 0,strokeOpacity:it?Pt.default.getOpacity(it.getColor()):void 0,strokeWidth:it?it.getWidth():void 0,offset:nt[0]||nt[1]?nt:void 0}}else if(q.getImage()instanceof this.OlStyleRegularshapeConstructor){var st=q.getImage(),ot=(et=st.getFill(),it=st.getStroke(),st.getRadius()),lt=st.getRadius2(),mt=st.getPoints(),_t=st.getAngle(),vt=(nt=st.getDisplacement(),{kind:"Mark",color:et?Pt.default.getHexColor(et.getColor()):void 0,opacity:et?Pt.default.getOpacity(et.getColor()):void 0,strokeColor:it?it.getColor():void 0,strokeOpacity:it?Pt.default.getOpacity(it.getColor()):void 0,strokeWidth:it?it.getWidth():void 0,radius:0!==ot?ot:5,rotate:st.getRotation()/Math.PI*180,offset:nt[0]||nt[1]?nt:void 0});switch(mt){case 2:switch(_t){case 0:vt.wellKnownName="shape://vertline";break;case Math.PI/2:vt.wellKnownName="shape://horline";break;case Math.PI/4:vt.wellKnownName="shape://slash";break;case 2*Math.PI-Math.PI/4:vt.wellKnownName="shape://backslash"}break;case 3:switch(_t){case 0:vt.wellKnownName="triangle";break;case Math.PI/2:vt.wellKnownName="shape://carrow"}break;case 4:Number.isFinite(lt)?0===st.getAngle()?vt.wellKnownName="cross":vt.wellKnownName="x":vt.wellKnownName="square";break;case 5:vt.wellKnownName="star";break;default:throw new Error("Could not parse OlStyle. Only 2, 3, 4 or 5 point regular shapes are allowed")}Y=vt}else if(q.getText()instanceof this.OlStyleTextConstructor){var bt=q.getText(),Mt=(et=bt.getFill(),it=bt.getStroke(),bt.getRotation()),Et=bt.getText()||"a",Rt=bt.getFont()||"10px sans-serif",It=Pt.default.getFontNameFromOlFont(Rt);ot=Pt.default.getSizeFromOlFont(Rt),nt=[bt.getOffsetX(),bt.getOffsetY()],Array.isArray(Et)&&(Et=Et[0]),Y={kind:"Mark",wellKnownName:"ttf://".concat(It,"#0x").concat(Et.charCodeAt(0).toString(16)),color:et?Pt.default.getHexColor(et.getColor()):void 0,opacity:et?Pt.default.getOpacity(et.getColor()):void 0,strokeColor:it?it.getColor():void 0,strokeOpacity:it?Pt.default.getOpacity(it.getColor()):void 0,strokeWidth:it?it.getWidth():void 0,radius:0!==ot?ot:5,rotate:Mt?Mt/Math.PI*180:0,offset:nt[0]||nt[1]?nt:void 0}}else{var Tt=q.getImage();nt=Tt.getDisplacement(),Y={kind:"Icon",image:Tt.getSrc()?Tt.getSrc():void 0,opacity:Tt.getOpacity(),size:0!==Tt.getScale()?Tt.getScale():5,rotate:Tt.getRotation()/Math.PI*180,offset:nt[0]||nt[1]?nt:void 0}}return Y},t.prototype.getLineSymbolizerFromOlStyle=function(q){var Y=q.getStroke(),H=Y?Y.getLineDash():void 0;return{kind:"Line",color:Y?Pt.default.getHexColor(Y.getColor()):void 0,opacity:Y?Pt.default.getOpacity(Y.getColor()):void 0,width:Y?Y.getWidth():void 0,cap:Y?Y.getLineCap():"butt",join:Y?Y.getLineJoin():"miter",dasharray:H||void 0,dashOffset:Y?Y.getLineDashOffset():void 0}},t.prototype.getFillSymbolizerFromOlStyle=function(q){var Y=q.getFill(),H=q.getStroke(),et=H?H.getLineDash():void 0,it={kind:"Fill"};return Y&&(it.color=Pt.default.getHexColor(Y.getColor())),H&&(it.opacity=Pt.default.getOpacity(Y.getColor())),H&&(it.outlineColor=Pt.default.getHexColor(H.getColor())),et&&(it.outlineDasharray=et),H&&(it.outlineOpacity=Pt.default.getOpacity(H.getColor())),H&&H.getWidth()&&(it.outlineWidth=H.getWidth()),it},t.prototype.getTextSymbolizerFromOlStyle=function(q){var Y,H=q.getText(),et=H.getFill(),it=H.getStroke(),nt=H.getOffsetX(),st=H.getOffsetY(),ot=H.getFont(),lt=H.getRotation(),mt=H.getOverflow()?H.getOverflow():void 0,_t=H.getText(),vt=Array.isArray(_t)?_t[0]:_t,bt=1/0,Mt=void 0;if(ot){var Et=ot.split("px");Y=Et[0].trim().split(" "),bt=parseInt(Y[Y.length-1],10),Mt=(2===Et.length?Et[1]:Et[2]).split(",").map((function(q){return q.startsWith(" ")?q.slice(1):q}))}return{kind:"Text",label:vt,allowOverlap:mt,color:et?Pt.default.getHexColor(et.getColor()):void 0,size:isFinite(bt)?bt:void 0,font:Mt,offset:void 0!==nt&&void 0!==st?[nt,st]:[0,0],haloColor:it&&it.getColor()?Pt.default.getHexColor(it.getColor()):void 0,haloWidth:it?it.getWidth():void 0,rotate:void 0!==lt?lt/Math.PI*180:void 0}},t.prototype.getSymbolizersFromOlStyle=function(q){var Y=this,H=[];return q.forEach((function(q){var et;switch(Y.getStyleTypeFromOlStyle(q)){case"Point":et=q.getText()&&!Pt.default.getIsMarkSymbolizerFont(q.getText().getFont())?Y.getTextSymbolizerFromOlStyle(q):Y.getPointSymbolizerFromOlStyle(q);break;case"Line":et=Y.getLineSymbolizerFromOlStyle(q);break;case"Fill":et=Y.getFillSymbolizerFromOlStyle(q);break;default:throw new Error("Failed to parse SymbolizerKind from OpenLayers Style")}H.push(et)})),H},t.prototype.getRuleFromOlStyle=function(q){return{name:"OL Style Rule 0",symbolizers:Array.isArray(q)?this.getSymbolizersFromOlStyle(q):this.getSymbolizersFromOlStyle([q])}},t.prototype.getStyleTypeFromOlStyle=function(q){var Y;if(q.getImage()instanceof this.OlStyleImageConstructor)Y="Point";else if(q.getText()instanceof this.OlStyleTextConstructor)Y="Point";else if(q.getFill()instanceof this.OlStyleFillConstructor)Y="Fill";else{if(!q.getStroke()||q.getFill())throw new Error("StyleType could not be detected");Y="Line"}return Y},t.prototype.olStyleToGeoStylerStyle=function(q){return{name:"OL Style",rules:[this.getRuleFromOlStyle(q)]}},t.prototype.readStyle=function(q){var Y=this;return new Promise((function(H){try{Y.isOlParserStyleFct(q)?H({output:q.__geoStylerStyle}):H({output:Y.olStyleToGeoStylerStyle(q)})}catch(q){H({errors:[q]})}}))},t.prototype.writeStyle=function(q){var Y=this;return new Promise((function(H){var et=Y.checkForUnsupportedProperites(q);try{H({output:Y.getOlStyleTypeFromGeoStylerStyle(q),unsupportedProperties:et,warnings:et&&["Your style contains unsupportedProperties!"]})}catch(q){H({errors:[q]})}}))},t.prototype.checkForUnsupportedProperites=function(q){var Y=this,H={};if(q.rules.forEach((function(q){q.symbolizers.forEach((function(q){var et,it,nt,st=(nt="".concat(q.kind,"Symbolizer"))[0].toUpperCase()+nt.slice(1),ot=null===(it=null===(et=Y.unsupportedProperties)||void 0===et?void 0:et.Symbolizer)||void 0===it?void 0:it[st];ot&&("string"==typeof ot||ot instanceof String?(H.Symbolizer||(H.Symbolizer={}),H.Symbolizer[st]=ot):Object.keys(q).forEach((function(q){ot[q]&&(H.Symbolizer||(H.Symbolizer={}),H.Symbolizer[st]||(H.Symbolizer[st]={}),H.Symbolizer[st][q]=ot[q])})))}))})),Object.keys(H).length>0)return H},t.prototype.getOlStyleTypeFromGeoStylerStyle=function(q){var Y,H,et,it,nt,st,ot,lt,mt=q.rules;if(1===mt.length){var _t=void 0!==(null===(H=null===(Y=null==q?void 0:q.rules)||void 0===Y?void 0:Y[0])||void 0===H?void 0:H.filter),vt=void 0!==(null===(nt=null===(it=null===(et=null==q?void 0:q.rules)||void 0===et?void 0:et[0])||void 0===it?void 0:it.scaleDenominator)||void 0===nt?void 0:nt.min),bt=void 0!==(null===(lt=null===(ot=null===(st=null==q?void 0:q.rules)||void 0===st?void 0:st[0])||void 0===ot?void 0:ot.scaleDenominator)||void 0===lt?void 0:lt.max),Mt=!(!vt&&!bt),Et=Pt.default.containsGeoStylerFunctions(q),Rt=q.rules[0].symbolizers.length,It=mt[0].symbolizers.some((function(q){return"Text"===q.kind})),Tt=mt[0].symbolizers.some((function(q){return"Icon"===q.kind&&"string"==typeof q.image&&q.image.includes("{{")}));return _t||Mt||It||Tt||Et?this.geoStylerStyleToOlParserStyleFct(q):1===Rt?this.geoStylerStyleToOlStyle(q):this.geoStylerStyleToOlStyleArray(q)}return this.geoStylerStyleToOlParserStyleFct(q)},t.prototype.geoStylerStyleToOlStyle=function(q){var Y=q.rules[0].symbolizers[0];return this.getOlSymbolizerFromSymbolizer(Y)},t.prototype.geoStylerStyleToOlStyleArray=function(q){var Y=this,H=q.rules[0],et=[];return H.symbolizers.forEach((function(q){var H=Y.getOlSymbolizerFromSymbolizer(q);et.push(H)})),et},t.prototype.geoStylerStyleToOlParserStyleFct=function(q){var Y=this,H=q.rules,n=function(q,et){var it=[],st=It.METERS_PER_UNIT.m,ot=et*st*39.37*(25.4/.28);return H.forEach((function(H){var st,lt,mt=null===(st=null==H?void 0:H.scaleDenominator)||void 0===st?void 0:st.min,_t=null===(lt=null==H?void 0:H.scaleDenominator)||void 0===lt?void 0:lt.max,vt=!0;void 0===mt&&void 0===_t||(mt=(0,nt.isGeoStylerFunction)(mt)?Pt.default.evaluateNumberFunction(mt):mt,_t=(0,nt.isGeoStylerFunction)(_t)?Pt.default.evaluateNumberFunction(_t):_t,void 0!==mt&&ot<mt&&(vt=!1),void 0!==_t&&ot>=_t&&(vt=!1));var bt=!1;if(H.filter)try{bt=Y.geoStylerFilterToOlParserFilter(q,H.filter)}catch(q){bt=!1}else bt=!0;vt&&bt&&H.symbolizers.forEach((function(H){var nt=Y.getOlSymbolizerFromSymbolizer(H,q);if("function"!=typeof nt)it.push(nt);else{var st=nt(q,et);it.push(st)}}))})),it};return n.__geoStylerStyle=q,n},t.prototype.geoStylerFilterToOlParserFilter=function(q,Y){var H=this,et=!0,it=!1;({"&&":!0,"||":!0,"!":!0})[Y[0]]&&(it=!0);try{if(it)switch(Y[0]){case"&&":var st=!0,ot=Y.slice(1);ot.forEach((function(Y){H.geoStylerFilterToOlParserFilter(q,Y)||(st=!1)})),et=st;break;case"||":st=!1,(ot=Y.slice(1)).forEach((function(Y){H.geoStylerFilterToOlParserFilter(q,Y)&&(st=!0)})),et=st;break;case"!":et=!this.geoStylerFilterToOlParserFilter(q,Y[1]);break;default:throw new Error("Cannot parse Filter. Unknown combination or negation operator.")}else{var lt,mt=void 0;switch(mt=(0,nt.isGeoStylerFunction)(Y[1])?Pt.default.evaluateFunction(Y[1],q):q.get(Y[1]),lt=(0,nt.isGeoStylerFunction)(Y[2])?q.get(Pt.default.evaluateFunction(Y[2],q)):Y[2],Y[0]){case"==":et=""+mt==""+lt;break;case"*=":"string"==typeof lt&&"string"==typeof mt&&(et=!(lt.length>mt.length)&&-1!==mt.indexOf(lt));break;case"!=":et=""+mt!=""+lt;break;case"<":et=Number(mt)<Number(lt);break;case"<=":et=Number(mt)<=Number(lt);break;case">":et=Number(mt)>Number(lt);break;case">=":et=Number(mt)>=Number(lt);break;default:throw new Error("Cannot parse Filter. Unknown comparison operator.")}}}catch(q){throw new Error("Cannot parse Filter. Invalid structure.")}return et},t.prototype.getOlSymbolizerFromSymbolizer=function(q,Y){var H;switch(q.kind){case"Mark":H=this.getOlPointSymbolizerFromMarkSymbolizer(q,Y);break;case"Icon":H=this.getOlIconSymbolizerFromIconSymbolizer(q,Y);break;case"Text":H=this.getOlTextSymbolizerFromTextSymbolizer(q,Y);break;case"Line":H=this.getOlLineSymbolizerFromLineSymbolizer(q,Y);break;case"Fill":H=this.getOlPolygonSymbolizerFromFillSymbolizer(q,Y);break;default:var et=new this.OlStyleFillConstructor({color:"rgba(255,255,255,0.4)"}),it=new this.OlStyleStrokeConstructor({color:"#3399CC",width:1.25});H=new this.OlStyleConstructor({image:new this.OlStyleCircleConstructor({fill:et,stroke:it,radius:5}),fill:et,stroke:it})}return H},t.prototype.getOlPointSymbolizerFromMarkSymbolizer=function(q,Y){for(var H,et=0,it=Object.keys(q);et<it.length;et++){var st=it[et];(0,nt.isGeoStylerFunction)(q[st])&&(q[st]=Pt.default.evaluateFunction(q[st],Y))}(q.strokeColor||void 0!==q.strokeWidth)&&(H=new this.OlStyleStrokeConstructor({color:q.strokeColor&&void 0!==q.strokeOpacity?Pt.default.getRgbaColor(q.strokeColor,q.strokeOpacity):q.strokeColor,width:q.strokeWidth}));var ot,lt={fill:new this.OlStyleFillConstructor({color:q.color&&void 0!==q.opacity?Pt.default.getRgbaColor(q.color,q.opacity):q.color}),opacity:q.opacity||1,radius:q.radius||5,rotation:"number"==typeof q.rotate?q.rotate*Math.PI/180:void 0,stroke:H,displacement:"number"==typeof q.offset?q.offset:void 0};switch(q.wellKnownName){case"shape://dot":case"circle":ot=new this.OlStyleConstructor({image:new this.OlStyleCircleConstructor(lt)});break;case"square":lt.points=4,lt.angle=45*Math.PI/180,ot=new this.OlStyleConstructor({image:new this.OlStyleRegularshapeConstructor(lt)});break;case"triangle":lt.points=3,lt.angle=0,ot=new this.OlStyleConstructor({image:new this.OlStyleRegularshapeConstructor(lt)});break;case"star":lt.points=5,lt.radius2=lt.radius/2.5,lt.angle=0,ot=new this.OlStyleConstructor({image:new this.OlStyleRegularshapeConstructor(lt)});break;case"shape://plus":case"cross":lt.points=4,lt.radius2=0,lt.angle=0,void 0===lt.stroke&&(lt.stroke=new this.OlStyleStrokeConstructor({color:"#000"})),ot=new this.OlStyleConstructor({image:new this.OlStyleRegularshapeConstructor(lt)});break;case"shape://times":case"x":lt.points=4,lt.radius2=0,lt.angle=45*Math.PI/180,void 0===lt.stroke&&(lt.stroke=new this.OlStyleStrokeConstructor({color:"#000"})),ot=new this.OlStyleConstructor({image:new this.OlStyleRegularshapeConstructor(lt)});break;case"shape://backslash":lt.points=2,lt.angle=2*Math.PI-Math.PI/4,void 0===lt.stroke&&(lt.stroke=new this.OlStyleStrokeConstructor({color:"#000"})),ot=new this.OlStyleConstructor({image:new this.OlStyleRegularshapeConstructor(lt)});break;case"shape://horline":lt.points=2,lt.angle=Math.PI/2,void 0===lt.stroke&&(lt.stroke=new this.OlStyleStrokeConstructor({color:"#000"})),ot=new this.OlStyleConstructor({image:new this.OlStyleRegularshapeConstructor(lt)});break;case"shape://oarrow":case"shape://carrow":lt.points=3,lt.angle=Math.PI/2,ot=new this.OlStyleConstructor({image:new this.OlStyleRegularshapeConstructor(lt)});break;case"shape://slash":lt.points=2,lt.angle=Math.PI/4,void 0===lt.stroke&&(lt.stroke=new this.OlStyleStrokeConstructor({color:"#000"})),ot=new this.OlStyleConstructor({image:new this.OlStyleRegularshapeConstructor(lt)});break;case"shape://vertline":lt.points=2,lt.angle=0,void 0===lt.stroke&&(lt.stroke=new this.OlStyleStrokeConstructor({color:"#000"})),ot=new this.OlStyleConstructor({image:new this.OlStyleRegularshapeConstructor(lt)});break;default:if(Pt.default.getIsFontGlyphBased(q)){ot=new this.OlStyleConstructor({text:new this.OlStyleTextConstructor({text:Pt.default.getCharacterForMarkSymbolizer(q),font:Pt.default.getTextFontForMarkSymbolizer(q),fill:lt.fill,stroke:lt.stroke,rotation:lt.rotation})});break}throw new Error("MarkSymbolizer cannot be parsed. Unsupported WellKnownName.")}return ot},t.prototype.getOlIconSymbolizerFromIconSymbolizer=function(q,Y){for(var H=this,it=0,st=Object.keys(q);it<st.length;it++){var ot=st[it];(0,nt.isGeoStylerFunction)(q[ot])&&(q[ot]=Pt.default.evaluateFunction(q[ot],Y))}var lt={src:q.image,crossOrigin:"anonymous",opacity:q.opacity,scale:q.size||1,rotation:"number"==typeof q.rotate?q.rotate*Math.PI/180:void 0,displacement:q.offset},mt=new RegExp("\\{\\{.*?\\}\\}","g");return"string"==typeof q.image&&q.image.match(mt)?function(Y){var it,nt=Pt.default.resolveAttributeTemplate(Y,q.image,"");return nt||(nt=q.image+""),H.olIconStyleCache[nt]?((it=H.olIconStyleCache[nt]).setScale(lt.scale),void 0!==lt.rotation&&it.setRotation(lt.rotation),void 0!==lt.opacity&&it.setOpacity(lt.opacity)):(it=new H.OlStyleIconConstructor(et(et({},lt),{src:nt})),H.olIconStyleCache[nt]=it),new H.OlStyleConstructor({image:it})}:new this.OlStyleConstructor({image:new this.OlStyleIconConstructor(et({},lt))})},t.prototype.getOlLineSymbolizerFromLineSymbolizer=function(q,Y){for(var H=0,et=Object.keys(q);H<et.length;H++){var it=et[H];(0,nt.isGeoStylerFunction)(q[it])&&(q[it]=Pt.default.evaluateFunction(q[it],Y))}return new this.OlStyleConstructor({stroke:new this.OlStyleStrokeConstructor({color:q.color&&null!==q.opacity&&void 0!==q.opacity?Pt.default.getRgbaColor(q.color,q.opacity):q.color,width:q.width,lineCap:q.cap,lineJoin:q.join,lineDash:q.dasharray,lineDashOffset:q.dashOffset})})},t.prototype.getOlPolygonSymbolizerFromFillSymbolizer=function(q,Y){for(var H=0,et=Object.keys(q);H<et.length;H++){var it=et[H];(0,nt.isGeoStylerFunction)(q[it])&&(q[it]=Pt.default.evaluateFunction(q[it],Y))}var st=q.color?new this.OlStyleFillConstructor({color:null!==q.opacity&&void 0!==q.opacity?Pt.default.getRgbaColor(q.color,q.opacity):q.color}):null,ot=q.outlineColor||q.outlineWidth?new this.OlStyleStrokeConstructor({color:q.outlineColor&&Number.isFinite(q.outlineOpacity)?Pt.default.getRgbaColor(q.outlineColor,q.outlineOpacity):q.outlineColor,width:q.outlineWidth,lineDash:q.outlineDasharray}):null,lt=new this.OlStyleConstructor({fill:st,stroke:ot});if(q.graphicFill){var mt=this.getOlPatternFromGraphicFill(q.graphicFill);st||(st=new this.OlStyleFillConstructor({})),mt&&st.setColor(mt),lt.setFill(st)}return lt},t.prototype.getOlPatternFromGraphicFill=function(q){var Y;if((0,nt.isIconSymbolizer)(q)){var H=null==(Y=this.getOlIconSymbolizerFromIconSymbolizer(q))?void 0:Y.getImage();if(null==H||H.load(),(null==H?void 0:H.getImageState())!==st.default.LOADED)return null}else{if(!(0,nt.isMarkSymbolizer)(q))return null;Y=this.getOlPointSymbolizerFromMarkSymbolizer(q)}var et=Y.clone(),it=et.getImage(),lt=document.createElement("canvas"),mt=lt.getContext("2d"),_t=it.getScale()||1;it.setScale(1);var vt=it.getSize(),bt=(0,Tt.toContext)(mt,{pixelRatio:_t,size:vt});bt.setStyle(et);var Mt=vt.map((function(q){return q/2}));return bt.drawGeometry(new ot.default(Mt)),mt.createPattern(lt,"repeat")},t.prototype.getOlTextSymbolizerFromTextSymbolizer=function(q,Y){for(var H=this,it=0,st=Object.keys(q);it<st.length;it++){var ot=st[it];(0,nt.isGeoStylerFunction)(q[ot])&&(q[ot]=Pt.default.evaluateFunction(q[ot],Y))}var lt,mt={font:Pt.default.getTextFont(q),fill:new this.OlStyleFillConstructor({color:q.color&&null!==q.opacity&&void 0!==q.opacity?Pt.default.getRgbaColor(q.color,q.opacity):q.color}),stroke:new this.OlStyleStrokeConstructor({color:q.haloColor&&null!==q.opacity&&void 0!==q.opacity?Pt.default.getRgbaColor(q.haloColor,q.opacity):q.haloColor,width:q.haloWidth?q.haloWidth:0}),overflow:q.allowOverlap,offsetX:q.offset?q.offset[0]:0,offsetY:q.offset?q.offset[1]:0,rotation:"number"==typeof q.rotate?q.rotate*Math.PI/180:void 0},_t=new RegExp("\\{\\{.*?\\}\\}","g");return(0,nt.isGeoStylerStringFunction)(q.label)||(lt=q.label?q.label.match(_t):null),lt?function(Y){var it=new H.OlStyleTextConstructor(et({text:Pt.default.resolveAttributeTemplate(Y,q.label,"")},mt));return new H.OlStyleConstructor({text:it})}:new this.OlStyleConstructor({text:new this.OlStyleTextConstructor(et({text:q.label},mt))})},t.title="OpenLayers Style Parser",t}();Y.OlStyleParser=Ft,Y.default=Ft},2661:function(q,Y,H){"use strict";var et=this&&this.__importDefault||function(q){return q&&q.__esModule?q:{default:q}};Object.defineProperty(Y,"__esModule",{value:!0}),Y.DUMMY_MARK_SYMBOLIZER_FONT=void 0;var it=H(2075),nt=et(H(9003)),st=/^ttf:\/\/(.+)#(.+)$/;Y.DUMMY_MARK_SYMBOLIZER_FONT="geostyler-mark-symbolizer";var ot=function(){function t(){}return t.getRgbaColor=function(q,Y){if((0,it.isGeoStylerStringFunction)(q)&&(q=t.evaluateStringFunction(q)),"string"==typeof q){if(q.startsWith("rgba("))return q;if(/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(q)){var H=parseInt(q.slice(1,3),16),et=parseInt(q.slice(3,5),16),nt=parseInt(q.slice(5,7),16);return(0,it.isGeoStylerNumberFunction)(Y)&&(Y=t.evaluateNumberFunction(Y)),Y<0&&(Y=1),"rgba("+H+", "+et+", "+nt+", "+Y+")"}}},t.splitRgbaColor=function(q){var Y=q.substring(q.indexOf("(")+1,q.lastIndexOf(")")).split(/,\s*/);return[parseInt(Y[0],10),parseInt(Y[1],10),parseInt(Y[2],10),parseFloat(Y[3])]},t.getHexColor=function(q){if(q.startsWith("#"))return q;if(q.startsWith("rgb")){var Y=t.splitRgbaColor(q);return t.getHexCodeFromRgbArray(Y)}if(void 0!==nt.default[q.toLocaleLowerCase()]){var H=nt.default[q.toLocaleLowerCase()];return t.getHexCodeFromRgbArray(H)}},t.getHexCodeFromRgbArray=function(q){return"#"+q.map((function(q,Y){var H=q.toString(16);return Y<3?1===H.length?"0"+H:H:""})).join("")},t.getOpacity=function(q){if(q.startsWith("rgba(")){var Y=t.splitRgbaColor(q);return 4===Y.length?Y[3]:void 0}},t.getTextFont=function(q){return"Normal "+q.size+"px "+q.font},t.getIsFontGlyphBased=function(q){return st.test(q.wellKnownName)},t.getIsMarkSymbolizerFont=function(q){var H=Y.DUMMY_MARK_SYMBOLIZER_FONT;return q.substring(q.length-H.length,q.length)===H},t.getTextFontForMarkSymbolizer=function(q){var H=q.wellKnownName.match(st);if(!H)throw new Error("Could not parse font-based well known name: ".concat(q.wellKnownName));var et=H[1];return"Normal ".concat(q.radius||5,"px '").concat(et,"', ").concat(Y.DUMMY_MARK_SYMBOLIZER_FONT)},t.getCharacterForMarkSymbolizer=function(q){var Y=q.wellKnownName.match(st);if(!Y)throw new Error("Could not parse font-based well known name: ".concat(q.wellKnownName));return String.fromCharCode(parseInt(Y[2],16))},t.getFontNameFromOlFont=function(q){var Y=q.match(/(?:\d+\S+) '?"?([^,'"]+)/);if(!Y)throw new Error("Could not find font family name in the following string: ".concat(q));return Y[1]},t.getSizeFromOlFont=function(q){var Y=q.match(/(?:(\d+)px)/);return Y?parseInt(Y[1],10):0},t.resolveAttributeTemplate=function(q,Y,H,et){void 0===H&&(H="n.v."),void 0===et&&(et=function(q,Y){return Y});var it=new RegExp("\\{\\{(.*?)\\}\\}","g"),nt=Y.match(it);return nt&&nt.forEach((function(it){for(var nt=0,st=0,ot=Object.entries(q.getProperties());st<ot.length;st++){var lt=ot[st],mt=lt[0],_t=lt[1];if(it.slice(2,it.length-2).toLowerCase()===mt.toLowerCase()){Y=Y.replace(it,et(mt,_t));break}nt++}nt===Object.keys(q.getProperties()).length&&(Y=Y.replace(it,H))})),Y},t.evaluateFunction=function(q,Y){if("property"===q.name){if(!Y)throw new Error("Could not evalute 'property' function. Feature ".concat(Y," is not defined."));return(0,it.isGeoStylerStringFunction)(q.args[0])?null==Y?void 0:Y.get(t.evaluateStringFunction(q.args[0],Y)):null==Y?void 0:Y.get(q.args[0])}return(0,it.isGeoStylerStringFunction)(q)?t.evaluateStringFunction(q,Y):(0,it.isGeoStylerNumberFunction)(q)?t.evaluateNumberFunction(q,Y):(0,it.isGeoStylerBooleanFunction)(q)?t.evaluateBooleanFunction(q,Y):(0,it.isGeoStylerUnknownFunction)(q)?t.evaluateUnknownFunction(q,Y):void 0},t.evaluateBooleanFunction=function(q,Y){var H=q.args.map((function(q){return(0,it.isGeoStylerFunction)(q)?t.evaluateFunction(q,Y):q}));switch(q.name){case"between":return H[0]>=H[1]&&H[0]<=H[2];case"double2bool":default:return!1;case"in":return H.slice(1).includes(H[0]);case"parseBoolean":return!!H[0];case"strEndsWith":return H[0].endsWith(H[1]);case"strEqualsIgnoreCase":return H[0].toLowerCase()===H[1].toLowerCase();case"strMatches":return new RegExp(H[1]).test(H[0]);case"strStartsWith":return H[0].startsWith(H[1])}},t.evaluateNumberFunction=function(q,Y){if("pi"===q.name)return Math.PI;if("random"===q.name)return Math.random();var H=q.args.map((function(q){return(0,it.isGeoStylerFunction)(q)?t.evaluateFunction(q,Y):q}));switch(q.name){case"abs":return Math.abs(H[0]);case"acos":return Math.acos(H[0]);case"asin":return Math.asin(H[0]);case"atan":return Math.atan(H[0]);case"atan2":case"rint":default:return H[0];case"ceil":return Math.ceil(H[0]);case"cos":return Math.cos(H[0]);case"exp":return Math.exp(H[0]);case"floor":return Math.floor(H[0]);case"log":return Math.log(H[0]);case"max":return Math.max.apply(Math,H);case"min":return Math.min.apply(Math,H);case"modulo":return H[0]%H[1];case"pow":return Math.pow(H[0],H[1]);case"round":return Math.round(H[0]);case"sin":return Math.sin(H[0]);case"sqrt":return Math.sqrt(H[0]);case"strIndexOf":return H[0].indexOf(H[1]);case"strLastIndexOf":return H[0].lastIndexOf(H[1]);case"strLength":return H[0].length;case"tan":return Math.tan(H[0]);case"toDegrees":return H[0]*(180/Math.PI);case"toRadians":return H[0]*(Math.PI/180)}},t.evaluateUnknownFunction=function(q,Y){var H=q.args.map((function(q){return(0,it.isGeoStylerFunction)(q)?t.evaluateFunction(q,Y):q}));return"property"===q.name?null==Y?void 0:Y.get(H[0]):H[0]},t.evaluateStringFunction=function(q,Y){var H,et=q.args.map((function(q){return(0,it.isGeoStylerFunction)(q)?t.evaluateFunction(q,Y):q}));switch(q.name){case"numberFormat":case"strAbbreviate":default:return et[0];case"strCapitalize":for(var nt=et[0].toLowerCase().split(" "),st=0,ot=nt;st<ot.length;st++){var lt=ot[st];lt=lt.charAt(0).toUpperCase()+lt.substring(1)}return nt.join(" ");case"strConcat":return et.join();case"strDefaultIfBlank":return(null===(H=et[0])||void 0===H?void 0:H.length)<1?et[1]:et[0];case"strReplace":return!0===et[3]?et[0].replaceAll(et[1],et[2]):et[0].replace(et[1],et[2]);case"strStripAccents":return et[0].normalize("NFKD").replace(/[\u0300-\u036f]/g,"");case"strSubstring":return et[0].substring(et[1],et[2]);case"strSubstringStart":return et[0].substring(et[1]);case"strToLowerCase":return et[0].toLowerCase();case"strToUpperCase":return et[0].toUpperCase();case"strTrim":return et[0].trim()}},t.containsGeoStylerFunctions=function(q){return q.rules.some((function(q){var Y,H,et,nt,st=null===(Y=q.filter)||void 0===Y?void 0:Y.some(it.isGeoStylerFunction),ot=null===(H=q.symbolizers)||void 0===H?void 0:H.some((function(q){return Object.values(q).some(it.isGeoStylerFunction)})),lt=(0,it.isGeoStylerFunction)(null===(et=null==q?void 0:q.scaleDenominator)||void 0===et?void 0:et.max)||(0,it.isGeoStylerFunction)(null===(nt=null==q?void 0:q.scaleDenominator)||void 0===nt?void 0:nt.min);return st||ot||lt}))},t}();Y.default=ot},9003:q=>{"use strict";q.exports={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}},3880:(q,Y)=>{"use strict";Object.defineProperty(Y,"__esModule",{value:!0})},2075:function(q,Y,H){"use strict";var et=this&&this.__createBinding||(Object.create?function(q,Y,H,et){void 0===et&&(et=H);var it=Object.getOwnPropertyDescriptor(Y,H);it&&!("get"in it?!Y.__esModule:it.writable||it.configurable)||(it={enumerable:!0,get:function(){return Y[H]}}),Object.defineProperty(q,et,it)}:function(q,Y,H,et){void 0===et&&(et=H),q[et]=Y[H]}),it=this&&this.__exportStar||function(q,Y){for(var H in q)"default"===H||Object.prototype.hasOwnProperty.call(Y,H)||et(Y,q,H)};Object.defineProperty(Y,"__esModule",{value:!0}),it(H(7760),Y),it(H(3880),Y),it(H(9859),Y)},7760:(q,Y)=>{"use strict";Object.defineProperty(Y,"__esModule",{value:!0})},9859:function(q,Y,H){"use strict";var et=this&&this.__importDefault||function(q){return q&&q.__esModule?q:{default:q}};Object.defineProperty(Y,"__esModule",{value:!0}),Y.isGeoStylerFunction=Y.isGeoStylerUnknownFunction=Y.isGeoStylerBooleanFunction=Y.isGeoStylerStringFunction=Y.isGeoStylerNumberFunction=Y.isGrayChannel=Y.isRgbChannel=Y.isRule=Y.isRasterSymbolizer=Y.isFillSymbolizer=Y.isLineSymbolizer=Y.isMarkSymbolizer=Y.isTextSymbolizer=Y.isIconSymbolizer=Y.isPointSymbolizer=Y.isSymbolizer=Y.isNegationFilter=Y.isCombinationFilter=Y.isComparisonFilter=Y.isFilter=Y.isNegationOperator=Y.isCombinationOperator=Y.isComparisonOperator=Y.isOperator=Y.isScaleDenominator=Y.isPropertyType=Y.isFunctionCall=Y.isExpression=void 0;var it=et(H(7037)),nt=et(H(1763)),st=et(H(1584));Y.isExpression=function(q){return(0,Y.isFunctionCall)(q)||(0,Y.isPropertyType)(q)},Y.isFunctionCall=function(q){return"functioncall"===q.type&&q.hasOwnProperty("name")&&(0,it.default)(q.name)&&q.hasOwnProperty("args")&&Array.isArray(q.args)&&q.args.every((function(q){return(0,Y.isExpression)(q)}))},Y.isPropertyType=function(q){return(0,it.default)(q)||(0,nt.default)(q)||(0,st.default)(q)||null===q},Y.isScaleDenominator=function(q){return((null==q?void 0:q.min)||(null==q?void 0:q.max))&&(!q.min||(0,Y.isFilter)(q.min))&&(!q.max||(0,Y.isFilter)(q.max))},Y.isOperator=function(q){return(0,Y.isComparisonOperator)(q)||(0,Y.isCombinationOperator)(q)||(0,Y.isNegationOperator)(q)},Y.isComparisonOperator=function(q){return["==","*=","!=","<","<=",">",">=","<=x<="].includes(q)},Y.isCombinationOperator=function(q){return["&&","||"].includes(q)},Y.isNegationOperator=function(q){return"!"===q},Y.isFilter=function(q){return(0,Y.isComparisonFilter)(q)||(0,Y.isCombinationFilter)(q)||(0,Y.isGeoStylerBooleanFunction)(q)||(0,Y.isNegationFilter)(q)},Y.isComparisonFilter=function(q){var H=q&&"<=x<="===q[0]?4:3;return Array.isArray(q)&&q.length===H&&(0,Y.isComparisonOperator)(q[0])&&((0,Y.isGeoStylerBooleanFunction)(q[1])||(0,it.default)(q[1]))&&(0,Y.isPropertyType)(q[2])&&("<=x<="!==q[0]||(0,nt.default)(q[3]))},Y.isCombinationFilter=function(q){return Array.isArray(q)&&q.length>=3&&(0,Y.isCombinationOperator)(q[0])&&q.every((function(q,H){return 0===H||(0,Y.isFilter)(q)}))},Y.isNegationFilter=function(q){return Array.isArray(q)&&2===q.length&&(0,Y.isNegationOperator)(q[0])&&(0,Y.isFilter)(q[1])},Y.isSymbolizer=function(q){return["Fill","Icon","Line","Text","Mark","Raster"].includes(null==q?void 0:q.kind)},Y.isPointSymbolizer=function(q){return["Icon","Text","Mark"].includes(null==q?void 0:q.kind)},Y.isIconSymbolizer=function(q){return"Icon"===(null==q?void 0:q.kind)},Y.isTextSymbolizer=function(q){return"Text"===(null==q?void 0:q.kind)},Y.isMarkSymbolizer=function(q){return"Mark"===(null==q?void 0:q.kind)&&(0,it.default)(null==q?void 0:q.wellKnownName)},Y.isLineSymbolizer=function(q){return"Line"===(null==q?void 0:q.kind)},Y.isFillSymbolizer=function(q){return"Fill"===(null==q?void 0:q.kind)},Y.isRasterSymbolizer=function(q){return"Raster"===(null==q?void 0:q.kind)},Y.isRule=function(q){return(0,it.default)(null==q?void 0:q.name)&&(!(null==q?void 0:q.filter)||(0,Y.isFilter)(q.filter))&&(!(null==q?void 0:q.scaleDenominator)||(0,Y.isScaleDenominator)(q.scaleDenominator))&&(null==q?void 0:q.symbolizers.every((function(q){return(0,Y.isSymbolizer)(q)})))},Y.isRgbChannel=function(q){return void 0!==q.redChannel||void 0!==q.greenChannel||void 0!==q.blueChannel},Y.isGrayChannel=function(q){return void 0!==q.grayChannel},Y.isGeoStylerNumberFunction=function(q){return["abs","acos","asin","atan","atan2","ceil","cos","exp","floor","log","max","min","modulo","pi","pow","random","rint","round","sin","sqrt","strIndexOf","strLastIndexOf","strLength","tan","toDegrees","toRadians"].includes(null==q?void 0:q.name)},Y.isGeoStylerStringFunction=function(q){return["numberFormat","strAbbreviate","strCapitalize","strConcat","strDefaultIfBlank","strReplace","strStripAccents","strSubstring","strSubstringStart","strToLowerCase","strToUpperCase","strTrim"].includes(null==q?void 0:q.name)},Y.isGeoStylerBooleanFunction=function(q){return["between","double2bool","in","parseBoolean","strEndsWith","strEqualsIgnoreCase","strMatches","strStartsWith"].includes(null==q?void 0:q.name)},Y.isGeoStylerUnknownFunction=function(q){return["property"].includes(null==q?void 0:q.name)},Y.isGeoStylerFunction=function(q){return(0,Y.isGeoStylerBooleanFunction)(q)||(0,Y.isGeoStylerNumberFunction)(q)||(0,Y.isGeoStylerStringFunction)(q)||(0,Y.isGeoStylerUnknownFunction)(q)}},2705:(q,Y,H)=>{var et=H(5639).Symbol;q.exports=et},4239:(q,Y,H)=>{var et=H(2705),it=H(9607),nt=H(2333),st=et?et.toStringTag:void 0;q.exports=function(q){return null==q?void 0===q?"[object Undefined]":"[object Null]":st&&st in Object(q)?it(q):nt(q)}},1957:(q,Y,H)=>{var et="object"==typeof H.g&&H.g&&H.g.Object===Object&&H.g;q.exports=et},9607:(q,Y,H)=>{var et=H(2705),it=Object.prototype,nt=it.hasOwnProperty,st=it.toString,ot=et?et.toStringTag:void 0;q.exports=function(q){var Y=nt.call(q,ot),H=q[ot];try{q[ot]=void 0;var et=!0}catch(q){}var it=st.call(q);return et&&(Y?q[ot]=H:delete q[ot]),it}},2333:q=>{var Y=Object.prototype.toString;q.exports=function(q){return Y.call(q)}},5639:(q,Y,H)=>{var et=H(1957),it="object"==typeof self&&self&&self.Object===Object&&self,nt=et||it||Function("return this")();q.exports=nt},1469:q=>{var Y=Array.isArray;q.exports=Y},1584:(q,Y,H)=>{var et=H(4239),it=H(7005);q.exports=function(q){return!0===q||!1===q||it(q)&&"[object Boolean]"==et(q)}},1763:(q,Y,H)=>{var et=H(4239),it=H(7005);q.exports=function(q){return"number"==typeof q||it(q)&&"[object Number]"==et(q)}},7005:q=>{q.exports=function(q){return null!=q&&"object"==typeof q}},7037:(q,Y,H)=>{var et=H(4239),it=H(1469),nt=H(7005);q.exports=function(q){return"string"==typeof q||!it(q)&&nt(q)&&"[object String]"==et(q)}},4331:function(q){q.exports=function(){"use strict";function t(q,Y,H,et,it){!function t(q,Y,H,et,it){for(;et>H;){if(et-H>600){var nt=et-H+1,st=Y-H+1,ot=Math.log(nt),lt=.5*Math.exp(2*ot/3),mt=.5*Math.sqrt(ot*lt*(nt-lt)/nt)*(st-nt/2<0?-1:1);t(q,Y,Math.max(H,Math.floor(Y-st*lt/nt+mt)),Math.min(et,Math.floor(Y+(nt-st)*lt/nt+mt)),it)}var _t=q[Y],vt=H,bt=et;for(e(q,H,Y),it(q[et],_t)>0&&e(q,H,et);vt<bt;){for(e(q,vt,bt),vt++,bt--;it(q[vt],_t)<0;)vt++;for(;it(q[bt],_t)>0;)bt--}0===it(q[H],_t)?e(q,H,bt):e(q,++bt,et),bt<=Y&&(H=bt+1),Y<=bt&&(et=bt-1)}}(q,Y,H||0,et||q.length-1,it||i)}function e(q,Y,H){var et=q[Y];q[Y]=q[H],q[H]=et}function i(q,Y){return q<Y?-1:q>Y?1:0}var n=function(q){void 0===q&&(q=9),this._maxEntries=Math.max(4,q),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function r(q,Y,H){if(!H)return Y.indexOf(q);for(var et=0;et<Y.length;et++)if(H(q,Y[et]))return et;return-1}function s(q,Y){o(q,0,q.children.length,Y,q)}function o(q,Y,H,et,it){it||(it=g(null)),it.minX=1/0,it.minY=1/0,it.maxX=-1/0,it.maxY=-1/0;for(var nt=Y;nt<H;nt++){var st=q.children[nt];a(it,q.leaf?et(st):st)}return it}function a(q,Y){return q.minX=Math.min(q.minX,Y.minX),q.minY=Math.min(q.minY,Y.minY),q.maxX=Math.max(q.maxX,Y.maxX),q.maxY=Math.max(q.maxY,Y.maxY),q}function h(q,Y){return q.minX-Y.minX}function l(q,Y){return q.minY-Y.minY}function u(q){return(q.maxX-q.minX)*(q.maxY-q.minY)}function c(q){return q.maxX-q.minX+(q.maxY-q.minY)}function d(q,Y){return q.minX<=Y.minX&&q.minY<=Y.minY&&Y.maxX<=q.maxX&&Y.maxY<=q.maxY}function f(q,Y){return Y.minX<=q.maxX&&Y.minY<=q.maxY&&Y.maxX>=q.minX&&Y.maxY>=q.minY}function g(q){return{children:q,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function p(q,Y,H,et,it){for(var nt=[Y,H];nt.length;)if(!((H=nt.pop())-(Y=nt.pop())<=et)){var st=Y+Math.ceil((H-Y)/et/2)*et;t(q,st,Y,H,it),nt.push(Y,st,st,H)}}return n.prototype.all=function(){return this._all(this.data,[])},n.prototype.search=function(q){var Y=this.data,H=[];if(!f(q,Y))return H;for(var et=this.toBBox,it=[];Y;){for(var nt=0;nt<Y.children.length;nt++){var st=Y.children[nt],ot=Y.leaf?et(st):st;f(q,ot)&&(Y.leaf?H.push(st):d(q,ot)?this._all(st,H):it.push(st))}Y=it.pop()}return H},n.prototype.collides=function(q){var Y=this.data;if(!f(q,Y))return!1;for(var H=[];Y;){for(var et=0;et<Y.children.length;et++){var it=Y.children[et],nt=Y.leaf?this.toBBox(it):it;if(f(q,nt)){if(Y.leaf||d(q,nt))return!0;H.push(it)}}Y=H.pop()}return!1},n.prototype.load=function(q){if(!q||!q.length)return this;if(q.length<this._minEntries){for(var Y=0;Y<q.length;Y++)this.insert(q[Y]);return this}var H=this._build(q.slice(),0,q.length-1,0);if(this.data.children.length)if(this.data.height===H.height)this._splitRoot(this.data,H);else{if(this.data.height<H.height){var et=this.data;this.data=H,H=et}this._insert(H,this.data.height-H.height-1,!0)}else this.data=H;return this},n.prototype.insert=function(q){return q&&this._insert(q,this.data.height-1),this},n.prototype.clear=function(){return this.data=g([]),this},n.prototype.remove=function(q,Y){if(!q)return this;for(var H,et,it,nt=this.data,st=this.toBBox(q),ot=[],lt=[];nt||ot.length;){if(nt||(nt=ot.pop(),et=ot[ot.length-1],H=lt.pop(),it=!0),nt.leaf){var mt=r(q,nt.children,Y);if(-1!==mt)return nt.children.splice(mt,1),ot.push(nt),this._condense(ot),this}it||nt.leaf||!d(nt,st)?et?(H++,nt=et.children[H],it=!1):nt=null:(ot.push(nt),lt.push(H),H=0,et=nt,nt=nt.children[0])}return this},n.prototype.toBBox=function(q){return q},n.prototype.compareMinX=function(q,Y){return q.minX-Y.minX},n.prototype.compareMinY=function(q,Y){return q.minY-Y.minY},n.prototype.toJSON=function(){return this.data},n.prototype.fromJSON=function(q){return this.data=q,this},n.prototype._all=function(q,Y){for(var H=[];q;)q.leaf?Y.push.apply(Y,q.children):H.push.apply(H,q.children),q=H.pop();return Y},n.prototype._build=function(q,Y,H,et){var it,nt=H-Y+1,st=this._maxEntries;if(nt<=st)return s(it=g(q.slice(Y,H+1)),this.toBBox),it;et||(et=Math.ceil(Math.log(nt)/Math.log(st)),st=Math.ceil(nt/Math.pow(st,et-1))),(it=g([])).leaf=!1,it.height=et;var ot=Math.ceil(nt/st),lt=ot*Math.ceil(Math.sqrt(st));p(q,Y,H,lt,this.compareMinX);for(var mt=Y;mt<=H;mt+=lt){var _t=Math.min(mt+lt-1,H);p(q,mt,_t,ot,this.compareMinY);for(var vt=mt;vt<=_t;vt+=ot){var bt=Math.min(vt+ot-1,_t);it.children.push(this._build(q,vt,bt,et-1))}}return s(it,this.toBBox),it},n.prototype._chooseSubtree=function(q,Y,H,et){for(;et.push(Y),!Y.leaf&&et.length-1!==H;){for(var it=1/0,nt=1/0,st=void 0,ot=0;ot<Y.children.length;ot++){var lt=Y.children[ot],mt=u(lt),_t=(vt=q,bt=lt,(Math.max(bt.maxX,vt.maxX)-Math.min(bt.minX,vt.minX))*(Math.max(bt.maxY,vt.maxY)-Math.min(bt.minY,vt.minY))-mt);_t<nt?(nt=_t,it=mt<it?mt:it,st=lt):_t===nt&&mt<it&&(it=mt,st=lt)}Y=st||Y.children[0]}var vt,bt;return Y},n.prototype._insert=function(q,Y,H){var et=H?q:this.toBBox(q),it=[],nt=this._chooseSubtree(et,this.data,Y,it);for(nt.children.push(q),a(nt,et);Y>=0&&it[Y].children.length>this._maxEntries;)this._split(it,Y),Y--;this._adjustParentBBoxes(et,it,Y)},n.prototype._split=function(q,Y){var H=q[Y],et=H.children.length,it=this._minEntries;this._chooseSplitAxis(H,it,et);var nt=this._chooseSplitIndex(H,it,et),st=g(H.children.splice(nt,H.children.length-nt));st.height=H.height,st.leaf=H.leaf,s(H,this.toBBox),s(st,this.toBBox),Y?q[Y-1].children.push(st):this._splitRoot(H,st)},n.prototype._splitRoot=function(q,Y){this.data=g([q,Y]),this.data.height=q.height+1,this.data.leaf=!1,s(this.data,this.toBBox)},n.prototype._chooseSplitIndex=function(q,Y,H){for(var et,it,nt,st,ot,lt,mt,_t=1/0,vt=1/0,bt=Y;bt<=H-Y;bt++){var Mt=o(q,0,bt,this.toBBox),Et=o(q,bt,H,this.toBBox),Rt=(it=Mt,nt=Et,st=Math.max(it.minX,nt.minX),ot=Math.max(it.minY,nt.minY),lt=Math.min(it.maxX,nt.maxX),mt=Math.min(it.maxY,nt.maxY),Math.max(0,lt-st)*Math.max(0,mt-ot)),It=u(Mt)+u(Et);Rt<_t?(_t=Rt,et=bt,vt=It<vt?It:vt):Rt===_t&&It<vt&&(vt=It,et=bt)}return et||H-Y},n.prototype._chooseSplitAxis=function(q,Y,H){var et=q.leaf?this.compareMinX:h,it=q.leaf?this.compareMinY:l;this._allDistMargin(q,Y,H,et)<this._allDistMargin(q,Y,H,it)&&q.children.sort(et)},n.prototype._allDistMargin=function(q,Y,H,et){q.children.sort(et);for(var it=this.toBBox,nt=o(q,0,Y,it),st=o(q,H-Y,H,it),ot=c(nt)+c(st),lt=Y;lt<H-Y;lt++){var mt=q.children[lt];a(nt,q.leaf?it(mt):mt),ot+=c(nt)}for(var _t=H-Y-1;_t>=Y;_t--){var vt=q.children[_t];a(st,q.leaf?it(vt):vt),ot+=c(st)}return ot},n.prototype._adjustParentBBoxes=function(q,Y,H){for(var et=H;et>=0;et--)a(Y[et],q)},n.prototype._condense=function(q){for(var Y=q.length-1,H=void 0;Y>=0;Y--)0===q[Y].children.length?Y>0?(H=q[Y-1].children).splice(H.indexOf(q[Y]),1):this.clear():s(q[Y],this.toBBox)},n}()},7061:(q,Y,H)=>{var et=H(8698).default;function r(){"use strict";q.exports=r=function(){return Y},q.exports.__esModule=!0,q.exports.default=q.exports;var Y={},H=Object.prototype,it=H.hasOwnProperty,nt=Object.defineProperty||function(q,Y,H){q[Y]=H.value},st="function"==typeof Symbol?Symbol:{},ot=st.iterator||"@@iterator",lt=st.asyncIterator||"@@asyncIterator",mt=st.toStringTag||"@@toStringTag";function c(q,Y,H){return Object.defineProperty(q,Y,{value:H,enumerable:!0,configurable:!0,writable:!0}),q[Y]}try{c({},"")}catch(q){c=function(q,Y,H){return q[Y]=H}}function d(q,Y,H,et){var it=Y&&Y.prototype instanceof p?Y:p,st=Object.create(it.prototype),ot=new O(et||[]);return nt(st,"_invoke",{value:w(q,H,ot)}),st}function f(q,Y,H){try{return{type:"normal",arg:q.call(Y,H)}}catch(q){return{type:"throw",arg:q}}}Y.wrap=d;var _t={};function p(){}function m(){}function y(){}var vt={};c(vt,ot,(function(){return this}));var bt=Object.getPrototypeOf,Mt=bt&&bt(bt(P([])));Mt&&Mt!==H&&it.call(Mt,ot)&&(vt=Mt);var Et=y.prototype=p.prototype=Object.create(vt);function b(q){["next","throw","return"].forEach((function(Y){c(q,Y,(function(q){return this._invoke(Y,q)}))}))}function M(q,Y){function i(H,nt,st,ot){var lt=f(q[H],q,nt);if("throw"!==lt.type){var mt=lt.arg,_t=mt.value;return _t&&"object"==et(_t)&&it.call(_t,"__await")?Y.resolve(_t.__await).then((function(q){i("next",q,st,ot)}),(function(q){i("throw",q,st,ot)})):Y.resolve(_t).then((function(q){mt.value=q,st(mt)}),(function(q){return i("throw",q,st,ot)}))}ot(lt.arg)}var H;nt(this,"_invoke",{value:function(q,et){function s(){return new Y((function(Y,H){i(q,et,Y,H)}))}return H=H?H.then(s,s):s()}})}function w(q,Y,H){var et="suspendedStart";return function(it,nt){if("executing"===et)throw new Error("Generator is already running");if("completed"===et){if("throw"===it)throw nt;return{value:void 0,done:!0}}for(H.method=it,H.arg=nt;;){var st=H.delegate;if(st){var ot=C(st,H);if(ot){if(ot===_t)continue;return ot}}if("next"===H.method)H.sent=H._sent=H.arg;else if("throw"===H.method){if("suspendedStart"===et)throw et="completed",H.arg;H.dispatchException(H.arg)}else"return"===H.method&&H.abrupt("return",H.arg);et="executing";var lt=f(q,Y,H);if("normal"===lt.type){if(et=H.done?"completed":"suspendedYield",lt.arg===_t)continue;return{value:lt.arg,done:H.done}}"throw"===lt.type&&(et="completed",H.method="throw",H.arg=lt.arg)}}}function C(q,Y){var H=Y.method,et=q.iterator[H];if(void 0===et)return Y.delegate=null,"throw"===H&&q.iterator.return&&(Y.method="return",Y.arg=void 0,C(q,Y),"throw"===Y.method)||"return"!==H&&(Y.method="throw",Y.arg=new TypeError("The iterator does not provide a '"+H+"' method")),_t;var it=f(et,q.iterator,Y.arg);if("throw"===it.type)return Y.method="throw",Y.arg=it.arg,Y.delegate=null,_t;var nt=it.arg;return nt?nt.done?(Y[q.resultName]=nt.value,Y.next=q.nextLoc,"return"!==Y.method&&(Y.method="next",Y.arg=void 0),Y.delegate=null,_t):nt:(Y.method="throw",Y.arg=new TypeError("iterator result is not an object"),Y.delegate=null,_t)}function E(q){var Y={tryLoc:q[0]};1 in q&&(Y.catchLoc=q[1]),2 in q&&(Y.finallyLoc=q[2],Y.afterLoc=q[3]),this.tryEntries.push(Y)}function R(q){var Y=q.completion||{};Y.type="normal",delete Y.arg,q.completion=Y}function O(q){this.tryEntries=[{tryLoc:"root"}],q.forEach(E,this),this.reset(!0)}function P(q){if(q){var Y=q[ot];if(Y)return Y.call(q);if("function"==typeof q.next)return q;if(!isNaN(q.length)){var H=-1,et=function e(){for(;++H<q.length;)if(it.call(q,H))return e.value=q[H],e.done=!1,e;return e.value=void 0,e.done=!0,e};return et.next=et}}return{next:I}}function I(){return{value:void 0,done:!0}}return m.prototype=y,nt(Et,"constructor",{value:y,configurable:!0}),nt(y,"constructor",{value:m,configurable:!0}),m.displayName=c(y,mt,"GeneratorFunction"),Y.isGeneratorFunction=function(q){var Y="function"==typeof q&&q.constructor;return!!Y&&(Y===m||"GeneratorFunction"===(Y.displayName||Y.name))},Y.mark=function(q){return Object.setPrototypeOf?Object.setPrototypeOf(q,y):(q.__proto__=y,c(q,mt,"GeneratorFunction")),q.prototype=Object.create(Et),q},Y.awrap=function(q){return{__await:q}},b(M.prototype),c(M.prototype,lt,(function(){return this})),Y.AsyncIterator=M,Y.async=function(q,H,et,it,nt){void 0===nt&&(nt=Promise);var st=new M(d(q,H,et,it),nt);return Y.isGeneratorFunction(H)?st:st.next().then((function(q){return q.done?q.value:st.next()}))},b(Et),c(Et,mt,"Generator"),c(Et,ot,(function(){return this})),c(Et,"toString",(function(){return"[object Generator]"})),Y.keys=function(q){var Y=Object(q),H=[];for(var et in Y)H.push(et);return H.reverse(),function t(){for(;H.length;){var q=H.pop();if(q in Y)return t.value=q,t.done=!1,t}return t.done=!0,t}},Y.values=P,O.prototype={constructor:O,reset:function(q){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(R),!q)for(var Y in this)"t"===Y.charAt(0)&&it.call(this,Y)&&!isNaN(+Y.slice(1))&&(this[Y]=void 0)},stop:function(){this.done=!0;var q=this.tryEntries[0].completion;if("throw"===q.type)throw q.arg;return this.rval},dispatchException:function(q){if(this.done)throw q;var Y=this;function i(H,et){return nt.type="throw",nt.arg=q,Y.next=H,et&&(Y.method="next",Y.arg=void 0),!!et}for(var H=this.tryEntries.length-1;H>=0;--H){var et=this.tryEntries[H],nt=et.completion;if("root"===et.tryLoc)return i("end");if(et.tryLoc<=this.prev){var st=it.call(et,"catchLoc"),ot=it.call(et,"finallyLoc");if(st&&ot){if(this.prev<et.catchLoc)return i(et.catchLoc,!0);if(this.prev<et.finallyLoc)return i(et.finallyLoc)}else if(st){if(this.prev<et.catchLoc)return i(et.catchLoc,!0)}else{if(!ot)throw new Error("try statement without catch or finally");if(this.prev<et.finallyLoc)return i(et.finallyLoc)}}}},abrupt:function(q,Y){for(var H=this.tryEntries.length-1;H>=0;--H){var et=this.tryEntries[H];if(et.tryLoc<=this.prev&&it.call(et,"finallyLoc")&&this.prev<et.finallyLoc){var nt=et;break}}nt&&("break"===q||"continue"===q)&&nt.tryLoc<=Y&&Y<=nt.finallyLoc&&(nt=null);var st=nt?nt.completion:{};return st.type=q,st.arg=Y,nt?(this.method="next",this.next=nt.finallyLoc,_t):this.complete(st)},complete:function(q,Y){if("throw"===q.type)throw q.arg;return"break"===q.type||"continue"===q.type?this.next=q.arg:"return"===q.type?(this.rval=this.arg=q.arg,this.method="return",this.next="end"):"normal"===q.type&&Y&&(this.next=Y),_t},finish:function(q){for(var Y=this.tryEntries.length-1;Y>=0;--Y){var H=this.tryEntries[Y];if(H.finallyLoc===q)return this.complete(H.completion,H.afterLoc),R(H),_t}},catch:function(q){for(var Y=this.tryEntries.length-1;Y>=0;--Y){var H=this.tryEntries[Y];if(H.tryLoc===q){var et=H.completion;if("throw"===et.type){var it=et.arg;R(H)}return it}}throw new Error("illegal catch attempt")},delegateYield:function(q,Y,H){return this.delegate={iterator:P(q),resultName:Y,nextLoc:H},"next"===this.method&&(this.arg=void 0),_t}},Y}q.exports=r,q.exports.__esModule=!0,q.exports.default=q.exports},8698:q=>{function e(Y){return q.exports=e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(q){return typeof q}:function(q){return q&&"function"==typeof Symbol&&q.constructor===Symbol&&q!==Symbol.prototype?"symbol":typeof q},q.exports.__esModule=!0,q.exports.default=q.exports,e(Y)}q.exports=e,q.exports.__esModule=!0,q.exports.default=q.exports},4687:(q,Y,H)=>{var et=H(7061)();q.exports=et;try{regeneratorRuntime=et}catch(q){"object"==typeof globalThis?globalThis.regeneratorRuntime=et:Function("r","regeneratorRuntime = r")(et)}},6813:(q,Y,H)=>{"use strict";H.d(Y,{Z:()=>nt});const et={1:"The view center is not defined",2:"The view resolution is not defined",3:"The view rotation is not defined",4:"`image` and `src` cannot be provided at the same time",5:"`imgSize` must be set when `image` is provided",7:"`format` must be set when `url` is set",8:"Unknown `serverType` configured",9:"`url` must be configured or set using `#setUrl()`",10:"The default `geometryFunction` can only handle `Point` geometries",11:"`options.featureTypes` must be an Array",12:"`options.geometryName` must also be provided when `options.bbox` is set",13:"Invalid corner",14:"Invalid color",15:"Tried to get a value for a key that does not exist in the cache",16:"Tried to set a value for a key that is used already",17:"`resolutions` must be sorted in descending order",18:"Either `origin` or `origins` must be configured, never both",19:"Number of `tileSizes` and `resolutions` must be equal",20:"Number of `origins` and `resolutions` must be equal",22:"Either `tileSize` or `tileSizes` must be configured, never both",24:"Invalid extent or geometry provided as `geometry`",25:"Cannot fit empty extent provided as `geometry`",26:"Features must have an id set",27:"Features must have an id set",28:'`renderMode` must be `"hybrid"` or `"vector"`',30:"The passed `feature` was already added to the source",31:"Tried to enqueue an `element` that was already added to the queue",32:"Transformation matrix cannot be inverted",33:"Invalid units",34:"Invalid geometry layout",36:"Unknown SRS type",37:"Unknown geometry type found",38:"`styleMapValue` has an unknown type",39:"Unknown geometry type",40:"Expected `feature` to have a geometry",41:"Expected an `ol/style/Style` or an array of `ol/style/Style.js`",42:"Question unknown, the answer is 42",43:"Expected `layers` to be an array or a `Collection`",47:"Expected `controls` to be an array or an `ol/Collection`",48:"Expected `interactions` to be an array or an `ol/Collection`",49:"Expected `overlays` to be an array or an `ol/Collection`",50:"`options.featureTypes` should be an Array",51:"Either `url` or `tileJSON` options must be provided",52:"Unknown `serverType` configured",53:"Unknown `tierSizeCalculation` configured",55:"The {-y} placeholder requires a tile grid with extent",56:"mapBrowserEvent must originate from a pointer event",57:"At least 2 conditions are required",59:"Invalid command found in the PBF",60:"Missing or invalid `size`",61:"Cannot determine IIIF Image API version from provided image information JSON",62:"A `WebGLArrayBuffer` must either be of type `ELEMENT_ARRAY_BUFFER` or `ARRAY_BUFFER`",64:"Layer opacity must be a number",66:"`forEachFeatureAtCoordinate` cannot be used on a WebGL layer if the hit detection logic has not been enabled. This is done by providing adequate shaders using the `hitVertexShader` and `hitFragmentShader` properties of `WebGLPointsLayerRenderer`",67:"A layer can only be added to the map once. Use either `layer.setMap()` or `map.addLayer()`, not both",68:"A VectorTile source can only be rendered if it has a projection compatible with the view projection",69:"`width` or `height` cannot be provided together with `scale`"};class it extends Error{constructor(q){const Y=et[q];super(Y),this.code=q,this.name="AssertionError",this.message=Y}}const nt=it},8096:(q,Y,H)=>{"use strict";H.d(Y,{K:()=>u,Z:()=>_t});var et=H(5487),it=H(1798),nt=H(553),st=H(177),ot=H(8641),lt=H(5818);class mt extends it.Z{constructor(q,Y,H,et,it,st){super(q,Y,H,nt.default.IDLE),this.src_=et,this.image_=new Image,null!==it&&(this.image_.crossOrigin=it),this.unlisten_=null,this.state=nt.default.IDLE,this.imageLoadFunction_=st}getImage(){return this.image_}handleImageError_(){this.state=nt.default.ERROR,this.unlistenImage_(),this.changed()}handleImageLoad_(){void 0===this.resolution&&(this.resolution=(0,ot.Cr)(this.extent)/this.image_.height),this.state=nt.default.LOADED,this.unlistenImage_(),this.changed()}load(){this.state!=nt.default.IDLE&&this.state!=nt.default.ERROR||(this.state=nt.default.LOADING,this.changed(),this.imageLoadFunction_(this,this.src_),this.unlisten_=u(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))}setImage(q){this.image_=q,this.resolution=(0,ot.Cr)(this.extent)/this.image_.height}unlistenImage_(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)}}function u(q,Y,H){const it=q;let nt=!0,ot=!1,mt=!1;const _t=[(0,lt.Vx)(it,et.Z.LOAD,(function(){mt=!0,ot||Y()}))];return it.src&&st.Tp?(ot=!0,it.decode().then((function(){nt&&Y()})).catch((function(q){nt&&(mt?Y():H())}))):_t.push((0,lt.Vx)(it,et.Z.ERROR,H)),function(){nt=!1,_t.forEach(lt.bN)}}const _t=mt},1798:(q,Y,H)=>{"use strict";H.d(Y,{Z:()=>ot});var et=H(3069),it=H(5487),nt=H(4187);class st extends et.Z{constructor(q,Y,H,et){super(),this.extent=q,this.pixelRatio_=H,this.resolution=Y,this.state=et}changed(){this.dispatchEvent(it.Z.CHANGE)}getExtent(){return this.extent}getImage(){return(0,nt.O3)()}getPixelRatio(){return this.pixelRatio_}getResolution(){return this.resolution}getState(){return this.state}load(){(0,nt.O3)()}}const ot=st},553:(q,Y,H)=>{"use strict";H.r(Y),H.d(Y,{default:()=>et});const et={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4}},2971:(q,Y,H)=>{"use strict";H.d(Y,{Z:()=>_t});var et=H(291),it=H(5990),nt=H(2706),st=H(4187),ot=H(9374);class lt extends et.ZP{constructor(q,Y,H){super(q),this.key=Y,this.oldValue=H}}class mt extends nt.Z{constructor(q){super(),this.on,this.once,this.un,(0,st.sq)(this),this.values_=null,void 0!==q&&this.setProperties(q)}get(q){let Y;return this.values_&&this.values_.hasOwnProperty(q)&&(Y=this.values_[q]),Y}getKeys(){return this.values_&&Object.keys(this.values_)||[]}getProperties(){return this.values_&&Object.assign({},this.values_)||{}}hasProperties(){return!!this.values_}notify(q,Y){let H;H=`change:${q}`,this.hasListener(H)&&this.dispatchEvent(new lt(H,q,Y)),H=it.Z.PROPERTYCHANGE,this.hasListener(H)&&this.dispatchEvent(new lt(H,q,Y))}addChangeListener(q,Y){this.addEventListener(`change:${q}`,Y)}removeChangeListener(q,Y){this.removeEventListener(`change:${q}`,Y)}set(q,Y,H){const et=this.values_||(this.values_={});if(H)et[q]=Y;else{const H=et[q];et[q]=Y,H!==Y&&this.notify(q,H)}}setProperties(q,Y){for(const H in q)this.set(H,q[H],Y)}applyProperties(q){q.values_&&Object.assign(this.values_||(this.values_={}),q.values_)}unset(q,Y){if(this.values_&&q in this.values_){const H=this.values_[q];delete this.values_[q],(0,ot.x)(this.values_)&&(this.values_=null),Y||this.notify(q,H)}}}const _t=mt},5990:(q,Y,H)=>{"use strict";H.d(Y,{Z:()=>et});const et={PROPERTYCHANGE:"propertychange"}},2706:(q,Y,H)=>{"use strict";H.d(Y,{Z:()=>ot});var et=H(3069),it=H(5487),nt=H(5818);class st extends et.Z{constructor(){super(),this.on=this.onInternal,this.once=this.onceInternal,this.un=this.unInternal,this.revision_=0}changed(){++this.revision_,this.dispatchEvent(it.Z.CHANGE)}getRevision(){return this.revision_}onInternal(q,Y){if(Array.isArray(q)){const H=q.length,et=new Array(H);for(let it=0;it<H;++it)et[it]=(0,nt.oL)(this,q[it],Y);return et}return(0,nt.oL)(this,q,Y)}onceInternal(q,Y){let H;if(Array.isArray(q)){const et=q.length;H=new Array(et);for(let it=0;it<et;++it)H[it]=(0,nt.Vx)(this,q[it],Y)}else H=(0,nt.Vx)(this,q,Y);return Y.ol_key=H,H}unInternal(q,Y){const H=Y.ol_key;if(H)!function(q){if(Array.isArray(q))for(let Y=0,H=q.length;Y<H;++Y)(0,nt.bN)(q[Y]);else(0,nt.bN)(q)}(H);else if(Array.isArray(q))for(let H=0,et=q.length;H<et;++H)this.removeEventListener(q[H],Y);else this.removeEventListener(q,Y)}}st.prototype.on,st.prototype.once,st.prototype.un;const ot=st},5537:(q,Y,H)=>{"use strict";function n(q,Y,H){let et,it;H=H||r;let nt=0,st=q.length,ot=!1;for(;nt<st;)et=nt+(st-nt>>1),it=+H(q[et],Y),it<0?nt=et+1:(st=et,ot=!it);return ot?nt:~nt}function r(q,Y){return q>Y?1:q<Y?-1:0}function s(q,Y,H){const et=q.length;if(q[0]<=Y)return 0;if(Y<=q[et-1])return et-1;let it;if(H>0){for(it=1;it<et;++it)if(q[it]<Y)return it-1}else if(H<0){for(it=1;it<et;++it)if(q[it]<=Y)return it}else for(it=1;it<et;++it){if(q[it]==Y)return it;if(q[it]<Y)return"function"==typeof H?H(Y,q[it-1],q[it])>0?it-1:it:q[it-1]-Y<Y-q[it]?it-1:it}return et-1}function o(q,Y,H){for(;Y<H;){const et=q[Y];q[Y]=q[H],q[H]=et,++Y,--H}}function a(q,Y){const H=Array.isArray(Y)?Y:[Y],et=H.length;for(let Y=0;Y<et;Y++)q[q.length]=H[Y]}function h(q,Y){const H=q.length;if(H!==Y.length)return!1;for(let et=0;et<H;et++)if(q[et]!==Y[et])return!1;return!0}function l(q,Y,H){const et=Y||r;return q.every((function(Y,it){if(0===it)return!0;const nt=et(q[it-1],Y);return!(nt>0||H&&0===nt)}))}H.d(Y,{FZ:()=>o,fS:()=>h,h7:()=>s,j2:()=>r,l7:()=>a,pT:()=>l,ry:()=>n})},9515:(q,Y,H)=>{"use strict";H.d(Y,{h:()=>r});var et=H(6813);function r(q,Y){if(!q)throw new et.Z(Y)}},9706:(q,Y,H)=>{"use strict";H.d(Y,{BB:()=>c,XC:()=>a,_2:()=>l});var et=H(9515),it=H(3983);const nt=/^#([a-f0-9]{3}|[a-f0-9]{4}(?:[a-f0-9]{2}){0,2})$/i,st=/^([a-z]*)$|^hsla?\(.*\)$/i;function a(q){return"string"==typeof q?q:c(q)}const ot=function(){const q={};let Y=0;return function(H){let it;if(q.hasOwnProperty(H))it=q[H];else{if(Y>=1024){let H=0;for(const et in q)0==(3&H++)&&(delete q[et],--Y)}it=function(q){let Y,H,it,ot,lt;if(st.exec(q)&&(q=function(q){const Y=document.createElement("div");if(Y.style.color=q,""!==Y.style.color){document.body.appendChild(Y);const q=getComputedStyle(Y).color;return document.body.removeChild(Y),q}return""}(q)),nt.exec(q)){const et=q.length-1;let nt;nt=et<=4?1:2;const st=4===et||8===et;Y=parseInt(q.substr(1+0*nt,nt),16),H=parseInt(q.substr(1+1*nt,nt),16),it=parseInt(q.substr(1+2*nt,nt),16),ot=st?parseInt(q.substr(1+3*nt,nt),16):255,1==nt&&(Y=(Y<<4)+Y,H=(H<<4)+H,it=(it<<4)+it,st&&(ot=(ot<<4)+ot)),lt=[Y,H,it,ot/255]}else q.startsWith("rgba(")?(lt=q.slice(5,-1).split(",").map(Number),u(lt)):q.startsWith("rgb(")?(lt=q.slice(4,-1).split(",").map(Number),lt.push(1),u(lt)):(0,et.h)(!1,14);return lt}(H),q[H]=it,++Y}return it}}();function l(q){return Array.isArray(q)?q:ot(q)}function u(q){return q[0]=(0,it.uZ)(q[0]+.5|0,0,255),q[1]=(0,it.uZ)(q[1]+.5|0,0,255),q[2]=(0,it.uZ)(q[2]+.5|0,0,255),q[3]=(0,it.uZ)(q[3],0,1),q}function c(q){let Y=q[0];Y!=(0|Y)&&(Y=Y+.5|0);let H=q[1];H!=(0|H)&&(H=H+.5|0);let et=q[2];return et!=(0|et)&&(et=et+.5|0),"rgba("+Y+","+H+","+et+","+(void 0===q[3]?1:Math.round(100*q[3])/100)+")"}},6620:(q,Y,H)=>{"use strict";H.d(Y,{y:()=>r});var et=H(9706);function r(q){return Array.isArray(q)?(0,et.BB)(q):q}},1900:(q,Y,H)=>{"use strict";H.d(Y,{Cf:()=>r,jk:()=>s});var et=H(8641);function r(q,Y){if(Y.canWrapX()){const H=(0,et.dz)(Y.getExtent()),it=s(q,Y,H);it&&(q[0]-=it*H)}return q}function s(q,Y,H){const it=Y.getExtent();let nt=0;return Y.canWrapX()&&(q[0]<it[0]||q[0]>it[2])&&(H=H||(0,et.dz)(it),nt=Math.floor((q[0]-it[0])/H)),nt}},8326:(q,Y,H)=>{"use strict";H.d(Y,{E4:()=>r,jy:()=>s});var et=H(177);function r(q,Y,H,it){let nt;return nt=H&&H.length?H.shift():et.Id?new OffscreenCanvas(q||300,Y||300):document.createElement("canvas"),q&&(nt.width=q),Y&&(nt.height=Y),nt.getContext("2d",it)}function s(q){const Y=q.canvas;Y.width=1,Y.height=1,q.clearRect(0,0,1,1)}},5818:(q,Y,H)=>{"use strict";H.d(Y,{Vx:()=>s,bN:()=>o,oL:()=>r});var et=H(9374);function r(q,Y,H,et,it){if(et&&et!==q&&(H=H.bind(et)),it){const et=H;H=function(){q.removeEventListener(Y,H),et.apply(this,arguments)}}const nt={target:q,type:Y,listener:H};return q.addEventListener(Y,H),nt}function s(q,Y,H,et){return r(q,Y,H,et,!0)}function o(q){q&&q.target&&(q.target.removeEventListener(q.type,q.listener),(0,et.Z)(q))}},291:(q,Y,H)=>{"use strict";H.d(Y,{ZP:()=>et});const et=class{constructor(q){this.propagationStopped,this.defaultPrevented,this.type=q,this.target=null}preventDefault(){this.defaultPrevented=!0}stopPropagation(){this.propagationStopped=!0}}},5487:(q,Y,H)=>{"use strict";H.d(Y,{Z:()=>et});const et={CHANGE:"change",ERROR:"error",BLUR:"blur",CLEAR:"clear",CONTEXTMENU:"contextmenu",CLICK:"click",DBLCLICK:"dblclick",DRAGENTER:"dragenter",DRAGOVER:"dragover",DROP:"drop",FOCUS:"focus",KEYDOWN:"keydown",KEYPRESS:"keypress",LOAD:"load",RESIZE:"resize",TOUCHMOVE:"touchmove",WHEEL:"wheel"}},3069:(q,Y,H)=>{"use strict";H.d(Y,{Z:()=>ot});const et=class{constructor(){this.disposed=!1}dispose(){this.disposed||(this.disposed=!0,this.disposeInternal())}disposeInternal(){}};var it=H(291),nt=H(6885),st=H(9374);const ot=class extends et{constructor(q){super(),this.eventTarget_=q,this.pendingRemovals_=null,this.dispatching_=null,this.listeners_=null}addEventListener(q,Y){if(!q||!Y)return;const H=this.listeners_||(this.listeners_={}),et=H[q]||(H[q]=[]);et.includes(Y)||et.push(Y)}dispatchEvent(q){const Y="string"==typeof q,H=Y?q:q.type,et=this.listeners_&&this.listeners_[H];if(!et)return;const st=Y?new it.ZP(q):q;st.target||(st.target=this.eventTarget_||this);const ot=this.dispatching_||(this.dispatching_={}),lt=this.pendingRemovals_||(this.pendingRemovals_={});let mt;H in ot||(ot[H]=0,lt[H]=0),++ot[H];for(let q=0,Y=et.length;q<Y;++q)if(mt="handleEvent"in et[q]?et[q].handleEvent(st):et[q].call(this,st),!1===mt||st.propagationStopped){mt=!1;break}if(0==--ot[H]){let q=lt[H];for(delete lt[H];q--;)this.removeEventListener(H,nt.Zn);delete ot[H]}return mt}disposeInternal(){this.listeners_&&(0,st.Z)(this.listeners_)}getListeners(q){return this.listeners_&&this.listeners_[q]||void 0}hasListener(q){return!!this.listeners_&&(q?q in this.listeners_:Object.keys(this.listeners_).length>0)}removeEventListener(q,Y){const H=this.listeners_&&this.listeners_[q];if(H){const et=H.indexOf(Y);-1!==et&&(this.pendingRemovals_&&q in this.pendingRemovals_?(H[et]=nt.Zn,++this.pendingRemovals_[q]):(H.splice(et,1),0===H.length&&delete this.listeners_[q]))}}}},8641:(q,Y,H)=>{"use strict";H.d(Y,{Cf:()=>U,Cr:()=>T,EO:()=>j,Ed:()=>F,GN:()=>y,H6:()=>M,HK:()=>m,I7:()=>D,MV:()=>B,Ne:()=>z,T9:()=>g,Wj:()=>x,Xv:()=>L,YN:()=>p,b8:()=>l,bg:()=>w,d9:()=>a,dY:()=>I,dz:()=>N,f3:()=>o,fS:()=>_,g0:()=>O,hC:()=>C,hI:()=>s,jE:()=>c,kK:()=>k,l7:()=>v,lJ:()=>f,p8:()=>P,pX:()=>d,qP:()=>S,qf:()=>h,qg:()=>R,r4:()=>u,rL:()=>A,w$:()=>E,xb:()=>G});var et=H(8716),it=H(9515);function s(q){const Y=[1/0,1/0,-1/0,-1/0];for(let H=0,et=q.length;H<et;++H)x(Y,q[H]);return Y}function o(q,Y,H){return H?(H[0]=q[0]-Y,H[1]=q[1]-Y,H[2]=q[2]+Y,H[3]=q[3]+Y,H):[q[0]-Y,q[1]-Y,q[2]+Y,q[3]+Y]}function a(q,Y){return Y?(Y[0]=q[0],Y[1]=q[1],Y[2]=q[2],Y[3]=q[3],Y):q.slice()}function h(q,Y,H){let et,it;return et=Y<q[0]?q[0]-Y:q[2]<Y?Y-q[2]:0,it=H<q[1]?q[1]-H:q[3]<H?H-q[3]:0,et*et+it*it}function l(q,Y){return c(q,Y[0],Y[1])}function u(q,Y){return q[0]<=Y[0]&&Y[2]<=q[2]&&q[1]<=Y[1]&&Y[3]<=q[3]}function c(q,Y,H){return q[0]<=Y&&Y<=q[2]&&q[1]<=H&&H<=q[3]}function d(q,Y){const H=q[0],it=q[1],nt=q[2],st=q[3],ot=Y[0],lt=Y[1];let mt=et.Z.UNKNOWN;return ot<H?mt|=et.Z.LEFT:ot>nt&&(mt|=et.Z.RIGHT),lt<it?mt|=et.Z.BELOW:lt>st&&(mt|=et.Z.ABOVE),mt===et.Z.UNKNOWN&&(mt=et.Z.INTERSECTING),mt}function f(){return[1/0,1/0,-1/0,-1/0]}function g(q,Y,H,et,it){return it?(it[0]=q,it[1]=Y,it[2]=H,it[3]=et,it):[q,Y,H,et]}function p(q){return g(1/0,1/0,-1/0,-1/0,q)}function m(q,Y){const H=q[0],et=q[1];return g(H,et,H,et,Y)}function y(q,Y,H,et,it){return S(p(it),q,Y,H,et)}function _(q,Y){return q[0]==Y[0]&&q[2]==Y[2]&&q[1]==Y[1]&&q[3]==Y[3]}function v(q,Y){return Y[0]<q[0]&&(q[0]=Y[0]),Y[2]>q[2]&&(q[2]=Y[2]),Y[1]<q[1]&&(q[1]=Y[1]),Y[3]>q[3]&&(q[3]=Y[3]),q}function x(q,Y){Y[0]<q[0]&&(q[0]=Y[0]),Y[0]>q[2]&&(q[2]=Y[0]),Y[1]<q[1]&&(q[1]=Y[1]),Y[1]>q[3]&&(q[3]=Y[1])}function S(q,Y,H,et,it){for(;H<et;H+=it)b(q,Y[H],Y[H+1]);return q}function b(q,Y,H){q[0]=Math.min(q[0],Y),q[1]=Math.min(q[1],H),q[2]=Math.max(q[2],Y),q[3]=Math.max(q[3],H)}function M(q,Y){let H;return H=Y(C(q)),H||(H=Y(E(q)),H||(H=Y(L(q)),H||(H=Y(A(q)),H||!1)))}function w(q){let Y=0;return G(q)||(Y=N(q)*T(q)),Y}function C(q){return[q[0],q[1]]}function E(q){return[q[2],q[1]]}function R(q){return[(q[0]+q[2])/2,(q[1]+q[3])/2]}function O(q,Y){let H;return"bottom-left"===Y?H=C(q):"bottom-right"===Y?H=E(q):"top-left"===Y?H=A(q):"top-right"===Y?H=L(q):(0,it.h)(!1,13),H}function P(q,Y,H,et,it){const[nt,st,ot,lt,mt,_t,vt,bt]=I(q,Y,H,et);return g(Math.min(nt,ot,mt,vt),Math.min(st,lt,_t,bt),Math.max(nt,ot,mt,vt),Math.max(st,lt,_t,bt),it)}function I(q,Y,H,et){const it=Y*et[0]/2,nt=Y*et[1]/2,st=Math.cos(H),ot=Math.sin(H),lt=it*st,mt=it*ot,_t=nt*st,vt=nt*ot,bt=q[0],Mt=q[1];return[bt-lt+vt,Mt-mt-_t,bt-lt-vt,Mt-mt+_t,bt+lt-vt,Mt+mt+_t,bt+lt+vt,Mt+mt-_t,bt-lt+vt,Mt-mt-_t]}function T(q){return q[3]-q[1]}function F(q,Y,H){const et=H||[1/0,1/0,-1/0,-1/0];return k(q,Y)?(q[0]>Y[0]?et[0]=q[0]:et[0]=Y[0],q[1]>Y[1]?et[1]=q[1]:et[1]=Y[1],q[2]<Y[2]?et[2]=q[2]:et[2]=Y[2],q[3]<Y[3]?et[3]=q[3]:et[3]=Y[3]):p(et),et}function A(q){return[q[0],q[3]]}function L(q){return[q[2],q[3]]}function N(q){return q[2]-q[0]}function k(q,Y){return q[0]<=Y[2]&&q[2]>=Y[0]&&q[1]<=Y[3]&&q[3]>=Y[1]}function G(q){return q[2]<q[0]||q[3]<q[1]}function j(q,Y){return Y?(Y[0]=q[0],Y[1]=q[1],Y[2]=q[2],Y[3]=q[3],Y):q}function D(q,Y,H){let it=!1;const nt=d(q,Y),st=d(q,H);if(nt===et.Z.INTERSECTING||st===et.Z.INTERSECTING)it=!0;else{const ot=q[0],lt=q[1],mt=q[2],_t=q[3],vt=Y[0],bt=Y[1],Mt=H[0],Et=H[1],Rt=(Et-bt)/(Mt-vt);let It,Pt;st&et.Z.ABOVE&&!(nt&et.Z.ABOVE)&&(It=Mt-(Et-_t)/Rt,it=It>=ot&&It<=mt),it||!(st&et.Z.RIGHT)||nt&et.Z.RIGHT||(Pt=Et-(Mt-mt)*Rt,it=Pt>=lt&&Pt<=_t),it||!(st&et.Z.BELOW)||nt&et.Z.BELOW||(It=Mt-(Et-lt)/Rt,it=It>=ot&&It<=mt),it||!(st&et.Z.LEFT)||nt&et.Z.LEFT||(Pt=Et-(Mt-ot)*Rt,it=Pt>=lt&&Pt<=_t)}return it}function z(q,Y,H,et){let it=[];if(et>1){const Y=q[2]-q[0],H=q[3]-q[1];for(let nt=0;nt<et;++nt)it.push(q[0]+Y*nt/et,q[1],q[2],q[1]+H*nt/et,q[2]-Y*nt/et,q[3],q[0],q[3]-H*nt/et)}else it=[q[0],q[1],q[2],q[1],q[2],q[3],q[0],q[3]];Y(it,it,2);const nt=[],st=[];for(let q=0,Y=it.length;q<Y;q+=2)nt.push(it[q]),st.push(it[q+1]);return function(q,Y,H){return g(Math.min.apply(null,q),Math.min.apply(null,Y),Math.max.apply(null,q),Math.max.apply(null,Y),H)}(nt,st,H)}function U(q,Y){const H=Y.getExtent(),et=R(q);if(Y.canWrapX()&&(et[0]<H[0]||et[0]>=H[2])){const Y=N(H),it=Math.floor((et[0]-H[0])/Y)*Y;q[0]-=it,q[2]-=it}return q}function B(q,Y){if(Y.canWrapX()){const H=Y.getExtent();if(!isFinite(q[0])||!isFinite(q[2]))return[[H[0],q[1],H[2],q[3]]];U(q,Y);const et=N(H);if(N(q)>et)return[[H[0],q[1],H[2],q[3]]];if(q[0]<H[0])return[[q[0]+et,q[1],H[2],q[3]],[H[0],q[1],q[2],q[3]]];if(q[2]>H[2])return[[q[0],q[1],H[2],q[3]],[H[0],q[1],q[2]-et,q[3]]]}return[q]}},8716:(q,Y,H)=>{"use strict";H.d(Y,{Z:()=>et});const et={UNKNOWN:0,INTERSECTING:1,ABOVE:2,RIGHT:4,BELOW:8,LEFT:16}},6885:(q,Y,H)=>{"use strict";H.d(Y,{Zn:()=>s,qe:()=>o,uX:()=>r});var et=H(5537);function r(){return!0}function s(){}function o(q){let Y,H,it,nt=!1;return function(){const st=Array.prototype.slice.call(arguments);return nt&&this===it&&(0,et.fS)(st,H)||(nt=!0,it=this,H=st,Y=q.apply(this,arguments)),Y}}},1694:(q,Y,H)=>{"use strict";H.d(Y,{Z:()=>bt});var et=H(2971),it=H(4187),nt=H(6101),st=H(8641),ot=H(8532),lt=H(6885),mt=H(6442);const _t=(0,nt.Ue)();class vt extends et.Z{constructor(){super(),this.extent_=(0,st.lJ)(),this.extentRevision_=-1,this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=0,this.simplifyTransformedInternal=(0,lt.qe)((function(q,Y,H){if(!H)return this.getSimplifiedGeometry(Y);const et=this.clone();return et.applyTransform(H),et.getSimplifiedGeometry(Y)}))}simplifyTransformed(q,Y){return this.simplifyTransformedInternal(this.getRevision(),q,Y)}clone(){return(0,it.O3)()}closestPointXY(q,Y,H,et){return(0,it.O3)()}containsXY(q,Y){const H=this.getClosestPoint([q,Y]);return H[0]===q&&H[1]===Y}getClosestPoint(q,Y){return Y=Y||[NaN,NaN],this.closestPointXY(q[0],q[1],Y,1/0),Y}intersectsCoordinate(q){return this.containsXY(q[0],q[1])}computeExtent(q){return(0,it.O3)()}getExtent(q){if(this.extentRevision_!=this.getRevision()){const q=this.computeExtent(this.extent_);(isNaN(q[0])||isNaN(q[1]))&&(0,st.YN)(q),this.extentRevision_=this.getRevision()}return(0,st.EO)(this.extent_,q)}rotate(q,Y){(0,it.O3)()}scale(q,Y,H){(0,it.O3)()}simplify(q){return this.getSimplifiedGeometry(q*q)}getSimplifiedGeometry(q){return(0,it.O3)()}getType(){return(0,it.O3)()}applyTransform(q){(0,it.O3)()}intersectsExtent(q){return(0,it.O3)()}translate(q,Y){(0,it.O3)()}transform(q,Y){const H=(0,ot.U2)(q),et="tile-pixels"==H.getUnits()?function(q,et,it){const lt=H.getExtent(),vt=H.getWorldExtent(),bt=(0,st.Cr)(vt)/(0,st.Cr)(lt);return(0,nt.qC)(_t,vt[0],vt[3],bt,-bt,0,0,0),(0,mt.vT)(q,0,q.length,it,_t,et),(0,ot.Ck)(H,Y)(q,et,it)}:(0,ot.Ck)(H,Y);return this.applyTransform(et),this}}const bt=vt},188:(q,Y,H)=>{"use strict";H.r(Y),H.d(Y,{default:()=>lt});var et=H(2967),it=H(8641),nt=H(8527),st=H(3983);class ot extends et.ZP{constructor(q,Y){super(),this.setCoordinates(q,Y)}clone(){const q=new ot(this.flatCoordinates.slice(),this.layout);return q.applyProperties(this),q}closestPointXY(q,Y,H,et){const it=this.flatCoordinates,nt=(0,st.bI)(q,Y,it[0],it[1]);if(nt<et){const q=this.stride;for(let Y=0;Y<q;++Y)H[Y]=it[Y];return H.length=q,nt}return et}getCoordinates(){return this.flatCoordinates?this.flatCoordinates.slice():[]}computeExtent(q){return(0,it.HK)(this.flatCoordinates,q)}getType(){return"Point"}intersectsExtent(q){return(0,it.jE)(q,this.flatCoordinates[0],this.flatCoordinates[1])}setCoordinates(q,Y){this.setLayout(Y,q,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=(0,nt.IG)(this.flatCoordinates,0,q,this.stride),this.changed()}}const lt=ot},2967:(q,Y,H)=>{"use strict";H.d(Y,{Kr:()=>l,ZP:()=>lt});var et=H(1694),it=H(4187),nt=H(8641),st=H(6442);class ot extends et.Z{constructor(){super(),this.layout="XY",this.stride=2,this.flatCoordinates=null}computeExtent(q){return(0,nt.GN)(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,q)}getCoordinates(){return(0,it.O3)()}getFirstCoordinate(){return this.flatCoordinates.slice(0,this.stride)}getFlatCoordinates(){return this.flatCoordinates}getLastCoordinate(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)}getLayout(){return this.layout}getSimplifiedGeometry(q){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),q<0||0!==this.simplifiedGeometryMaxMinSquaredTolerance&&q<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;const Y=this.getSimplifiedGeometryInternal(q);return Y.getFlatCoordinates().length<this.flatCoordinates.length?Y:(this.simplifiedGeometryMaxMinSquaredTolerance=q,this)}getSimplifiedGeometryInternal(q){return this}getStride(){return this.stride}setFlatCoordinates(q,Y){this.stride=h(q),this.layout=q,this.flatCoordinates=Y}setCoordinates(q,Y){(0,it.O3)()}setLayout(q,Y,H){let et;if(q)et=h(q);else{for(let q=0;q<H;++q){if(0===Y.length)return this.layout="XY",void(this.stride=2);Y=Y[0]}et=Y.length,q=function(q){let Y;return 2==q?Y="XY":3==q?Y="XYZ":4==q&&(Y="XYZM"),Y}(et)}this.layout=q,this.stride=et}applyTransform(q){this.flatCoordinates&&(q(this.flatCoordinates,this.flatCoordinates,this.stride),this.changed())}rotate(q,Y){const H=this.getFlatCoordinates();if(H){const et=this.getStride();(0,st.U1)(H,0,H.length,et,q,Y,H),this.changed()}}scale(q,Y,H){void 0===Y&&(Y=q),H||(H=(0,nt.qg)(this.getExtent()));const et=this.getFlatCoordinates();if(et){const it=this.getStride();(0,st.bA)(et,0,et.length,it,q,Y,H,et),this.changed()}}translate(q,Y){const H=this.getFlatCoordinates();if(H){const et=this.getStride();(0,st.Iu)(H,0,H.length,et,q,Y,H),this.changed()}}}function h(q){let Y;return"XY"==q?Y=2:"XYZ"==q||"XYM"==q?Y=3:"XYZM"==q&&(Y=4),Y}function l(q,Y,H){const et=q.getFlatCoordinates();if(!et)return null;const it=q.getStride();return(0,st.vT)(et,0,et.length,it,Y,H)}const lt=ot},8527:(q,Y,H)=>{"use strict";function n(q,Y,H,et){for(let et=0,it=H.length;et<it;++et)q[Y++]=H[et];return Y}function r(q,Y,H,et){for(let it=0,nt=H.length;it<nt;++it){const nt=H[it];for(let H=0;H<et;++H)q[Y++]=nt[H]}return Y}function s(q,Y,H,et,it){it=it||[];let nt=0;for(let st=0,ot=H.length;st<ot;++st){const ot=r(q,Y,H[st],et);it[nt++]=ot,Y=ot}return it.length=nt,it}function o(q,Y,H,et,it){it=it||[];let nt=0;for(let st=0,ot=H.length;st<ot;++st){const ot=s(q,Y,H[st],et,it[nt]);0===ot.length&&(ot[0]=Y),it[nt++]=ot,Y=ot[ot.length-1]}return it.length=nt,it}H.d(Y,{IG:()=>n,QT:()=>o,Sg:()=>r,_5:()=>s})},6442:(q,Y,H)=>{"use strict";function n(q,Y,H,et,it,nt){nt=nt||[];let st=0;for(let ot=Y;ot<H;ot+=et){const Y=q[ot],H=q[ot+1];nt[st++]=it[0]*Y+it[2]*H+it[4],nt[st++]=it[1]*Y+it[3]*H+it[5]}return nt&&nt.length!=st&&(nt.length=st),nt}function r(q,Y,H,et,it,nt,st){st=st||[];const ot=Math.cos(it),lt=Math.sin(it),mt=nt[0],_t=nt[1];let vt=0;for(let it=Y;it<H;it+=et){const Y=q[it]-mt,H=q[it+1]-_t;st[vt++]=mt+Y*ot-H*lt,st[vt++]=_t+Y*lt+H*ot;for(let Y=it+2;Y<it+et;++Y)st[vt++]=q[Y]}return st&&st.length!=vt&&(st.length=vt),st}function s(q,Y,H,et,it,nt,st,ot){ot=ot||[];const lt=st[0],mt=st[1];let _t=0;for(let st=Y;st<H;st+=et){const Y=q[st]-lt,H=q[st+1]-mt;ot[_t++]=lt+it*Y,ot[_t++]=mt+nt*H;for(let Y=st+2;Y<st+et;++Y)ot[_t++]=q[Y]}return ot&&ot.length!=_t&&(ot.length=_t),ot}function o(q,Y,H,et,it,nt,st){st=st||[];let ot=0;for(let lt=Y;lt<H;lt+=et){st[ot++]=q[lt]+it,st[ot++]=q[lt+1]+nt;for(let Y=lt+2;Y<lt+et;++Y)st[ot++]=q[Y]}return st&&st.length!=ot&&(st.length=ot),st}H.d(Y,{Iu:()=>o,U1:()=>r,bA:()=>s,vT:()=>n})},177:(q,Y,H)=>{"use strict";H.d(Y,{Id:()=>nt,MP:()=>it,Tp:()=>st});const et="undefined"!=typeof navigator&&void 0!==navigator.userAgent?navigator.userAgent.toLowerCase():"",it=(et.includes("firefox"),et.includes("safari")&&!et.includes("chrom")&&(et.includes("version/15.4")||/cpu (os|iphone os) 15_4 like mac os x/.test(et)),et.includes("webkit")&&et.includes("edge"),et.includes("macintosh"),"undefined"!=typeof devicePixelRatio?devicePixelRatio:1),nt="undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof OffscreenCanvas&&self instanceof WorkerGlobalScope,st="undefined"!=typeof Image&&Image.prototype.decode;!function(){let q=!1;try{const Y=Object.defineProperty({},"passive",{get:function(){q=!0}});window.addEventListener("_",null,Y),window.removeEventListener("_",null,Y)}catch(q){}}()},3983:(q,Y,H)=>{"use strict";function n(q,Y,H){return Math.min(Math.max(q,Y),H)}function r(q,Y,H,et,it,nt){const st=it-H,ot=nt-et;if(0!==st||0!==ot){const lt=((q-H)*st+(Y-et)*ot)/(st*st+ot*ot);lt>1?(H=it,et=nt):lt>0&&(H+=st*lt,et+=ot*lt)}return s(q,Y,H,et)}function s(q,Y,H,et){const it=H-q,nt=et-Y;return it*it+nt*nt}function o(q){const Y=q.length;for(let H=0;H<Y;H++){let et=H,it=Math.abs(q[H][H]);for(let nt=H+1;nt<Y;nt++){const Y=Math.abs(q[nt][H]);Y>it&&(it=Y,et=nt)}if(0===it)return null;const nt=q[et];q[et]=q[H],q[H]=nt;for(let et=H+1;et<Y;et++){const it=-q[et][H]/q[H][H];for(let nt=H;nt<Y+1;nt++)H==nt?q[et][nt]=0:q[et][nt]+=it*q[H][nt]}}const H=new Array(Y);for(let et=Y-1;et>=0;et--){H[et]=q[et][Y]/q[et][et];for(let it=et-1;it>=0;it--)q[it][Y]-=q[it][et]*H[et]}return H}function a(q){return q*Math.PI/180}function h(q,Y){const H=q%Y;return H*Y<0?H+Y:H}function l(q,Y,H){return q+H*(Y-q)}function u(q,Y){const H=Math.pow(10,Y);return Math.round(q*H)/H}function c(q,Y){return Math.round(u(q,Y))}function d(q,Y){return Math.floor(u(q,Y))}function f(q,Y){return Math.ceil(u(q,Y))}H.d(Y,{$W:()=>h,FH:()=>u,GW:()=>d,NM:()=>c,SV:()=>o,Yr:()=>a,bI:()=>s,mD:()=>f,rU:()=>r,t7:()=>l,uZ:()=>n})},9374:(q,Y,H)=>{"use strict";function n(q){for(const Y in q)delete q[Y]}function r(q){let Y;for(Y in q)return!1;return!Y}H.d(Y,{Z:()=>n,x:()=>r})},8532:(q,Y,H)=>{"use strict";H.d(Y,{Wm:()=>Rt.METERS_PER_UNIT,zY:()=>I,rM:()=>O,Sx:()=>C,uA:()=>B,OP:()=>F,mi:()=>T,dY:()=>z,U2:()=>E,_Q:()=>R,Ck:()=>L,WO:()=>A,Cs:()=>j,Fj:()=>D,on:()=>U,vs:()=>N,$A:()=>k});var et=H(9619);const it=6378137,nt=Math.PI*it,st=[-nt,-nt,nt,nt],ot=[-180,-85,180,85],lt=it*Math.log(Math.tan(Math.PI/2));class mt extends et.Z{constructor(q){super({code:q,units:"m",extent:st,global:!0,worldExtent:ot,getPointResolution:function(q,Y){return q/Math.cosh(Y[1]/it)}})}}const _t=[new mt("EPSG:3857"),new mt("EPSG:102100"),new mt("EPSG:102113"),new mt("EPSG:900913"),new mt("http://www.opengis.net/def/crs/EPSG/0/3857"),new mt("http://www.opengis.net/gml/srs/epsg.xml#3857")],vt=[-180,-90,180,90],bt=6378137*Math.PI/180;class Mt extends et.Z{constructor(q,Y){super({code:q,units:"degrees",extent:vt,axisOrientation:Y,global:!0,metersPerUnit:bt,worldExtent:vt})}}const Et=[new Mt("CRS:84"),new Mt("EPSG:4326","neu"),new Mt("urn:ogc:def:crs:OGC:1.3:CRS84"),new Mt("urn:ogc:def:crs:OGC:2:84"),new Mt("http://www.opengis.net/def/crs/OGC/1.3/CRS84"),new Mt("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new Mt("http://www.opengis.net/def/crs/EPSG/0/4326","neu")];var Rt=H(8375);let It={};var Pt=H(9556),Tt=H(8641),Ft=H(3983),At=H(1900);function S(q,Y,H){H=H||6371008.8;const et=(0,Ft.Yr)(q[1]),it=(0,Ft.Yr)(Y[1]),nt=(it-et)/2,st=(0,Ft.Yr)(Y[0]-q[0])/2,ot=Math.sin(nt)*Math.sin(nt)+Math.sin(st)*Math.sin(st)*Math.cos(et)*Math.cos(it);return 2*H*Math.atan2(Math.sqrt(ot),Math.sqrt(1-ot))}let Lt=!0;function M(q,Y){if(void 0!==Y)for(let H=0,et=q.length;H<et;++H)Y[H]=q[H];else Y=q.slice();return Y}function w(q,Y){if(void 0!==Y&&q!==Y){for(let H=0,et=q.length;H<et;++H)Y[H]=q[H];q=Y}return q}function C(q){!function(q,Y){It[q]=Y}(q.getCode(),q),(0,Pt.IH)(q,q,M)}function E(q){return"string"==typeof q?It[Y=q]||It[Y.replace(/urn:(x-)?ogc:def:crs:EPSG:(.*:)?(\w+)$/,"EPSG:$3")]||null:q||null;var Y}function R(q,Y,H,et){let it;const nt=(q=E(q)).getPointResolutionFunc();if(nt){if(it=nt(Y,H),et&&et!==q.getUnits()){const Y=q.getMetersPerUnit();Y&&(it=it*Y/Rt.METERS_PER_UNIT[et])}}else{const nt=q.getUnits();if("degrees"==nt&&!et||"degrees"==et)it=Y;else{const st=A(q,E("EPSG:4326"));if(st===w&&"degrees"!==nt)it=Y*q.getMetersPerUnit();else{let q=[H[0]-Y/2,H[1],H[0]+Y/2,H[1],H[0],H[1]-Y/2,H[0],H[1]+Y/2];q=st(q,q,2),it=(S(q.slice(0,2),q.slice(2,4))+S(q.slice(4,6),q.slice(6,8)))/2}const ot=et?Rt.METERS_PER_UNIT[et]:q.getMetersPerUnit();void 0!==ot&&(it/=ot)}}return it}function O(q){!function(q){q.forEach(C)}(q),q.forEach((function(Y){q.forEach((function(q){Y!==q&&(0,Pt.IH)(Y,q,M)}))}))}function P(q){return function(Y,H,et){const it=Y.length;et=void 0!==et?et:2,H=void 0!==H?H:new Array(it);for(let nt=0;nt<it;nt+=et){const it=q(Y.slice(nt,nt+et)),st=it.length;for(let q=0,ot=et;q<ot;++q)H[nt+q]=q>=st?Y[nt+q]:it[q]}return H}}function I(q,Y,H,et){const it=E(q),nt=E(Y);(0,Pt.IH)(it,nt,P(H)),(0,Pt.IH)(nt,it,P(et))}function T(q,Y){return Lt=!1,N(q,"EPSG:4326",void 0!==Y?Y:"EPSG:3857")}function F(q,Y){if(q===Y)return!0;const H=q.getUnits()===Y.getUnits();return(q.getCode()===Y.getCode()||A(q,Y)===M)&&H}function A(q,Y){const H=q.getCode(),et=Y.getCode();let it=(0,Pt.U2)(H,et);return it||(it=w),it}function L(q,Y){return A(E(q),E(Y))}function N(q,Y,H){return L(Y,H)(q,void 0,q.length)}function k(q,Y,H,et){const it=L(Y,H);return(0,Tt.Ne)(q,it,void 0,et)}let Nt=null;function j(){return Nt}function D(q,Y){return q}function z(q,Y){return q}function U(q,Y){return q}function B(q,Y,H){return function(et){let it,nt;if(q.canWrapX()){const Y=q.getExtent(),st=(0,Tt.dz)(Y);et=et.slice(0),nt=(0,At.jk)(et,q,st),nt&&(et[0]=et[0]-nt*st),et[0]=(0,Ft.uZ)(et[0],Y[0],Y[2]),et[1]=(0,Ft.uZ)(et[1],Y[1],Y[3]),it=H(et)}else it=H(et);return nt&&Y.canWrapX()&&(it[0]+=nt*(0,Tt.dz)(Y.getExtent())),it}}var kt,Gt,jt;O(_t),O(Et),kt=_t,Gt=function(q,Y,H){const et=q.length;H=H>1?H:2,void 0===Y&&(Y=H>2?q.slice():new Array(et));for(let st=0;st<et;st+=H){Y[st]=nt*q[st]/180;let H=it*Math.log(Math.tan(Math.PI*(+q[st+1]+90)/360));H>lt?H=lt:H<-lt&&(H=-lt),Y[st+1]=H}return Y},jt=function(q,Y,H){const et=q.length;H=H>1?H:2,void 0===Y&&(Y=H>2?q.slice():new Array(et));for(let st=0;st<et;st+=H)Y[st]=180*q[st]/nt,Y[st+1]=360*Math.atan(Math.exp(q[st+1]/it))/Math.PI-90;return Y},Et.forEach((function(q){kt.forEach((function(Y){(0,Pt.IH)(q,Y,Gt),(0,Pt.IH)(Y,q,jt)}))}))},9619:(q,Y,H)=>{"use strict";H.d(Y,{Z:()=>it});var et=H(8375);const it=class{constructor(q){this.code_=q.code,this.units_=q.units,this.extent_=void 0!==q.extent?q.extent:null,this.worldExtent_=void 0!==q.worldExtent?q.worldExtent:null,this.axisOrientation_=void 0!==q.axisOrientation?q.axisOrientation:"enu",this.global_=void 0!==q.global&&q.global,this.canWrapX_=!(!this.global_||!this.extent_),this.getPointResolutionFunc_=q.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=q.metersPerUnit}canWrapX(){return this.canWrapX_}getCode(){return this.code_}getExtent(){return this.extent_}getUnits(){return this.units_}getMetersPerUnit(){return this.metersPerUnit_||et.METERS_PER_UNIT[this.units_]}getWorldExtent(){return this.worldExtent_}getAxisOrientation(){return this.axisOrientation_}isGlobal(){return this.global_}setGlobal(q){this.global_=q,this.canWrapX_=!(!q||!this.extent_)}getDefaultTileGrid(){return this.defaultTileGrid_}setDefaultTileGrid(q){this.defaultTileGrid_=q}setExtent(q){this.extent_=q,this.canWrapX_=!(!this.global_||!q)}setWorldExtent(q){this.worldExtent_=q}setGetPointResolution(q){this.getPointResolutionFunc_=q}getPointResolutionFunc(){return this.getPointResolutionFunc_}}},8375:(q,Y,H)=>{"use strict";H.r(Y),H.d(Y,{METERS_PER_UNIT:()=>it,fromCode:()=>r});const et={9001:"m",9002:"ft",9003:"us-ft",9101:"radians",9102:"degrees"};function r(q){return et[q]}const it={radians:6370997/(2*Math.PI),degrees:2*Math.PI*6370997/360,ft:.3048,m:1,"us-ft":1200/3937}},9556:(q,Y,H)=>{"use strict";H.d(Y,{IH:()=>r,U2:()=>s});let et={};function r(q,Y,H){const it=q.getCode(),nt=Y.getCode();it in et||(et[it]={}),et[it][nt]=H}function s(q,Y){let H;return q in et&&Y in et[q]&&(H=et[q][Y]),H}},9839:(q,Y,H)=>{"use strict";H.r(Y),H.d(Y,{getRenderPixel:()=>u,getVectorContext:()=>l,toContext:()=>h});var et=H(5069),it=H(177),nt=H(6101),st=H(6234),ot=H(8532);function h(q,Y){const H=q.canvas,st=(Y=Y||{}).pixelRatio||it.MP,ot=Y.size;ot&&(H.width=ot[0]*st,H.height=ot[1]*st,H.style.width=ot[0]+"px",H.style.height=ot[1]+"px");const lt=[0,0,H.width,H.height],mt=(0,nt.bA)((0,nt.Ue)(),st,st);return new et.Z(q,st,lt,mt,0)}function l(q){if(!(q.context instanceof CanvasRenderingContext2D))throw new Error("Only works for render events from Canvas 2D layers");const Y=q.inversePixelTransform[0],H=q.inversePixelTransform[1],it=Math.sqrt(Y*Y+H*H),lt=q.frameState,mt=(0,nt.Jp)(q.inversePixelTransform.slice(),lt.coordinateToPixelTransform),_t=(0,st.se)(lt.viewState.resolution,it);let vt;const bt=(0,ot.Cs)();return bt&&(vt=(0,ot.WO)(bt,lt.viewState.projection)),new et.Z(q.context,it,lt.extent,mt,lt.viewState.rotation,_t,vt)}function u(q,Y){return(0,nt.nn)(q.inversePixelTransform,Y.slice(0))}},5624:(q,Y,H)=>{"use strict";H.d(Y,{Z:()=>et});const et=class{drawCustom(q,Y,H,et){}drawGeometry(q){}setStyle(q){}drawCircle(q,Y){}drawFeature(q,Y){}drawGeometryCollection(q,Y){}drawLineString(q,Y){}drawMultiLineString(q,Y){}drawMultiPoint(q,Y){}drawMultiPolygon(q,Y){}drawPoint(q,Y){}drawPolygon(q,Y){}drawText(q,Y){}setFillStrokeStyle(q,Y){}setImageStyle(q,Y){}setTextStyle(q,Y){}}},4778:(q,Y,H)=>{"use strict";H.d(Y,{bL:()=>_t,Df:()=>mt,mb:()=>vt,X9:()=>bt,He:()=>Mt,rc:()=>Et,yC:()=>At,V4:()=>Rt,oB:()=>Ft,Tx:()=>It,PH:()=>Pt,ru:()=>Tt,_f:()=>F,Zw:()=>T,Kd:()=>I,Qx:()=>jt});var et=H(2971),it=H(177),nt=H(9374),st=H(8326);const ot=new RegExp(["^\\s*(?=(?:(?:[-a-z]+\\s*){0,2}(italic|oblique))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(small-caps))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(bold(?:er)?|lighter|[1-9]00 ))?)","(?:(?:normal|\\1|\\2|\\3)\\s*){0,3}((?:xx?-)?","(?:small|large)|medium|smaller|larger|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx]))","(?:\\s*\\/\\s*(normal|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx])?))","?\\s*([-,\\\"\\'\\sa-z]+?)\\s*$"].join(""),"i"),lt=["style","variant","weight","size","lineHeight","family"],l=function(q){const Y=q.match(ot);if(!Y)return null;const H={lineHeight:"normal",size:"1.2em",style:"normal",weight:"normal",variant:"normal"};for(let q=0,et=lt.length;q<et;++q){const et=Y[q+1];void 0!==et&&(H[lt[q]]=et)}return H.families=H.family.split(/,\s?/),H},mt="10px sans-serif",_t="#000",vt="round",bt=[],Mt=0,Et="round",Rt=10,It="#000",Pt="center",Tt="middle",Ft=[0,0,0,0],At=1,Lt=new et.Z;let Nt,kt=null;const Gt={},jt=function(){const q="32px ",Y=["monospace","serif"],H=Y.length,et="wmytzilWMYTZIL@#/&?$%10";let it,st;function a(it,nt,ot){let lt=!0;for(let mt=0;mt<H;++mt){const H=Y[mt];if(st=P(it+" "+nt+" "+q+H,et),ot!=H){const Y=P(it+" "+nt+" "+q+ot+","+H,et);lt=lt&&Y!=st}}return!!lt}function h(){let q=!0;const Y=Lt.getKeys();for(let H=0,et=Y.length;H<et;++H){const et=Y[H];Lt.get(et)<100&&(a.apply(this,et.split("\n"))?((0,nt.Z)(Gt),kt=null,Nt=void 0,Lt.set(et,100)):(Lt.set(et,Lt.get(et)+1,!0),q=!1))}q&&(clearInterval(it),it=void 0)}return function(q){const Y=l(q);if(!Y)return;const H=Y.families;for(let q=0,et=H.length;q<et;++q){const et=H[q],nt=Y.style+"\n"+Y.weight+"\n"+et;void 0===Lt.get(nt)&&(Lt.set(nt,100,!0),a(Y.style,Y.weight,et)||(Lt.set(nt,0,!0),void 0===it&&(it=setInterval(h,32))))}}}(),Dt=function(){let q;return function(Y){let H=Gt[Y];if(null==H){if(it.Id){const q=l(Y),et=O(Y,"g");H=(isNaN(Number(q.lineHeight))?1.2:Number(q.lineHeight))*(et.actualBoundingBoxAscent+et.actualBoundingBoxDescent)}else q||(q=document.createElement("div"),q.innerHTML="M",q.style.minHeight="0",q.style.maxHeight="none",q.style.height="auto",q.style.padding="0",q.style.border="none",q.style.position="absolute",q.style.display="block",q.style.left="-99999px"),q.style.font=Y,document.body.appendChild(q),H=q.offsetHeight,document.body.removeChild(q);Gt[Y]=H}return H}}();function O(q,Y){return kt||(kt=(0,st.E4)(1,1)),q!=Nt&&(kt.font=q,Nt=kt.font),kt.measureText(Y)}function P(q,Y){return O(q,Y).width}function I(q,Y,H){if(Y in H)return H[Y];const et=Y.split("\n").reduce(((Y,H)=>Math.max(Y,P(q,H))),0);return H[Y]=et,et}function T(q,Y){const H=[],et=[],it=[];let nt=0,st=0,ot=0,lt=0;for(let mt=0,_t=Y.length;mt<=_t;mt+=2){const vt=Y[mt];if("\n"===vt||mt===_t){nt=Math.max(nt,st),it.push(st),st=0,ot+=lt;continue}const bt=Y[mt+1]||q.font,Mt=P(bt,vt);H.push(Mt),st+=Mt;const Et=Dt(bt);et.push(Et),lt=Math.max(lt,Et)}return{width:nt,height:ot,widths:H,heights:et,lineWidths:it}}function F(q,Y,H,et,it,nt,st,ot,lt,mt,_t){q.save(),1!==H&&(q.globalAlpha*=H),Y&&q.setTransform.apply(q,Y),et.contextInstructions?(q.translate(lt,mt),q.scale(_t[0],_t[1]),function(q,Y){const H=q.contextInstructions;for(let q=0,et=H.length;q<et;q+=2)Array.isArray(H[q+1])?Y[H[q]].apply(Y,H[q+1]):Y[H[q]]=H[q+1]}(et,q)):_t[0]<0||_t[1]<0?(q.translate(lt,mt),q.scale(_t[0],_t[1]),q.drawImage(et,it,nt,st,ot,0,0,st,ot)):q.drawImage(et,it,nt,st,ot,lt,mt,st*_t[0],ot*_t[1]),q.restore()}},5069:(q,Y,H)=>{"use strict";H.d(Y,{Z:()=>Mt});var et=H(5624),it=H(6620),nt=H(6101),st=H(4778),ot=H(5537),lt=H(8641),mt=H(3983),_t=H(6442),vt=H(2967);class bt extends et.Z{constructor(q,Y,H,et,it,st,ot){super(),this.context_=q,this.pixelRatio_=Y,this.extent_=H,this.transform_=et,this.transformRotation_=et?(0,mt.FH)(Math.atan2(et[1],et[0]),10):0,this.viewRotation_=it,this.squaredTolerance_=st,this.userTransform_=ot,this.contextFillState_=null,this.contextStrokeState_=null,this.contextTextState_=null,this.fillState_=null,this.strokeState_=null,this.image_=null,this.imageAnchorX_=0,this.imageAnchorY_=0,this.imageHeight_=0,this.imageOpacity_=0,this.imageOriginX_=0,this.imageOriginY_=0,this.imageRotateWithView_=!1,this.imageRotation_=0,this.imageScale_=[0,0],this.imageWidth_=0,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=!1,this.textRotation_=0,this.textScale_=[0,0],this.textFillState_=null,this.textStrokeState_=null,this.textState_=null,this.pixelCoordinates_=[],this.tmpLocalTransform_=(0,nt.Ue)()}drawImages_(q,Y,H,et){if(!this.image_)return;const it=(0,_t.vT)(q,Y,H,et,this.transform_,this.pixelCoordinates_),st=this.context_,ot=this.tmpLocalTransform_,lt=st.globalAlpha;1!=this.imageOpacity_&&(st.globalAlpha=lt*this.imageOpacity_);let mt=this.imageRotation_;0===this.transformRotation_&&(mt-=this.viewRotation_),this.imageRotateWithView_&&(mt+=this.viewRotation_);for(let q=0,Y=it.length;q<Y;q+=2){const Y=it[q]-this.imageAnchorX_,H=it[q+1]-this.imageAnchorY_;if(0!==mt||1!=this.imageScale_[0]||1!=this.imageScale_[1]){const q=Y+this.imageAnchorX_,et=H+this.imageAnchorY_;(0,nt.qC)(ot,q,et,1,1,mt,-q,-et),st.setTransform.apply(st,ot),st.translate(q,et),st.scale(this.imageScale_[0],this.imageScale_[1]),st.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,-this.imageAnchorX_,-this.imageAnchorY_,this.imageWidth_,this.imageHeight_),st.setTransform(1,0,0,1,0,0)}else st.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,Y,H,this.imageWidth_,this.imageHeight_)}1!=this.imageOpacity_&&(st.globalAlpha=lt)}drawText_(q,Y,H,et){if(!this.textState_||""===this.text_)return;this.textFillState_&&this.setContextFillState_(this.textFillState_),this.textStrokeState_&&this.setContextStrokeState_(this.textStrokeState_),this.setContextTextState_(this.textState_);const it=(0,_t.vT)(q,Y,H,et,this.transform_,this.pixelCoordinates_),nt=this.context_;let st=this.textRotation_;for(0===this.transformRotation_&&(st-=this.viewRotation_),this.textRotateWithView_&&(st+=this.viewRotation_);Y<H;Y+=et){const q=it[Y]+this.textOffsetX_,H=it[Y+1]+this.textOffsetY_;0!==st||1!=this.textScale_[0]||1!=this.textScale_[1]?(nt.translate(q-this.textOffsetX_,H-this.textOffsetY_),nt.rotate(st),nt.translate(this.textOffsetX_,this.textOffsetY_),nt.scale(this.textScale_[0],this.textScale_[1]),this.textStrokeState_&&nt.strokeText(this.text_,0,0),this.textFillState_&&nt.fillText(this.text_,0,0),nt.setTransform(1,0,0,1,0,0)):(this.textStrokeState_&&nt.strokeText(this.text_,q,H),this.textFillState_&&nt.fillText(this.text_,q,H))}}moveToLineTo_(q,Y,H,et,it){const nt=this.context_,st=(0,_t.vT)(q,Y,H,et,this.transform_,this.pixelCoordinates_);nt.moveTo(st[0],st[1]);let ot=st.length;it&&(ot-=2);for(let q=2;q<ot;q+=2)nt.lineTo(st[q],st[q+1]);return it&&nt.closePath(),H}drawRings_(q,Y,H,et){for(let it=0,nt=H.length;it<nt;++it)Y=this.moveToLineTo_(q,Y,H[it],et,!0);return Y}drawCircle(q){if((0,lt.kK)(this.extent_,q.getExtent())){if(this.fillState_||this.strokeState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const Y=(0,vt.Kr)(q,this.transform_,this.pixelCoordinates_),H=Y[2]-Y[0],et=Y[3]-Y[1],it=Math.sqrt(H*H+et*et),nt=this.context_;nt.beginPath(),nt.arc(Y[0],Y[1],it,0,2*Math.PI),this.fillState_&&nt.fill(),this.strokeState_&&nt.stroke()}""!==this.text_&&this.drawText_(q.getCenter(),0,2,2)}}setStyle(q){this.setFillStrokeStyle(q.getFill(),q.getStroke()),this.setImageStyle(q.getImage()),this.setTextStyle(q.getText())}setTransform(q){this.transform_=q}drawGeometry(q){switch(q.getType()){case"Point":this.drawPoint(q);break;case"LineString":this.drawLineString(q);break;case"Polygon":this.drawPolygon(q);break;case"MultiPoint":this.drawMultiPoint(q);break;case"MultiLineString":this.drawMultiLineString(q);break;case"MultiPolygon":this.drawMultiPolygon(q);break;case"GeometryCollection":this.drawGeometryCollection(q);break;case"Circle":this.drawCircle(q)}}drawFeature(q,Y){const H=Y.getGeometryFunction()(q);H&&(0,lt.kK)(this.extent_,H.getExtent())&&(this.setStyle(Y),this.drawGeometry(H))}drawGeometryCollection(q){const Y=q.getGeometriesArray();for(let q=0,H=Y.length;q<H;++q)this.drawGeometry(Y[q])}drawPoint(q){this.squaredTolerance_&&(q=q.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const Y=q.getFlatCoordinates(),H=q.getStride();this.image_&&this.drawImages_(Y,0,Y.length,H),""!==this.text_&&this.drawText_(Y,0,Y.length,H)}drawMultiPoint(q){this.squaredTolerance_&&(q=q.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const Y=q.getFlatCoordinates(),H=q.getStride();this.image_&&this.drawImages_(Y,0,Y.length,H),""!==this.text_&&this.drawText_(Y,0,Y.length,H)}drawLineString(q){if(this.squaredTolerance_&&(q=q.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),(0,lt.kK)(this.extent_,q.getExtent())){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const Y=this.context_,H=q.getFlatCoordinates();Y.beginPath(),this.moveToLineTo_(H,0,H.length,q.getStride(),!1),Y.stroke()}if(""!==this.text_){const Y=q.getFlatMidpoint();this.drawText_(Y,0,2,2)}}}drawMultiLineString(q){this.squaredTolerance_&&(q=q.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const Y=q.getExtent();if((0,lt.kK)(this.extent_,Y)){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const Y=this.context_,H=q.getFlatCoordinates();let et=0;const it=q.getEnds(),nt=q.getStride();Y.beginPath();for(let q=0,Y=it.length;q<Y;++q)et=this.moveToLineTo_(H,et,it[q],nt,!1);Y.stroke()}if(""!==this.text_){const Y=q.getFlatMidpoints();this.drawText_(Y,0,Y.length,2)}}}drawPolygon(q){if(this.squaredTolerance_&&(q=q.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),(0,lt.kK)(this.extent_,q.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const Y=this.context_;Y.beginPath(),this.drawRings_(q.getOrientedFlatCoordinates(),0,q.getEnds(),q.getStride()),this.fillState_&&Y.fill(),this.strokeState_&&Y.stroke()}if(""!==this.text_){const Y=q.getFlatInteriorPoint();this.drawText_(Y,0,2,2)}}}drawMultiPolygon(q){if(this.squaredTolerance_&&(q=q.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),(0,lt.kK)(this.extent_,q.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const Y=this.context_,H=q.getOrientedFlatCoordinates();let et=0;const it=q.getEndss(),nt=q.getStride();Y.beginPath();for(let q=0,Y=it.length;q<Y;++q){const Y=it[q];et=this.drawRings_(H,et,Y,nt)}this.fillState_&&Y.fill(),this.strokeState_&&Y.stroke()}if(""!==this.text_){const Y=q.getFlatInteriorPoints();this.drawText_(Y,0,Y.length,2)}}}setContextFillState_(q){const Y=this.context_,H=this.contextFillState_;H?H.fillStyle!=q.fillStyle&&(H.fillStyle=q.fillStyle,Y.fillStyle=q.fillStyle):(Y.fillStyle=q.fillStyle,this.contextFillState_={fillStyle:q.fillStyle})}setContextStrokeState_(q){const Y=this.context_,H=this.contextStrokeState_;H?(H.lineCap!=q.lineCap&&(H.lineCap=q.lineCap,Y.lineCap=q.lineCap),(0,ot.fS)(H.lineDash,q.lineDash)||Y.setLineDash(H.lineDash=q.lineDash),H.lineDashOffset!=q.lineDashOffset&&(H.lineDashOffset=q.lineDashOffset,Y.lineDashOffset=q.lineDashOffset),H.lineJoin!=q.lineJoin&&(H.lineJoin=q.lineJoin,Y.lineJoin=q.lineJoin),H.lineWidth!=q.lineWidth&&(H.lineWidth=q.lineWidth,Y.lineWidth=q.lineWidth),H.miterLimit!=q.miterLimit&&(H.miterLimit=q.miterLimit,Y.miterLimit=q.miterLimit),H.strokeStyle!=q.strokeStyle&&(H.strokeStyle=q.strokeStyle,Y.strokeStyle=q.strokeStyle)):(Y.lineCap=q.lineCap,Y.setLineDash(q.lineDash),Y.lineDashOffset=q.lineDashOffset,Y.lineJoin=q.lineJoin,Y.lineWidth=q.lineWidth,Y.miterLimit=q.miterLimit,Y.strokeStyle=q.strokeStyle,this.contextStrokeState_={lineCap:q.lineCap,lineDash:q.lineDash,lineDashOffset:q.lineDashOffset,lineJoin:q.lineJoin,lineWidth:q.lineWidth,miterLimit:q.miterLimit,strokeStyle:q.strokeStyle})}setContextTextState_(q){const Y=this.context_,H=this.contextTextState_,et=q.textAlign?q.textAlign:st.PH;H?(H.font!=q.font&&(H.font=q.font,Y.font=q.font),H.textAlign!=et&&(H.textAlign=et,Y.textAlign=et),H.textBaseline!=q.textBaseline&&(H.textBaseline=q.textBaseline,Y.textBaseline=q.textBaseline)):(Y.font=q.font,Y.textAlign=et,Y.textBaseline=q.textBaseline,this.contextTextState_={font:q.font,textAlign:et,textBaseline:q.textBaseline})}setFillStrokeStyle(q,Y){if(q){const Y=q.getColor();this.fillState_={fillStyle:(0,it.y)(Y||st.bL)}}else this.fillState_=null;if(Y){const q=Y.getColor(),H=Y.getLineCap(),et=Y.getLineDash(),nt=Y.getLineDashOffset(),ot=Y.getLineJoin(),lt=Y.getWidth(),mt=Y.getMiterLimit(),_t=et||st.X9;this.strokeState_={lineCap:void 0!==H?H:st.mb,lineDash:1===this.pixelRatio_?_t:_t.map((q=>q*this.pixelRatio_)),lineDashOffset:(nt||st.He)*this.pixelRatio_,lineJoin:void 0!==ot?ot:st.rc,lineWidth:(void 0!==lt?lt:st.yC)*this.pixelRatio_,miterLimit:void 0!==mt?mt:st.V4,strokeStyle:(0,it.y)(q||st.Tx)}}else this.strokeState_=null}setImageStyle(q){let Y;if(!q||!(Y=q.getSize()))return void(this.image_=null);const H=q.getPixelRatio(this.pixelRatio_),et=q.getAnchor(),it=q.getOrigin();this.image_=q.getImage(this.pixelRatio_),this.imageAnchorX_=et[0]*H,this.imageAnchorY_=et[1]*H,this.imageHeight_=Y[1]*H,this.imageOpacity_=q.getOpacity(),this.imageOriginX_=it[0],this.imageOriginY_=it[1],this.imageRotateWithView_=q.getRotateWithView(),this.imageRotation_=q.getRotation();const nt=q.getScaleArray();this.imageScale_=[nt[0]*this.pixelRatio_/H,nt[1]*this.pixelRatio_/H],this.imageWidth_=Y[0]*H}setTextStyle(q){if(q){const Y=q.getFill();if(Y){const q=Y.getColor();this.textFillState_={fillStyle:(0,it.y)(q||st.bL)}}else this.textFillState_=null;const H=q.getStroke();if(H){const q=H.getColor(),Y=H.getLineCap(),et=H.getLineDash(),nt=H.getLineDashOffset(),ot=H.getLineJoin(),lt=H.getWidth(),mt=H.getMiterLimit();this.textStrokeState_={lineCap:void 0!==Y?Y:st.mb,lineDash:et||st.X9,lineDashOffset:nt||st.He,lineJoin:void 0!==ot?ot:st.rc,lineWidth:void 0!==lt?lt:st.yC,miterLimit:void 0!==mt?mt:st.V4,strokeStyle:(0,it.y)(q||st.Tx)}}else this.textStrokeState_=null;const et=q.getFont(),nt=q.getOffsetX(),ot=q.getOffsetY(),lt=q.getRotateWithView(),mt=q.getRotation(),_t=q.getScaleArray(),vt=q.getText(),bt=q.getTextAlign(),Mt=q.getTextBaseline();this.textState_={font:void 0!==et?et:st.Df,textAlign:void 0!==bt?bt:st.PH,textBaseline:void 0!==Mt?Mt:st.ru},this.text_=void 0!==vt?Array.isArray(vt)?vt.reduce(((q,Y,H)=>q+(H%2?" ":Y)),""):vt:"",this.textOffsetX_=void 0!==nt?this.pixelRatio_*nt:0,this.textOffsetY_=void 0!==ot?this.pixelRatio_*ot:0,this.textRotateWithView_=void 0!==lt&&lt,this.textRotation_=void 0!==mt?mt:0,this.textScale_=[this.pixelRatio_*_t[0],this.pixelRatio_*_t[1]]}else this.text_=""}}const Mt=bt},6234:(q,Y,H)=>{"use strict";H.d(Y,{Pn:()=>l,Qz:()=>h,eR:()=>o,se:()=>a});var et=H(553),it=H(4187);const nt={Point:function(q,Y,H,it,nt){const st=H.getImage(),ot=H.getText();let lt;if(st){if(st.getImageState()!=et.default.LOADED)return;let mt=q;if(nt){const et=st.getDeclutterMode();if("none"!==et)if(mt=nt,"obstacle"===et){const et=q.getBuilder(H.getZIndex(),"Image");et.setImageStyle(st,lt),et.drawPoint(Y,it)}else ot&&ot.getText()&&(lt={})}const _t=mt.getBuilder(H.getZIndex(),"Image");_t.setImageStyle(st,lt),_t.drawPoint(Y,it)}if(ot&&ot.getText()){let et=q;nt&&(et=nt);const st=et.getBuilder(H.getZIndex(),"Text");st.setTextStyle(ot,lt),st.drawText(Y,it)}},LineString:function(q,Y,H,et,it){const nt=H.getStroke();if(nt){const it=q.getBuilder(H.getZIndex(),"LineString");it.setFillStrokeStyle(null,nt),it.drawLineString(Y,et)}const st=H.getText();if(st&&st.getText()){const nt=(it||q).getBuilder(H.getZIndex(),"Text");nt.setTextStyle(st),nt.drawText(Y,et)}},Polygon:function(q,Y,H,et,it){const nt=H.getFill(),st=H.getStroke();if(nt||st){const it=q.getBuilder(H.getZIndex(),"Polygon");it.setFillStrokeStyle(nt,st),it.drawPolygon(Y,et)}const ot=H.getText();if(ot&&ot.getText()){const nt=(it||q).getBuilder(H.getZIndex(),"Text");nt.setTextStyle(ot),nt.drawText(Y,et)}},MultiPoint:function(q,Y,H,it,nt){const st=H.getImage(),ot=H.getText();let lt;if(st){if(st.getImageState()!=et.default.LOADED)return;let mt=q;if(nt){const et=st.getDeclutterMode();if("none"!==et)if(mt=nt,"obstacle"===et){const et=q.getBuilder(H.getZIndex(),"Image");et.setImageStyle(st,lt),et.drawMultiPoint(Y,it)}else ot&&ot.getText()&&(lt={})}const _t=mt.getBuilder(H.getZIndex(),"Image");_t.setImageStyle(st,lt),_t.drawMultiPoint(Y,it)}if(ot&&ot.getText()){let et=q;nt&&(et=nt);const st=et.getBuilder(H.getZIndex(),"Text");st.setTextStyle(ot,lt),st.drawText(Y,it)}},MultiLineString:function(q,Y,H,et,it){const nt=H.getStroke();if(nt){const it=q.getBuilder(H.getZIndex(),"LineString");it.setFillStrokeStyle(null,nt),it.drawMultiLineString(Y,et)}const st=H.getText();if(st&&st.getText()){const nt=(it||q).getBuilder(H.getZIndex(),"Text");nt.setTextStyle(st),nt.drawText(Y,et)}},MultiPolygon:function(q,Y,H,et,it){const nt=H.getFill(),st=H.getStroke();if(st||nt){const it=q.getBuilder(H.getZIndex(),"Polygon");it.setFillStrokeStyle(nt,st),it.drawMultiPolygon(Y,et)}const ot=H.getText();if(ot&&ot.getText()){const nt=(it||q).getBuilder(H.getZIndex(),"Text");nt.setTextStyle(ot),nt.drawText(Y,et)}},GeometryCollection:function(q,Y,H,et,it){const st=Y.getGeometriesArray();let ot,lt;for(ot=0,lt=st.length;ot<lt;++ot)(0,nt[st[ot].getType()])(q,st[ot],H,et,it)},Circle:function(q,Y,H,et,it){const nt=H.getFill(),st=H.getStroke();if(nt||st){const it=q.getBuilder(H.getZIndex(),"Circle");it.setFillStrokeStyle(nt,st),it.drawCircle(Y,et)}const ot=H.getText();if(ot&&ot.getText()){const nt=(it||q).getBuilder(H.getZIndex(),"Text");nt.setTextStyle(ot),nt.drawText(Y,et)}}};function o(q,Y){return parseInt((0,it.sq)(q),10)-parseInt((0,it.sq)(Y),10)}function a(q,Y){const H=h(q,Y);return H*H}function h(q,Y){return.5*q/Y}function l(q,Y,H,it,st,ot,lt){let mt=!1;const _t=H.getImage();if(_t){const q=_t.getImageState();q==et.default.LOADED||q==et.default.ERROR?_t.unlistenImageChange(st):(q==et.default.IDLE&&_t.load(),_t.listenImageChange(st),mt=!0)}return function(q,Y,H,et,it,st){const ot=H.getGeometryFunction()(Y);if(!ot)return;const lt=ot.simplifyTransformed(et,it);H.getRenderer()?u(q,lt,H,Y):(0,nt[lt.getType()])(q,lt,H,Y,st)}(q,Y,H,it,ot,lt),mt}function u(q,Y,H,et){if("GeometryCollection"!=Y.getType())q.getBuilder(H.getZIndex(),"Default").drawCustom(Y,et,H.getRenderer(),H.getHitDetectionRenderer());else{const it=Y.getGeometries();for(let Y=0,nt=it.length;Y<nt;++Y)u(q,it[Y],H,et)}}},4307:(q,Y,H)=>{"use strict";function n(q,Y,H){return void 0===H&&(H=[0,0]),H[0]=q[0]+2*Y,H[1]=q[1]+2*Y,H}function r(q,Y,H){return void 0===H&&(H=[0,0]),H[0]=q[0]*Y+.5|0,H[1]=q[1]*Y+.5|0,H}function s(q,Y){return Array.isArray(q)?q:(void 0===Y?Y=[q,q]:(Y[0]=q,Y[1]=q),Y)}H.d(Y,{Pq:()=>s,bA:()=>r,f3:()=>n})},283:(q,Y,H)=>{"use strict";H.r(Y),H.d(Y,{default:()=>nt});var et=H(5393);class it extends et.default{constructor(q){super({points:1/0,fill:(q=q||{radius:5}).fill,radius:q.radius,stroke:q.stroke,scale:void 0!==q.scale?q.scale:1,rotation:void 0!==q.rotation?q.rotation:0,rotateWithView:void 0!==q.rotateWithView&&q.rotateWithView,displacement:void 0!==q.displacement?q.displacement:[0,0],declutterMode:q.declutterMode})}clone(){const q=this.getScale(),Y=new it({fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,radius:this.getRadius(),scale:Array.isArray(q)?q.slice():q,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return Y.setOpacity(this.getOpacity()),Y}setRadius(q){this.radius_=q,this.render()}}const nt=it},1345:(q,Y,H)=>{"use strict";H.r(Y),H.d(Y,{default:()=>it});class et{constructor(q){q=q||{},this.color_=void 0!==q.color?q.color:null}clone(){const q=this.getColor();return new et({color:Array.isArray(q)?q.slice():q||void 0})}getColor(){return this.color_}setColor(q){this.color_=q}}const it=et},4548:(q,Y,H)=>{"use strict";H.r(Y),H.d(Y,{default:()=>It});var et=H(5487),it=H(553),nt=H(8443),st=H(9706),ot=H(9515),lt=H(3069),mt=H(8326);function u(q,Y,H){return Y+":"+q+":"+(H?(0,st.XC)(H):"null")}const _t=new class{constructor(){this.cache_={},this.cacheSize_=0,this.maxCacheSize_=32}clear(){this.cache_={},this.cacheSize_=0}canExpireCache(){return this.cacheSize_>this.maxCacheSize_}expire(){if(this.canExpireCache()){let q=0;for(const Y in this.cache_){const H=this.cache_[Y];0!=(3&q++)||H.hasListener()||(delete this.cache_[Y],--this.cacheSize_)}}}get(q,Y,H){const et=u(q,Y,H);return et in this.cache_?this.cache_[et]:null}set(q,Y,H,et){const it=u(q,Y,H);this.cache_[it]=et,++this.cacheSize_}setSize(q){this.maxCacheSize_=q,this.expire()}};var vt=H(8096);let bt=null;class Mt extends lt.Z{constructor(q,Y,H,et,it,nt){super(),this.hitDetectionImage_=null,this.image_=q,this.crossOrigin_=et,this.canvas_={},this.color_=nt,this.unlisten_=null,this.imageState_=it,this.size_=H,this.src_=Y,this.tainted_}initializeImage_(){this.image_=new Image,null!==this.crossOrigin_&&(this.image_.crossOrigin=this.crossOrigin_)}isTainted_(){if(void 0===this.tainted_&&this.imageState_===it.default.LOADED){bt||(bt=(0,mt.E4)(1,1,void 0,{willReadFrequently:!0})),bt.drawImage(this.image_,0,0);try{bt.getImageData(0,0,1,1),this.tainted_=!1}catch(q){bt=null,this.tainted_=!0}}return!0===this.tainted_}dispatchChangeEvent_(){this.dispatchEvent(et.Z.CHANGE)}handleImageError_(){this.imageState_=it.default.ERROR,this.unlistenImage_(),this.dispatchChangeEvent_()}handleImageLoad_(){this.imageState_=it.default.LOADED,this.size_?(this.image_.width=this.size_[0],this.image_.height=this.size_[1]):this.size_=[this.image_.width,this.image_.height],this.unlistenImage_(),this.dispatchChangeEvent_()}getImage(q){return this.image_||this.initializeImage_(),this.replaceColor_(q),this.canvas_[q]?this.canvas_[q]:this.image_}getPixelRatio(q){return this.replaceColor_(q),this.canvas_[q]?q:1}getImageState(){return this.imageState_}getHitDetectionImage(){if(this.image_||this.initializeImage_(),!this.hitDetectionImage_)if(this.isTainted_()){const q=this.size_[0],Y=this.size_[1],H=(0,mt.E4)(q,Y);H.fillRect(0,0,q,Y),this.hitDetectionImage_=H.canvas}else this.hitDetectionImage_=this.image_;return this.hitDetectionImage_}getSize(){return this.size_}getSrc(){return this.src_}load(){if(this.imageState_===it.default.IDLE){this.image_||this.initializeImage_(),this.imageState_=it.default.LOADING;try{this.image_.src=this.src_}catch(q){this.handleImageError_()}this.unlisten_=(0,vt.K)(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this))}}replaceColor_(q){if(!this.color_||this.canvas_[q]||this.imageState_!==it.default.LOADED)return;const Y=this.image_,H=document.createElement("canvas");H.width=Math.ceil(Y.width*q),H.height=Math.ceil(Y.height*q);const et=H.getContext("2d");et.scale(q,q),et.drawImage(Y,0,0),et.globalCompositeOperation="multiply",et.fillStyle=(0,st.XC)(this.color_),et.fillRect(0,0,H.width/q,H.height/q),et.globalCompositeOperation="destination-in",et.drawImage(Y,0,0),this.canvas_[q]=H}unlistenImage_(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)}}var Et=H(4187);class Rt extends nt.default{constructor(q){const Y=void 0!==(q=q||{}).opacity?q.opacity:1,H=void 0!==q.rotation?q.rotation:0,et=void 0!==q.scale?q.scale:1,nt=void 0!==q.rotateWithView&&q.rotateWithView;super({opacity:Y,rotation:H,scale:et,displacement:void 0!==q.displacement?q.displacement:[0,0],rotateWithView:nt,declutterMode:q.declutterMode}),this.anchor_=void 0!==q.anchor?q.anchor:[.5,.5],this.normalizedAnchor_=null,this.anchorOrigin_=void 0!==q.anchorOrigin?q.anchorOrigin:"top-left",this.anchorXUnits_=void 0!==q.anchorXUnits?q.anchorXUnits:"fraction",this.anchorYUnits_=void 0!==q.anchorYUnits?q.anchorYUnits:"fraction",this.crossOrigin_=void 0!==q.crossOrigin?q.crossOrigin:null;const lt=void 0!==q.img?q.img:null;this.imgSize_=q.imgSize;let mt=q.src;(0,ot.h)(!(void 0!==mt&&lt),4),(0,ot.h)(!lt||lt&&this.imgSize_,5),void 0!==mt&&0!==mt.length||!lt||(mt=lt.src||(0,Et.sq)(lt)),(0,ot.h)(void 0!==mt&&mt.length>0,6),(0,ot.h)(!((void 0!==q.width||void 0!==q.height)&&void 0!==q.scale),69);const vt=void 0!==q.src?it.default.IDLE:it.default.LOADED;if(this.color_=void 0!==q.color?(0,st._2)(q.color):null,this.iconImage_=function(q,Y,H,et,it,nt){let st=_t.get(Y,et,nt);return st||(st=new Mt(q,Y,H,et,it,nt),_t.set(Y,et,nt,st)),st}(lt,mt,void 0!==this.imgSize_?this.imgSize_:null,this.crossOrigin_,vt,this.color_),this.offset_=void 0!==q.offset?q.offset:[0,0],this.offsetOrigin_=void 0!==q.offsetOrigin?q.offsetOrigin:"top-left",this.origin_=null,this.size_=void 0!==q.size?q.size:null,this.width_=q.width,this.height_=q.height,void 0!==this.width_||void 0!==this.height_){const q=this.getImage(1),e=()=>{this.updateScaleFromWidthAndHeight(this.width_,this.height_)};q.width>0?this.updateScaleFromWidthAndHeight(this.width_,this.height_):q.addEventListener("load",e)}}clone(){const q=this.getScale();return new Rt({anchor:this.anchor_.slice(),anchorOrigin:this.anchorOrigin_,anchorXUnits:this.anchorXUnits_,anchorYUnits:this.anchorYUnits_,color:this.color_&&this.color_.slice?this.color_.slice():this.color_||void 0,crossOrigin:this.crossOrigin_,imgSize:this.imgSize_,offset:this.offset_.slice(),offsetOrigin:this.offsetOrigin_,opacity:this.getOpacity(),rotateWithView:this.getRotateWithView(),rotation:this.getRotation(),scale:Array.isArray(q)?q.slice():q,size:null!==this.size_?this.size_.slice():void 0,src:this.getSrc(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode(),width:this.width_,height:this.height_})}updateScaleFromWidthAndHeight(q,Y){const H=this.getImage(1);void 0!==q&&void 0!==Y?super.setScale([q/H.width,Y/H.height]):void 0!==q?super.setScale([q/H.width,q/H.width]):void 0!==Y?super.setScale([Y/H.height,Y/H.height]):super.setScale([1,1])}getAnchor(){let q=this.normalizedAnchor_;if(!q){q=this.anchor_;const Y=this.getSize();if("fraction"==this.anchorXUnits_||"fraction"==this.anchorYUnits_){if(!Y)return null;q=this.anchor_.slice(),"fraction"==this.anchorXUnits_&&(q[0]*=Y[0]),"fraction"==this.anchorYUnits_&&(q[1]*=Y[1])}if("top-left"!=this.anchorOrigin_){if(!Y)return null;q===this.anchor_&&(q=this.anchor_.slice()),"top-right"!=this.anchorOrigin_&&"bottom-right"!=this.anchorOrigin_||(q[0]=-q[0]+Y[0]),"bottom-left"!=this.anchorOrigin_&&"bottom-right"!=this.anchorOrigin_||(q[1]=-q[1]+Y[1])}this.normalizedAnchor_=q}const Y=this.getDisplacement(),H=this.getScaleArray();return[q[0]-Y[0]/H[0],q[1]+Y[1]/H[1]]}setAnchor(q){this.anchor_=q,this.normalizedAnchor_=null}getColor(){return this.color_}getImage(q){return this.iconImage_.getImage(q)}getPixelRatio(q){return this.iconImage_.getPixelRatio(q)}getImageSize(){return this.iconImage_.getSize()}getImageState(){return this.iconImage_.getImageState()}getHitDetectionImage(){return this.iconImage_.getHitDetectionImage()}getOrigin(){if(this.origin_)return this.origin_;let q=this.offset_;if("top-left"!=this.offsetOrigin_){const Y=this.getSize(),H=this.iconImage_.getSize();if(!Y||!H)return null;q=q.slice(),"top-right"!=this.offsetOrigin_&&"bottom-right"!=this.offsetOrigin_||(q[0]=H[0]-Y[0]-q[0]),"bottom-left"!=this.offsetOrigin_&&"bottom-right"!=this.offsetOrigin_||(q[1]=H[1]-Y[1]-q[1])}return this.origin_=q,this.origin_}getSrc(){return this.iconImage_.getSrc()}getSize(){return this.size_?this.size_:this.iconImage_.getSize()}getWidth(){return this.width_}getHeight(){return this.height_}setWidth(q){this.width_=q,this.updateScaleFromWidthAndHeight(q,this.height_)}setHeight(q){this.height_=q,this.updateScaleFromWidthAndHeight(this.width_,q)}setScale(q){super.setScale(q);const Y=this.getImage(1);if(Y){const H=Array.isArray(q)?q[0]:q;void 0!==H&&(this.width_=H*Y.width);const et=Array.isArray(q)?q[1]:q;void 0!==et&&(this.height_=et*Y.height)}}listenImageChange(q){this.iconImage_.addEventListener(et.Z.CHANGE,q)}load(){this.iconImage_.load()}unlistenImageChange(q){this.iconImage_.removeEventListener(et.Z.CHANGE,q)}}const It=Rt},8443:(q,Y,H)=>{"use strict";H.r(Y),H.d(Y,{default:()=>st});var et=H(4187),it=H(4307);class nt{constructor(q){this.opacity_=q.opacity,this.rotateWithView_=q.rotateWithView,this.rotation_=q.rotation,this.scale_=q.scale,this.scaleArray_=(0,it.Pq)(q.scale),this.displacement_=q.displacement,this.declutterMode_=q.declutterMode}clone(){const q=this.getScale();return new nt({opacity:this.getOpacity(),scale:Array.isArray(q)?q.slice():q,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getOpacity(){return this.opacity_}getRotateWithView(){return this.rotateWithView_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getDisplacement(){return this.displacement_}getDeclutterMode(){return this.declutterMode_}getAnchor(){return(0,et.O3)()}getImage(q){return(0,et.O3)()}getHitDetectionImage(){return(0,et.O3)()}getPixelRatio(q){return 1}getImageState(){return(0,et.O3)()}getImageSize(){return(0,et.O3)()}getOrigin(){return(0,et.O3)()}getSize(){return(0,et.O3)()}setDisplacement(q){this.displacement_=q}setOpacity(q){this.opacity_=q}setRotateWithView(q){this.rotateWithView_=q}setRotation(q){this.rotation_=q}setScale(q){this.scale_=q,this.scaleArray_=(0,it.Pq)(q)}listenImageChange(q){(0,et.O3)()}load(){(0,et.O3)()}unlistenImageChange(q){(0,et.O3)()}}const st=nt},5393:(q,Y,H)=>{"use strict";H.r(Y),H.d(Y,{default:()=>_t});var et=H(553),it=H(8443),nt=H(9706),st=H(6620),ot=H(8326),lt=H(4778);class mt extends it.default{constructor(q){super({opacity:1,rotateWithView:void 0!==q.rotateWithView&&q.rotateWithView,rotation:void 0!==q.rotation?q.rotation:0,scale:void 0!==q.scale?q.scale:1,displacement:void 0!==q.displacement?q.displacement:[0,0],declutterMode:q.declutterMode}),this.canvas_=void 0,this.hitDetectionCanvas_=null,this.fill_=void 0!==q.fill?q.fill:null,this.origin_=[0,0],this.points_=q.points,this.radius_=void 0!==q.radius?q.radius:q.radius1,this.radius2_=q.radius2,this.angle_=void 0!==q.angle?q.angle:0,this.stroke_=void 0!==q.stroke?q.stroke:null,this.size_=null,this.renderOptions_=null,this.render()}clone(){const q=this.getScale(),Y=new mt({fill:this.getFill()?this.getFill().clone():void 0,points:this.getPoints(),radius:this.getRadius(),radius2:this.getRadius2(),angle:this.getAngle(),stroke:this.getStroke()?this.getStroke().clone():void 0,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(q)?q.slice():q,displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return Y.setOpacity(this.getOpacity()),Y}getAnchor(){const q=this.size_;if(!q)return null;const Y=this.getDisplacement(),H=this.getScaleArray();return[q[0]/2-Y[0]/H[0],q[1]/2+Y[1]/H[1]]}getAngle(){return this.angle_}getFill(){return this.fill_}setFill(q){this.fill_=q,this.render()}getHitDetectionImage(){return this.hitDetectionCanvas_||this.createHitDetectionCanvas_(this.renderOptions_),this.hitDetectionCanvas_}getImage(q){let Y=this.canvas_[q];if(!Y){const H=this.renderOptions_,et=(0,ot.E4)(H.size*q,H.size*q);this.draw_(H,et,q),Y=et.canvas,this.canvas_[q]=Y}return Y}getPixelRatio(q){return q}getImageSize(){return this.size_}getImageState(){return et.default.LOADED}getOrigin(){return this.origin_}getPoints(){return this.points_}getRadius(){return this.radius_}getRadius2(){return this.radius2_}getSize(){return this.size_}getStroke(){return this.stroke_}setStroke(q){this.stroke_=q,this.render()}listenImageChange(q){}load(){}unlistenImageChange(q){}calculateLineJoinSize_(q,Y,H){if(0===Y||this.points_===1/0||"bevel"!==q&&"miter"!==q)return Y;let et=this.radius_,it=void 0===this.radius2_?et:this.radius2_;if(et<it){const q=et;et=it,it=q}const nt=void 0===this.radius2_?this.points_:2*this.points_,st=2*Math.PI/nt,ot=it*Math.sin(st),lt=et-Math.sqrt(it*it-ot*ot),mt=Math.sqrt(ot*ot+lt*lt),_t=mt/ot;if("miter"===q&&_t<=H)return _t*Y;const vt=Y/2/_t,bt=Y/2*(lt/mt),Mt=Math.sqrt((et+vt)*(et+vt)+bt*bt)-et;if(void 0===this.radius2_||"bevel"===q)return 2*Mt;const Et=et*Math.sin(st),Rt=it-Math.sqrt(et*et-Et*Et),It=Math.sqrt(Et*Et+Rt*Rt)/Et;if(It<=H){const q=It*Y/2-it-et;return 2*Math.max(Mt,q)}return 2*Mt}createRenderOptions(){let q,Y=lt.rc,H=0,et=null,it=0,nt=0;this.stroke_&&(q=this.stroke_.getColor(),null===q&&(q=lt.Tx),q=(0,st.y)(q),nt=this.stroke_.getWidth(),void 0===nt&&(nt=lt.yC),et=this.stroke_.getLineDash(),it=this.stroke_.getLineDashOffset(),Y=this.stroke_.getLineJoin(),void 0===Y&&(Y=lt.rc),H=this.stroke_.getMiterLimit(),void 0===H&&(H=lt.V4));const ot=this.calculateLineJoinSize_(Y,nt,H),mt=Math.max(this.radius_,this.radius2_||0);return{strokeStyle:q,strokeWidth:nt,size:Math.ceil(2*mt+ot),lineDash:et,lineDashOffset:it,lineJoin:Y,miterLimit:H}}render(){this.renderOptions_=this.createRenderOptions();const q=this.renderOptions_.size;this.canvas_={},this.size_=[q,q]}draw_(q,Y,H){if(Y.scale(H,H),Y.translate(q.size/2,q.size/2),this.createPath_(Y),this.fill_){let q=this.fill_.getColor();null===q&&(q=lt.bL),Y.fillStyle=(0,st.y)(q),Y.fill()}this.stroke_&&(Y.strokeStyle=q.strokeStyle,Y.lineWidth=q.strokeWidth,q.lineDash&&(Y.setLineDash(q.lineDash),Y.lineDashOffset=q.lineDashOffset),Y.lineJoin=q.lineJoin,Y.miterLimit=q.miterLimit,Y.stroke())}createHitDetectionCanvas_(q){if(this.fill_){let Y=this.fill_.getColor(),H=0;if("string"==typeof Y&&(Y=(0,nt._2)(Y)),null===Y?H=1:Array.isArray(Y)&&(H=4===Y.length?Y[3]:1),0===H){const Y=(0,ot.E4)(q.size,q.size);this.hitDetectionCanvas_=Y.canvas,this.drawHitDetectionCanvas_(q,Y)}}this.hitDetectionCanvas_||(this.hitDetectionCanvas_=this.getImage(1))}createPath_(q){let Y=this.points_;const H=this.radius_;if(Y===1/0)q.arc(0,0,H,0,2*Math.PI);else{const et=void 0===this.radius2_?H:this.radius2_;void 0!==this.radius2_&&(Y*=2);const it=this.angle_-Math.PI/2,nt=2*Math.PI/Y;for(let st=0;st<Y;st++){const Y=it+st*nt,ot=st%2==0?H:et;q.lineTo(ot*Math.cos(Y),ot*Math.sin(Y))}q.closePath()}}drawHitDetectionCanvas_(q,Y){Y.translate(q.size/2,q.size/2),this.createPath_(Y),Y.fillStyle=lt.bL,Y.fill(),this.stroke_&&(Y.strokeStyle=q.strokeStyle,Y.lineWidth=q.strokeWidth,q.lineDash&&(Y.setLineDash(q.lineDash),Y.lineDashOffset=q.lineDashOffset),Y.lineJoin=q.lineJoin,Y.miterLimit=q.miterLimit,Y.stroke())}}const _t=mt},8958:(q,Y,H)=>{"use strict";H.r(Y),H.d(Y,{default:()=>it});class et{constructor(q){q=q||{},this.color_=void 0!==q.color?q.color:null,this.lineCap_=q.lineCap,this.lineDash_=void 0!==q.lineDash?q.lineDash:null,this.lineDashOffset_=q.lineDashOffset,this.lineJoin_=q.lineJoin,this.miterLimit_=q.miterLimit,this.width_=q.width}clone(){const q=this.getColor();return new et({color:Array.isArray(q)?q.slice():q||void 0,lineCap:this.getLineCap(),lineDash:this.getLineDash()?this.getLineDash().slice():void 0,lineDashOffset:this.getLineDashOffset(),lineJoin:this.getLineJoin(),miterLimit:this.getMiterLimit(),width:this.getWidth()})}getColor(){return this.color_}getLineCap(){return this.lineCap_}getLineDash(){return this.lineDash_}getLineDashOffset(){return this.lineDashOffset_}getLineJoin(){return this.lineJoin_}getMiterLimit(){return this.miterLimit_}getWidth(){return this.width_}setColor(q){this.color_=q}setLineCap(q){this.lineCap_=q}setLineDash(q){this.lineDash_=q}setLineDashOffset(q){this.lineDashOffset_=q}setLineJoin(q){this.lineJoin_=q}setMiterLimit(q){this.miterLimit_=q}setWidth(q){this.width_=q}}const it=et},7539:(q,Y,H)=>{"use strict";H.r(Y),H.d(Y,{createDefaultStyle:()=>u,createEditingStyle:()=>c,default:()=>mt,toFunction:()=>h});var et=H(283),it=H(1345),nt=H(8958),st=H(9515);class ot{constructor(q){q=q||{},this.geometry_=null,this.geometryFunction_=d,void 0!==q.geometry&&this.setGeometry(q.geometry),this.fill_=void 0!==q.fill?q.fill:null,this.image_=void 0!==q.image?q.image:null,this.renderer_=void 0!==q.renderer?q.renderer:null,this.hitDetectionRenderer_=void 0!==q.hitDetectionRenderer?q.hitDetectionRenderer:null,this.stroke_=void 0!==q.stroke?q.stroke:null,this.text_=void 0!==q.text?q.text:null,this.zIndex_=q.zIndex}clone(){let q=this.getGeometry();return q&&"object"==typeof q&&(q=q.clone()),new ot({geometry:q,fill:this.getFill()?this.getFill().clone():void 0,image:this.getImage()?this.getImage().clone():void 0,renderer:this.getRenderer(),stroke:this.getStroke()?this.getStroke().clone():void 0,text:this.getText()?this.getText().clone():void 0,zIndex:this.getZIndex()})}getRenderer(){return this.renderer_}setRenderer(q){this.renderer_=q}setHitDetectionRenderer(q){this.hitDetectionRenderer_=q}getHitDetectionRenderer(){return this.hitDetectionRenderer_}getGeometry(){return this.geometry_}getGeometryFunction(){return this.geometryFunction_}getFill(){return this.fill_}setFill(q){this.fill_=q}getImage(){return this.image_}setImage(q){this.image_=q}getStroke(){return this.stroke_}setStroke(q){this.stroke_=q}getText(){return this.text_}setText(q){this.text_=q}getZIndex(){return this.zIndex_}setGeometry(q){"function"==typeof q?this.geometryFunction_=q:"string"==typeof q?this.geometryFunction_=function(Y){return Y.get(q)}:q?void 0!==q&&(this.geometryFunction_=function(){return q}):this.geometryFunction_=d,this.geometry_=q}setZIndex(q){this.zIndex_=q}}function h(q){let Y;if("function"==typeof q)Y=q;else{let H;Array.isArray(q)?H=q:((0,st.h)("function"==typeof q.getZIndex,41),H=[q]),Y=function(){return H}}return Y}let lt=null;function u(q,Y){if(!lt){const q=new it.default({color:"rgba(255,255,255,0.4)"}),Y=new nt.default({color:"#3399CC",width:1.25});lt=[new ot({image:new et.default({fill:q,stroke:Y,radius:5}),fill:q,stroke:Y})]}return lt}function c(){const q={},Y=[255,255,255,1],H=[0,153,255,1];return q.Polygon=[new ot({fill:new it.default({color:[255,255,255,.5]})})],q.MultiPolygon=q.Polygon,q.LineString=[new ot({stroke:new nt.default({color:Y,width:5})}),new ot({stroke:new nt.default({color:H,width:3})})],q.MultiLineString=q.LineString,q.Circle=q.Polygon.concat(q.LineString),q.Point=[new ot({image:new et.default({radius:6,fill:new it.default({color:H}),stroke:new nt.default({color:Y,width:1.5})}),zIndex:1/0})],q.MultiPoint=q.Point,q.GeometryCollection=q.Polygon.concat(q.LineString,q.Point),q}function d(q){return q.getGeometry()}const mt=ot},1280:(q,Y,H)=>{"use strict";H.r(Y),H.d(Y,{default:()=>st});var et=H(1345),it=H(4307);class nt{constructor(q){q=q||{},this.font_=q.font,this.rotation_=q.rotation,this.rotateWithView_=q.rotateWithView,this.scale_=q.scale,this.scaleArray_=(0,it.Pq)(void 0!==q.scale?q.scale:1),this.text_=q.text,this.textAlign_=q.textAlign,this.justify_=q.justify,this.textBaseline_=q.textBaseline,this.fill_=void 0!==q.fill?q.fill:new et.default({color:"#333"}),this.maxAngle_=void 0!==q.maxAngle?q.maxAngle:Math.PI/4,this.placement_=void 0!==q.placement?q.placement:"point",this.overflow_=!!q.overflow,this.stroke_=void 0!==q.stroke?q.stroke:null,this.offsetX_=void 0!==q.offsetX?q.offsetX:0,this.offsetY_=void 0!==q.offsetY?q.offsetY:0,this.backgroundFill_=q.backgroundFill?q.backgroundFill:null,this.backgroundStroke_=q.backgroundStroke?q.backgroundStroke:null,this.padding_=void 0===q.padding?null:q.padding}clone(){const q=this.getScale();return new nt({font:this.getFont(),placement:this.getPlacement(),maxAngle:this.getMaxAngle(),overflow:this.getOverflow(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(q)?q.slice():q,text:this.getText(),textAlign:this.getTextAlign(),justify:this.getJustify(),textBaseline:this.getTextBaseline(),fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,offsetX:this.getOffsetX(),offsetY:this.getOffsetY(),backgroundFill:this.getBackgroundFill()?this.getBackgroundFill().clone():void 0,backgroundStroke:this.getBackgroundStroke()?this.getBackgroundStroke().clone():void 0,padding:this.getPadding()||void 0})}getOverflow(){return this.overflow_}getFont(){return this.font_}getMaxAngle(){return this.maxAngle_}getPlacement(){return this.placement_}getOffsetX(){return this.offsetX_}getOffsetY(){return this.offsetY_}getFill(){return this.fill_}getRotateWithView(){return this.rotateWithView_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getStroke(){return this.stroke_}getText(){return this.text_}getTextAlign(){return this.textAlign_}getJustify(){return this.justify_}getTextBaseline(){return this.textBaseline_}getBackgroundFill(){return this.backgroundFill_}getBackgroundStroke(){return this.backgroundStroke_}getPadding(){return this.padding_}setOverflow(q){this.overflow_=q}setFont(q){this.font_=q}setMaxAngle(q){this.maxAngle_=q}setOffsetX(q){this.offsetX_=q}setOffsetY(q){this.offsetY_=q}setPlacement(q){this.placement_=q}setRotateWithView(q){this.rotateWithView_=q}setFill(q){this.fill_=q}setRotation(q){this.rotation_=q}setScale(q){this.scale_=q,this.scaleArray_=(0,it.Pq)(void 0!==q?q:1)}setStroke(q){this.stroke_=q}setText(q){this.text_=q}setTextAlign(q){this.textAlign_=q}setJustify(q){this.justify_=q}setTextBaseline(q){this.textBaseline_=q}setBackgroundFill(q){this.backgroundFill_=q}setBackgroundStroke(q){this.backgroundStroke_=q}setPadding(q){this.padding_=q}}const st=nt},6101:(q,Y,H)=>{"use strict";H.d(Y,{BB:()=>m,Jp:()=>a,Ue:()=>o,bA:()=>c,lk:()=>l,n3:()=>d,nb:()=>g,nn:()=>u,qC:()=>f});var et=H(177),it=H(9515);const nt=new Array(6);function o(){return[1,0,0,1,0,0]}function a(q,Y){const H=q[0],et=q[1],it=q[2],nt=q[3],st=q[4],ot=q[5],lt=Y[0],mt=Y[1],_t=Y[2],vt=Y[3],bt=Y[4],Mt=Y[5];return q[0]=H*lt+it*mt,q[1]=et*lt+nt*mt,q[2]=H*_t+it*vt,q[3]=et*_t+nt*vt,q[4]=H*bt+it*Mt+st,q[5]=et*bt+nt*Mt+ot,q}function h(q,Y,H,et,it,nt,st){return q[0]=Y,q[1]=H,q[2]=et,q[3]=it,q[4]=nt,q[5]=st,q}function l(q,Y){return q[0]=Y[0],q[1]=Y[1],q[2]=Y[2],q[3]=Y[3],q[4]=Y[4],q[5]=Y[5],q}function u(q,Y){const H=Y[0],et=Y[1];return Y[0]=q[0]*H+q[2]*et+q[4],Y[1]=q[1]*H+q[3]*et+q[5],Y}function c(q,Y,H){return a(q,h(nt,Y,0,0,H,0,0))}function d(q,Y,H){return h(q,Y,0,0,H,0,0)}function f(q,Y,H,et,it,nt,st,ot){const lt=Math.sin(nt),mt=Math.cos(nt);return q[0]=et*mt,q[1]=it*lt,q[2]=-et*lt,q[3]=it*mt,q[4]=st*et*mt-ot*et*lt+Y,q[5]=st*it*lt+ot*it*mt+H,q}function g(q,Y){const H=(et=Y)[0]*et[3]-et[1]*et[2];var et;(0,it.h)(0!==H,32);const nt=Y[0],st=Y[1],ot=Y[2],lt=Y[3],mt=Y[4],_t=Y[5];return q[0]=lt/H,q[1]=-st/H,q[2]=-ot/H,q[3]=nt/H,q[4]=(ot*_t-lt*mt)/H,q[5]=-(nt*_t-st*mt)/H,q}let st;function m(q){const Y="matrix("+q.join(", ")+")";if(et.Id)return Y;const H=st||(st=document.createElement("div"));return H.style.transform=Y,H.style.transform}},4187:(q,Y,H)=>{"use strict";function n(){throw new Error("Unimplemented abstract method.")}H.d(Y,{O3:()=>n,sq:()=>s});let et=0;function s(q){return q.ol_uid||(q.ol_uid=String(++et))}}},Y={};function i(H){var et=Y[H];if(void 0!==et)return et.exports;var it=Y[H]={exports:{}};return q[H].call(it.exports,it,it.exports,i),it.exports}i.n=q=>{var Y=q&&q.__esModule?()=>q.default:()=>q;return i.d(Y,{a:Y}),Y},i.d=(q,Y)=>{for(var H in Y)i.o(Y,H)&&!i.o(q,H)&&Object.defineProperty(q,H,{enumerable:!0,get:Y[H]})},i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(q){if("object"==typeof window)return window}}(),i.o=(q,Y)=>Object.prototype.hasOwnProperty.call(q,Y),i.r=q=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(q,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(q,"__esModule",{value:!0})},(()=>{"use strict";function t(q,Y){if(!(q instanceof Y))throw new TypeError("Cannot call a class as a function")}function e(q){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(q){return typeof q}:function(q){return q&&"function"==typeof Symbol&&q.constructor===Symbol&&q!==Symbol.prototype?"symbol":typeof q},e(q)}function n(q){var Y=function(q,Y){if("object"!==e(q)||null===q)return q;var H=q[Symbol.toPrimitive];if(void 0!==H){var et=H.call(q,"string");if("object"!==e(et))return et;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(q)}(q);return"symbol"===e(Y)?Y:String(Y)}function r(q,Y){for(var H=0;H<Y.length;H++){var et=Y[H];et.enumerable=et.enumerable||!1,et.configurable=!0,"value"in et&&(et.writable=!0),Object.defineProperty(q,n(et.key),et)}}function s(q,Y,H){return Y&&r(q.prototype,Y),H&&r(q,H),Object.defineProperty(q,"prototype",{writable:!1}),q}function o(q,Y){return o=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(q,Y){return q.__proto__=Y,q},o(q,Y)}function a(q,Y){if(Y&&("object"===e(Y)||"function"==typeof Y))return Y;if(void 0!==Y)throw new TypeError("Derived constructors may only return object or undefined");return function(q){if(void 0===q)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return q}(q)}function h(q){return h=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(q){return q.__proto__||Object.getPrototypeOf(q)},h(q)}function l(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(q){return!1}}function u(q,Y,H){return u=l()?Reflect.construct.bind():function(q,Y,H){var et=[null];et.push.apply(et,Y);var it=new(Function.bind.apply(q,et));return H&&o(it,H.prototype),it},u.apply(null,arguments)}function c(q){var Y="function"==typeof Map?new Map:void 0;return c=function(q){if(null===q||(H=q,-1===Function.toString.call(H).indexOf("[native code]")))return q;var H;if("function"!=typeof q)throw new TypeError("Super expression must either be null or a function");if(void 0!==Y){if(Y.has(q))return Y.get(q);Y.set(q,n)}function n(){return u(q,arguments,h(this).constructor)}return n.prototype=Object.create(q.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),o(n,q)},c(q)}var q=function(q){!function(q,Y){if("function"!=typeof Y&&null!==Y)throw new TypeError("Super expression must either be null or a function");q.prototype=Object.create(Y&&Y.prototype,{constructor:{value:q,writable:!0,configurable:!0}}),Object.defineProperty(q,"prototype",{writable:!1}),Y&&o(q,Y)}(l,q);var Y,H,et=(Y=l,H=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(q){return!1}}(),function(){var q,et=h(Y);if(H){var it=h(this).constructor;q=Reflect.construct(et,arguments,it)}else q=et.apply(this,arguments);return a(this,q)});function l(){var q;return t(this,l),(q=et.call(this,1,1)).src_=null,q.hintImageSize(1,1),q.loadPromiseResolver=null,q.loadPromiseRejecter=null,q.loadPromise=new Promise((function(Y,H){q.loadPromiseResolver=Y,q.loadPromiseRejecter=H})),q}return s(l,[{key:"hintImageSize",value:function(q,Y){this.width=q,this.height=Y,this.naturalWidth=q,this.naturalHeight=Y}},{key:"src",get:function(){return this.src_},set:function(q){var Y=this;fetch(q).then((function(q){return q.blob()})).then((function(q){return createImageBitmap(q)})).then((function(q){return Y.getContext("2d").drawImage(q,0,0),Y.loadPromiseResolver()})).catch(this.loadPromiseRejecter)}},{key:"addEventListener",value:function(q,Y){"load"===q?this.loadPromise.then(Y).catch((function(){})):"error"===q&&this.loadPromise.catch(Y)}},{key:"removeEventListener",value:function(){}}]),l}(c(OffscreenCanvas));self.Image=q;var Y=function(){function e(){t(this,e)}return s(e,[{key:"createElement",value:function(q){if("canvas"===q)return new OffscreenCanvas(1,1)}}]),e}();function g(q,Y,H){return(Y=n(Y))in q?Object.defineProperty(q,Y,{value:H,enumerable:!0,configurable:!0,writable:!0}):q[Y]=H,q}self.document=new Y;var p=function(q,Y){return p=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(q,Y){q.__proto__=Y}||function(q,Y){for(var H in Y)Y.hasOwnProperty(H)&&(q[H]=Y[H])},p(q,Y)};function m(q,Y){function i(){this.constructor=q}p(q,Y),q.prototype=null===Y?Object.create(Y):(i.prototype=Y.prototype,new i)}function y(q){return"function"==typeof q}var H=!1,et={Promise:void 0,set useDeprecatedSynchronousErrorHandling(q){q&&(new Error).stack,H=q},get useDeprecatedSynchronousErrorHandling(){return H}};function x(q){setTimeout((function(){throw q}),0)}var it={closed:!0,next:function(q){},error:function(q){if(et.useDeprecatedSynchronousErrorHandling)throw q;x(q)},complete:function(){}},nt=Array.isArray||function(q){return q&&"number"==typeof q.length};function M(q){return null!==q&&"object"==typeof q}var st=function(){function t(q){return Error.call(this),this.message=q?q.length+" errors occurred during unsubscription:\n"+q.map((function(q,Y){return Y+1+") "+q.toString()})).join("\n  "):"",this.name="UnsubscriptionError",this.errors=q,this}return t.prototype=Object.create(Error.prototype),t}(),ot=function(){function t(q){this.closed=!1,this._parentOrParents=null,this._subscriptions=null,q&&(this._ctorUnsubscribe=!0,this._unsubscribe=q)}return t.prototype.unsubscribe=function(){var q;if(!this.closed){var Y=this,H=Y._parentOrParents,et=Y._ctorUnsubscribe,it=Y._unsubscribe,ot=Y._subscriptions;if(this.closed=!0,this._parentOrParents=null,this._subscriptions=null,H instanceof t)H.remove(this);else if(null!==H)for(var lt=0;lt<H.length;++lt)H[lt].remove(this);if(y(it)){et&&(this._unsubscribe=void 0);try{it.call(this)}catch(Y){q=Y instanceof st?E(Y.errors):[Y]}}if(nt(ot)){lt=-1;for(var mt=ot.length;++lt<mt;){var _t=ot[lt];if(M(_t))try{_t.unsubscribe()}catch(Y){q=q||[],Y instanceof st?q=q.concat(E(Y.errors)):q.push(Y)}}}if(q)throw new st(q)}},t.prototype.add=function(q){var Y=q;if(!q)return t.EMPTY;switch(typeof q){case"function":Y=new t(q);case"object":if(Y===this||Y.closed||"function"!=typeof Y.unsubscribe)return Y;if(this.closed)return Y.unsubscribe(),Y;if(!(Y instanceof t)){var H=Y;(Y=new t)._subscriptions=[H]}break;default:throw new Error("unrecognized teardown "+q+" added to Subscription.")}var et=Y._parentOrParents;if(null===et)Y._parentOrParents=this;else if(et instanceof t){if(et===this)return Y;Y._parentOrParents=[et,this]}else{if(-1!==et.indexOf(this))return Y;et.push(this)}var it=this._subscriptions;return null===it?this._subscriptions=[Y]:it.push(Y),Y},t.prototype.remove=function(q){var Y=this._subscriptions;if(Y){var H=Y.indexOf(q);-1!==H&&Y.splice(H,1)}},t.EMPTY=function(q){return q.closed=!0,q}(new t),t}();function E(q){return q.reduce((function(q,Y){return q.concat(Y instanceof st?Y.errors:Y)}),[])}var lt="function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random(),mt=function(q){function e(Y,H,et){var nt=q.call(this)||this;switch(nt.syncErrorValue=null,nt.syncErrorThrown=!1,nt.syncErrorThrowable=!1,nt.isStopped=!1,arguments.length){case 0:nt.destination=it;break;case 1:if(!Y){nt.destination=it;break}if("object"==typeof Y){Y instanceof e?(nt.syncErrorThrowable=Y.syncErrorThrowable,nt.destination=Y,Y.add(nt)):(nt.syncErrorThrowable=!0,nt.destination=new _t(nt,Y));break}default:nt.syncErrorThrowable=!0,nt.destination=new _t(nt,Y,H,et)}return nt}return m(e,q),e.prototype[lt]=function(){return this},e.create=function(q,Y,H){var et=new e(q,Y,H);return et.syncErrorThrowable=!1,et},e.prototype.next=function(q){this.isStopped||this._next(q)},e.prototype.error=function(q){this.isStopped||(this.isStopped=!0,this._error(q))},e.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},e.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,q.prototype.unsubscribe.call(this))},e.prototype._next=function(q){this.destination.next(q)},e.prototype._error=function(q){this.destination.error(q),this.unsubscribe()},e.prototype._complete=function(){this.destination.complete(),this.unsubscribe()},e.prototype._unsubscribeAndRecycle=function(){var q=this._parentOrParents;return this._parentOrParents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parentOrParents=q,this},e}(ot),_t=function(q){function e(Y,H,et,nt){var st,ot=q.call(this)||this;ot._parentSubscriber=Y;var lt=ot;return y(H)?st=H:H&&(st=H.next,et=H.error,nt=H.complete,H!==it&&(y((lt=Object.create(H)).unsubscribe)&&ot.add(lt.unsubscribe.bind(lt)),lt.unsubscribe=ot.unsubscribe.bind(ot))),ot._context=lt,ot._next=st,ot._error=et,ot._complete=nt,ot}return m(e,q),e.prototype.next=function(q){if(!this.isStopped&&this._next){var Y=this._parentSubscriber;et.useDeprecatedSynchronousErrorHandling&&Y.syncErrorThrowable?this.__tryOrSetError(Y,this._next,q)&&this.unsubscribe():this.__tryOrUnsub(this._next,q)}},e.prototype.error=function(q){if(!this.isStopped){var Y=this._parentSubscriber,H=et.useDeprecatedSynchronousErrorHandling;if(this._error)H&&Y.syncErrorThrowable?(this.__tryOrSetError(Y,this._error,q),this.unsubscribe()):(this.__tryOrUnsub(this._error,q),this.unsubscribe());else if(Y.syncErrorThrowable)H?(Y.syncErrorValue=q,Y.syncErrorThrown=!0):x(q),this.unsubscribe();else{if(this.unsubscribe(),H)throw q;x(q)}}},e.prototype.complete=function(){var q=this;if(!this.isStopped){var Y=this._parentSubscriber;if(this._complete){var i=function(){return q._complete.call(q._context)};et.useDeprecatedSynchronousErrorHandling&&Y.syncErrorThrowable?(this.__tryOrSetError(Y,i),this.unsubscribe()):(this.__tryOrUnsub(i),this.unsubscribe())}else this.unsubscribe()}},e.prototype.__tryOrUnsub=function(q,Y){try{q.call(this._context,Y)}catch(q){if(this.unsubscribe(),et.useDeprecatedSynchronousErrorHandling)throw q;x(q)}},e.prototype.__tryOrSetError=function(q,Y,H){if(!et.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{Y.call(this._context,H)}catch(Y){return et.useDeprecatedSynchronousErrorHandling?(q.syncErrorValue=Y,q.syncErrorThrown=!0,!0):(x(Y),!0)}return!1},e.prototype._unsubscribe=function(){var q=this._parentSubscriber;this._context=null,this._parentSubscriber=null,q.unsubscribe()},e}(mt),vt="function"==typeof Symbol&&Symbol.observable||"@@observable";function T(q){return q}function F(q){return 0===q.length?T:1===q.length?q[0]:function(Y){return q.reduce((function(q,Y){return Y(q)}),Y)}}var bt=function(){function t(q){this._isScalar=!1,q&&(this._subscribe=q)}return t.prototype.lift=function(q){var Y=new t;return Y.source=this,Y.operator=q,Y},t.prototype.subscribe=function(q,Y,H){var nt=this.operator,st=function(q,Y,H){if(q){if(q instanceof mt)return q;if(q[lt])return q[lt]()}return q||Y||H?new mt(q,Y,H):new mt(it)}(q,Y,H);if(nt?st.add(nt.call(st,this.source)):st.add(this.source||et.useDeprecatedSynchronousErrorHandling&&!st.syncErrorThrowable?this._subscribe(st):this._trySubscribe(st)),et.useDeprecatedSynchronousErrorHandling&&st.syncErrorThrowable&&(st.syncErrorThrowable=!1,st.syncErrorThrown))throw st.syncErrorValue;return st},t.prototype._trySubscribe=function(q){try{return this._subscribe(q)}catch(Y){et.useDeprecatedSynchronousErrorHandling&&(q.syncErrorThrown=!0,q.syncErrorValue=Y),function(q){for(;q;){var Y=q,H=Y.closed,et=Y.destination,it=Y.isStopped;if(H||it)return!1;q=et&&et instanceof mt?et:null}return!0}(q)?q.error(Y):console.warn(Y)}},t.prototype.forEach=function(q,Y){var H=this;return new(Y=L(Y))((function(Y,et){var it;it=H.subscribe((function(Y){try{q(Y)}catch(q){et(q),it&&it.unsubscribe()}}),et,Y)}))},t.prototype._subscribe=function(q){var Y=this.source;return Y&&Y.subscribe(q)},t.prototype[vt]=function(){return this},t.prototype.pipe=function(){for(var q=[],Y=0;Y<arguments.length;Y++)q[Y]=arguments[Y];return 0===q.length?this:F(q)(this)},t.prototype.toPromise=function(q){var Y=this;return new(q=L(q))((function(q,H){var et;Y.subscribe((function(q){return et=q}),(function(q){return H(q)}),(function(){return q(et)}))}))},t.create=function(q){return new t(q)},t}();function L(q){if(q||(q=et.Promise||Promise),!q)throw new Error("no Promise impl found");return q}function N(q,Y){return function(H){if("function"!=typeof q)throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return H.lift(new Mt(q,Y))}}var Mt=function(){function t(q,Y){this.project=q,this.thisArg=Y}return t.prototype.call=function(q,Y){return Y.subscribe(new Et(q,this.project,this.thisArg))},t}(),Et=function(q){function e(Y,H,et){var it=q.call(this,Y)||this;return it.project=H,it.count=0,it.thisArg=et||it,it}return m(e,q),e.prototype._next=function(q){var Y;try{Y=this.project.call(this.thisArg,q,this.count++)}catch(q){return void this.destination.error(q)}this.destination.next(Y)},e}(mt);function j(q,Y,H,et){return y(H)&&(et=H,H=void 0),et?j(q,Y,H).pipe(N((function(q){return nt(q)?et.apply(void 0,q):et(q)}))):new bt((function(et){D(q,Y,(function(q){arguments.length>1?et.next(Array.prototype.slice.call(arguments)):et.next(q)}),et,H)}))}function D(q,Y,H,et,it){var nt;if(function(q){return q&&"function"==typeof q.addEventListener&&"function"==typeof q.removeEventListener}(q)){var st=q;q.addEventListener(Y,H,it),nt=function(){return st.removeEventListener(Y,H,it)}}else if(function(q){return q&&"function"==typeof q.on&&"function"==typeof q.off}(q)){var ot=q;q.on(Y,H),nt=function(){return ot.off(Y,H)}}else if(function(q){return q&&"function"==typeof q.addListener&&"function"==typeof q.removeListener}(q)){var lt=q;q.addListener(Y,H),nt=function(){return lt.removeListener(Y,H)}}else{if(!q||!q.length)throw new TypeError("Invalid event target");for(var mt=0,_t=q.length;mt<_t;mt++)D(q[mt],Y,H,et,it)}et.add(nt)}function z(){for(var q=[],Y=0;Y<arguments.length;Y++)q[Y]=arguments[Y];var H=q.length;if(0===H)throw new Error("list of properties cannot be empty.");return function(Y){return N(U(q,H))(Y)}}function U(q,Y){return function(H){for(var et=H,it=0;it<Y;it++){var nt=null!=et?et[q[it]]:void 0;if(void 0===nt)return;et=nt}return et}}function B(){}function W(q,Y,H){return function(et){return et.lift(new Rt(q,Y,H))}}var Rt=function(){function t(q,Y,H){this.nextOrObserver=q,this.error=Y,this.complete=H}return t.prototype.call=function(q,Y){return Y.subscribe(new It(q,this.nextOrObserver,this.error,this.complete))},t}(),It=function(q){function e(Y,H,et,it){var nt=q.call(this,Y)||this;return nt._tapNext=B,nt._tapError=B,nt._tapComplete=B,nt._tapError=et||B,nt._tapComplete=it||B,y(H)?(nt._context=nt,nt._tapNext=H):H&&(nt._context=H,nt._tapNext=H.next||B,nt._tapError=H.error||B,nt._tapComplete=H.complete||B),nt}return m(e,q),e.prototype._next=function(q){try{this._tapNext.call(this._context,q)}catch(q){return void this.destination.error(q)}this.destination.next(q)},e.prototype._error=function(q){try{this._tapError.call(this._context,q)}catch(q){return void this.destination.error(q)}this.destination.error(q)},e.prototype._complete=function(){try{this._tapComplete.call(this._context)}catch(q){return void this.destination.error(q)}return this.destination.complete()},e}(mt);function Z(){return"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope}function X(q,Y){var H=Object.keys(q);if(Object.getOwnPropertySymbols){var et=Object.getOwnPropertySymbols(q);Y&&(et=et.filter((function(Y){return Object.getOwnPropertyDescriptor(q,Y).enumerable}))),H.push.apply(H,et)}return H}function V(q){for(var Y=1;Y<arguments.length;Y++){var H=null!=arguments[Y]?arguments[Y]:{};Y%2?X(Object(H),!0).forEach((function(Y){g(q,Y,H[Y])})):Object.getOwnPropertyDescriptors?Object.defineProperties(q,Object.getOwnPropertyDescriptors(H)):X(Object(H)).forEach((function(Y){Object.defineProperty(q,Y,Object.getOwnPropertyDescriptor(H,Y))}))}return q}function K(q,Y){Z()?self.clients.matchAll({type:"window"}).then((function(H){H.forEach((function(H){H.postMessage(V(V({},Y),{},{type:q}))}))})):window.dispatchEvent(new CustomEvent("inkmap.toMain",{detail:V(V({},Y),{},{type:q})}))}var Pt=(Z()?j(self,"message").pipe(z("data")):j(window,"inkmap.toPrinter").pipe(z("detail"))).pipe(W((function(q){return console.log("[inkmap] message to printer:",q)})));function J(q,Y){(null==Y||Y>q.length)&&(Y=q.length);for(var H=0,et=new Array(Y);H<Y;H++)et[H]=q[H];return et}function Q(q,Y){return function(q){if(Array.isArray(q))return q}(q)||function(q,Y){var H=null==q?null:"undefined"!=typeof Symbol&&q[Symbol.iterator]||q["@@iterator"];if(null!=H){var et,it,nt,st,ot=[],lt=!0,mt=!1;try{if(nt=(H=H.call(q)).next,0===Y){if(Object(H)!==H)return;lt=!1}else for(;!(lt=(et=nt.call(H)).done)&&(ot.push(et.value),ot.length!==Y);lt=!0);}catch(q){mt=!0,it=q}finally{try{if(!lt&&null!=H.return&&(st=H.return(),Object(st)!==st))return}finally{if(mt)throw it}}return ot}}(q,Y)||function(q,Y){if(q){if("string"==typeof q)return J(q,Y);var H=Object.prototype.toString.call(q).slice(8,-1);return"Object"===H&&q.constructor&&(H=q.constructor.name),"Map"===H||"Set"===H?Array.from(q):"Arguments"===H||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(H)?J(q,Y):void 0}}(q,Y)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function $(q,Y,H,et,it,nt,st){try{var ot=q[nt](st),lt=ot.value}catch(q){return void H(q)}ot.done?Y(lt):Promise.resolve(lt).then(et,it)}function tt(q){return function(){var Y=this,H=arguments;return new Promise((function(et,it){var nt=q.apply(Y,H);function o(q){$(nt,et,it,o,a,"next",q)}function a(q){$(nt,et,it,o,a,"throw",q)}o(void 0)}))}}var Tt=i(4687),Ft=i.n(Tt),At=i(8326);function rt(q){return q&&"function"==typeof q.schedule}var Lt=function(q){function e(){return null!==q&&q.apply(this,arguments)||this}return m(e,q),e.prototype.notifyNext=function(q,Y,H,et,it){this.destination.next(Y)},e.prototype.notifyError=function(q,Y){this.destination.error(q)},e.prototype.notifyComplete=function(q){this.destination.complete()},e}(mt),Nt=function(q){function e(Y,H,et){var it=q.call(this)||this;return it.parent=Y,it.outerValue=H,it.outerIndex=et,it.index=0,it}return m(e,q),e.prototype._next=function(q){this.parent.notifyNext(this.outerValue,q,this.outerIndex,this.index++,this)},e.prototype._error=function(q){this.parent.notifyError(q,this),this.unsubscribe()},e.prototype._complete=function(){this.parent.notifyComplete(this),this.unsubscribe()},e}(mt),at=function(q){return function(Y){for(var H=0,et=q.length;H<et&&!Y.closed;H++)Y.next(q[H]);Y.complete()}};var kt=function ht(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}(),ut=function(q){return q&&"number"==typeof q.length&&"function"!=typeof q};function ct(q){return!!q&&"function"!=typeof q.subscribe&&"function"==typeof q.then}var dt=function(q){if(q&&"function"==typeof q[vt])return function(q){return function(Y){var H=q[vt]();if("function"!=typeof H.subscribe)throw new TypeError("Provided object does not correctly implement Symbol.observable");return H.subscribe(Y)}}(q);if(ut(q))return at(q);if(ct(q))return H=q,function(q){return H.then((function(Y){q.closed||(q.next(Y),q.complete())}),(function(Y){return q.error(Y)})).then(null,x),q};if(q&&"function"==typeof q[kt])return Y=q,function(q){for(var H=Y[kt]();;){var et=void 0;try{et=H.next()}catch(Y){return q.error(Y),q}if(et.done){q.complete();break}if(q.next(et.value),q.closed)break}return"function"==typeof H.return&&q.add((function(){H.return&&H.return()})),q};var Y,H,et=M(q)?"an invalid object":"'"+q+"'";throw new TypeError("You provided "+et+" where a stream was expected. You can provide an Observable, Promise, Array, or Iterable.")};function ft(q,Y,H,et,it){if(void 0===it&&(it=new Nt(q,H,et)),!it.closed)return Y instanceof bt?Y.subscribe(it):dt(Y)(it)}function gt(q,Y){return new bt((function(H){var et=new ot,it=0;return et.add(Y.schedule((function(){it!==q.length?(H.next(q[it++]),H.closed||et.add(this.schedule())):H.complete()}))),et}))}function pt(q,Y){return Y?gt(q,Y):new bt(at(q))}var Gt={};function yt(){for(var q=[],Y=0;Y<arguments.length;Y++)q[Y]=arguments[Y];var H=void 0,et=void 0;return rt(q[q.length-1])&&(et=q.pop()),"function"==typeof q[q.length-1]&&(H=q.pop()),1===q.length&&nt(q[0])&&(q=q[0]),pt(q,et).lift(new jt(H))}var jt=function(){function t(q){this.resultSelector=q}return t.prototype.call=function(q,Y){return Y.subscribe(new Dt(q,this.resultSelector))},t}(),Dt=function(q){function e(Y,H){var et=q.call(this,Y)||this;return et.resultSelector=H,et.active=0,et.values=[],et.observables=[],et}return m(e,q),e.prototype._next=function(q){this.values.push(Gt),this.observables.push(q)},e.prototype._complete=function(){var q=this.observables,Y=q.length;if(0===Y)this.destination.complete();else{this.active=Y,this.toRespond=Y;for(var H=0;H<Y;H++){var et=q[H];this.add(ft(this,et,void 0,H))}}},e.prototype.notifyComplete=function(q){0==(this.active-=1)&&this.destination.complete()},e.prototype.notifyNext=function(q,Y,H){var et=this.values,it=et[H],nt=this.toRespond?it===Gt?--this.toRespond:this.toRespond:0;et[H]=Y,0===nt&&(this.resultSelector?this._tryResultSelector(et):this.destination.next(et.slice()))},e.prototype._tryResultSelector=function(q){var Y;try{Y=this.resultSelector.apply(this,q)}catch(q){return void this.destination.error(q)}this.destination.next(Y)},e}(Lt);function xt(){for(var q=[],Y=0;Y<arguments.length;Y++)q[Y]=arguments[Y];var H=q[q.length-1];return rt(H)?(q.pop(),gt(q,H)):pt(q)}function St(q,Y){return Y?function(q,Y){if(null!=q){if(function(q){return q&&"function"==typeof q[vt]}(q))return function(q,Y){return new bt((function(H){var et=new ot;return et.add(Y.schedule((function(){var it=q[vt]();et.add(it.subscribe({next:function(q){et.add(Y.schedule((function(){return H.next(q)})))},error:function(q){et.add(Y.schedule((function(){return H.error(q)})))},complete:function(){et.add(Y.schedule((function(){return H.complete()})))}}))}))),et}))}(q,Y);if(ct(q))return function(q,Y){return new bt((function(H){var et=new ot;return et.add(Y.schedule((function(){return q.then((function(q){et.add(Y.schedule((function(){H.next(q),et.add(Y.schedule((function(){return H.complete()})))})))}),(function(q){et.add(Y.schedule((function(){return H.error(q)})))}))}))),et}))}(q,Y);if(ut(q))return gt(q,Y);if(function(q){return q&&"function"==typeof q[kt]}(q)||"string"==typeof q)return function(q,Y){if(!q)throw new Error("Iterable cannot be null");return new bt((function(H){var et,it=new ot;return it.add((function(){et&&"function"==typeof et.return&&et.return()})),it.add(Y.schedule((function(){et=q[kt](),it.add(Y.schedule((function(){if(!H.closed){var q,Y;try{var it=et.next();q=it.value,Y=it.done}catch(q){return void H.error(q)}Y?H.complete():(H.next(q),this.schedule())}})))}))),it}))}(q,Y)}throw new TypeError((null!==q&&typeof q||q)+" is not observable")}(q,Y):q instanceof bt?q:new bt(dt(q))}var zt=function(q){function e(Y){var H=q.call(this)||this;return H.parent=Y,H}return m(e,q),e.prototype._next=function(q){this.parent.notifyNext(q)},e.prototype._error=function(q){this.parent.notifyError(q),this.unsubscribe()},e.prototype._complete=function(){this.parent.notifyComplete(),this.unsubscribe()},e}(mt),Bt=function(q){function e(){return null!==q&&q.apply(this,arguments)||this}return m(e,q),e.prototype.notifyNext=function(q){this.destination.next(q)},e.prototype.notifyError=function(q){this.destination.error(q)},e.prototype.notifyComplete=function(){this.destination.complete()},e}(mt);function wt(q,Y){if(!Y.closed){if(q instanceof bt)return q.subscribe(Y);var H;try{H=dt(q)(Y)}catch(q){Y.error(q)}return H}}function Ct(q,Y){return"function"==typeof Y?function(H){return H.pipe(Ct((function(H,et){return St(q(H,et)).pipe(N((function(q,it){return Y(H,q,et,it)})))})))}:function(Y){return Y.lift(new Ut(q))}}var Ut=function(){function t(q){this.project=q}return t.prototype.call=function(q,Y){return Y.subscribe(new qt(q,this.project))},t}(),qt=function(q){function e(Y,H){var et=q.call(this,Y)||this;return et.project=H,et.index=0,et}return m(e,q),e.prototype._next=function(q){var Y,H=this.index++;try{Y=this.project(q,H)}catch(q){return void this.destination.error(q)}this._innerSub(Y)},e.prototype._innerSub=function(q){var Y=this.innerSubscription;Y&&Y.unsubscribe();var H=new zt(this),et=this.destination;et.add(H),this.innerSubscription=wt(q,H),this.innerSubscription!==H&&et.add(this.innerSubscription)},e.prototype._complete=function(){var Y=this.innerSubscription;Y&&!Y.closed||q.prototype._complete.call(this),this.unsubscribe()},e.prototype._unsubscribe=function(){this.innerSubscription=void 0},e.prototype.notifyComplete=function(){this.innerSubscription=void 0,this.isStopped&&q.prototype._complete.call(this)},e.prototype.notifyNext=function(q){this.destination.next(q)},e}(Bt);function Ot(q,Y){return void 0===Y&&(Y=!1),function(H){return H.lift(new Wt(q,Y))}}var Wt=function(){function t(q,Y){this.predicate=q,this.inclusive=Y}return t.prototype.call=function(q,Y){return Y.subscribe(new Yt(q,this.predicate,this.inclusive))},t}(),Yt=function(q){function e(Y,H,et){var it=q.call(this,Y)||this;return it.predicate=H,it.inclusive=et,it.index=0,it}return m(e,q),e.prototype._next=function(q){var Y,H=this.destination;try{Y=this.predicate(q,this.index++)}catch(q){return void H.error(q)}this.nextOrComplete(q,Y)},e.prototype.nextOrComplete=function(q,Y){var H=this.destination;Boolean(Y)?H.next(q):(this.inclusive&&H.next(q),H.complete())},e}(mt),Zt=2.54,Xt=i(8641),Vt=i(8532),Kt=i(9619),Ht=i(9556);let $t=null;var te=6378137,ee=.0066943799901413165,ie=484813681109536e-20,ne=Math.PI/2,ue=1e-10,ce=.017453292519943295,de=57.29577951308232,xe=Math.PI/4,Se=2*Math.PI,be=3.14159265359,we={greenwich:0,lisbon:-9.131906111111,paris:2.337229166667,bogota:-74.080916666667,madrid:-3.687938888889,rome:12.452333333333,bern:7.439583333333,jakarta:106.807719444444,ferro:-17.666666666667,brussels:4.367975,stockholm:18.058277777778,athens:23.7163375,oslo:10.722916666667};const Ce={ft:{to_meter:.3048},"us-ft":{to_meter:1200/3937}};var Ee=/[\s_\-\/\(\)]/g;function Jt(q,Y){if(q[Y])return q[Y];for(var H,et=Object.keys(q),it=Y.toLowerCase().replace(Ee,""),nt=-1;++nt<et.length;)if((H=et[nt]).toLowerCase().replace(Ee,"")===it)return q[H]}function Qt(q){var Y,H,et,it={},nt=q.split("+").map((function(q){return q.trim()})).filter((function(q){return q})).reduce((function(q,Y){var H=Y.split("=");return H.push(!0),q[H[0].toLowerCase()]=H[1],q}),{}),st={proj:"projName",datum:"datumCode",rf:function(q){it.rf=parseFloat(q)},lat_0:function(q){it.lat0=q*ce},lat_1:function(q){it.lat1=q*ce},lat_2:function(q){it.lat2=q*ce},lat_ts:function(q){it.lat_ts=q*ce},lon_0:function(q){it.long0=q*ce},lon_1:function(q){it.long1=q*ce},lon_2:function(q){it.long2=q*ce},alpha:function(q){it.alpha=parseFloat(q)*ce},gamma:function(q){it.rectified_grid_angle=parseFloat(q)},lonc:function(q){it.longc=q*ce},x_0:function(q){it.x0=parseFloat(q)},y_0:function(q){it.y0=parseFloat(q)},k_0:function(q){it.k0=parseFloat(q)},k:function(q){it.k0=parseFloat(q)},a:function(q){it.a=parseFloat(q)},b:function(q){it.b=parseFloat(q)},r_a:function(){it.R_A=!0},zone:function(q){it.zone=parseInt(q,10)},south:function(){it.utmSouth=!0},towgs84:function(q){it.datum_params=q.split(",").map((function(q){return parseFloat(q)}))},to_meter:function(q){it.to_meter=parseFloat(q)},units:function(q){it.units=q;var Y=Jt(Ce,q);Y&&(it.to_meter=Y.to_meter)},from_greenwich:function(q){it.from_greenwich=q*ce},pm:function(q){var Y=Jt(we,q);it.from_greenwich=(Y||parseFloat(q))*ce},nadgrids:function(q){"@null"===q?it.datumCode="none":it.nadgrids=q},axis:function(q){var Y="ewnsud";3===q.length&&-1!==Y.indexOf(q.substr(0,1))&&-1!==Y.indexOf(q.substr(1,1))&&-1!==Y.indexOf(q.substr(2,1))&&(it.axis=q)},approx:function(){it.approx=!0}};for(Y in nt)H=nt[Y],Y in st?"function"==typeof(et=st[Y])?et(H):it[et]=H:it[Y]=H;return"string"==typeof it.datumCode&&"WGS84"!==it.datumCode&&(it.datumCode=it.datumCode.toLowerCase()),it}var Re=/\s/,Oe=/[A-Za-z]/,ke=/[A-Za-z84_]/,Xe=/[,\]]/,Je=/[\d\.E\-\+]/;function re(q){if("string"!=typeof q)throw new Error("not a string");this.text=q.trim(),this.level=0,this.place=0,this.root=null,this.stack=[],this.currentObject=null,this.state=1}function se(q,Y,H){Array.isArray(Y)&&(H.unshift(Y),Y=null);var et=Y?{}:q,it=H.reduce((function(q,Y){return oe(Y,q),q}),et);Y&&(q[Y]=it)}function oe(q,Y){if(Array.isArray(q)){var H=q.shift();if("PARAMETER"===H&&(H=q.shift()),1===q.length)return Array.isArray(q[0])?(Y[H]={},void oe(q[0],Y[H])):void(Y[H]=q[0]);if(q.length)if("TOWGS84"!==H){if("AXIS"===H)return H in Y||(Y[H]=[]),void Y[H].push(q);var et;switch(Array.isArray(H)||(Y[H]={}),H){case"UNIT":case"PRIMEM":case"VERT_DATUM":return Y[H]={name:q[0].toLowerCase(),convert:q[1]},void(3===q.length&&oe(q[2],Y[H]));case"SPHEROID":case"ELLIPSOID":return Y[H]={name:q[0],a:q[1],rf:q[2]},void(4===q.length&&oe(q[3],Y[H]));case"PROJECTEDCRS":case"PROJCRS":case"GEOGCS":case"GEOCCS":case"PROJCS":case"LOCAL_CS":case"GEODCRS":case"GEODETICCRS":case"GEODETICDATUM":case"EDATUM":case"ENGINEERINGDATUM":case"VERT_CS":case"VERTCRS":case"VERTICALCRS":case"COMPD_CS":case"COMPOUNDCRS":case"ENGINEERINGCRS":case"ENGCRS":case"FITTED_CS":case"LOCAL_DATUM":case"DATUM":return q[0]=["name",q[0]],void se(Y,H,q);default:for(et=-1;++et<q.length;)if(!Array.isArray(q[et]))return oe(q,Y[H]);return se(Y,H,q)}}else Y[H]=q;else Y[H]=!0}else Y[q]=!0}function ae(q){return.017453292519943295*q}function he(q){var Y=new re(q).output(),H=Y.shift(),et=Y.shift();Y.unshift(["name",et]),Y.unshift(["type",H]);var it={};return oe(Y,it),function(q){if("GEOGCS"===q.type?q.projName="longlat":"LOCAL_CS"===q.type?(q.projName="identity",q.local=!0):"object"==typeof q.PROJECTION?q.projName=Object.keys(q.PROJECTION)[0]:q.projName=q.PROJECTION,q.AXIS){for(var Y="",H=0,et=q.AXIS.length;H<et;++H){var it=[q.AXIS[H][0].toLowerCase(),q.AXIS[H][1].toLowerCase()];-1!==it[0].indexOf("north")||("y"===it[0]||"lat"===it[0])&&"north"===it[1]?Y+="n":-1!==it[0].indexOf("south")||("y"===it[0]||"lat"===it[0])&&"south"===it[1]?Y+="s":-1!==it[0].indexOf("east")||("x"===it[0]||"lon"===it[0])&&"east"===it[1]?Y+="e":-1===it[0].indexOf("west")&&("x"!==it[0]&&"lon"!==it[0]||"west"!==it[1])||(Y+="w")}2===Y.length&&(Y+="u"),3===Y.length&&(q.axis=Y)}q.UNIT&&(q.units=q.UNIT.name.toLowerCase(),"metre"===q.units&&(q.units="meter"),q.UNIT.convert&&("GEOGCS"===q.type?q.DATUM&&q.DATUM.SPHEROID&&(q.to_meter=q.UNIT.convert*q.DATUM.SPHEROID.a):q.to_meter=q.UNIT.convert));var nt=q.GEOGCS;function o(Y){return Y*(q.to_meter||1)}"GEOGCS"===q.type&&(nt=q),nt&&(nt.DATUM?q.datumCode=nt.DATUM.name.toLowerCase():q.datumCode=nt.name.toLowerCase(),"d_"===q.datumCode.slice(0,2)&&(q.datumCode=q.datumCode.slice(2)),"new_zealand_geodetic_datum_1949"!==q.datumCode&&"new_zealand_1949"!==q.datumCode||(q.datumCode="nzgd49"),"wgs_1984"!==q.datumCode&&"world_geodetic_system_1984"!==q.datumCode||("Mercator_Auxiliary_Sphere"===q.PROJECTION&&(q.sphere=!0),q.datumCode="wgs84"),"_ferro"===q.datumCode.slice(-6)&&(q.datumCode=q.datumCode.slice(0,-6)),"_jakarta"===q.datumCode.slice(-8)&&(q.datumCode=q.datumCode.slice(0,-8)),~q.datumCode.indexOf("belge")&&(q.datumCode="rnb72"),nt.DATUM&&nt.DATUM.SPHEROID&&(q.ellps=nt.DATUM.SPHEROID.name.replace("_19","").replace(/[Cc]larke\_18/,"clrk"),"international"===q.ellps.toLowerCase().slice(0,13)&&(q.ellps="intl"),q.a=nt.DATUM.SPHEROID.a,q.rf=parseFloat(nt.DATUM.SPHEROID.rf,10)),nt.DATUM&&nt.DATUM.TOWGS84&&(q.datum_params=nt.DATUM.TOWGS84),~q.datumCode.indexOf("osgb_1936")&&(q.datumCode="osgb36"),~q.datumCode.indexOf("osni_1952")&&(q.datumCode="osni52"),(~q.datumCode.indexOf("tm65")||~q.datumCode.indexOf("geodetic_datum_of_1965"))&&(q.datumCode="ire65"),"ch1903+"===q.datumCode&&(q.datumCode="ch1903"),~q.datumCode.indexOf("israel")&&(q.datumCode="isr93")),q.b&&!isFinite(q.b)&&(q.b=q.a),[["standard_parallel_1","Standard_Parallel_1"],["standard_parallel_1","Latitude of 1st standard parallel"],["standard_parallel_2","Standard_Parallel_2"],["standard_parallel_2","Latitude of 2nd standard parallel"],["false_easting","False_Easting"],["false_easting","False easting"],["false-easting","Easting at false origin"],["false_northing","False_Northing"],["false_northing","False northing"],["false_northing","Northing at false origin"],["central_meridian","Central_Meridian"],["central_meridian","Longitude of natural origin"],["central_meridian","Longitude of false origin"],["latitude_of_origin","Latitude_Of_Origin"],["latitude_of_origin","Central_Parallel"],["latitude_of_origin","Latitude of natural origin"],["latitude_of_origin","Latitude of false origin"],["scale_factor","Scale_Factor"],["k0","scale_factor"],["latitude_of_center","Latitude_Of_Center"],["latitude_of_center","Latitude_of_center"],["lat0","latitude_of_center",ae],["longitude_of_center","Longitude_Of_Center"],["longitude_of_center","Longitude_of_center"],["longc","longitude_of_center",ae],["x0","false_easting",o],["y0","false_northing",o],["long0","central_meridian",ae],["lat0","latitude_of_origin",ae],["lat0","standard_parallel_1",ae],["lat1","standard_parallel_1",ae],["lat2","standard_parallel_2",ae],["azimuth","Azimuth"],["alpha","azimuth",ae],["srsCode","name"]].forEach((function(Y){return function(q,Y){var H=Y[0],et=Y[1];!(H in q)&&et in q&&(q[H]=q[et],3===Y.length&&(q[H]=Y[2](q[H])))}(q,Y)})),q.long0||!q.longc||"Albers_Conic_Equal_Area"!==q.projName&&"Lambert_Azimuthal_Equal_Area"!==q.projName||(q.long0=q.longc),q.lat_ts||!q.lat1||"Stereographic_South_Pole"!==q.projName&&"Polar Stereographic (variant B)"!==q.projName||(q.lat0=ae(q.lat1>0?90:-90),q.lat_ts=q.lat1)}(it),it}function le(q){var Y=this;if(2===arguments.length){var H=arguments[1];"string"==typeof H?"+"===H.charAt(0)?le[q]=Qt(arguments[1]):le[q]=he(arguments[1]):le[q]=H}else if(1===arguments.length){if(Array.isArray(q))return q.map((function(q){Array.isArray(q)?le.apply(Y,q):le(q)}));if("string"==typeof q){if(q in le)return le[q]}else"EPSG"in q?le["EPSG:"+q.EPSG]=q:"ESRI"in q?le["ESRI:"+q.ESRI]=q:"IAU2000"in q?le["IAU2000:"+q.IAU2000]=q:console.log(q);return}}re.prototype.readCharicter=function(){var q=this.text[this.place++];if(4!==this.state)for(;Re.test(q);){if(this.place>=this.text.length)return;q=this.text[this.place++]}switch(this.state){case 1:return this.neutral(q);case 2:return this.keyword(q);case 4:return this.quoted(q);case 5:return this.afterquote(q);case 3:return this.number(q);case-1:return}},re.prototype.afterquote=function(q){if('"'===q)return this.word+='"',void(this.state=4);if(Xe.test(q))return this.word=this.word.trim(),void this.afterItem(q);throw new Error("havn't handled \""+q+'" in afterquote yet, index '+this.place)},re.prototype.afterItem=function(q){return","===q?(null!==this.word&&this.currentObject.push(this.word),this.word=null,void(this.state=1)):"]"===q?(this.level--,null!==this.word&&(this.currentObject.push(this.word),this.word=null),this.state=1,this.currentObject=this.stack.pop(),void(this.currentObject||(this.state=-1))):void 0},re.prototype.number=function(q){if(!Je.test(q)){if(Xe.test(q))return this.word=parseFloat(this.word),void this.afterItem(q);throw new Error("havn't handled \""+q+'" in number yet, index '+this.place)}this.word+=q},re.prototype.quoted=function(q){'"'!==q?this.word+=q:this.state=5},re.prototype.keyword=function(q){if(ke.test(q))this.word+=q;else{if("["===q){var Y=[];return Y.push(this.word),this.level++,null===this.root?this.root=Y:this.currentObject.push(Y),this.stack.push(this.currentObject),this.currentObject=Y,void(this.state=1)}if(!Xe.test(q))throw new Error("havn't handled \""+q+'" in keyword yet, index '+this.place);this.afterItem(q)}},re.prototype.neutral=function(q){if(Oe.test(q))return this.word=q,void(this.state=2);if('"'===q)return this.word="",void(this.state=4);if(Je.test(q))return this.word=q,void(this.state=3);if(!Xe.test(q))throw new Error("havn't handled \""+q+'" in neutral yet, index '+this.place);this.afterItem(q)},re.prototype.output=function(){for(;this.place<this.text.length;)this.readCharicter();if(-1===this.state)return this.root;throw new Error('unable to parse string "'+this.text+'". State is '+this.state)},function(q){q("EPSG:4326","+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees"),q("EPSG:4269","+title=NAD83 (long/lat) +proj=longlat +a=6378137.0 +b=6356752.31414036 +ellps=GRS80 +datum=NAD83 +units=degrees"),q("EPSG:3857","+title=WGS 84 / Pseudo-Mercator +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs"),q.WGS84=q["EPSG:4326"],q["EPSG:3785"]=q["EPSG:3857"],q.GOOGLE=q["EPSG:3857"],q["EPSG:900913"]=q["EPSG:3857"],q["EPSG:102113"]=q["EPSG:3857"]}(le);const Qe=le;var $e=["PROJECTEDCRS","PROJCRS","GEOGCS","GEOCCS","PROJCS","LOCAL_CS","GEODCRS","GEODETICCRS","GEODETICDATUM","ENGCRS","ENGINEERINGCRS"],ti=["3857","900913","3785","102113"];function fe(q,Y){var H,et;if(q=q||{},!Y)return q;for(et in Y)void 0!==(H=Y[et])&&(q[et]=H);return q}function ge(q,Y,H){var et=q*Y;return H/Math.sqrt(1-et*et)}function pe(q){return q<0?-1:1}function me(q){return Math.abs(q)<=be?q:q-pe(q)*Se}function ye(q,Y,H){var et=q*H,it=.5*q;return et=Math.pow((1-et)/(1+et),it),Math.tan(.5*(ne-Y))/et}function _e(q,Y){for(var H,et,it=.5*q,nt=ne-2*Math.atan(Y),st=0;st<=15;st++)if(H=q*Math.sin(nt),nt+=et=ne-2*Math.atan(Y*Math.pow((1-H)/(1+H),it))-nt,Math.abs(et)<=1e-10)return nt;return-9999}function ve(q){return q}var ei=[{init:function(){var q=this.b/this.a;this.es=1-q*q,"x0"in this||(this.x0=0),"y0"in this||(this.y0=0),this.e=Math.sqrt(this.es),this.lat_ts?this.sphere?this.k0=Math.cos(this.lat_ts):this.k0=ge(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)):this.k0||(this.k?this.k0=this.k:this.k0=1)},forward:function(q){var Y,H,et=q.x,it=q.y;if(it*de>90&&it*de<-90&&et*de>180&&et*de<-180)return null;if(Math.abs(Math.abs(it)-ne)<=ue)return null;if(this.sphere)Y=this.x0+this.a*this.k0*me(et-this.long0),H=this.y0+this.a*this.k0*Math.log(Math.tan(xe+.5*it));else{var nt=Math.sin(it),st=ye(this.e,it,nt);Y=this.x0+this.a*this.k0*me(et-this.long0),H=this.y0-this.a*this.k0*Math.log(st)}return q.x=Y,q.y=H,q},inverse:function(q){var Y,H,et=q.x-this.x0,it=q.y-this.y0;if(this.sphere)H=ne-2*Math.atan(Math.exp(-it/(this.a*this.k0)));else{var nt=Math.exp(-it/(this.a*this.k0));if(-9999===(H=_e(this.e,nt)))return null}return Y=me(this.long0+et/(this.a*this.k0)),q.x=Y,q.y=H,q},names:["Mercator","Popular Visualisation Pseudo Mercator","Mercator_1SP","Mercator_Auxiliary_Sphere","merc"]},{init:function(){},forward:ve,inverse:ve,names:["longlat","identity"]}],ii={},di=[];function Me(q,Y){var H=di.length;return q.names?(di[H]=q,q.names.forEach((function(q){ii[q.toLowerCase()]=H})),this):(console.log(Y),!0)}const gi={start:function(){ei.forEach(Me)},add:Me,get:function(q){if(!q)return!1;var Y=q.toLowerCase();return void 0!==ii[Y]&&di[ii[Y]]?di[ii[Y]]:void 0}};var fi={MERIT:{a:6378137,rf:298.257,ellipseName:"MERIT 1983"},SGS85:{a:6378136,rf:298.257,ellipseName:"Soviet Geodetic System 85"},GRS80:{a:6378137,rf:298.257222101,ellipseName:"GRS 1980(IUGG, 1980)"},IAU76:{a:6378140,rf:298.257,ellipseName:"IAU 1976"},airy:{a:6377563.396,b:6356256.91,ellipseName:"Airy 1830"},APL4:{a:6378137,rf:298.25,ellipseName:"Appl. Physics. 1965"},NWL9D:{a:6378145,rf:298.25,ellipseName:"Naval Weapons Lab., 1965"},mod_airy:{a:6377340.189,b:6356034.446,ellipseName:"Modified Airy"},andrae:{a:6377104.43,rf:300,ellipseName:"Andrae 1876 (Den., Iclnd.)"},aust_SA:{a:6378160,rf:298.25,ellipseName:"Australian Natl & S. Amer. 1969"},GRS67:{a:6378160,rf:298.247167427,ellipseName:"GRS 67(IUGG 1967)"},bessel:{a:6377397.155,rf:299.1528128,ellipseName:"Bessel 1841"},bess_nam:{a:6377483.865,rf:299.1528128,ellipseName:"Bessel 1841 (Namibia)"},clrk66:{a:6378206.4,b:6356583.8,ellipseName:"Clarke 1866"},clrk80:{a:6378249.145,rf:293.4663,ellipseName:"Clarke 1880 mod."},clrk58:{a:6378293.645208759,rf:294.2606763692654,ellipseName:"Clarke 1858"},CPM:{a:6375738.7,rf:334.29,ellipseName:"Comm. des Poids et Mesures 1799"},delmbr:{a:6376428,rf:311.5,ellipseName:"Delambre 1810 (Belgium)"},engelis:{a:6378136.05,rf:298.2566,ellipseName:"Engelis 1985"},evrst30:{a:6377276.345,rf:300.8017,ellipseName:"Everest 1830"},evrst48:{a:6377304.063,rf:300.8017,ellipseName:"Everest 1948"},evrst56:{a:6377301.243,rf:300.8017,ellipseName:"Everest 1956"},evrst69:{a:6377295.664,rf:300.8017,ellipseName:"Everest 1969"},evrstSS:{a:6377298.556,rf:300.8017,ellipseName:"Everest (Sabah & Sarawak)"},fschr60:{a:6378166,rf:298.3,ellipseName:"Fischer (Mercury Datum) 1960"},fschr60m:{a:6378155,rf:298.3,ellipseName:"Fischer 1960"},fschr68:{a:6378150,rf:298.3,ellipseName:"Fischer 1968"},helmert:{a:6378200,rf:298.3,ellipseName:"Helmert 1906"},hough:{a:6378270,rf:297,ellipseName:"Hough"},intl:{a:6378388,rf:297,ellipseName:"International 1909 (Hayford)"},kaula:{a:6378163,rf:298.24,ellipseName:"Kaula 1961"},lerch:{a:6378139,rf:298.257,ellipseName:"Lerch 1979"},mprts:{a:6397300,rf:191,ellipseName:"Maupertius 1738"},new_intl:{a:6378157.5,b:6356772.2,ellipseName:"New International 1967"},plessis:{a:6376523,rf:6355863,ellipseName:"Plessis 1817 (France)"},krass:{a:6378245,rf:298.3,ellipseName:"Krassovsky, 1942"},SEasia:{a:6378155,b:6356773.3205,ellipseName:"Southeast Asia"},walbeck:{a:6376896,b:6355834.8467,ellipseName:"Walbeck"},WGS60:{a:6378165,rf:298.3,ellipseName:"WGS 60"},WGS66:{a:6378145,rf:298.25,ellipseName:"WGS 66"},WGS7:{a:6378135,rf:298.26,ellipseName:"WGS 72"}},pi=fi.WGS84={a:6378137,rf:298.257223563,ellipseName:"WGS 84"};fi.sphere={a:6370997,b:6370997,ellipseName:"Normal Sphere (r=6370997)"};var vi={wgs84:{towgs84:"0,0,0",ellipse:"WGS84",datumName:"WGS84"},ch1903:{towgs84:"674.374,15.056,405.346",ellipse:"bessel",datumName:"swiss"},ggrs87:{towgs84:"-199.87,74.79,246.62",ellipse:"GRS80",datumName:"Greek_Geodetic_Reference_System_1987"},nad83:{towgs84:"0,0,0",ellipse:"GRS80",datumName:"North_American_Datum_1983"},nad27:{nadgrids:"@conus,@alaska,@ntv2_0.gsb,@ntv1_can.dat",ellipse:"clrk66",datumName:"North_American_Datum_1927"},potsdam:{towgs84:"598.1,73.7,418.2,0.202,0.045,-2.455,6.7",ellipse:"bessel",datumName:"Potsdam Rauenberg 1950 DHDN"},carthage:{towgs84:"-263.0,6.0,431.0",ellipse:"clark80",datumName:"Carthage 1934 Tunisia"},hermannskogel:{towgs84:"577.326,90.129,463.919,5.137,1.474,5.297,2.4232",ellipse:"bessel",datumName:"Hermannskogel"},osni52:{towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"airy",datumName:"Irish National"},ire65:{towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"mod_airy",datumName:"Ireland 1965"},rassadiran:{towgs84:"-133.63,-157.5,-158.62",ellipse:"intl",datumName:"Rassadiran"},nzgd49:{towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993",ellipse:"intl",datumName:"New Zealand Geodetic Datum 1949"},osgb36:{towgs84:"446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894",ellipse:"airy",datumName:"Airy 1830"},s_jtsk:{towgs84:"589,76,480",ellipse:"bessel",datumName:"S-JTSK (Ferro)"},beduaram:{towgs84:"-106,-87,188",ellipse:"clrk80",datumName:"Beduaram"},gunung_segara:{towgs84:"-403,684,41",ellipse:"bessel",datumName:"Gunung Segara Jakarta"},rnb72:{towgs84:"106.869,-52.2978,103.724,-0.33657,0.456955,-1.84218,1",ellipse:"intl",datumName:"Reseau National Belge 1972"}},wi={};function Pe(q){if(0===q.length)return null;var Y="@"===q[0];return Y&&(q=q.slice(1)),"null"===q?{name:"null",mandatory:!Y,grid:null,isNull:!0}:{name:q,mandatory:!Y,grid:wi[q]||null,isNull:!1}}function Ie(q){return q/3600*Math.PI/180}function Te(q,Y,H){return String.fromCharCode.apply(null,new Uint8Array(q.buffer.slice(Y,H)))}function Fe(q){return q.map((function(q){return[Ie(q.longitudeShift),Ie(q.latitudeShift)]}))}function Ae(q,Y,H){return{name:Te(q,Y+8,Y+16).trim(),parent:Te(q,Y+24,Y+24+8).trim(),lowerLatitude:q.getFloat64(Y+72,H),upperLatitude:q.getFloat64(Y+88,H),lowerLongitude:q.getFloat64(Y+104,H),upperLongitude:q.getFloat64(Y+120,H),latitudeInterval:q.getFloat64(Y+136,H),longitudeInterval:q.getFloat64(Y+152,H),gridNodeCount:q.getInt32(Y+168,H)}}function Le(q,Y,H,et){for(var it=Y+176,nt=[],st=0;st<H.gridNodeCount;st++){var ot={latitudeShift:q.getFloat32(it+16*st,et),longitudeShift:q.getFloat32(it+16*st+4,et),latitudeAccuracy:q.getFloat32(it+16*st+8,et),longitudeAccuracy:q.getFloat32(it+16*st+12,et)};nt.push(ot)}return nt}function Ne(q,Y){if(!(this instanceof Ne))return new Ne(q);Y=Y||function(q){if(q)throw q};var H=function(q){if(!function(q){return"string"==typeof q}(q))return q;if(function(q){return q in Qe}(q))return Qe[q];if(function(q){return $e.some((function(Y){return q.indexOf(Y)>-1}))}(q)){var Y=he(q);if(function(q){var Y=Jt(q,"authority");if(Y){var H=Jt(Y,"epsg");return H&&ti.indexOf(H)>-1}}(Y))return Qe["EPSG:3857"];var H=function(q){var Y=Jt(q,"extension");if(Y)return Jt(Y,"proj4")}(Y);return H?Qt(H):Y}return function(q){return"+"===q[0]}(q)?Qt(q):void 0}(q);if("object"==typeof H){var et=Ne.projections.get(H.projName);if(et){if(H.datumCode&&"none"!==H.datumCode){var it=Jt(vi,H.datumCode);it&&(H.datum_params=H.datum_params||(it.towgs84?it.towgs84.split(","):null),H.ellps=it.ellipse,H.datumName=it.datumName?it.datumName:H.datumCode)}H.k0=H.k0||1,H.axis=H.axis||"enu",H.ellps=H.ellps||"wgs84",H.lat1=H.lat1||H.lat0;var nt,st,ot,lt,mt,_t,vt=function(q,Y,H,et,it){if(!q){var nt=Jt(fi,et);nt||(nt=pi),q=nt.a,Y=nt.b,H=nt.rf}return H&&!Y&&(Y=(1-1/H)*q),(0===H||Math.abs(q-Y)<ue)&&(it=!0,Y=q),{a:q,b:Y,rf:H,sphere:it}}(H.a,H.b,H.rf,H.ellps,H.sphere),bt=(nt=vt.a,st=vt.b,vt.rf,mt=((ot=nt*nt)-(lt=st*st))/ot,_t=0,H.R_A?(ot=(nt*=1-mt*(.16666666666666666+mt*(.04722222222222222+.022156084656084655*mt)))*nt,mt=0):_t=Math.sqrt(mt),{es:mt,e:_t,ep2:(ot-lt)/lt}),Mt=function(q){return void 0===q?null:q.split(",").map(Pe)}(H.nadgrids),Et=H.datum||function(q,Y,H,et,it,nt,st){var ot={};return ot.datum_type=void 0===q||"none"===q?5:4,Y&&(ot.datum_params=Y.map(parseFloat),0===ot.datum_params[0]&&0===ot.datum_params[1]&&0===ot.datum_params[2]||(ot.datum_type=1),ot.datum_params.length>3&&(0===ot.datum_params[3]&&0===ot.datum_params[4]&&0===ot.datum_params[5]&&0===ot.datum_params[6]||(ot.datum_type=2,ot.datum_params[3]*=ie,ot.datum_params[4]*=ie,ot.datum_params[5]*=ie,ot.datum_params[6]=ot.datum_params[6]/1e6+1))),st&&(ot.datum_type=3,ot.grids=st),ot.a=H,ot.b=et,ot.es=it,ot.ep2=nt,ot}(H.datumCode,H.datum_params,vt.a,vt.b,bt.es,bt.ep2,Mt);fe(this,H),fe(this,et),this.a=vt.a,this.b=vt.b,this.rf=vt.rf,this.sphere=vt.sphere,this.es=bt.es,this.e=bt.e,this.ep2=bt.ep2,this.datum=Et,this.init(),Y(null,this)}else Y(q)}else Y(q)}Ne.projections=gi,Ne.projections.start();const Ci=Ne;function Ge(q,Y,H){var et,it,nt,st,ot=q.x,lt=q.y,mt=q.z?q.z:0;if(lt<-ne&&lt>-1.001*ne)lt=-ne;else if(lt>ne&&lt<1.001*ne)lt=ne;else{if(lt<-ne)return{x:-1/0,y:-1/0,z:q.z};if(lt>ne)return{x:1/0,y:1/0,z:q.z}}return ot>Math.PI&&(ot-=2*Math.PI),it=Math.sin(lt),st=Math.cos(lt),nt=it*it,{x:((et=H/Math.sqrt(1-Y*nt))+mt)*st*Math.cos(ot),y:(et+mt)*st*Math.sin(ot),z:(et*(1-Y)+mt)*it}}function je(q,Y,H,et){var it,nt,st,ot,lt,mt,_t,vt,bt,Mt,Et,Rt,It,Pt,Tt,Ft=q.x,At=q.y,Lt=q.z?q.z:0;if(it=Math.sqrt(Ft*Ft+At*At),nt=Math.sqrt(Ft*Ft+At*At+Lt*Lt),it/H<1e-12){if(Pt=0,nt/H<1e-12)return Tt=-et,{x:q.x,y:q.y,z:q.z}}else Pt=Math.atan2(At,Ft);st=Lt/nt,vt=(ot=it/nt)*(1-Y)*(lt=1/Math.sqrt(1-Y*(2-Y)*ot*ot)),bt=st*lt,It=0;do{It++,mt=Y*(_t=H/Math.sqrt(1-Y*bt*bt))/(_t+(Tt=it*vt+Lt*bt-_t*(1-Y*bt*bt))),Rt=(Et=st*(lt=1/Math.sqrt(1-mt*(2-mt)*ot*ot)))*vt-(Mt=ot*(1-mt)*lt)*bt,vt=Mt,bt=Et}while(Rt*Rt>1e-24&&It<30);return{x:Pt,y:Math.atan(Et/Math.abs(Mt)),z:Tt}}function De(q){return 1===q||2===q}function ze(q,Y,H){if(null===q.grids||0===q.grids.length)return console.log("Grid shift grids not found"),-1;for(var et={x:-H.x,y:H.y},it={x:Number.NaN,y:Number.NaN},nt=[],st=0;st<q.grids.length;st++){var ot=q.grids[st];if(nt.push(ot.name),ot.isNull){it=et;break}if(ot.mandatory,null!==ot.grid){var lt=ot.grid.subgrids[0],mt=(Math.abs(lt.del[1])+Math.abs(lt.del[0]))/1e4,_t=lt.ll[0]-mt,vt=lt.ll[1]-mt,bt=lt.ll[0]+(lt.lim[0]-1)*lt.del[0]+mt,Mt=lt.ll[1]+(lt.lim[1]-1)*lt.del[1]+mt;if(!(vt>et.y||_t>et.x||Mt<et.y||bt<et.x||(it=Ue(et,Y,lt),isNaN(it.x))))break}else if(ot.mandatory)return console.log("Unable to find mandatory grid '"+ot.name+"'"),-1}return isNaN(it.x)?(console.log("Failed to find a grid shift table for location '"+-et.x*de+" "+et.y*de+" tried: '"+nt+"'"),-1):(H.x=-it.x,H.y=it.y,0)}function Ue(q,Y,H){var et={x:Number.NaN,y:Number.NaN};if(isNaN(q.x))return et;var it={x:q.x,y:q.y};it.x-=H.ll[0],it.y-=H.ll[1],it.x=me(it.x-Math.PI)+Math.PI;var nt=Be(it,H);if(Y){if(isNaN(nt.x))return et;nt.x=it.x-nt.x,nt.y=it.y-nt.y;var st,ot,lt=9;do{if(ot=Be(nt,H),isNaN(ot.x)){console.log("Inverse grid shift iteration failed, presumably at grid edge.  Using first approximation.");break}st={x:it.x-(ot.x+nt.x),y:it.y-(ot.y+nt.y)},nt.x+=st.x,nt.y+=st.y}while(lt--&&Math.abs(st.x)>1e-12&&Math.abs(st.y)>1e-12);if(lt<0)return console.log("Inverse grid shift iterator failed to converge."),et;et.x=me(nt.x+H.ll[0]),et.y=nt.y+H.ll[1]}else isNaN(nt.x)||(et.x=q.x+nt.x,et.y=q.y+nt.y);return et}function Be(q,Y){var H,et={x:q.x/Y.del[0],y:q.y/Y.del[1]},it=Math.floor(et.x),nt=Math.floor(et.y),st=et.x-1*it,ot=et.y-1*nt,lt={x:Number.NaN,y:Number.NaN};if(it<0||it>=Y.lim[0])return lt;if(nt<0||nt>=Y.lim[1])return lt;H=nt*Y.lim[0]+it;var mt=Y.cvs[H][0],_t=Y.cvs[H][1];H++;var vt=Y.cvs[H][0],bt=Y.cvs[H][1];H+=Y.lim[0];var Mt=Y.cvs[H][0],Et=Y.cvs[H][1];H--;var Rt=Y.cvs[H][0],It=Y.cvs[H][1],Pt=st*ot,Tt=st*(1-ot),Ft=(1-st)*(1-ot),At=(1-st)*ot;return lt.x=Ft*mt+Tt*vt+At*Rt+Pt*Mt,lt.y=Ft*_t+Tt*bt+At*It+Pt*Et,lt}function We(q,Y,H){var et,it,nt,st=H.x,ot=H.y,lt=H.z||0,mt={};for(nt=0;nt<3;nt++)if(!Y||2!==nt||void 0!==H.z)switch(0===nt?(et=st,it=-1!=="ew".indexOf(q.axis[nt])?"x":"y"):1===nt?(et=ot,it=-1!=="ns".indexOf(q.axis[nt])?"y":"x"):(et=lt,it="z"),q.axis[nt]){case"e":case"n":mt[it]=et;break;case"w":case"s":mt[it]=-et;break;case"u":void 0!==H[it]&&(mt.z=et);break;case"d":void 0!==H[it]&&(mt.z=-et);break;default:return null}return mt}function qe(q){var Y={x:q[0],y:q[1]};return q.length>2&&(Y.z=q[2]),q.length>3&&(Y.m=q[3]),Y}function Ye(q){if("function"==typeof Number.isFinite){if(Number.isFinite(q))return;throw new TypeError("coordinates must be finite numbers")}if("number"!=typeof q||q!=q||!isFinite(q))throw new TypeError("coordinates must be finite numbers")}function Ze(q,Y,H,et){var it;if(Array.isArray(H)&&(H=qe(H)),function(q){Ye(q.x),Ye(q.y)}(H),q.datum&&Y.datum&&function(q,Y){return(1===q.datum.datum_type||2===q.datum.datum_type)&&"WGS84"!==Y.datumCode||(1===Y.datum.datum_type||2===Y.datum.datum_type)&&"WGS84"!==q.datumCode}(q,Y)&&(H=Ze(q,it=new Ci("WGS84"),H,et),q=it),et&&"enu"!==q.axis&&(H=We(q,!1,H)),"longlat"===q.projName)H={x:H.x*ce,y:H.y*ce,z:H.z||0};else if(q.to_meter&&(H={x:H.x*q.to_meter,y:H.y*q.to_meter,z:H.z||0}),!(H=q.inverse(H)))return;if(q.from_greenwich&&(H.x+=q.from_greenwich),H=function(q,Y,H){if(function(q,Y){return q.datum_type===Y.datum_type&&!(q.a!==Y.a||Math.abs(q.es-Y.es)>5e-11)&&(1===q.datum_type?q.datum_params[0]===Y.datum_params[0]&&q.datum_params[1]===Y.datum_params[1]&&q.datum_params[2]===Y.datum_params[2]:2!==q.datum_type||q.datum_params[0]===Y.datum_params[0]&&q.datum_params[1]===Y.datum_params[1]&&q.datum_params[2]===Y.datum_params[2]&&q.datum_params[3]===Y.datum_params[3]&&q.datum_params[4]===Y.datum_params[4]&&q.datum_params[5]===Y.datum_params[5]&&q.datum_params[6]===Y.datum_params[6])}(q,Y))return H;if(5===q.datum_type||5===Y.datum_type)return H;var et=q.a,it=q.es;if(3===q.datum_type){if(0!==ze(q,!1,H))return;et=te,it=ee}var nt=Y.a,st=Y.b,ot=Y.es;return 3===Y.datum_type&&(nt=te,st=6356752.314,ot=ee),it!==ot||et!==nt||De(q.datum_type)||De(Y.datum_type)?(H=Ge(H,it,et),De(q.datum_type)&&(H=function(q,Y,H){if(1===Y)return{x:q.x+H[0],y:q.y+H[1],z:q.z+H[2]};if(2===Y){var et=H[0],it=H[1],nt=H[2],st=H[3],ot=H[4],lt=H[5],mt=H[6];return{x:mt*(q.x-lt*q.y+ot*q.z)+et,y:mt*(lt*q.x+q.y-st*q.z)+it,z:mt*(-ot*q.x+st*q.y+q.z)+nt}}}(H,q.datum_type,q.datum_params)),De(Y.datum_type)&&(H=function(q,Y,H){if(1===Y)return{x:q.x-H[0],y:q.y-H[1],z:q.z-H[2]};if(2===Y){var et=H[0],it=H[1],nt=H[2],st=H[3],ot=H[4],lt=H[5],mt=H[6],_t=(q.x-et)/mt,vt=(q.y-it)/mt,bt=(q.z-nt)/mt;return{x:_t+lt*vt-ot*bt,y:-lt*_t+vt+st*bt,z:ot*_t-st*vt+bt}}}(H,Y.datum_type,Y.datum_params)),H=je(H,ot,nt,st),3!==Y.datum_type||0===ze(Y,!0,H)?H:void 0):H}(q.datum,Y.datum,H))return Y.from_greenwich&&(H={x:H.x-Y.from_greenwich,y:H.y,z:H.z||0}),"longlat"===Y.projName?H={x:H.x*de,y:H.y*de,z:H.z||0}:(H=Y.forward(H),Y.to_meter&&(H={x:H.x/Y.to_meter,y:H.y/Y.to_meter,z:H.z||0})),et&&"enu"!==Y.axis?We(Y,!0,H):H}var Ri=Ci("WGS84");function Ve(q,Y,H,et){var it,nt,st;return Array.isArray(H)?(it=Ze(q,Y,H,et)||{x:NaN,y:NaN},H.length>2?void 0!==q.name&&"geocent"===q.name||void 0!==Y.name&&"geocent"===Y.name?"number"==typeof it.z?[it.x,it.y,it.z].concat(H.splice(3)):[it.x,it.y,H[2]].concat(H.splice(3)):[it.x,it.y].concat(H.splice(2)):[it.x,it.y]):(nt=Ze(q,Y,H,et),2===(st=Object.keys(H)).length||st.forEach((function(et){if(void 0!==q.name&&"geocent"===q.name||void 0!==Y.name&&"geocent"===Y.name){if("x"===et||"y"===et||"z"===et)return}else if("x"===et||"y"===et)return;nt[et]=H[et]})),nt)}function Ke(q){return q instanceof Ci?q:q.oProj?q.oProj:Ci(q)}const He=function(q,Y,H){q=Ke(q);var et,it=!1;return void 0===Y?(Y=q,q=Ri,it=!0):(void 0!==Y.x||Array.isArray(Y))&&(H=Y,Y=q,q=Ri,it=!0),Y=Ke(Y),H?Ve(q,Y,H):(et={forward:function(H,et){return Ve(q,Y,H,et)},inverse:function(H,et){return Ve(Y,q,H,et)}},it&&(et.oProj=Y),et)};var Oi="AJSAJS",Ii="AFAFAF",Pi=65,Ti=73,Fi=79;const Ai={forward:ni,inverse:function(q){var Y=ai(li(q.toUpperCase()));return Y.lat&&Y.lon?[Y.lon,Y.lat,Y.lon,Y.lat]:[Y.left,Y.bottom,Y.right,Y.top]},toPoint:ri};function ni(q,Y){return Y=Y||5,function(q,Y){var H,et,it,nt,st,ot,lt,mt,_t,vt,bt,Mt="00000"+q.easting,Et="00000"+q.northing;return q.zoneNumber+q.zoneLetter+(_t=q.easting,vt=q.northing,bt=hi(q.zoneNumber),H=Math.floor(_t/1e5),et=Math.floor(vt/1e5)%20,nt=Oi.charCodeAt(it=bt-1),st=Ii.charCodeAt(it),mt=!1,(ot=nt+H-1)>90&&(ot=ot-90+Pi-1,mt=!0),(ot===Ti||nt<Ti&&ot>Ti||(ot>Ti||nt<Ti)&&mt)&&ot++,(ot===Fi||nt<Fi&&ot>Fi||(ot>Fi||nt<Fi)&&mt)&&++ot===Ti&&ot++,ot>90&&(ot=ot-90+Pi-1),(lt=st+et)>86?(lt=lt-86+Pi-1,mt=!0):mt=!1,(lt===Ti||st<Ti&&lt>Ti||(lt>Ti||st<Ti)&&mt)&&lt++,(lt===Fi||st<Fi&&lt>Fi||(lt>Fi||st<Fi)&&mt)&&++lt===Ti&&lt++,lt>86&&(lt=lt-86+Pi-1),String.fromCharCode(ot)+String.fromCharCode(lt))+Mt.substr(Mt.length-5,Y)+Et.substr(Et.length-5,Y)}(function(q){var Y,H,et,it,nt,st,ot,lt=q.lat,mt=q.lon,_t=6378137,vt=.9996,bt=si(lt),Mt=si(mt);ot=Math.floor((mt+180)/6)+1,180===mt&&(ot=60),lt>=56&&lt<64&&mt>=3&&mt<12&&(ot=32),lt>=72&&lt<84&&(mt>=0&&mt<9?ot=31:mt>=9&&mt<21?ot=33:mt>=21&&mt<33?ot=35:mt>=33&&mt<42&&(ot=37)),st=si(6*(ot-1)-180+3),Y=.006739496752268451,H=_t/Math.sqrt(1-.00669438*Math.sin(bt)*Math.sin(bt)),et=Math.tan(bt)*Math.tan(bt),it=Y*Math.cos(bt)*Math.cos(bt);var Et,Rt,It=vt*H*((nt=Math.cos(bt)*(Mt-st))+(1-et+it)*nt*nt*nt/6+(5-18*et+et*et+72*it-58*Y)*nt*nt*nt*nt*nt/120)+5e5,Pt=vt*(_t*(.9983242984503243*bt-.002514607064228144*Math.sin(2*bt)+2639046602129982e-21*Math.sin(4*bt)-3.418046101696858e-9*Math.sin(6*bt))+H*Math.tan(bt)*(nt*nt/2+(5-et+9*it+4*it*it)*nt*nt*nt*nt/24+(61-58*et+et*et+600*it-2.2240339282485886)*nt*nt*nt*nt*nt*nt/720));return lt<0&&(Pt+=1e7),{northing:Math.round(Pt),easting:Math.round(It),zoneNumber:ot,zoneLetter:(Et=lt,Rt="Z",84>=Et&&Et>=72?Rt="X":72>Et&&Et>=64?Rt="W":64>Et&&Et>=56?Rt="V":56>Et&&Et>=48?Rt="U":48>Et&&Et>=40?Rt="T":40>Et&&Et>=32?Rt="S":32>Et&&Et>=24?Rt="R":24>Et&&Et>=16?Rt="Q":16>Et&&Et>=8?Rt="P":8>Et&&Et>=0?Rt="N":0>Et&&Et>=-8?Rt="M":-8>Et&&Et>=-16?Rt="L":-16>Et&&Et>=-24?Rt="K":-24>Et&&Et>=-32?Rt="J":-32>Et&&Et>=-40?Rt="H":-40>Et&&Et>=-48?Rt="G":-48>Et&&Et>=-56?Rt="F":-56>Et&&Et>=-64?Rt="E":-64>Et&&Et>=-72?Rt="D":-72>Et&&Et>=-80&&(Rt="C"),Rt)}}({lat:q[1],lon:q[0]}),Y)}function ri(q){var Y=ai(li(q.toUpperCase()));return Y.lat&&Y.lon?[Y.lon,Y.lat]:[(Y.left+Y.right)/2,(Y.top+Y.bottom)/2]}function si(q){return q*(Math.PI/180)}function oi(q){return q/Math.PI*180}function ai(q){var Y=q.northing,H=q.easting,et=q.zoneLetter,it=q.zoneNumber;if(it<0||it>60)return null;var nt,st,ot,lt,mt,_t,vt,bt,Mt,Et=.9996,Rt=6378137,It=.00669438,Pt=(1-Math.sqrt(.99330562))/(1+Math.sqrt(.99330562)),Tt=H-5e5,Ft=Y;et<"N"&&(Ft-=1e7),vt=6*(it-1)-180+3,nt=.006739496752268451,Mt=(bt=Ft/Et/6367449.145945056)+(3*Pt/2-27*Pt*Pt*Pt/32)*Math.sin(2*bt)+(21*Pt*Pt/16-55*Pt*Pt*Pt*Pt/32)*Math.sin(4*bt)+151*Pt*Pt*Pt/96*Math.sin(6*bt),st=Rt/Math.sqrt(1-It*Math.sin(Mt)*Math.sin(Mt)),ot=Math.tan(Mt)*Math.tan(Mt),lt=nt*Math.cos(Mt)*Math.cos(Mt),mt=.99330562*Rt/Math.pow(1-It*Math.sin(Mt)*Math.sin(Mt),1.5),_t=Tt/(st*Et);var At=Mt-st*Math.tan(Mt)/mt*(_t*_t/2-(5+3*ot+10*lt-4*lt*lt-9*nt)*_t*_t*_t*_t/24+(61+90*ot+298*lt+45*ot*ot-1.6983531815716497-3*lt*lt)*_t*_t*_t*_t*_t*_t/720);At=oi(At);var Lt,Nt=(_t-(1+2*ot+lt)*_t*_t*_t/6+(5-2*lt+28*ot-3*lt*lt+8*nt+24*ot*ot)*_t*_t*_t*_t*_t/120)/Math.cos(Mt);if(Nt=vt+oi(Nt),q.accuracy){var kt=ai({northing:q.northing+q.accuracy,easting:q.easting+q.accuracy,zoneLetter:q.zoneLetter,zoneNumber:q.zoneNumber});Lt={top:kt.lat,right:kt.lon,bottom:At,left:Nt}}else Lt={lat:At,lon:Nt};return Lt}function hi(q){var Y=q%6;return 0===Y&&(Y=6),Y}function li(q){if(q&&0===q.length)throw"MGRSPoint coverting from nothing";for(var Y,H=q.length,et=null,it="",nt=0;!/[A-Z]/.test(Y=q.charAt(nt));){if(nt>=2)throw"MGRSPoint bad conversion from: "+q;it+=Y,nt++}var st=parseInt(it,10);if(0===nt||nt+3>H)throw"MGRSPoint bad conversion from: "+q;var ot=q.charAt(nt++);if(ot<="A"||"B"===ot||"Y"===ot||ot>="Z"||"I"===ot||"O"===ot)throw"MGRSPoint zone letter "+ot+" not handled: "+q;et=q.substring(nt,nt+=2);for(var lt=hi(st),mt=function(q,Y){for(var H=Oi.charCodeAt(Y-1),et=1e5,it=!1;H!==q.charCodeAt(0);){if(++H===Ti&&H++,H===Fi&&H++,H>90){if(it)throw"Bad character: "+q;H=Pi,it=!0}et+=1e5}return et}(et.charAt(0),lt),_t=function(q,Y){if(q>"V")throw"MGRSPoint given invalid Northing "+q;for(var H=Ii.charCodeAt(Y-1),et=0,it=!1;H!==q.charCodeAt(0);){if(++H===Ti&&H++,H===Fi&&H++,H>86){if(it)throw"Bad character: "+q;H=Pi,it=!0}et+=1e5}return et}(et.charAt(1),lt);_t<ui(ot);)_t+=2e6;var vt=H-nt;if(vt%2!=0)throw"MGRSPoint has to have an even number \nof digits after the zone letter and two 100km letters - front \nhalf for easting meters, second half for \nnorthing meters"+q;var bt,Mt,Et,Rt=vt/2,It=0,Pt=0;return Rt>0&&(bt=1e5/Math.pow(10,Rt),Mt=q.substring(nt,nt+Rt),It=parseFloat(Mt)*bt,Et=q.substring(nt+Rt),Pt=parseFloat(Et)*bt),{easting:It+mt,northing:Pt+_t,zoneLetter:ot,zoneNumber:st,accuracy:bt}}function ui(q){var Y;switch(q){case"C":Y=11e5;break;case"D":Y=2e6;break;case"E":Y=28e5;break;case"F":Y=37e5;break;case"G":Y=46e5;break;case"H":Y=55e5;break;case"J":Y=64e5;break;case"K":Y=73e5;break;case"L":Y=82e5;break;case"M":Y=91e5;break;case"N":Y=0;break;case"P":Y=8e5;break;case"Q":Y=17e5;break;case"R":Y=26e5;break;case"S":Y=35e5;break;case"T":Y=44e5;break;case"U":Y=53e5;break;case"V":Y=62e5;break;case"W":Y=7e6;break;case"X":Y=79e5;break;default:Y=-1}if(Y>=0)return Y;throw"Invalid zone letter: "+q}function ci(q,Y,H){if(!(this instanceof ci))return new ci(q,Y,H);if(Array.isArray(q))this.x=q[0],this.y=q[1],this.z=q[2]||0;else if("object"==typeof q)this.x=q.x,this.y=q.y,this.z=q.z||0;else if("string"==typeof q&&void 0===Y){var et=q.split(",");this.x=parseFloat(et[0],10),this.y=parseFloat(et[1],10),this.z=parseFloat(et[2],10)||0}else this.x=q,this.y=Y,this.z=H||0;console.warn("proj4.Point will be removed in version 3, use proj4.toPoint")}ci.fromMGRS=function(q){return new ci(ri(q))},ci.prototype.toMGRS=function(q){return ni([this.x,this.y],q)};const Li=ci;var Wi=.046875,Yi=.01953125,Xi=.01068115234375;function mi(q){var Y=[];Y[0]=1-q*(.25+q*(Wi+q*(Yi+q*Xi))),Y[1]=q*(.75-q*(Wi+q*(Yi+q*Xi)));var H=q*q;return Y[2]=H*(.46875-q*(.013020833333333334+.007120768229166667*q)),H*=q,Y[3]=H*(.3645833333333333-.005696614583333333*q),Y[4]=H*q*.3076171875,Y}function yi(q,Y,H,et){return H*=Y,Y*=Y,et[0]*q-H*(et[1]+Y*(et[2]+Y*(et[3]+Y*et[4])))}function _i(q,Y,H){for(var et=1/(1-Y),it=q,nt=20;nt;--nt){var st=Math.sin(it),ot=1-Y*st*st;if(it-=ot=(yi(it,st,Math.cos(it),H)-q)*(ot*Math.sqrt(ot))*et,Math.abs(ot)<ue)return it}return it}const Vi={init:function(){this.x0=void 0!==this.x0?this.x0:0,this.y0=void 0!==this.y0?this.y0:0,this.long0=void 0!==this.long0?this.long0:0,this.lat0=void 0!==this.lat0?this.lat0:0,this.es&&(this.en=mi(this.es),this.ml0=yi(this.lat0,Math.sin(this.lat0),Math.cos(this.lat0),this.en))},forward:function(q){var Y,H,et,it=q.x,nt=q.y,st=me(it-this.long0),ot=Math.sin(nt),lt=Math.cos(nt);if(this.es){var mt=lt*st,_t=Math.pow(mt,2),vt=this.ep2*Math.pow(lt,2),bt=Math.pow(vt,2),Mt=Math.abs(lt)>ue?Math.tan(nt):0,Et=Math.pow(Mt,2),Rt=Math.pow(Et,2);Y=1-this.es*Math.pow(ot,2),mt/=Math.sqrt(Y);var It=yi(nt,ot,lt,this.en);H=this.a*(this.k0*mt*(1+_t/6*(1-Et+vt+_t/20*(5-18*Et+Rt+14*vt-58*Et*vt+_t/42*(61+179*Rt-Rt*Et-479*Et)))))+this.x0,et=this.a*(this.k0*(It-this.ml0+ot*st*mt/2*(1+_t/12*(5-Et+9*vt+4*bt+_t/30*(61+Rt-58*Et+270*vt-330*Et*vt+_t/56*(1385+543*Rt-Rt*Et-3111*Et))))))+this.y0}else{var Pt=lt*Math.sin(st);if(Math.abs(Math.abs(Pt)-1)<ue)return 93;if(H=.5*this.a*this.k0*Math.log((1+Pt)/(1-Pt))+this.x0,et=lt*Math.cos(st)/Math.sqrt(1-Math.pow(Pt,2)),(Pt=Math.abs(et))>=1){if(Pt-1>ue)return 93;et=0}else et=Math.acos(et);nt<0&&(et=-et),et=this.a*this.k0*(et-this.lat0)+this.y0}return q.x=H,q.y=et,q},inverse:function(q){var Y,H,et,it,nt=(q.x-this.x0)*(1/this.a),st=(q.y-this.y0)*(1/this.a);if(this.es)if(H=_i(Y=this.ml0+st/this.k0,this.es,this.en),Math.abs(H)<ne){var ot=Math.sin(H),lt=Math.cos(H),mt=Math.abs(lt)>ue?Math.tan(H):0,_t=this.ep2*Math.pow(lt,2),vt=Math.pow(_t,2),bt=Math.pow(mt,2),Mt=Math.pow(bt,2);Y=1-this.es*Math.pow(ot,2);var Et=nt*Math.sqrt(Y)/this.k0,Rt=Math.pow(Et,2);et=H-(Y*=mt)*Rt/(1-this.es)*.5*(1-Rt/12*(5+3*bt-9*_t*bt+_t-4*vt-Rt/30*(61+90*bt-252*_t*bt+45*Mt+46*_t-Rt/56*(1385+3633*bt+4095*Mt+1574*Mt*bt)))),it=me(this.long0+Et*(1-Rt/6*(1+2*bt+_t-Rt/20*(5+28*bt+24*Mt+8*_t*bt+6*_t-Rt/42*(61+662*bt+1320*Mt+720*Mt*bt))))/lt)}else et=ne*pe(st),it=0;else{var It=Math.exp(nt/this.k0),Pt=.5*(It-1/It),Tt=this.lat0+st/this.k0,Ft=Math.cos(Tt);Y=Math.sqrt((1-Math.pow(Ft,2))/(1+Math.pow(Pt,2))),et=Math.asin(Y),st<0&&(et=-et),it=0===Pt&&0===Ft?0:me(Math.atan2(Pt,Ft)+this.long0)}return q.x=it,q.y=et,q},names:["Fast_Transverse_Mercator","Fast Transverse Mercator"]};function xi(q){var Y=Math.exp(q);return(Y-1/Y)/2}function Si(q,Y){q=Math.abs(q),Y=Math.abs(Y);var H=Math.max(q,Y),et=Math.min(q,Y)/(H||1);return H*Math.sqrt(1+Math.pow(et,2))}function bi(q,Y){for(var H,et=2*Math.cos(2*Y),it=q.length-1,nt=q[it],st=0;--it>=0;)H=et*nt-st+q[it],st=nt,nt=H;return Y+H*Math.sin(2*Y)}function Mi(q,Y,H){for(var et,it,nt=Math.sin(Y),st=Math.cos(Y),ot=xi(H),lt=function(q){var Y=Math.exp(q);return(Y+1/Y)/2}(H),mt=2*st*lt,_t=-2*nt*ot,vt=q.length-1,bt=q[vt],Mt=0,Et=0,Rt=0;--vt>=0;)et=Et,it=Mt,bt=mt*(Et=bt)-et-_t*(Mt=Rt)+q[vt],Rt=_t*Et-it+mt*Mt;return[(mt=nt*lt)*bt-(_t=st*ot)*Rt,mt*Rt+_t*bt]}const Ki={init:function(){if(!this.approx&&(isNaN(this.es)||this.es<=0))throw new Error('Incorrect elliptical usage. Try using the +approx option in the proj string, or PROJECTION["Fast_Transverse_Mercator"] in the WKT.');this.approx&&(Vi.init.apply(this),this.forward=Vi.forward,this.inverse=Vi.inverse),this.x0=void 0!==this.x0?this.x0:0,this.y0=void 0!==this.y0?this.y0:0,this.long0=void 0!==this.long0?this.long0:0,this.lat0=void 0!==this.lat0?this.lat0:0,this.cgb=[],this.cbg=[],this.utg=[],this.gtu=[];var q=this.es/(1+Math.sqrt(1-this.es)),Y=q/(2-q),H=Y;this.cgb[0]=Y*(2+Y*(-2/3+Y*(Y*(116/45+Y*(26/45+Y*(-2854/675)))-2))),this.cbg[0]=Y*(Y*(2/3+Y*(4/3+Y*(-82/45+Y*(32/45+Y*(4642/4725)))))-2),H*=Y,this.cgb[1]=H*(7/3+Y*(Y*(-227/45+Y*(2704/315+Y*(2323/945)))-1.6)),this.cbg[1]=H*(5/3+Y*(-16/15+Y*(-13/9+Y*(904/315+Y*(-1522/945))))),H*=Y,this.cgb[2]=H*(56/15+Y*(-136/35+Y*(-1262/105+Y*(73814/2835)))),this.cbg[2]=H*(-26/15+Y*(34/21+Y*(1.6+Y*(-12686/2835)))),H*=Y,this.cgb[3]=H*(4279/630+Y*(-332/35+Y*(-399572/14175))),this.cbg[3]=H*(1237/630+Y*(Y*(-24832/14175)-2.4)),H*=Y,this.cgb[4]=H*(4174/315+Y*(-144838/6237)),this.cbg[4]=H*(-734/315+Y*(109598/31185)),H*=Y,this.cgb[5]=H*(601676/22275),this.cbg[5]=H*(444337/155925),H=Math.pow(Y,2),this.Qn=this.k0/(1+Y)*(1+H*(1/4+H*(1/64+H/256))),this.utg[0]=Y*(Y*(2/3+Y*(-37/96+Y*(1/360+Y*(81/512+Y*(-96199/604800)))))-.5),this.gtu[0]=Y*(.5+Y*(-2/3+Y*(5/16+Y*(41/180+Y*(-127/288+Y*(7891/37800)))))),this.utg[1]=H*(-1/48+Y*(-1/15+Y*(437/1440+Y*(-46/105+Y*(1118711/3870720))))),this.gtu[1]=H*(13/48+Y*(Y*(557/1440+Y*(281/630+Y*(-1983433/1935360)))-.6)),H*=Y,this.utg[2]=H*(-17/480+Y*(37/840+Y*(209/4480+Y*(-5569/90720)))),this.gtu[2]=H*(61/240+Y*(-103/140+Y*(15061/26880+Y*(167603/181440)))),H*=Y,this.utg[3]=H*(-4397/161280+Y*(11/504+Y*(830251/7257600))),this.gtu[3]=H*(49561/161280+Y*(-179/168+Y*(6601661/7257600))),H*=Y,this.utg[4]=H*(-4583/161280+Y*(108847/3991680)),this.gtu[4]=H*(34729/80640+Y*(-3418889/1995840)),H*=Y,this.utg[5]=H*(-20648693/638668800),this.gtu[5]=.6650675310896665*H;var et=bi(this.cbg,this.lat0);this.Zb=-this.Qn*(et+function(q,Y){for(var H,et=2*Math.cos(Y),it=q.length-1,nt=q[it],st=0;--it>=0;)H=et*nt-st+q[it],st=nt,nt=H;return Math.sin(Y)*H}(this.gtu,2*et))},forward:function(q){var Y=me(q.x-this.long0),H=q.y;H=bi(this.cbg,H);var et=Math.sin(H),it=Math.cos(H),nt=Math.sin(Y),st=Math.cos(Y);H=Math.atan2(et,st*it),Y=Math.atan2(nt*it,Si(et,it*st)),Y=function(q){var Y=Math.abs(q);return Y=function(q){var Y=1+q,H=Y-1;return 0===H?q:q*Math.log(Y)/H}(Y*(1+Y/(Si(1,Y)+1))),q<0?-Y:Y}(Math.tan(Y));var ot,lt,mt=Mi(this.gtu,2*H,2*Y);return H+=mt[0],Y+=mt[1],Math.abs(Y)<=2.623395162778?(ot=this.a*(this.Qn*Y)+this.x0,lt=this.a*(this.Qn*H+this.Zb)+this.y0):(ot=1/0,lt=1/0),q.x=ot,q.y=lt,q},inverse:function(q){var Y,H,et=(q.x-this.x0)*(1/this.a),it=(q.y-this.y0)*(1/this.a);if(it=(it-this.Zb)/this.Qn,et/=this.Qn,Math.abs(et)<=2.623395162778){var nt=Mi(this.utg,2*it,2*et);it+=nt[0],et+=nt[1],et=Math.atan(xi(et));var st=Math.sin(it),ot=Math.cos(it),lt=Math.sin(et),mt=Math.cos(et);it=Math.atan2(st*mt,Si(lt,mt*ot)),Y=me((et=Math.atan2(lt,mt*ot))+this.long0),H=bi(this.cgb,it)}else Y=1/0,H=1/0;return q.x=Y,q.y=H,q},names:["Extended_Transverse_Mercator","Extended Transverse Mercator","etmerc","Transverse_Mercator","Transverse Mercator","tmerc"]},Hi={init:function(){var q=function(q,Y){if(void 0===q){if((q=Math.floor(30*(me(Y)+Math.PI)/Math.PI)+1)<0)return 0;if(q>60)return 60}return q}(this.zone,this.long0);if(void 0===q)throw new Error("unknown utm zone");this.lat0=0,this.long0=(6*Math.abs(q)-183)*ce,this.x0=5e5,this.y0=this.utmSouth?1e7:0,this.k0=.9996,Ki.init.apply(this),this.forward=Ki.forward,this.inverse=Ki.inverse},names:["Universal Transverse Mercator System","utm"],dependsOn:"etmerc"};function Ei(q,Y){return Math.pow((1-q)/(1+q),Y)}const Ji={init:function(){var q=Math.sin(this.lat0),Y=Math.cos(this.lat0);Y*=Y,this.rc=Math.sqrt(1-this.es)/(1-this.es*q*q),this.C=Math.sqrt(1+this.es*Y*Y/(1-this.es)),this.phic0=Math.asin(q/this.C),this.ratexp=.5*this.C*this.e,this.K=Math.tan(.5*this.phic0+xe)/(Math.pow(Math.tan(.5*this.lat0+xe),this.C)*Ei(this.e*q,this.ratexp))},forward:function(q){var Y=q.x,H=q.y;return q.y=2*Math.atan(this.K*Math.pow(Math.tan(.5*H+xe),this.C)*Ei(this.e*Math.sin(H),this.ratexp))-ne,q.x=this.C*Y,q},inverse:function(q){for(var Y=q.x/this.C,H=q.y,et=Math.pow(Math.tan(.5*H+xe)/this.K,1/this.C),it=20;it>0&&(H=2*Math.atan(et*Ei(this.e*Math.sin(q.y),-.5*this.e))-ne,!(Math.abs(H-q.y)<1e-14));--it)q.y=H;return it?(q.x=Y,q.y=H,q):null},names:["gauss"]},Qi={init:function(){Ji.init.apply(this),this.rc&&(this.sinc0=Math.sin(this.phic0),this.cosc0=Math.cos(this.phic0),this.R2=2*this.rc,this.title||(this.title="Oblique Stereographic Alternative"))},forward:function(q){var Y,H,et,it;return q.x=me(q.x-this.long0),Ji.forward.apply(this,[q]),Y=Math.sin(q.y),H=Math.cos(q.y),et=Math.cos(q.x),it=this.k0*this.R2/(1+this.sinc0*Y+this.cosc0*H*et),q.x=it*H*Math.sin(q.x),q.y=it*(this.cosc0*Y-this.sinc0*H*et),q.x=this.a*q.x+this.x0,q.y=this.a*q.y+this.y0,q},inverse:function(q){var Y,H,et,it,nt;if(q.x=(q.x-this.x0)/this.a,q.y=(q.y-this.y0)/this.a,q.x/=this.k0,q.y/=this.k0,nt=Math.sqrt(q.x*q.x+q.y*q.y)){var st=2*Math.atan2(nt,this.R2);Y=Math.sin(st),H=Math.cos(st),it=Math.asin(H*this.sinc0+q.y*Y*this.cosc0/nt),et=Math.atan2(q.x*Y,nt*this.cosc0*H-q.y*this.sinc0*Y)}else it=this.phic0,et=0;return q.x=et,q.y=it,Ji.inverse.apply(this,[q]),q.x=me(q.x+this.long0),q},names:["Stereographic_North_Pole","Oblique_Stereographic","Polar_Stereographic","sterea","Oblique Stereographic Alternative","Double_Stereographic"]},$i={init:function(){this.coslat0=Math.cos(this.lat0),this.sinlat0=Math.sin(this.lat0),this.sphere?1===this.k0&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=ue&&(this.k0=.5*(1+pe(this.lat0)*Math.sin(this.lat_ts))):(Math.abs(this.coslat0)<=ue&&(this.lat0>0?this.con=1:this.con=-1),this.cons=Math.sqrt(Math.pow(1+this.e,1+this.e)*Math.pow(1-this.e,1-this.e)),1===this.k0&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=ue&&(this.k0=.5*this.cons*ge(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts))/ye(this.e,this.con*this.lat_ts,this.con*Math.sin(this.lat_ts))),this.ms1=ge(this.e,this.sinlat0,this.coslat0),this.X0=2*Math.atan(this.ssfn_(this.lat0,this.sinlat0,this.e))-ne,this.cosX0=Math.cos(this.X0),this.sinX0=Math.sin(this.X0))},forward:function(q){var Y,H,et,it,nt,st,ot=q.x,lt=q.y,mt=Math.sin(lt),_t=Math.cos(lt),vt=me(ot-this.long0);return Math.abs(Math.abs(ot-this.long0)-Math.PI)<=ue&&Math.abs(lt+this.lat0)<=ue?(q.x=NaN,q.y=NaN,q):this.sphere?(Y=2*this.k0/(1+this.sinlat0*mt+this.coslat0*_t*Math.cos(vt)),q.x=this.a*Y*_t*Math.sin(vt)+this.x0,q.y=this.a*Y*(this.coslat0*mt-this.sinlat0*_t*Math.cos(vt))+this.y0,q):(H=2*Math.atan(this.ssfn_(lt,mt,this.e))-ne,it=Math.cos(H),et=Math.sin(H),Math.abs(this.coslat0)<=ue?(nt=ye(this.e,lt*this.con,this.con*mt),st=2*this.a*this.k0*nt/this.cons,q.x=this.x0+st*Math.sin(ot-this.long0),q.y=this.y0-this.con*st*Math.cos(ot-this.long0),q):(Math.abs(this.sinlat0)<ue?(Y=2*this.a*this.k0/(1+it*Math.cos(vt)),q.y=Y*et):(Y=2*this.a*this.k0*this.ms1/(this.cosX0*(1+this.sinX0*et+this.cosX0*it*Math.cos(vt))),q.y=Y*(this.cosX0*et-this.sinX0*it*Math.cos(vt))+this.y0),q.x=Y*it*Math.sin(vt)+this.x0,q))},inverse:function(q){var Y,H,et,it,nt;q.x-=this.x0,q.y-=this.y0;var st=Math.sqrt(q.x*q.x+q.y*q.y);if(this.sphere){var ot=2*Math.atan(st/(2*this.a*this.k0));return Y=this.long0,H=this.lat0,st<=ue?(q.x=Y,q.y=H,q):(H=Math.asin(Math.cos(ot)*this.sinlat0+q.y*Math.sin(ot)*this.coslat0/st),Y=Math.abs(this.coslat0)<ue?this.lat0>0?me(this.long0+Math.atan2(q.x,-1*q.y)):me(this.long0+Math.atan2(q.x,q.y)):me(this.long0+Math.atan2(q.x*Math.sin(ot),st*this.coslat0*Math.cos(ot)-q.y*this.sinlat0*Math.sin(ot))),q.x=Y,q.y=H,q)}if(Math.abs(this.coslat0)<=ue){if(st<=ue)return H=this.lat0,Y=this.long0,q.x=Y,q.y=H,q;q.x*=this.con,q.y*=this.con,et=st*this.cons/(2*this.a*this.k0),H=this.con*_e(this.e,et),Y=this.con*me(this.con*this.long0+Math.atan2(q.x,-1*q.y))}else it=2*Math.atan(st*this.cosX0/(2*this.a*this.k0*this.ms1)),Y=this.long0,st<=ue?nt=this.X0:(nt=Math.asin(Math.cos(it)*this.sinX0+q.y*Math.sin(it)*this.cosX0/st),Y=me(this.long0+Math.atan2(q.x*Math.sin(it),st*this.cosX0*Math.cos(it)-q.y*this.sinX0*Math.sin(it)))),H=-1*_e(this.e,Math.tan(.5*(ne+nt)));return q.x=Y,q.y=H,q},names:["stere","Stereographic_South_Pole","Polar Stereographic (variant B)"],ssfn_:function(q,Y,H){return Y*=H,Math.tan(.5*(ne+q))*Math.pow((1-Y)/(1+Y),.5*H)}},tr={init:function(){var q=this.lat0;this.lambda0=this.long0;var Y=Math.sin(q),H=this.a,et=1/this.rf,it=2*et-Math.pow(et,2),nt=this.e=Math.sqrt(it);this.R=this.k0*H*Math.sqrt(1-it)/(1-it*Math.pow(Y,2)),this.alpha=Math.sqrt(1+it/(1-it)*Math.pow(Math.cos(q),4)),this.b0=Math.asin(Y/this.alpha);var st=Math.log(Math.tan(Math.PI/4+this.b0/2)),ot=Math.log(Math.tan(Math.PI/4+q/2)),lt=Math.log((1+nt*Y)/(1-nt*Y));this.K=st-this.alpha*ot+this.alpha*nt/2*lt},forward:function(q){var Y=Math.log(Math.tan(Math.PI/4-q.y/2)),H=this.e/2*Math.log((1+this.e*Math.sin(q.y))/(1-this.e*Math.sin(q.y))),et=-this.alpha*(Y+H)+this.K,it=2*(Math.atan(Math.exp(et))-Math.PI/4),nt=this.alpha*(q.x-this.lambda0),st=Math.atan(Math.sin(nt)/(Math.sin(this.b0)*Math.tan(it)+Math.cos(this.b0)*Math.cos(nt))),ot=Math.asin(Math.cos(this.b0)*Math.sin(it)-Math.sin(this.b0)*Math.cos(it)*Math.cos(nt));return q.y=this.R/2*Math.log((1+Math.sin(ot))/(1-Math.sin(ot)))+this.y0,q.x=this.R*st+this.x0,q},inverse:function(q){for(var Y=q.x-this.x0,H=q.y-this.y0,et=Y/this.R,it=2*(Math.atan(Math.exp(H/this.R))-Math.PI/4),nt=Math.asin(Math.cos(this.b0)*Math.sin(it)+Math.sin(this.b0)*Math.cos(it)*Math.cos(et)),st=Math.atan(Math.sin(et)/(Math.cos(this.b0)*Math.cos(et)-Math.sin(this.b0)*Math.tan(it))),ot=this.lambda0+st/this.alpha,lt=0,mt=nt,_t=-1e3,vt=0;Math.abs(mt-_t)>1e-7;){if(++vt>20)return;lt=1/this.alpha*(Math.log(Math.tan(Math.PI/4+nt/2))-this.K)+this.e*Math.log(Math.tan(Math.PI/4+Math.asin(this.e*Math.sin(mt))/2)),_t=mt,mt=2*Math.atan(Math.exp(lt))-Math.PI/2}return q.x=ot,q.y=mt,q},names:["somerc"]};var er=1e-7;const ir={init:function(){var q,Y,H,et,it,nt,st,ot,lt,mt,_t,vt,bt,Mt=0,Et=0,Rt=0,It=0,Pt=0,Tt=0,Ft=0;this.no_off=(bt="object"==typeof(vt=this).PROJECTION?Object.keys(vt.PROJECTION)[0]:vt.PROJECTION,"no_uoff"in vt||"no_off"in vt||-1!==["Hotine_Oblique_Mercator","Hotine_Oblique_Mercator_Azimuth_Natural_Origin"].indexOf(bt)),this.no_rot="no_rot"in this;var At=!1;"alpha"in this&&(At=!0);var Lt=!1;if("rectified_grid_angle"in this&&(Lt=!0),At&&(Ft=this.alpha),Lt&&(Mt=this.rectified_grid_angle*ce),At||Lt)Et=this.longc;else if(Rt=this.long1,Pt=this.lat1,It=this.long2,Tt=this.lat2,Math.abs(Pt-Tt)<=er||(q=Math.abs(Pt))<=er||Math.abs(q-ne)<=er||Math.abs(Math.abs(this.lat0)-ne)<=er||Math.abs(Math.abs(Tt)-ne)<=er)throw new Error;var Nt=1-this.es;Y=Math.sqrt(Nt),Math.abs(this.lat0)>ue?(ot=Math.sin(this.lat0),H=Math.cos(this.lat0),q=1-this.es*ot*ot,this.B=H*H,this.B=Math.sqrt(1+this.es*this.B*this.B/Nt),this.A=this.B*this.k0*Y/q,(it=(et=this.B*Y/(H*Math.sqrt(q)))*et-1)<=0?it=0:(it=Math.sqrt(it),this.lat0<0&&(it=-it)),this.E=it+=et,this.E*=Math.pow(ye(this.e,this.lat0,ot),this.B)):(this.B=1/Y,this.A=this.k0,this.E=et=it=1),At||Lt?(At?(_t=Math.asin(Math.sin(Ft)/et),Lt||(Mt=Ft)):(_t=Mt,Ft=Math.asin(et*Math.sin(_t))),this.lam0=Et-Math.asin(.5*(it-1/it)*Math.tan(_t))/this.B):(nt=Math.pow(ye(this.e,Pt,Math.sin(Pt)),this.B),st=Math.pow(ye(this.e,Tt,Math.sin(Tt)),this.B),it=this.E/nt,lt=(st-nt)/(st+nt),mt=((mt=this.E*this.E)-st*nt)/(mt+st*nt),(q=Rt-It)<-Math.pi?It-=Se:q>Math.pi&&(It+=Se),this.lam0=me(.5*(Rt+It)-Math.atan(mt*Math.tan(.5*this.B*(Rt-It))/lt)/this.B),_t=Math.atan(2*Math.sin(this.B*me(Rt-this.lam0))/(it-1/it)),Mt=Ft=Math.asin(et*Math.sin(_t))),this.singam=Math.sin(_t),this.cosgam=Math.cos(_t),this.sinrot=Math.sin(Mt),this.cosrot=Math.cos(Mt),this.rB=1/this.B,this.ArB=this.A*this.rB,this.BrA=1/this.ArB,this.A,this.B,this.no_off?this.u_0=0:(this.u_0=Math.abs(this.ArB*Math.atan(Math.sqrt(et*et-1)/Math.cos(Ft))),this.lat0<0&&(this.u_0=-this.u_0)),it=.5*_t,this.v_pole_n=this.ArB*Math.log(Math.tan(xe-it)),this.v_pole_s=this.ArB*Math.log(Math.tan(xe+it))},forward:function(q){var Y,H,et,it,nt,st,ot,lt,mt={};if(q.x=q.x-this.lam0,Math.abs(Math.abs(q.y)-ne)>ue){if(Y=.5*((nt=this.E/Math.pow(ye(this.e,q.y,Math.sin(q.y)),this.B))-(st=1/nt)),H=.5*(nt+st),it=Math.sin(this.B*q.x),et=(Y*this.singam-it*this.cosgam)/H,Math.abs(Math.abs(et)-1)<ue)throw new Error;lt=.5*this.ArB*Math.log((1-et)/(1+et)),st=Math.cos(this.B*q.x),ot=Math.abs(st)<er?this.A*q.x:this.ArB*Math.atan2(Y*this.cosgam+it*this.singam,st)}else lt=q.y>0?this.v_pole_n:this.v_pole_s,ot=this.ArB*q.y;return this.no_rot?(mt.x=ot,mt.y=lt):(ot-=this.u_0,mt.x=lt*this.cosrot+ot*this.sinrot,mt.y=ot*this.cosrot-lt*this.sinrot),mt.x=this.a*mt.x+this.x0,mt.y=this.a*mt.y+this.y0,mt},inverse:function(q){var Y,H,et,it,nt,st,ot,lt={};if(q.x=(q.x-this.x0)*(1/this.a),q.y=(q.y-this.y0)*(1/this.a),this.no_rot?(H=q.y,Y=q.x):(H=q.x*this.cosrot-q.y*this.sinrot,Y=q.y*this.cosrot+q.x*this.sinrot+this.u_0),it=.5*((et=Math.exp(-this.BrA*H))-1/et),nt=.5*(et+1/et),ot=((st=Math.sin(this.BrA*Y))*this.cosgam+it*this.singam)/nt,Math.abs(Math.abs(ot)-1)<ue)lt.x=0,lt.y=ot<0?-ne:ne;else{if(lt.y=this.E/Math.sqrt((1+ot)/(1-ot)),lt.y=_e(this.e,Math.pow(lt.y,1/this.B)),lt.y===1/0)throw new Error;lt.x=-this.rB*Math.atan2(it*this.cosgam-st*this.singam,Math.cos(this.BrA*Y))}return lt.x+=this.lam0,lt},names:["Hotine_Oblique_Mercator","Hotine Oblique Mercator","Hotine_Oblique_Mercator_Azimuth_Natural_Origin","Hotine_Oblique_Mercator_Two_Point_Natural_Origin","Hotine_Oblique_Mercator_Azimuth_Center","Oblique_Mercator","omerc"]},rr={init:function(){if(this.lat2||(this.lat2=this.lat1),this.k0||(this.k0=1),this.x0=this.x0||0,this.y0=this.y0||0,!(Math.abs(this.lat1+this.lat2)<ue)){var q=this.b/this.a;this.e=Math.sqrt(1-q*q);var Y=Math.sin(this.lat1),H=Math.cos(this.lat1),et=ge(this.e,Y,H),it=ye(this.e,this.lat1,Y),nt=Math.sin(this.lat2),st=Math.cos(this.lat2),ot=ge(this.e,nt,st),lt=ye(this.e,this.lat2,nt),mt=ye(this.e,this.lat0,Math.sin(this.lat0));Math.abs(this.lat1-this.lat2)>ue?this.ns=Math.log(et/ot)/Math.log(it/lt):this.ns=Y,isNaN(this.ns)&&(this.ns=Y),this.f0=et/(this.ns*Math.pow(it,this.ns)),this.rh=this.a*this.f0*Math.pow(mt,this.ns),this.title||(this.title="Lambert Conformal Conic")}},forward:function(q){var Y=q.x,H=q.y;Math.abs(2*Math.abs(H)-Math.PI)<=ue&&(H=pe(H)*(ne-2e-10));var et,it,nt=Math.abs(Math.abs(H)-ne);if(nt>ue)et=ye(this.e,H,Math.sin(H)),it=this.a*this.f0*Math.pow(et,this.ns);else{if((nt=H*this.ns)<=0)return null;it=0}var st=this.ns*me(Y-this.long0);return q.x=this.k0*(it*Math.sin(st))+this.x0,q.y=this.k0*(this.rh-it*Math.cos(st))+this.y0,q},inverse:function(q){var Y,H,et,it,nt,st=(q.x-this.x0)/this.k0,ot=this.rh-(q.y-this.y0)/this.k0;this.ns>0?(Y=Math.sqrt(st*st+ot*ot),H=1):(Y=-Math.sqrt(st*st+ot*ot),H=-1);var lt=0;if(0!==Y&&(lt=Math.atan2(H*st,H*ot)),0!==Y||this.ns>0){if(H=1/this.ns,et=Math.pow(Y/(this.a*this.f0),H),-9999===(it=_e(this.e,et)))return null}else it=-ne;return nt=me(lt/this.ns+this.long0),q.x=nt,q.y=it,q},names:["Lambert Tangential Conformal Conic Projection","Lambert_Conformal_Conic","Lambert_Conformal_Conic_1SP","Lambert_Conformal_Conic_2SP","lcc","Lambert Conic Conformal (1SP)","Lambert Conic Conformal (2SP)"]},nr={init:function(){this.a=6377397.155,this.es=.006674372230614,this.e=Math.sqrt(this.es),this.lat0||(this.lat0=.863937979737193),this.long0||(this.long0=.4334234309119251),this.k0||(this.k0=.9999),this.s45=.785398163397448,this.s90=2*this.s45,this.fi0=this.lat0,this.e2=this.es,this.e=Math.sqrt(this.e2),this.alfa=Math.sqrt(1+this.e2*Math.pow(Math.cos(this.fi0),4)/(1-this.e2)),this.uq=1.04216856380474,this.u0=Math.asin(Math.sin(this.fi0)/this.alfa),this.g=Math.pow((1+this.e*Math.sin(this.fi0))/(1-this.e*Math.sin(this.fi0)),this.alfa*this.e/2),this.k=Math.tan(this.u0/2+this.s45)/Math.pow(Math.tan(this.fi0/2+this.s45),this.alfa)*this.g,this.k1=this.k0,this.n0=this.a*Math.sqrt(1-this.e2)/(1-this.e2*Math.pow(Math.sin(this.fi0),2)),this.s0=1.37008346281555,this.n=Math.sin(this.s0),this.ro0=this.k1*this.n0/Math.tan(this.s0),this.ad=this.s90-this.uq},forward:function(q){var Y,H,et,it,nt,st,ot,lt=q.x,mt=q.y,_t=me(lt-this.long0);return Y=Math.pow((1+this.e*Math.sin(mt))/(1-this.e*Math.sin(mt)),this.alfa*this.e/2),H=2*(Math.atan(this.k*Math.pow(Math.tan(mt/2+this.s45),this.alfa)/Y)-this.s45),et=-_t*this.alfa,it=Math.asin(Math.cos(this.ad)*Math.sin(H)+Math.sin(this.ad)*Math.cos(H)*Math.cos(et)),nt=Math.asin(Math.cos(H)*Math.sin(et)/Math.cos(it)),st=this.n*nt,ot=this.ro0*Math.pow(Math.tan(this.s0/2+this.s45),this.n)/Math.pow(Math.tan(it/2+this.s45),this.n),q.y=ot*Math.cos(st)/1,q.x=ot*Math.sin(st)/1,this.czech||(q.y*=-1,q.x*=-1),q},inverse:function(q){var Y,H,et,it,nt,st,ot,lt=q.x;q.x=q.y,q.y=lt,this.czech||(q.y*=-1,q.x*=-1),nt=Math.sqrt(q.x*q.x+q.y*q.y),it=Math.atan2(q.y,q.x)/Math.sin(this.s0),et=2*(Math.atan(Math.pow(this.ro0/nt,1/this.n)*Math.tan(this.s0/2+this.s45))-this.s45),Y=Math.asin(Math.cos(this.ad)*Math.sin(et)-Math.sin(this.ad)*Math.cos(et)*Math.cos(it)),H=Math.asin(Math.cos(et)*Math.sin(it)/Math.cos(Y)),q.x=this.long0-H/this.alfa,st=Y,ot=0;var mt=0;do{q.y=2*(Math.atan(Math.pow(this.k,-1/this.alfa)*Math.pow(Math.tan(Y/2+this.s45),1/this.alfa)*Math.pow((1+this.e*Math.sin(st))/(1-this.e*Math.sin(st)),this.e/2))-this.s45),Math.abs(st-q.y)<1e-10&&(ot=1),st=q.y,mt+=1}while(0===ot&&mt<15);return mt>=15?null:q},names:["Krovak","krovak"]};function Ni(q,Y,H,et,it){return q*it-Y*Math.sin(2*it)+H*Math.sin(4*it)-et*Math.sin(6*it)}function ki(q){return 1-.25*q*(1+q/16*(3+1.25*q))}function Gi(q){return.375*q*(1+.25*q*(1+.46875*q))}function ji(q){return.05859375*q*q*(1+.75*q)}function Di(q){return q*q*q*(35/3072)}function zi(q,Y,H){var et=Y*H;return q/Math.sqrt(1-et*et)}function Ui(q){return Math.abs(q)<ne?q:q-pe(q)*Math.PI}function Bi(q,Y,H,et,it){var nt,st;nt=q/Y;for(var ot=0;ot<15;ot++)if(nt+=st=(q-(Y*nt-H*Math.sin(2*nt)+et*Math.sin(4*nt)-it*Math.sin(6*nt)))/(Y-2*H*Math.cos(2*nt)+4*et*Math.cos(4*nt)-6*it*Math.cos(6*nt)),Math.abs(st)<=1e-10)return nt;return NaN}const sr={init:function(){this.sphere||(this.e0=ki(this.es),this.e1=Gi(this.es),this.e2=ji(this.es),this.e3=Di(this.es),this.ml0=this.a*Ni(this.e0,this.e1,this.e2,this.e3,this.lat0))},forward:function(q){var Y,H,et=q.x,it=q.y;if(et=me(et-this.long0),this.sphere)Y=this.a*Math.asin(Math.cos(it)*Math.sin(et)),H=this.a*(Math.atan2(Math.tan(it),Math.cos(et))-this.lat0);else{var nt=Math.sin(it),st=Math.cos(it),ot=zi(this.a,this.e,nt),lt=Math.tan(it)*Math.tan(it),mt=et*Math.cos(it),_t=mt*mt,vt=this.es*st*st/(1-this.es);Y=ot*mt*(1-_t*lt*(1/6-(8-lt+8*vt)*_t/120)),H=this.a*Ni(this.e0,this.e1,this.e2,this.e3,it)-this.ml0+ot*nt/st*_t*(.5+(5-lt+6*vt)*_t/24)}return q.x=Y+this.x0,q.y=H+this.y0,q},inverse:function(q){q.x-=this.x0,q.y-=this.y0;var Y,H,et=q.x/this.a,it=q.y/this.a;if(this.sphere){var nt=it+this.lat0;Y=Math.asin(Math.sin(nt)*Math.cos(et)),H=Math.atan2(Math.tan(et),Math.cos(nt))}else{var st=Bi(this.ml0/this.a+it,this.e0,this.e1,this.e2,this.e3);if(Math.abs(Math.abs(st)-ne)<=ue)return q.x=this.long0,q.y=ne,it<0&&(q.y*=-1),q;var ot=zi(this.a,this.e,Math.sin(st)),lt=ot*ot*ot/this.a/this.a*(1-this.es),mt=Math.pow(Math.tan(st),2),_t=et*this.a/ot,vt=_t*_t;Y=st-ot*Math.tan(st)/lt*_t*_t*(.5-(1+3*mt)*_t*_t/24),H=_t*(1-vt*(mt/3+(1+3*mt)*mt*vt/15))/Math.cos(st)}return q.x=me(H+this.long0),q.y=Ui(Y),q},names:["Cassini","Cassini_Soldner","cass"]};function qi(q,Y){var H;return q>1e-7?(1-q*q)*(Y/(1-(H=q*Y)*H)-.5/q*Math.log((1-H)/(1+H))):2*Y}const or={init:function(){var q,Y=Math.abs(this.lat0);if(Math.abs(Y-ne)<ue?this.mode=this.lat0<0?this.S_POLE:this.N_POLE:Math.abs(Y)<ue?this.mode=this.EQUIT:this.mode=this.OBLIQ,this.es>0)switch(this.qp=qi(this.e,1),this.mmf=.5/(1-this.es),this.apa=function(q){var Y,H=[];return H[0]=.3333333333333333*q,Y=q*q,H[0]+=.17222222222222222*Y,H[1]=.06388888888888888*Y,Y*=q,H[0]+=.10257936507936508*Y,H[1]+=.0664021164021164*Y,H[2]=.016415012942191543*Y,H}(this.es),this.mode){case this.N_POLE:case this.S_POLE:this.dd=1;break;case this.EQUIT:this.rq=Math.sqrt(.5*this.qp),this.dd=1/this.rq,this.xmf=1,this.ymf=.5*this.qp;break;case this.OBLIQ:this.rq=Math.sqrt(.5*this.qp),q=Math.sin(this.lat0),this.sinb1=qi(this.e,q)/this.qp,this.cosb1=Math.sqrt(1-this.sinb1*this.sinb1),this.dd=Math.cos(this.lat0)/(Math.sqrt(1-this.es*q*q)*this.rq*this.cosb1),this.ymf=(this.xmf=this.rq)/this.dd,this.xmf*=this.dd}else this.mode===this.OBLIQ&&(this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0))},forward:function(q){var Y,H,et,it,nt,st,ot,lt,mt,_t,vt=q.x,bt=q.y;if(vt=me(vt-this.long0),this.sphere){if(nt=Math.sin(bt),_t=Math.cos(bt),et=Math.cos(vt),this.mode===this.OBLIQ||this.mode===this.EQUIT){if((H=this.mode===this.EQUIT?1+_t*et:1+this.sinph0*nt+this.cosph0*_t*et)<=ue)return null;Y=(H=Math.sqrt(2/H))*_t*Math.sin(vt),H*=this.mode===this.EQUIT?nt:this.cosph0*nt-this.sinph0*_t*et}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(et=-et),Math.abs(bt+this.lat0)<ue)return null;H=xe-.5*bt,Y=(H=2*(this.mode===this.S_POLE?Math.cos(H):Math.sin(H)))*Math.sin(vt),H*=et}}else{switch(ot=0,lt=0,mt=0,et=Math.cos(vt),it=Math.sin(vt),nt=Math.sin(bt),st=qi(this.e,nt),this.mode!==this.OBLIQ&&this.mode!==this.EQUIT||(ot=st/this.qp,lt=Math.sqrt(1-ot*ot)),this.mode){case this.OBLIQ:mt=1+this.sinb1*ot+this.cosb1*lt*et;break;case this.EQUIT:mt=1+lt*et;break;case this.N_POLE:mt=ne+bt,st=this.qp-st;break;case this.S_POLE:mt=bt-ne,st=this.qp+st}if(Math.abs(mt)<ue)return null;switch(this.mode){case this.OBLIQ:case this.EQUIT:mt=Math.sqrt(2/mt),H=this.mode===this.OBLIQ?this.ymf*mt*(this.cosb1*ot-this.sinb1*lt*et):(mt=Math.sqrt(2/(1+lt*et)))*ot*this.ymf,Y=this.xmf*mt*lt*it;break;case this.N_POLE:case this.S_POLE:st>=0?(Y=(mt=Math.sqrt(st))*it,H=et*(this.mode===this.S_POLE?mt:-mt)):Y=H=0}}return q.x=this.a*Y+this.x0,q.y=this.a*H+this.y0,q},inverse:function(q){q.x-=this.x0,q.y-=this.y0;var Y,H,et,it,nt,st,ot,lt,mt,_t,vt=q.x/this.a,bt=q.y/this.a;if(this.sphere){var Mt,Et=0,Rt=0;if((H=.5*(Mt=Math.sqrt(vt*vt+bt*bt)))>1)return null;switch(H=2*Math.asin(H),this.mode!==this.OBLIQ&&this.mode!==this.EQUIT||(Rt=Math.sin(H),Et=Math.cos(H)),this.mode){case this.EQUIT:H=Math.abs(Mt)<=ue?0:Math.asin(bt*Rt/Mt),vt*=Rt,bt=Et*Mt;break;case this.OBLIQ:H=Math.abs(Mt)<=ue?this.lat0:Math.asin(Et*this.sinph0+bt*Rt*this.cosph0/Mt),vt*=Rt*this.cosph0,bt=(Et-Math.sin(H)*this.sinph0)*Mt;break;case this.N_POLE:bt=-bt,H=ne-H;break;case this.S_POLE:H-=ne}Y=0!==bt||this.mode!==this.EQUIT&&this.mode!==this.OBLIQ?Math.atan2(vt,bt):0}else{if(ot=0,this.mode===this.OBLIQ||this.mode===this.EQUIT){if(vt/=this.dd,bt*=this.dd,(st=Math.sqrt(vt*vt+bt*bt))<ue)return q.x=this.long0,q.y=this.lat0,q;it=2*Math.asin(.5*st/this.rq),et=Math.cos(it),vt*=it=Math.sin(it),this.mode===this.OBLIQ?(ot=et*this.sinb1+bt*it*this.cosb1/st,nt=this.qp*ot,bt=st*this.cosb1*et-bt*this.sinb1*it):(ot=bt*it/st,nt=this.qp*ot,bt=st*et)}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(bt=-bt),!(nt=vt*vt+bt*bt))return q.x=this.long0,q.y=this.lat0,q;ot=1-nt/this.qp,this.mode===this.S_POLE&&(ot=-ot)}Y=Math.atan2(vt,bt),_t=(lt=Math.asin(ot))+lt,H=lt+(mt=this.apa)[0]*Math.sin(_t)+mt[1]*Math.sin(_t+_t)+mt[2]*Math.sin(_t+_t+_t)}return q.x=me(this.long0+Y),q.y=H,q},names:["Lambert Azimuthal Equal Area","Lambert_Azimuthal_Equal_Area","laea"],S_POLE:1,N_POLE:2,EQUIT:3,OBLIQ:4};function Zi(q){return Math.abs(q)>1&&(q=q>1?1:-1),Math.asin(q)}const ar={init:function(){Math.abs(this.lat1+this.lat2)<ue||(this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e3=Math.sqrt(this.es),this.sin_po=Math.sin(this.lat1),this.cos_po=Math.cos(this.lat1),this.t1=this.sin_po,this.con=this.sin_po,this.ms1=ge(this.e3,this.sin_po,this.cos_po),this.qs1=qi(this.e3,this.sin_po,this.cos_po),this.sin_po=Math.sin(this.lat2),this.cos_po=Math.cos(this.lat2),this.t2=this.sin_po,this.ms2=ge(this.e3,this.sin_po,this.cos_po),this.qs2=qi(this.e3,this.sin_po,this.cos_po),this.sin_po=Math.sin(this.lat0),this.cos_po=Math.cos(this.lat0),this.t3=this.sin_po,this.qs0=qi(this.e3,this.sin_po,this.cos_po),Math.abs(this.lat1-this.lat2)>ue?this.ns0=(this.ms1*this.ms1-this.ms2*this.ms2)/(this.qs2-this.qs1):this.ns0=this.con,this.c=this.ms1*this.ms1+this.ns0*this.qs1,this.rh=this.a*Math.sqrt(this.c-this.ns0*this.qs0)/this.ns0)},forward:function(q){var Y=q.x,H=q.y;this.sin_phi=Math.sin(H),this.cos_phi=Math.cos(H);var et=qi(this.e3,this.sin_phi,this.cos_phi),it=this.a*Math.sqrt(this.c-this.ns0*et)/this.ns0,nt=this.ns0*me(Y-this.long0),st=it*Math.sin(nt)+this.x0,ot=this.rh-it*Math.cos(nt)+this.y0;return q.x=st,q.y=ot,q},inverse:function(q){var Y,H,et,it,nt,st;return q.x-=this.x0,q.y=this.rh-q.y+this.y0,this.ns0>=0?(Y=Math.sqrt(q.x*q.x+q.y*q.y),et=1):(Y=-Math.sqrt(q.x*q.x+q.y*q.y),et=-1),it=0,0!==Y&&(it=Math.atan2(et*q.x,et*q.y)),et=Y*this.ns0/this.a,this.sphere?st=Math.asin((this.c-et*et)/(2*this.ns0)):(H=(this.c-et*et)/this.ns0,st=this.phi1z(this.e3,H)),nt=me(it/this.ns0+this.long0),q.x=nt,q.y=st,q},names:["Albers_Conic_Equal_Area","Albers","aea"],phi1z:function(q,Y){var H,et,it,nt,st=Zi(.5*Y);if(q<ue)return st;for(var ot=q*q,lt=1;lt<=25;lt++)if(st+=nt=.5*(it=1-(et=q*(H=Math.sin(st)))*et)*it/Math.cos(st)*(Y/(1-ot)-H/it+.5/q*Math.log((1-et)/(1+et))),Math.abs(nt)<=1e-7)return st;return null}},hr={init:function(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0),this.infinity_dist=1e3*this.a,this.rc=1},forward:function(q){var Y,H,et,it,nt,st,ot,lt=q.x,mt=q.y;return et=me(lt-this.long0),Y=Math.sin(mt),H=Math.cos(mt),it=Math.cos(et),(nt=this.sin_p14*Y+this.cos_p14*H*it)>0||Math.abs(nt)<=ue?(st=this.x0+1*this.a*H*Math.sin(et)/nt,ot=this.y0+1*this.a*(this.cos_p14*Y-this.sin_p14*H*it)/nt):(st=this.x0+this.infinity_dist*H*Math.sin(et),ot=this.y0+this.infinity_dist*(this.cos_p14*Y-this.sin_p14*H*it)),q.x=st,q.y=ot,q},inverse:function(q){var Y,H,et,it,nt,st;return q.x=(q.x-this.x0)/this.a,q.y=(q.y-this.y0)/this.a,q.x/=this.k0,q.y/=this.k0,(Y=Math.sqrt(q.x*q.x+q.y*q.y))?(it=Math.atan2(Y,this.rc),H=Math.sin(it),st=Zi((et=Math.cos(it))*this.sin_p14+q.y*H*this.cos_p14/Y),nt=Math.atan2(q.x*H,Y*this.cos_p14*et-q.y*this.sin_p14*H),nt=me(this.long0+nt)):(st=this.phic0,nt=0),q.x=nt,q.y=st,q},names:["gnom"]},lr={init:function(){this.sphere||(this.k0=ge(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)))},forward:function(q){var Y,H,et=q.x,it=q.y,nt=me(et-this.long0);if(this.sphere)Y=this.x0+this.a*nt*Math.cos(this.lat_ts),H=this.y0+this.a*Math.sin(it)/Math.cos(this.lat_ts);else{var st=qi(this.e,Math.sin(it));Y=this.x0+this.a*this.k0*nt,H=this.y0+this.a*st*.5/this.k0}return q.x=Y,q.y=H,q},inverse:function(q){var Y,H;return q.x-=this.x0,q.y-=this.y0,this.sphere?(Y=me(this.long0+q.x/this.a/Math.cos(this.lat_ts)),H=Math.asin(q.y/this.a*Math.cos(this.lat_ts))):(H=function(q,Y){var H=1-(1-q*q)/(2*q)*Math.log((1-q)/(1+q));if(Math.abs(Math.abs(Y)-H)<1e-6)return Y<0?-1*ne:ne;for(var et,it,nt,st,ot=Math.asin(.5*Y),lt=0;lt<30;lt++)if(it=Math.sin(ot),nt=Math.cos(ot),st=q*it,ot+=et=Math.pow(1-st*st,2)/(2*nt)*(Y/(1-q*q)-it/(1-st*st)+.5/q*Math.log((1-st)/(1+st))),Math.abs(et)<=1e-10)return ot;return NaN}(this.e,2*q.y*this.k0/this.a),Y=me(this.long0+q.x/(this.a*this.k0))),q.x=Y,q.y=H,q},names:["cea"]},ur={init:function(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Equidistant Cylindrical (Plate Carre)",this.rc=Math.cos(this.lat_ts)},forward:function(q){var Y=q.x,H=q.y,et=me(Y-this.long0),it=Ui(H-this.lat0);return q.x=this.x0+this.a*et*this.rc,q.y=this.y0+this.a*it,q},inverse:function(q){var Y=q.x,H=q.y;return q.x=me(this.long0+(Y-this.x0)/(this.a*this.rc)),q.y=Ui(this.lat0+(H-this.y0)/this.a),q},names:["Equirectangular","Equidistant_Cylindrical","eqc"]},cr={init:function(){this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=ki(this.es),this.e1=Gi(this.es),this.e2=ji(this.es),this.e3=Di(this.es),this.ml0=this.a*Ni(this.e0,this.e1,this.e2,this.e3,this.lat0)},forward:function(q){var Y,H,et,it=q.x,nt=q.y,st=me(it-this.long0);if(et=st*Math.sin(nt),this.sphere)Math.abs(nt)<=ue?(Y=this.a*st,H=-1*this.a*this.lat0):(Y=this.a*Math.sin(et)/Math.tan(nt),H=this.a*(Ui(nt-this.lat0)+(1-Math.cos(et))/Math.tan(nt)));else if(Math.abs(nt)<=ue)Y=this.a*st,H=-1*this.ml0;else{var ot=zi(this.a,this.e,Math.sin(nt))/Math.tan(nt);Y=ot*Math.sin(et),H=this.a*Ni(this.e0,this.e1,this.e2,this.e3,nt)-this.ml0+ot*(1-Math.cos(et))}return q.x=Y+this.x0,q.y=H+this.y0,q},inverse:function(q){var Y,H,et,it,nt,st,ot,lt,mt;if(et=q.x-this.x0,it=q.y-this.y0,this.sphere)if(Math.abs(it+this.a*this.lat0)<=ue)Y=me(et/this.a+this.long0),H=0;else{var _t;for(st=this.lat0+it/this.a,ot=et*et/this.a/this.a+st*st,lt=st,nt=20;nt;--nt)if(lt+=mt=-1*(st*(lt*(_t=Math.tan(lt))+1)-lt-.5*(lt*lt+ot)*_t)/((lt-st)/_t-1),Math.abs(mt)<=ue){H=lt;break}Y=me(this.long0+Math.asin(et*Math.tan(lt)/this.a)/Math.sin(H))}else if(Math.abs(it+this.ml0)<=ue)H=0,Y=me(this.long0+et/this.a);else{var vt,bt,Mt,Et,Rt;for(st=(this.ml0+it)/this.a,ot=et*et/this.a/this.a+st*st,lt=st,nt=20;nt;--nt)if(Rt=this.e*Math.sin(lt),vt=Math.sqrt(1-Rt*Rt)*Math.tan(lt),bt=this.a*Ni(this.e0,this.e1,this.e2,this.e3,lt),Mt=this.e0-2*this.e1*Math.cos(2*lt)+4*this.e2*Math.cos(4*lt)-6*this.e3*Math.cos(6*lt),lt-=mt=(st*(vt*(Et=bt/this.a)+1)-Et-.5*vt*(Et*Et+ot))/(this.es*Math.sin(2*lt)*(Et*Et+ot-2*st*Et)/(4*vt)+(st-Et)*(vt*Mt-2/Math.sin(2*lt))-Mt),Math.abs(mt)<=ue){H=lt;break}vt=Math.sqrt(1-this.es*Math.pow(Math.sin(H),2))*Math.tan(H),Y=me(this.long0+Math.asin(et*vt/this.a)/Math.sin(H))}return q.x=Y,q.y=H,q},names:["Polyconic","poly"]},dr={init:function(){this.A=[],this.A[1]=.6399175073,this.A[2]=-.1358797613,this.A[3]=.063294409,this.A[4]=-.02526853,this.A[5]=.0117879,this.A[6]=-.0055161,this.A[7]=.0026906,this.A[8]=-.001333,this.A[9]=67e-5,this.A[10]=-34e-5,this.B_re=[],this.B_im=[],this.B_re[1]=.7557853228,this.B_im[1]=0,this.B_re[2]=.249204646,this.B_im[2]=.003371507,this.B_re[3]=-.001541739,this.B_im[3]=.04105856,this.B_re[4]=-.10162907,this.B_im[4]=.01727609,this.B_re[5]=-.26623489,this.B_im[5]=-.36249218,this.B_re[6]=-.6870983,this.B_im[6]=-1.1651967,this.C_re=[],this.C_im=[],this.C_re[1]=1.3231270439,this.C_im[1]=0,this.C_re[2]=-.577245789,this.C_im[2]=-.007809598,this.C_re[3]=.508307513,this.C_im[3]=-.112208952,this.C_re[4]=-.15094762,this.C_im[4]=.18200602,this.C_re[5]=1.01418179,this.C_im[5]=1.64497696,this.C_re[6]=1.9660549,this.C_im[6]=2.5127645,this.D=[],this.D[1]=1.5627014243,this.D[2]=.5185406398,this.D[3]=-.03333098,this.D[4]=-.1052906,this.D[5]=-.0368594,this.D[6]=.007317,this.D[7]=.0122,this.D[8]=.00394,this.D[9]=-.0013},forward:function(q){var Y,H=q.x,et=q.y-this.lat0,it=H-this.long0,nt=et/ie*1e-5,st=it,ot=1,lt=0;for(Y=1;Y<=10;Y++)ot*=nt,lt+=this.A[Y]*ot;var mt,_t=lt,vt=st,bt=1,Mt=0,Et=0,Rt=0;for(Y=1;Y<=6;Y++)mt=Mt*_t+bt*vt,bt=bt*_t-Mt*vt,Mt=mt,Et=Et+this.B_re[Y]*bt-this.B_im[Y]*Mt,Rt=Rt+this.B_im[Y]*bt+this.B_re[Y]*Mt;return q.x=Rt*this.a+this.x0,q.y=Et*this.a+this.y0,q},inverse:function(q){var Y,H,et=q.x,it=q.y,nt=et-this.x0,st=(it-this.y0)/this.a,ot=nt/this.a,lt=1,mt=0,_t=0,vt=0;for(Y=1;Y<=6;Y++)H=mt*st+lt*ot,lt=lt*st-mt*ot,mt=H,_t=_t+this.C_re[Y]*lt-this.C_im[Y]*mt,vt=vt+this.C_im[Y]*lt+this.C_re[Y]*mt;for(var bt=0;bt<this.iterations;bt++){var Mt,Et=_t,Rt=vt,It=st,Pt=ot;for(Y=2;Y<=6;Y++)Mt=Rt*_t+Et*vt,Et=Et*_t-Rt*vt,Rt=Mt,It+=(Y-1)*(this.B_re[Y]*Et-this.B_im[Y]*Rt),Pt+=(Y-1)*(this.B_im[Y]*Et+this.B_re[Y]*Rt);Et=1,Rt=0;var Tt=this.B_re[1],Ft=this.B_im[1];for(Y=2;Y<=6;Y++)Mt=Rt*_t+Et*vt,Et=Et*_t-Rt*vt,Rt=Mt,Tt+=Y*(this.B_re[Y]*Et-this.B_im[Y]*Rt),Ft+=Y*(this.B_im[Y]*Et+this.B_re[Y]*Rt);var At=Tt*Tt+Ft*Ft;_t=(It*Tt+Pt*Ft)/At,vt=(Pt*Tt-It*Ft)/At}var Lt=_t,Nt=vt,kt=1,Gt=0;for(Y=1;Y<=9;Y++)kt*=Lt,Gt+=this.D[Y]*kt;var jt=this.lat0+Gt*ie*1e5,Dt=this.long0+Nt;return q.x=Dt,q.y=jt,q},names:["New_Zealand_Map_Grid","nzmg"]},yr={init:function(){},forward:function(q){var Y=q.x,H=q.y,et=me(Y-this.long0),it=this.x0+this.a*et,nt=this.y0+this.a*Math.log(Math.tan(Math.PI/4+H/2.5))*1.25;return q.x=it,q.y=nt,q},inverse:function(q){q.x-=this.x0,q.y-=this.y0;var Y=me(this.long0+q.x/this.a),H=2.5*(Math.atan(Math.exp(.8*q.y/this.a))-Math.PI/4);return q.x=Y,q.y=H,q},names:["Miller_Cylindrical","mill"]},_r={init:function(){this.sphere?(this.n=1,this.m=0,this.es=0,this.C_y=Math.sqrt((this.m+1)/this.n),this.C_x=this.C_y/(this.m+1)):this.en=mi(this.es)},forward:function(q){var Y,H,et=q.x,it=q.y;if(et=me(et-this.long0),this.sphere){if(this.m)for(var nt=this.n*Math.sin(it),st=20;st;--st){var ot=(this.m*it+Math.sin(it)-nt)/(this.m+Math.cos(it));if(it-=ot,Math.abs(ot)<ue)break}else it=1!==this.n?Math.asin(this.n*Math.sin(it)):it;Y=this.a*this.C_x*et*(this.m+Math.cos(it)),H=this.a*this.C_y*it}else{var lt=Math.sin(it),mt=Math.cos(it);H=this.a*yi(it,lt,mt,this.en),Y=this.a*et*mt/Math.sqrt(1-this.es*lt*lt)}return q.x=Y,q.y=H,q},inverse:function(q){var Y,H,et;return q.x-=this.x0,H=q.x/this.a,q.y-=this.y0,Y=q.y/this.a,this.sphere?(Y/=this.C_y,H/=this.C_x*(this.m+Math.cos(Y)),this.m?Y=Zi((this.m*Y+Math.sin(Y))/this.n):1!==this.n&&(Y=Zi(Math.sin(Y)/this.n)),H=me(H+this.long0),Y=Ui(Y)):(Y=_i(q.y/this.a,this.es,this.en),(et=Math.abs(Y))<ne?(et=Math.sin(Y),H=me(this.long0+q.x*Math.sqrt(1-this.es*et*et)/(this.a*Math.cos(Y)))):et-ue<ne&&(H=this.long0)),q.x=H,q.y=Y,q},names:["Sinusoidal","sinu"]},xr={init:function(){},forward:function(q){for(var Y=q.x,H=q.y,et=me(Y-this.long0),it=H,nt=Math.PI*Math.sin(H);;){var st=-(it+Math.sin(it)-nt)/(1+Math.cos(it));if(it+=st,Math.abs(st)<ue)break}it/=2,Math.PI/2-Math.abs(H)<ue&&(et=0);var ot=.900316316158*this.a*et*Math.cos(it)+this.x0,lt=1.4142135623731*this.a*Math.sin(it)+this.y0;return q.x=ot,q.y=lt,q},inverse:function(q){var Y,H;q.x-=this.x0,q.y-=this.y0,H=q.y/(1.4142135623731*this.a),Math.abs(H)>.999999999999&&(H=.999999999999),Y=Math.asin(H);var et=me(this.long0+q.x/(.900316316158*this.a*Math.cos(Y)));et<-Math.PI&&(et=-Math.PI),et>Math.PI&&(et=Math.PI),H=(2*Y+Math.sin(2*Y))/Math.PI,Math.abs(H)>1&&(H=1);var it=Math.asin(H);return q.x=et,q.y=it,q},names:["Mollweide","moll"]},Sr={init:function(){Math.abs(this.lat1+this.lat2)<ue||(this.lat2=this.lat2||this.lat1,this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=ki(this.es),this.e1=Gi(this.es),this.e2=ji(this.es),this.e3=Di(this.es),this.sinphi=Math.sin(this.lat1),this.cosphi=Math.cos(this.lat1),this.ms1=ge(this.e,this.sinphi,this.cosphi),this.ml1=Ni(this.e0,this.e1,this.e2,this.e3,this.lat1),Math.abs(this.lat1-this.lat2)<ue?this.ns=this.sinphi:(this.sinphi=Math.sin(this.lat2),this.cosphi=Math.cos(this.lat2),this.ms2=ge(this.e,this.sinphi,this.cosphi),this.ml2=Ni(this.e0,this.e1,this.e2,this.e3,this.lat2),this.ns=(this.ms1-this.ms2)/(this.ml2-this.ml1)),this.g=this.ml1+this.ms1/this.ns,this.ml0=Ni(this.e0,this.e1,this.e2,this.e3,this.lat0),this.rh=this.a*(this.g-this.ml0))},forward:function(q){var Y,H=q.x,et=q.y;if(this.sphere)Y=this.a*(this.g-et);else{var it=Ni(this.e0,this.e1,this.e2,this.e3,et);Y=this.a*(this.g-it)}var nt=this.ns*me(H-this.long0),st=this.x0+Y*Math.sin(nt),ot=this.y0+this.rh-Y*Math.cos(nt);return q.x=st,q.y=ot,q},inverse:function(q){var Y,H,et,it;q.x-=this.x0,q.y=this.rh-q.y+this.y0,this.ns>=0?(H=Math.sqrt(q.x*q.x+q.y*q.y),Y=1):(H=-Math.sqrt(q.x*q.x+q.y*q.y),Y=-1);var nt=0;return 0!==H&&(nt=Math.atan2(Y*q.x,Y*q.y)),this.sphere?(it=me(this.long0+nt/this.ns),et=Ui(this.g-H/this.a),q.x=it,q.y=et,q):(et=Bi(this.g-H/this.a,this.e0,this.e1,this.e2,this.e3),it=me(this.long0+nt/this.ns),q.x=it,q.y=et,q)},names:["Equidistant_Conic","eqdc"]},br={init:function(){this.R=this.a},forward:function(q){var Y,H,et=q.x,it=q.y,nt=me(et-this.long0);Math.abs(it)<=ue&&(Y=this.x0+this.R*nt,H=this.y0);var st=Zi(2*Math.abs(it/Math.PI));(Math.abs(nt)<=ue||Math.abs(Math.abs(it)-ne)<=ue)&&(Y=this.x0,H=it>=0?this.y0+Math.PI*this.R*Math.tan(.5*st):this.y0+Math.PI*this.R*-Math.tan(.5*st));var ot=.5*Math.abs(Math.PI/nt-nt/Math.PI),lt=ot*ot,mt=Math.sin(st),_t=Math.cos(st),vt=_t/(mt+_t-1),bt=vt*vt,Mt=vt*(2/mt-1),Et=Mt*Mt,Rt=Math.PI*this.R*(ot*(vt-Et)+Math.sqrt(lt*(vt-Et)*(vt-Et)-(Et+lt)*(bt-Et)))/(Et+lt);nt<0&&(Rt=-Rt),Y=this.x0+Rt;var It=lt+vt;return Rt=Math.PI*this.R*(Mt*It-ot*Math.sqrt((Et+lt)*(lt+1)-It*It))/(Et+lt),H=it>=0?this.y0+Rt:this.y0-Rt,q.x=Y,q.y=H,q},inverse:function(q){var Y,H,et,it,nt,st,ot,lt,mt,_t,vt,bt;return q.x-=this.x0,q.y-=this.y0,vt=Math.PI*this.R,nt=(et=q.x/vt)*et+(it=q.y/vt)*it,vt=3*(it*it/(lt=-2*(st=-Math.abs(it)*(1+nt))+1+2*it*it+nt*nt)+(2*(ot=st-2*it*it+et*et)*ot*ot/lt/lt/lt-9*st*ot/lt/lt)/27)/(mt=(st-ot*ot/3/lt)/lt)/(_t=2*Math.sqrt(-mt/3)),Math.abs(vt)>1&&(vt=vt>=0?1:-1),bt=Math.acos(vt)/3,H=q.y>=0?(-_t*Math.cos(bt+Math.PI/3)-ot/3/lt)*Math.PI:-(-_t*Math.cos(bt+Math.PI/3)-ot/3/lt)*Math.PI,Y=Math.abs(et)<ue?this.long0:me(this.long0+Math.PI*(nt-1+Math.sqrt(1+2*(et*et-it*it)+nt*nt))/2/et),q.x=Y,q.y=H,q},names:["Van_der_Grinten_I","VanDerGrinten","vandg"]},Mr={init:function(){this.sin_p12=Math.sin(this.lat0),this.cos_p12=Math.cos(this.lat0)},forward:function(q){var Y,H,et,it,nt,st,ot,lt,mt,_t,vt,bt,Mt,Et,Rt,It,Pt,Tt,Ft,At,Lt,Nt,kt=q.x,Gt=q.y,jt=Math.sin(q.y),Dt=Math.cos(q.y),zt=me(kt-this.long0);return this.sphere?Math.abs(this.sin_p12-1)<=ue?(q.x=this.x0+this.a*(ne-Gt)*Math.sin(zt),q.y=this.y0-this.a*(ne-Gt)*Math.cos(zt),q):Math.abs(this.sin_p12+1)<=ue?(q.x=this.x0+this.a*(ne+Gt)*Math.sin(zt),q.y=this.y0+this.a*(ne+Gt)*Math.cos(zt),q):(Tt=this.sin_p12*jt+this.cos_p12*Dt*Math.cos(zt),Pt=(It=Math.acos(Tt))?It/Math.sin(It):1,q.x=this.x0+this.a*Pt*Dt*Math.sin(zt),q.y=this.y0+this.a*Pt*(this.cos_p12*jt-this.sin_p12*Dt*Math.cos(zt)),q):(Y=ki(this.es),H=Gi(this.es),et=ji(this.es),it=Di(this.es),Math.abs(this.sin_p12-1)<=ue?(nt=this.a*Ni(Y,H,et,it,ne),st=this.a*Ni(Y,H,et,it,Gt),q.x=this.x0+(nt-st)*Math.sin(zt),q.y=this.y0-(nt-st)*Math.cos(zt),q):Math.abs(this.sin_p12+1)<=ue?(nt=this.a*Ni(Y,H,et,it,ne),st=this.a*Ni(Y,H,et,it,Gt),q.x=this.x0+(nt+st)*Math.sin(zt),q.y=this.y0+(nt+st)*Math.cos(zt),q):(ot=jt/Dt,lt=zi(this.a,this.e,this.sin_p12),mt=zi(this.a,this.e,jt),_t=Math.atan((1-this.es)*ot+this.es*lt*this.sin_p12/(mt*Dt)),Ft=0===(vt=Math.atan2(Math.sin(zt),this.cos_p12*Math.tan(_t)-this.sin_p12*Math.cos(zt)))?Math.asin(this.cos_p12*Math.sin(_t)-this.sin_p12*Math.cos(_t)):Math.abs(Math.abs(vt)-Math.PI)<=ue?-Math.asin(this.cos_p12*Math.sin(_t)-this.sin_p12*Math.cos(_t)):Math.asin(Math.sin(zt)*Math.cos(_t)/Math.sin(vt)),bt=this.e*this.sin_p12/Math.sqrt(1-this.es),It=lt*Ft*(1-(At=Ft*Ft)*(Rt=(Mt=this.e*this.cos_p12*Math.cos(vt)/Math.sqrt(1-this.es))*Mt)*(1-Rt)/6+(Lt=At*Ft)/8*(Et=bt*Mt)*(1-2*Rt)+(Nt=Lt*Ft)/120*(Rt*(4-7*Rt)-3*bt*bt*(1-7*Rt))-Nt*Ft/48*Et),q.x=this.x0+It*Math.sin(vt),q.y=this.y0+It*Math.cos(vt),q))},inverse:function(q){var Y,H,et,it,nt,st,ot,lt,mt,_t,vt,bt,Mt,Et,Rt,It,Pt,Tt,Ft,At,Lt,Nt,kt;if(q.x-=this.x0,q.y-=this.y0,this.sphere){if((Y=Math.sqrt(q.x*q.x+q.y*q.y))>2*ne*this.a)return;return H=Y/this.a,et=Math.sin(H),it=Math.cos(H),nt=this.long0,Math.abs(Y)<=ue?st=this.lat0:(st=Zi(it*this.sin_p12+q.y*et*this.cos_p12/Y),ot=Math.abs(this.lat0)-ne,nt=Math.abs(ot)<=ue?this.lat0>=0?me(this.long0+Math.atan2(q.x,-q.y)):me(this.long0-Math.atan2(-q.x,q.y)):me(this.long0+Math.atan2(q.x*et,Y*this.cos_p12*it-q.y*this.sin_p12*et))),q.x=nt,q.y=st,q}return lt=ki(this.es),mt=Gi(this.es),_t=ji(this.es),vt=Di(this.es),Math.abs(this.sin_p12-1)<=ue?(st=Bi(((bt=this.a*Ni(lt,mt,_t,vt,ne))-(Y=Math.sqrt(q.x*q.x+q.y*q.y)))/this.a,lt,mt,_t,vt),nt=me(this.long0+Math.atan2(q.x,-1*q.y)),q.x=nt,q.y=st,q):Math.abs(this.sin_p12+1)<=ue?(bt=this.a*Ni(lt,mt,_t,vt,ne),st=Bi(((Y=Math.sqrt(q.x*q.x+q.y*q.y))-bt)/this.a,lt,mt,_t,vt),nt=me(this.long0+Math.atan2(q.x,q.y)),q.x=nt,q.y=st,q):(Y=Math.sqrt(q.x*q.x+q.y*q.y),Rt=Math.atan2(q.x,q.y),Mt=zi(this.a,this.e,this.sin_p12),It=Math.cos(Rt),Tt=-(Pt=this.e*this.cos_p12*It)*Pt/(1-this.es),Ft=3*this.es*(1-Tt)*this.sin_p12*this.cos_p12*It/(1-this.es),Nt=1-Tt*(Lt=(At=Y/Mt)-Tt*(1+Tt)*Math.pow(At,3)/6-Ft*(1+3*Tt)*Math.pow(At,4)/24)*Lt/2-At*Lt*Lt*Lt/6,Et=Math.asin(this.sin_p12*Math.cos(Lt)+this.cos_p12*Math.sin(Lt)*It),nt=me(this.long0+Math.asin(Math.sin(Rt)*Math.sin(Lt)/Math.cos(Et))),kt=Math.sin(Et),st=Math.atan2((kt-this.es*Nt*this.sin_p12)*Math.tan(Et),kt*(1-this.es)),q.x=nt,q.y=st,q)},names:["Azimuthal_Equidistant","aeqd"]},wr={init:function(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0)},forward:function(q){var Y,H,et,it,nt,st,ot,lt=q.x,mt=q.y;return et=me(lt-this.long0),Y=Math.sin(mt),H=Math.cos(mt),it=Math.cos(et),((nt=this.sin_p14*Y+this.cos_p14*H*it)>0||Math.abs(nt)<=ue)&&(st=1*this.a*H*Math.sin(et),ot=this.y0+1*this.a*(this.cos_p14*Y-this.sin_p14*H*it)),q.x=st,q.y=ot,q},inverse:function(q){var Y,H,et,it,nt,st,ot;return q.x-=this.x0,q.y-=this.y0,H=Zi((Y=Math.sqrt(q.x*q.x+q.y*q.y))/this.a),et=Math.sin(H),it=Math.cos(H),st=this.long0,Math.abs(Y)<=ue?(ot=this.lat0,q.x=st,q.y=ot,q):(ot=Zi(it*this.sin_p14+q.y*et*this.cos_p14/Y),nt=Math.abs(this.lat0)-ne,Math.abs(nt)<=ue?(st=this.lat0>=0?me(this.long0+Math.atan2(q.x,-q.y)):me(this.long0-Math.atan2(-q.x,q.y)),q.x=st,q.y=ot,q):(st=me(this.long0+Math.atan2(q.x*et,Y*this.cos_p14*it-q.y*this.sin_p14*et)),q.x=st,q.y=ot,q))},names:["ortho"]};function an(q,Y,H,et){var it;return q<ue?(et.value=1,it=0):(it=Math.atan2(Y,H),Math.abs(it)<=xe?et.value=1:it>xe&&it<=ne+xe?(et.value=2,it-=ne):it>ne+xe||it<=-(ne+xe)?(et.value=3,it=it>=0?it-be:it+be):(et.value=4,it+=ne)),it}function hn(q,Y){var H=q+Y;return H<-be?H+=Se:H>+be&&(H-=Se),H}const Ir={init:function(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Quadrilateralized Spherical Cube",this.lat0>=ne-xe/2?this.face=5:this.lat0<=-(ne-xe/2)?this.face=6:Math.abs(this.long0)<=xe?this.face=1:Math.abs(this.long0)<=ne+xe?this.face=this.long0>0?2:4:this.face=3,0!==this.es&&(this.one_minus_f=1-(this.a-this.b)/this.a,this.one_minus_f_squared=this.one_minus_f*this.one_minus_f)},forward:function(q){var Y,H,et,it,nt,st,ot={x:0,y:0},lt={value:0};if(q.x-=this.long0,Y=0!==this.es?Math.atan(this.one_minus_f_squared*Math.tan(q.y)):q.y,H=q.x,5===this.face)it=ne-Y,H>=xe&&H<=ne+xe?(lt.value=1,et=H-ne):H>ne+xe||H<=-(ne+xe)?(lt.value=2,et=H>0?H-be:H+be):H>-(ne+xe)&&H<=-xe?(lt.value=3,et=H+ne):(lt.value=4,et=H);else if(6===this.face)it=ne+Y,H>=xe&&H<=ne+xe?(lt.value=1,et=-H+ne):H<xe&&H>=-xe?(lt.value=2,et=-H):H<-xe&&H>=-(ne+xe)?(lt.value=3,et=-H-ne):(lt.value=4,et=H>0?-H+be:-H-be);else{var mt,_t,vt,bt,Mt,Et;2===this.face?H=hn(H,+ne):3===this.face?H=hn(H,+be):4===this.face&&(H=hn(H,-ne)),bt=Math.sin(Y),Mt=Math.cos(Y),Et=Math.sin(H),mt=Mt*Math.cos(H),_t=Mt*Et,vt=bt,1===this.face?et=an(it=Math.acos(mt),vt,_t,lt):2===this.face?et=an(it=Math.acos(_t),vt,-mt,lt):3===this.face?et=an(it=Math.acos(-mt),vt,-_t,lt):4===this.face?et=an(it=Math.acos(-_t),vt,mt,lt):(it=et=0,lt.value=1)}return st=Math.atan(12/be*(et+Math.acos(Math.sin(et)*Math.cos(xe))-ne)),nt=Math.sqrt((1-Math.cos(it))/(Math.cos(st)*Math.cos(st))/(1-Math.cos(Math.atan(1/Math.cos(et))))),2===lt.value?st+=ne:3===lt.value?st+=be:4===lt.value&&(st+=1.5*be),ot.x=nt*Math.cos(st),ot.y=nt*Math.sin(st),ot.x=ot.x*this.a+this.x0,ot.y=ot.y*this.a+this.y0,q.x=ot.x,q.y=ot.y,q},inverse:function(q){var Y,H,et,it,nt,st,ot,lt,mt,_t,vt,bt,Mt={lam:0,phi:0},Et={value:0};if(q.x=(q.x-this.x0)/this.a,q.y=(q.y-this.y0)/this.a,H=Math.atan(Math.sqrt(q.x*q.x+q.y*q.y)),Y=Math.atan2(q.y,q.x),q.x>=0&&q.x>=Math.abs(q.y)?Et.value=1:q.y>=0&&q.y>=Math.abs(q.x)?(Et.value=2,Y-=ne):q.x<0&&-q.x>=Math.abs(q.y)?(Et.value=3,Y=Y<0?Y+be:Y-be):(Et.value=4,Y+=ne),mt=be/12*Math.tan(Y),nt=Math.sin(mt)/(Math.cos(mt)-1/Math.sqrt(2)),st=Math.atan(nt),(ot=1-(et=Math.cos(Y))*et*(it=Math.tan(H))*it*(1-Math.cos(Math.atan(1/Math.cos(st)))))<-1?ot=-1:ot>1&&(ot=1),5===this.face)lt=Math.acos(ot),Mt.phi=ne-lt,1===Et.value?Mt.lam=st+ne:2===Et.value?Mt.lam=st<0?st+be:st-be:3===Et.value?Mt.lam=st-ne:Mt.lam=st;else if(6===this.face)lt=Math.acos(ot),Mt.phi=lt-ne,1===Et.value?Mt.lam=-st+ne:2===Et.value?Mt.lam=-st:3===Et.value?Mt.lam=-st-ne:Mt.lam=st<0?-st-be:-st+be;else{var Rt,It,Pt;mt=(Rt=ot)*Rt,It=(mt+=(Pt=mt>=1?0:Math.sqrt(1-mt)*Math.sin(st))*Pt)>=1?0:Math.sqrt(1-mt),2===Et.value?(mt=It,It=-Pt,Pt=mt):3===Et.value?(It=-It,Pt=-Pt):4===Et.value&&(mt=It,It=Pt,Pt=-mt),2===this.face?(mt=Rt,Rt=-It,It=mt):3===this.face?(Rt=-Rt,It=-It):4===this.face&&(mt=Rt,Rt=It,It=-mt),Mt.phi=Math.acos(-Pt)-ne,Mt.lam=Math.atan2(It,Rt),2===this.face?Mt.lam=hn(Mt.lam,-ne):3===this.face?Mt.lam=hn(Mt.lam,-be):4===this.face&&(Mt.lam=hn(Mt.lam,+ne))}return 0!==this.es&&(_t=Mt.phi<0?1:0,vt=Math.tan(Mt.phi),bt=this.b/Math.sqrt(vt*vt+this.one_minus_f_squared),Mt.phi=Math.atan(Math.sqrt(this.a*this.a-bt*bt)/(this.one_minus_f*bt)),_t&&(Mt.phi=-Mt.phi)),Mt.lam+=this.long0,q.x=Mt.lam,q.y=Mt.phi,q},names:["Quadrilateralized Spherical Cube","Quadrilateralized_Spherical_Cube","qsc"]};var Pr=[[1,22199e-21,-715515e-10,31103e-10],[.9986,-482243e-9,-24897e-9,-13309e-10],[.9954,-83103e-8,-448605e-10,-9.86701e-7],[.99,-.00135364,-59661e-9,36777e-10],[.9822,-.00167442,-449547e-11,-572411e-11],[.973,-.00214868,-903571e-10,1.8736e-8],[.96,-.00305085,-900761e-10,164917e-11],[.9427,-.00382792,-653386e-10,-26154e-10],[.9216,-.00467746,-10457e-8,481243e-11],[.8962,-.00536223,-323831e-10,-543432e-11],[.8679,-.00609363,-113898e-9,332484e-11],[.835,-.00698325,-640253e-10,9.34959e-7],[.7986,-.00755338,-500009e-10,9.35324e-7],[.7597,-.00798324,-35971e-9,-227626e-11],[.7186,-.00851367,-701149e-10,-86303e-10],[.6732,-.00986209,-199569e-9,191974e-10],[.6213,-.010418,883923e-10,624051e-11],[.5722,-.00906601,182e-6,624051e-11],[.5322,-.00677797,275608e-9,624051e-11]],Fr=[[-520417e-23,.0124,121431e-23,-845284e-16],[.062,.0124,-1.26793e-9,4.22642e-10],[.124,.0124,5.07171e-9,-1.60604e-9],[.186,.0123999,-1.90189e-8,6.00152e-9],[.248,.0124002,7.10039e-8,-2.24e-8],[.31,.0123992,-2.64997e-7,8.35986e-8],[.372,.0124029,9.88983e-7,-3.11994e-7],[.434,.0123893,-369093e-11,-4.35621e-7],[.4958,.0123198,-102252e-10,-3.45523e-7],[.5571,.0121916,-154081e-10,-5.82288e-7],[.6176,.0119938,-241424e-10,-5.25327e-7],[.6769,.011713,-320223e-10,-5.16405e-7],[.7346,.0113541,-397684e-10,-6.09052e-7],[.7903,.0109107,-489042e-10,-104739e-11],[.8435,.0103431,-64615e-9,-1.40374e-9],[.8936,.00969686,-64636e-9,-8547e-9],[.9394,.00840947,-192841e-9,-42106e-10],[.9761,.00616527,-256e-6,-42106e-10],[1,.00328947,-319159e-9,-42106e-10]],zr=.8487,Ur=1.3523,gn=function(q,Y){return q[0]+Y*(q[1]+Y*(q[2]+Y*q[3]))};const Yr={init:function(){this.x0=this.x0||0,this.y0=this.y0||0,this.long0=this.long0||0,this.es=0,this.title=this.title||"Robinson"},forward:function(q){var Y=me(q.x-this.long0),H=Math.abs(q.y),et=Math.floor(11.459155902616464*H);et<0?et=0:et>=18&&(et=17);var it={x:gn(Pr[et],H=de*(H-.08726646259971647*et))*Y,y:gn(Fr[et],H)};return q.y<0&&(it.y=-it.y),it.x=it.x*this.a*zr+this.x0,it.y=it.y*this.a*Ur+this.y0,it},inverse:function(q){var Y={x:(q.x-this.x0)/(this.a*zr),y:Math.abs(q.y-this.y0)/(this.a*Ur)};if(Y.y>=1)Y.x/=Pr[18][0],Y.y=q.y<0?-ne:ne;else{var H=Math.floor(18*Y.y);for(H<0?H=0:H>=18&&(H=17);;)if(Fr[H][0]>Y.y)--H;else{if(!(Fr[H+1][0]<=Y.y))break;++H}var et=Fr[H],it=5*(Y.y-et[0])/(Fr[H+1][0]-et[0]);it=function(q,Y,H,et){for(var it=Y;et;--et){var nt=q(it);if(it-=nt,Math.abs(nt)<1e-10)break}return it}((function(q){return(gn(et,q)-Y.y)/function(q,Y){return q[1]+Y*(2*q[2]+3*Y*q[3])}(et,q)}),it,0,100),Y.x/=gn(Pr[H],it),Y.y=(5*H+it)*ce,q.y<0&&(Y.y=-Y.y)}return Y.x=me(Y.x+this.long0),Y},names:["Robinson","robin"]},Zr={init:function(){this.name="geocent"},forward:function(q){return Ge(q,this.es,this.a)},inverse:function(q){return je(q,this.es,this.a,this.b)},names:["Geocentric","geocentric","geocent","Geocent"]};var Hr={h:{def:1e5,num:!0},azi:{def:0,num:!0,degrees:!0},tilt:{def:0,num:!0,degrees:!0},long0:{def:0,num:!0},lat0:{def:0,num:!0}};const Jr={init:function(){if(Object.keys(Hr).forEach(function(q){if(void 0===this[q])this[q]=Hr[q].def;else{if(Hr[q].num&&isNaN(this[q]))throw new Error("Invalid parameter value, must be numeric "+q+" = "+this[q]);Hr[q].num&&(this[q]=parseFloat(this[q]))}Hr[q].degrees&&(this[q]=this[q]*ce)}.bind(this)),Math.abs(Math.abs(this.lat0)-ne)<ue?this.mode=this.lat0<0?1:0:Math.abs(this.lat0)<ue?this.mode=2:(this.mode=3,this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0)),this.pn1=this.h/this.a,this.pn1<=0||this.pn1>1e10)throw new Error("Invalid height");this.p=1+this.pn1,this.rp=1/this.p,this.h1=1/this.pn1,this.pfact=(this.p+1)*this.h1,this.es=0;var q=this.tilt,Y=this.azi;this.cg=Math.cos(Y),this.sg=Math.sin(Y),this.cw=Math.cos(q),this.sw=Math.sin(q)},forward:function(q){q.x-=this.long0;var Y,H,et,it,nt=Math.sin(q.y),st=Math.cos(q.y),ot=Math.cos(q.x);switch(this.mode){case 3:H=this.sinph0*nt+this.cosph0*st*ot;break;case 2:H=st*ot;break;case 1:H=-nt;break;case 0:H=nt}switch(Y=(H=this.pn1/(this.p-H))*st*Math.sin(q.x),this.mode){case 3:H*=this.cosph0*nt-this.sinph0*st*ot;break;case 2:H*=nt;break;case 0:H*=-st*ot;break;case 1:H*=st*ot}return it=1/((et=H*this.cg+Y*this.sg)*this.sw*this.h1+this.cw),Y=(Y*this.cg-H*this.sg)*this.cw*it,H=et*it,q.x=Y*this.a,q.y=H*this.a,q},inverse:function(q){q.x/=this.a,q.y/=this.a;var Y,H,et,it={x:q.x,y:q.y};et=1/(this.pn1-q.y*this.sw),Y=this.pn1*q.x*et,H=this.pn1*q.y*this.cw*et,q.x=Y*this.cg+H*this.sg,q.y=H*this.cg-Y*this.sg;var nt=Si(q.x,q.y);if(Math.abs(nt)<ue)it.x=0,it.y=q.y;else{var st,ot;switch(ot=1-nt*nt*this.pfact,ot=(this.p-Math.sqrt(ot))/(this.pn1/nt+nt/this.pn1),st=Math.sqrt(1-ot*ot),this.mode){case 3:it.y=Math.asin(st*this.sinph0+q.y*ot*this.cosph0/nt),q.y=(st-this.sinph0*Math.sin(it.y))*nt,q.x*=ot*this.cosph0;break;case 2:it.y=Math.asin(q.y*ot/nt),q.y=st*nt,q.x*=ot;break;case 0:it.y=Math.asin(st),q.y=-q.y;break;case 1:it.y=-Math.asin(st)}it.x=Math.atan2(q.x,q.y)}return q.x=it.x+this.long0,q.y=it.y,q},names:["Tilted_Perspective","tpers"]},$r={init:function(){if(this.flip_axis="x"===this.sweep?1:0,this.h=Number(this.h),this.radius_g_1=this.h/this.a,this.radius_g_1<=0||this.radius_g_1>1e10)throw new Error;if(this.radius_g=1+this.radius_g_1,this.C=this.radius_g*this.radius_g-1,0!==this.es){var q=1-this.es,Y=1/q;this.radius_p=Math.sqrt(q),this.radius_p2=q,this.radius_p_inv2=Y,this.shape="ellipse"}else this.radius_p=1,this.radius_p2=1,this.radius_p_inv2=1,this.shape="sphere";this.title||(this.title="Geostationary Satellite View")},forward:function(q){var Y,H,et,it,nt=q.x,st=q.y;if(nt-=this.long0,"ellipse"===this.shape){st=Math.atan(this.radius_p2*Math.tan(st));var ot=this.radius_p/Si(this.radius_p*Math.cos(st),Math.sin(st));if(H=ot*Math.cos(nt)*Math.cos(st),et=ot*Math.sin(nt)*Math.cos(st),it=ot*Math.sin(st),(this.radius_g-H)*H-et*et-it*it*this.radius_p_inv2<0)return q.x=Number.NaN,q.y=Number.NaN,q;Y=this.radius_g-H,this.flip_axis?(q.x=this.radius_g_1*Math.atan(et/Si(it,Y)),q.y=this.radius_g_1*Math.atan(it/Y)):(q.x=this.radius_g_1*Math.atan(et/Y),q.y=this.radius_g_1*Math.atan(it/Si(et,Y)))}else"sphere"===this.shape&&(Y=Math.cos(st),H=Math.cos(nt)*Y,et=Math.sin(nt)*Y,it=Math.sin(st),Y=this.radius_g-H,this.flip_axis?(q.x=this.radius_g_1*Math.atan(et/Si(it,Y)),q.y=this.radius_g_1*Math.atan(it/Y)):(q.x=this.radius_g_1*Math.atan(et/Y),q.y=this.radius_g_1*Math.atan(it/Si(et,Y))));return q.x=q.x*this.a,q.y=q.y*this.a,q},inverse:function(q){var Y,H,et,it,nt=-1,st=0,ot=0;if(q.x=q.x/this.a,q.y=q.y/this.a,"ellipse"===this.shape){this.flip_axis?(ot=Math.tan(q.y/this.radius_g_1),st=Math.tan(q.x/this.radius_g_1)*Si(1,ot)):(st=Math.tan(q.x/this.radius_g_1),ot=Math.tan(q.y/this.radius_g_1)*Si(1,st));var lt=ot/this.radius_p;if(Y=st*st+lt*lt+nt*nt,(et=(H=2*this.radius_g*nt)*H-4*Y*this.C)<0)return q.x=Number.NaN,q.y=Number.NaN,q;it=(-H-Math.sqrt(et))/(2*Y),nt=this.radius_g+it*nt,st*=it,ot*=it,q.x=Math.atan2(st,nt),q.y=Math.atan(ot*Math.cos(q.x)/nt),q.y=Math.atan(this.radius_p_inv2*Math.tan(q.y))}else if("sphere"===this.shape){if(this.flip_axis?(ot=Math.tan(q.y/this.radius_g_1),st=Math.tan(q.x/this.radius_g_1)*Math.sqrt(1+ot*ot)):(st=Math.tan(q.x/this.radius_g_1),ot=Math.tan(q.y/this.radius_g_1)*Math.sqrt(1+st*st)),Y=st*st+ot*ot+nt*nt,(et=(H=2*this.radius_g*nt)*H-4*Y*this.C)<0)return q.x=Number.NaN,q.y=Number.NaN,q;it=(-H-Math.sqrt(et))/(2*Y),nt=this.radius_g+it*nt,st*=it,ot*=it,q.x=Math.atan2(st,nt),q.y=Math.atan(ot*Math.cos(q.x)/nt)}return q.x=q.x+this.long0,q},names:["Geostationary Satellite View","Geostationary_Satellite","geos"]};var tn;He.defaultDatum="WGS84",He.Proj=Ci,He.WGS84=new He.Proj("WGS84"),He.Point=Li,He.toPoint=qe,He.defs=Qe,He.nadgrid=function(q,Y){var H=new DataView(Y),et=function(q){var Y=q.getInt32(8,!1);return 11!==Y&&(11!==(Y=q.getInt32(8,!0))&&console.warn("Failed to detect nadgrid endian-ness, defaulting to little-endian"),!0)}(H),it=function(q,Y){return{nFields:q.getInt32(8,Y),nSubgridFields:q.getInt32(24,Y),nSubgrids:q.getInt32(40,Y),shiftType:Te(q,56,64).trim(),fromSemiMajorAxis:q.getFloat64(120,Y),fromSemiMinorAxis:q.getFloat64(136,Y),toSemiMajorAxis:q.getFloat64(152,Y),toSemiMinorAxis:q.getFloat64(168,Y)}}(H,et);it.nSubgrids>1&&console.log("Only single NTv2 subgrids are currently supported, subsequent sub grids are ignored");var nt=function(q,Y,H){for(var et=[],it=0;it<Y.nSubgrids;it++){var nt=Ae(q,176,H),st=Le(q,176,nt,H),ot=Math.round(1+(nt.upperLongitude-nt.lowerLongitude)/nt.longitudeInterval),lt=Math.round(1+(nt.upperLatitude-nt.lowerLatitude)/nt.latitudeInterval);et.push({ll:[Ie(nt.lowerLongitude),Ie(nt.lowerLatitude)],del:[Ie(nt.longitudeInterval),Ie(nt.latitudeInterval)],lim:[ot,lt],count:nt.gridNodeCount,cvs:Fe(st)})}return et}(H,it,et),st={header:it,subgrids:nt};return wi[q]=st,st},He.transform=Ze,He.mgrs=Ai,He.version="__VERSION__",(tn=He).Proj.projections.add(Vi),tn.Proj.projections.add(Ki),tn.Proj.projections.add(Hi),tn.Proj.projections.add(Qi),tn.Proj.projections.add($i),tn.Proj.projections.add(tr),tn.Proj.projections.add(ir),tn.Proj.projections.add(rr),tn.Proj.projections.add(nr),tn.Proj.projections.add(sr),tn.Proj.projections.add(or),tn.Proj.projections.add(ar),tn.Proj.projections.add(hr),tn.Proj.projections.add(lr),tn.Proj.projections.add(ur),tn.Proj.projections.add(cr),tn.Proj.projections.add(dr),tn.Proj.projections.add(yr),tn.Proj.projections.add(_r),tn.Proj.projections.add(xr),tn.Proj.projections.add(Sr),tn.Proj.projections.add(br),tn.Proj.projections.add(Mr),tn.Proj.projections.add(wr),tn.Proj.projections.add(Ir),tn.Proj.projections.add(Yr),tn.Proj.projections.add(Zr),tn.Proj.projections.add(Jr),tn.Proj.projections.add($r);const en=He;function bn(q){return Mn.apply(this,arguments)}function Mn(){return(Mn=tt(Ft().mark((function t(q){var Y,H,et,it,nt,st,ot,lt,mt;return Ft().wrap((function(_t){for(;;)switch(_t.prev=_t.next){case 0:return _t.next=2,fetch("https://epsg.io/?format=json&q="+q);case 2:return Y=_t.sent,_t.next=5,Y.json();case 5:if(H=_t.sent,!((et=H.results)&&et.length>0)){_t.next=20;break}it=0,nt=et.length;case 9:if(!(it<nt)){_t.next=20;break}if(!(st=et[it])){_t.next=17;break}if(ot=st.code,lt=st.proj4,mt=st.bbox,!(ot&&ot.length>0&&lt&&lt.length>0&&mt&&4==mt.length)){_t.next=17;break}return _t.abrupt("return",{name:"EPSG:"+ot,proj4def:lt,bbox:mt});case 17:it++,_t.next=9;break;case 20:case"end":return _t.stop()}}),t)})))).apply(this,arguments)}function wn(q,Y,H){en.defs(q,Y),function(q){$t=q;const Y=Object.keys(q.defs),H=Y.length;let et,it;for(et=0;et<H;++et){const H=Y[et];if(!(0,Vt.U2)(H)){const Y=q.defs(H);let et=Y.units;et||"longlat"!==Y.projName||(et="degrees"),(0,Vt.Sx)(new Kt.Z({code:H,axisOrientation:Y.axis,metersPerUnit:Y.to_meter,units:et}))}}for(et=0;et<H;++et){const nt=Y[et],st=(0,Vt.U2)(nt);for(it=0;it<H;++it){const H=Y[it],et=(0,Vt.U2)(H);if(!(0,Ht.U2)(nt,H))if(q.defs[nt]===q.defs[H])(0,Vt.rM)([st,et]);else{const Y=q(nt,H);(0,Vt.zY)(st,et,(0,Vt.uA)(st,et,Y.forward),(0,Vt.uA)(et,st,Y.inverse))}}}}(en);var et=(0,Vt.U2)(q),it=(0,Vt.Ck)("EPSG:4326",et),nt=[H[1],H[2],H[3],H[0]];et.setWorldExtent(nt),H[1]>H[3]&&(nt=[H[1],H[2],H[3]+360,H[0]]);var st=(0,Xt.Ne)(nt,it,void 0,8);et.setExtent(st)}var rn=i(2971);const nn="opacity",sn="visible",on="extent",ln="zIndex",un="maxResolution",cn="minResolution",dn="maxZoom",fn="minZoom",pn="source";var mn=i(4187),yn=i(9515),_n=i(3983);class vn extends rn.Z{constructor(q){super(),this.on,this.once,this.un,this.background_=q.background;const Y=Object.assign({},q);"object"==typeof q.properties&&(delete Y.properties,Object.assign(Y,q.properties)),Y[nn]=void 0!==q.opacity?q.opacity:1,(0,yn.h)("number"==typeof Y[nn],64),Y[sn]=void 0===q.visible||q.visible,Y[ln]=q.zIndex,Y[un]=void 0!==q.maxResolution?q.maxResolution:1/0,Y[cn]=void 0!==q.minResolution?q.minResolution:0,Y[fn]=void 0!==q.minZoom?q.minZoom:-1/0,Y[dn]=void 0!==q.maxZoom?q.maxZoom:1/0,this.className_=void 0!==Y.className?Y.className:"ol-layer",delete Y.className,this.setProperties(Y),this.state_=null}getBackground(){return this.background_}getClassName(){return this.className_}getLayerState(q){const Y=this.state_||{layer:this,managed:void 0===q||q},H=this.getZIndex();return Y.opacity=(0,_n.uZ)(Math.round(100*this.getOpacity())/100,0,1),Y.visible=this.getVisible(),Y.extent=this.getExtent(),Y.zIndex=void 0!==H||Y.managed?H:1/0,Y.maxResolution=this.getMaxResolution(),Y.minResolution=Math.max(this.getMinResolution(),0),Y.minZoom=this.getMinZoom(),Y.maxZoom=this.getMaxZoom(),this.state_=Y,Y}getLayersArray(q){return(0,mn.O3)()}getLayerStatesArray(q){return(0,mn.O3)()}getExtent(){return this.get(on)}getMaxResolution(){return this.get(un)}getMinResolution(){return this.get(cn)}getMinZoom(){return this.get(fn)}getMaxZoom(){return this.get(dn)}getOpacity(){return this.get(nn)}getSourceState(){return(0,mn.O3)()}getVisible(){return this.get(sn)}getZIndex(){return this.get(ln)}setBackground(q){this.background_=q,this.changed()}setExtent(q){this.set(on,q)}setMaxResolution(q){this.set(un,q)}setMinResolution(q){this.set(cn,q)}setMaxZoom(q){this.set(dn,q)}setMinZoom(q){this.set(fn,q)}setOpacity(q){(0,yn.h)("number"==typeof q,64),this.set(nn,q)}setVisible(q){this.set(sn,q)}setZIndex(q){this.set(ln,q)}disposeInternal(){this.state_&&(this.state_.layer=null,this.state_=null),super.disposeInternal()}}const xn=vn;var Sn=i(5487),Cn=i(5818);const En=class extends xn{constructor(q){const Y=Object.assign({},q);delete Y.source,super(Y),this.on,this.once,this.un,this.mapPrecomposeKey_=null,this.mapRenderKey_=null,this.sourceChangeKey_=null,this.renderer_=null,this.sourceReady_=!1,this.rendered=!1,q.render&&(this.render=q.render),q.map&&this.setMap(q.map),this.addChangeListener(pn,this.handleSourcePropertyChange_);const H=q.source?q.source:null;this.setSource(H)}getLayersArray(q){return(q=q||[]).push(this),q}getLayerStatesArray(q){return(q=q||[]).push(this.getLayerState()),q}getSource(){return this.get(pn)||null}getRenderSource(){return this.getSource()}getSourceState(){const q=this.getSource();return q?q.getState():"undefined"}handleSourceChange_(){this.changed(),this.sourceReady_||"ready"!==this.getSource().getState()||(this.sourceReady_=!0,this.dispatchEvent("sourceready"))}handleSourcePropertyChange_(){this.sourceChangeKey_&&((0,Cn.bN)(this.sourceChangeKey_),this.sourceChangeKey_=null),this.sourceReady_=!1;const q=this.getSource();q&&(this.sourceChangeKey_=(0,Cn.oL)(q,Sn.Z.CHANGE,this.handleSourceChange_,this),"ready"===q.getState()&&(this.sourceReady_=!0,setTimeout((()=>{this.dispatchEvent("sourceready")}),0))),this.changed()}getFeatures(q){return this.renderer_?this.renderer_.getFeatures(q):Promise.resolve([])}getData(q){return this.renderer_&&this.rendered?this.renderer_.getData(q):null}render(q,Y){const H=this.getRenderer();if(H.prepareFrame(q))return this.rendered=!0,H.renderFrame(q,Y)}unrender(){this.rendered=!1}setMapInternal(q){q||this.unrender(),this.set("map",q)}getMapInternal(){return this.get("map")}setMap(q){this.mapPrecomposeKey_&&((0,Cn.bN)(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null),q||this.changed(),this.mapRenderKey_&&((0,Cn.bN)(this.mapRenderKey_),this.mapRenderKey_=null),q&&(this.mapPrecomposeKey_=(0,Cn.oL)(q,"precompose",(function(q){const Y=q.frameState.layerStatesArray,H=this.getLayerState(!1);(0,yn.h)(!Y.some((function(q){return q.layer===H.layer})),67),Y.push(H)}),this),this.mapRenderKey_=(0,Cn.oL)(this,Sn.Z.CHANGE,q.render,q),this.changed())}setSource(q){this.set(pn,q)}getRenderer(){return this.renderer_||(this.renderer_=this.createRenderer()),this.renderer_}hasRenderer(){return!!this.renderer_}createRenderer(){return null}disposeInternal(){this.renderer_&&(this.renderer_.dispose(),delete this.renderer_),this.setSource(null),super.disposeInternal()}},Rn="preload",On="useInterimTilesOnError",In=class extends En{constructor(q){q=q||{};const Y=Object.assign({},q);delete Y.preload,delete Y.useInterimTilesOnError,super(Y),this.on,this.once,this.un,this.setPreload(void 0!==q.preload?q.preload:0),this.setUseInterimTilesOnError(void 0===q.useInterimTilesOnError||q.useInterimTilesOnError)}getPreload(){return this.get(Rn)}setPreload(q){this.set(Rn,q)}getUseInterimTilesOnError(){return this.get(On)}setUseInterimTilesOnError(q){this.set(On,q)}getData(q){return super.getData(q)}};var Pn=i(553),Tn=i(2706);class Fn extends Tn.Z{constructor(q){super(),this.ready=!0,this.boundHandleImageChange_=this.handleImageChange_.bind(this),this.layer_=q,this.declutterExecutorGroup=null}getFeatures(q){return(0,mn.O3)()}getData(q){return null}prepareFrame(q){return(0,mn.O3)()}renderFrame(q,Y){return(0,mn.O3)()}loadedTileCallback(q,Y,H){q[Y]||(q[Y]={}),q[Y][H.tileCoord.toString()]=H}createLoadedTileFinder(q,Y,H){return(et,it)=>{const nt=this.loadedTileCallback.bind(this,H,et);return q.forEachLoadedTile(Y,et,it,nt)}}forEachFeatureAtCoordinate(q,Y,H,et,it){}getLayer(){return this.layer_}handleFontsChanged(){}handleImageChange_(q){q.target.getState()===Pn.default.LOADED&&this.renderIfReadyAndVisible()}loadImage(q){let Y=q.getState();return Y!=Pn.default.LOADED&&Y!=Pn.default.ERROR&&q.addEventListener(Sn.Z.CHANGE,this.boundHandleImageChange_),Y==Pn.default.IDLE&&(q.load(),Y=q.getState()),Y==Pn.default.LOADED}renderIfReadyAndVisible(){const q=this.getLayer();q&&q.getVisible()&&"ready"===q.getSourceState()&&q.changed()}disposeInternal(){delete this.layer_,super.disposeInternal()}}const An=Fn;var Ln=i(291);class Nn extends Ln.ZP{constructor(q,Y,H,et){super(q),this.inversePixelTransform=Y,this.frameState=H,this.context=et}}const kn=Nn;var Gn=i(6101),jn=i(9706),Dn=i(5537);const zn=[];let Bn=null;const Un=class extends An{constructor(q){super(q),this.container=null,this.renderedResolution,this.tempTransform=(0,Gn.Ue)(),this.pixelTransform=(0,Gn.Ue)(),this.inversePixelTransform=(0,Gn.Ue)(),this.context=null,this.containerReused=!1,this.pixelContext_=null,this.frameState=null}getImageData(q,Y,H){let et;Bn||(Bn=(0,At.E4)(1,1,void 0,{willReadFrequently:!0})),Bn.clearRect(0,0,1,1);try{Bn.drawImage(q,Y,H,1,1,0,0,1,1),et=Bn.getImageData(0,0,1,1).data}catch(q){return Bn=null,null}return et}getBackground(q){let Y=this.getLayer().getBackground();return"function"==typeof Y&&(Y=Y(q.viewState.resolution)),Y||void 0}useContainer(q,Y,H){const et=this.getLayer().getClassName();let it,nt;if(q&&q.className===et&&(!H||q&&q.style.backgroundColor&&(0,Dn.fS)((0,jn._2)(q.style.backgroundColor),(0,jn._2)(H)))){const Y=q.firstElementChild;Y instanceof HTMLCanvasElement&&(nt=Y.getContext("2d"))}if(nt&&nt.canvas.style.transform===Y?(this.container=q,this.context=nt,this.containerReused=!0):this.containerReused&&(this.container=null,this.context=null,this.containerReused=!1),!this.container){it=document.createElement("div"),it.className=et;let q=it.style;q.position="absolute",q.width="100%",q.height="100%",nt=(0,At.E4)();const Y=nt.canvas;it.appendChild(Y),q=Y.style,q.position="absolute",q.left="0",q.transformOrigin="top left",this.container=it,this.context=nt}this.containerReused||!H||this.container.style.backgroundColor||(this.container.style.backgroundColor=H)}clipUnrotated(q,Y,H){const et=(0,Xt.rL)(H),it=(0,Xt.Xv)(H),nt=(0,Xt.w$)(H),st=(0,Xt.hC)(H);(0,Gn.nn)(Y.coordinateToPixelTransform,et),(0,Gn.nn)(Y.coordinateToPixelTransform,it),(0,Gn.nn)(Y.coordinateToPixelTransform,nt),(0,Gn.nn)(Y.coordinateToPixelTransform,st);const ot=this.inversePixelTransform;(0,Gn.nn)(ot,et),(0,Gn.nn)(ot,it),(0,Gn.nn)(ot,nt),(0,Gn.nn)(ot,st),q.save(),q.beginPath(),q.moveTo(Math.round(et[0]),Math.round(et[1])),q.lineTo(Math.round(it[0]),Math.round(it[1])),q.lineTo(Math.round(nt[0]),Math.round(nt[1])),q.lineTo(Math.round(st[0]),Math.round(st[1])),q.clip()}dispatchRenderEvent_(q,Y,H){const et=this.getLayer();if(et.hasListener(q)){const it=new kn(q,this.inversePixelTransform,H,Y);et.dispatchEvent(it)}}preRender(q,Y){this.frameState=Y,this.dispatchRenderEvent_("prerender",q,Y)}postRender(q,Y){this.dispatchRenderEvent_("postrender",q,Y)}getRenderTransform(q,Y,H,et,it,nt,st){const ot=it/2,lt=nt/2,mt=et/Y,_t=-mt,vt=-q[0]+st,bt=-q[1];return(0,Gn.qC)(this.tempTransform,ot,lt,mt,_t,-H,vt,bt)}disposeInternal(){delete this.frameState,super.disposeInternal()}};var qn=i(3069);class Wn extends qn.Z{constructor(q,Y,H){super(),H=H||{},this.tileCoord=q,this.state=Y,this.interimTile=null,this.key="",this.transition_=void 0===H.transition?250:H.transition,this.transitionStarts_={},this.interpolate=!!H.interpolate}changed(){this.dispatchEvent(Sn.Z.CHANGE)}release(){3===this.state&&this.setState(4)}getKey(){return this.key+"/"+this.tileCoord}getInterimTile(){if(!this.interimTile)return this;let q=this.interimTile;do{if(2==q.getState())return this.transition_=0,q;q=q.interimTile}while(q);return this}refreshInterimChain(){if(!this.interimTile)return;let q=this.interimTile,Y=this;do{if(2==q.getState()){q.interimTile=null;break}1==q.getState()?Y=q:0==q.getState()?Y.interimTile=q.interimTile:Y=q,q=Y.interimTile}while(q)}getTileCoord(){return this.tileCoord}getState(){return this.state}setState(q){if(3!==this.state&&this.state>q)throw new Error("Tile load sequence violation");this.state=q,this.changed()}load(){(0,mn.O3)()}getAlpha(q,Y){if(!this.transition_)return 1;let H=this.transitionStarts_[q];if(H){if(-1===H)return 1}else H=Y,this.transitionStarts_[q]=H;const et=Y-H+1e3/60;return et>=this.transition_?1:(it=et/this.transition_,Math.pow(it,3));var it}inTransition(q){return!!this.transition_&&-1!==this.transitionStarts_[q]}endTransition(q){this.transition_&&(this.transitionStarts_[q]=-1)}}const Yn=Wn;var Zn=i(8096);const Xn=class extends Yn{constructor(q,Y,H,et,it,nt){super(q,Y,nt),this.crossOrigin_=et,this.src_=H,this.key=H,this.image_=new Image,null!==et&&(this.image_.crossOrigin=et),this.unlisten_=null,this.tileLoadFunction_=it}getImage(){return this.image_}setImage(q){this.image_=q,this.state=2,this.unlistenImage_(),this.changed()}handleImageError_(){this.state=3,this.unlistenImage_(),this.image_=function(){const q=(0,At.E4)(1,1);return q.fillStyle="rgba(0,0,0,0)",q.fillRect(0,0,1,1),q.canvas}(),this.changed()}handleImageLoad_(){const q=this.image_;q.naturalWidth&&q.naturalHeight?this.state=2:this.state=4,this.unlistenImage_(),this.changed()}load(){3==this.state&&(this.state=0,this.image_=new Image,null!==this.crossOrigin_&&(this.image_.crossOrigin=this.crossOrigin_)),0==this.state&&(this.state=1,this.changed(),this.tileLoadFunction_(this,this.src_),this.unlisten_=(0,Zn.K)(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))}unlistenImage_(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)}},Vn=class{constructor(q,Y,H,et,it,nt){this.sourceProj_=q,this.targetProj_=Y;let st={};const ot=(0,Vt.Ck)(this.targetProj_,this.sourceProj_);this.transformInv_=function(q){const Y=q[0]+"/"+q[1];return st[Y]||(st[Y]=ot(q)),st[Y]},this.maxSourceExtent_=et,this.errorThresholdSquared_=it*it,this.triangles_=[],this.wrapsXInSource_=!1,this.canWrapXInSource_=this.sourceProj_.canWrapX()&&!!et&&!!this.sourceProj_.getExtent()&&(0,Xt.dz)(et)==(0,Xt.dz)(this.sourceProj_.getExtent()),this.sourceWorldWidth_=this.sourceProj_.getExtent()?(0,Xt.dz)(this.sourceProj_.getExtent()):null,this.targetWorldWidth_=this.targetProj_.getExtent()?(0,Xt.dz)(this.targetProj_.getExtent()):null;const lt=(0,Xt.rL)(H),mt=(0,Xt.Xv)(H),_t=(0,Xt.w$)(H),vt=(0,Xt.hC)(H),bt=this.transformInv_(lt),Mt=this.transformInv_(mt),Et=this.transformInv_(_t),Rt=this.transformInv_(vt),It=10+(nt?Math.max(0,Math.ceil(Math.log2((0,Xt.bg)(H)/(nt*nt*256*256)))):0);if(this.addQuad_(lt,mt,_t,vt,bt,Mt,Et,Rt,It),this.wrapsXInSource_){let q=1/0;this.triangles_.forEach((function(Y,H,et){q=Math.min(q,Y.source[0][0],Y.source[1][0],Y.source[2][0])})),this.triangles_.forEach((Y=>{if(Math.max(Y.source[0][0],Y.source[1][0],Y.source[2][0])-q>this.sourceWorldWidth_/2){const H=[[Y.source[0][0],Y.source[0][1]],[Y.source[1][0],Y.source[1][1]],[Y.source[2][0],Y.source[2][1]]];H[0][0]-q>this.sourceWorldWidth_/2&&(H[0][0]-=this.sourceWorldWidth_),H[1][0]-q>this.sourceWorldWidth_/2&&(H[1][0]-=this.sourceWorldWidth_),H[2][0]-q>this.sourceWorldWidth_/2&&(H[2][0]-=this.sourceWorldWidth_);const et=Math.min(H[0][0],H[1][0],H[2][0]);Math.max(H[0][0],H[1][0],H[2][0])-et<this.sourceWorldWidth_/2&&(Y.source=H)}}))}st={}}addTriangle_(q,Y,H,et,it,nt){this.triangles_.push({source:[et,it,nt],target:[q,Y,H]})}addQuad_(q,Y,H,et,it,nt,st,ot,lt){const mt=(0,Xt.hI)([it,nt,st,ot]),_t=this.sourceWorldWidth_?(0,Xt.dz)(mt)/this.sourceWorldWidth_:null,vt=this.sourceWorldWidth_,bt=this.sourceProj_.canWrapX()&&_t>.5&&_t<1;let Mt=!1;if(lt>0){if(this.targetProj_.isGlobal()&&this.targetWorldWidth_){const it=(0,Xt.hI)([q,Y,H,et]);Mt=(0,Xt.dz)(it)/this.targetWorldWidth_>.25||Mt}!bt&&this.sourceProj_.isGlobal()&&_t&&(Mt=_t>.25||Mt)}if(!Mt&&this.maxSourceExtent_&&isFinite(mt[0])&&isFinite(mt[1])&&isFinite(mt[2])&&isFinite(mt[3])&&!(0,Xt.kK)(mt,this.maxSourceExtent_))return;let Et=0;if(!(Mt||isFinite(it[0])&&isFinite(it[1])&&isFinite(nt[0])&&isFinite(nt[1])&&isFinite(st[0])&&isFinite(st[1])&&isFinite(ot[0])&&isFinite(ot[1])))if(lt>0)Mt=!0;else if(Et=(isFinite(it[0])&&isFinite(it[1])?0:8)+(isFinite(nt[0])&&isFinite(nt[1])?0:4)+(isFinite(st[0])&&isFinite(st[1])?0:2)+(isFinite(ot[0])&&isFinite(ot[1])?0:1),1!=Et&&2!=Et&&4!=Et&&8!=Et)return;if(lt>0){if(!Mt){const Y=[(q[0]+H[0])/2,(q[1]+H[1])/2],et=this.transformInv_(Y);let nt;nt=bt?((0,_n.$W)(it[0],vt)+(0,_n.$W)(st[0],vt))/2-(0,_n.$W)(et[0],vt):(it[0]+st[0])/2-et[0];const ot=(it[1]+st[1])/2-et[1];Mt=nt*nt+ot*ot>this.errorThresholdSquared_}if(Mt){if(Math.abs(q[0]-H[0])<=Math.abs(q[1]-H[1])){const mt=[(Y[0]+H[0])/2,(Y[1]+H[1])/2],_t=this.transformInv_(mt),vt=[(et[0]+q[0])/2,(et[1]+q[1])/2],bt=this.transformInv_(vt);this.addQuad_(q,Y,mt,vt,it,nt,_t,bt,lt-1),this.addQuad_(vt,mt,H,et,bt,_t,st,ot,lt-1)}else{const mt=[(q[0]+Y[0])/2,(q[1]+Y[1])/2],_t=this.transformInv_(mt),vt=[(H[0]+et[0])/2,(H[1]+et[1])/2],bt=this.transformInv_(vt);this.addQuad_(q,mt,vt,et,it,_t,bt,ot,lt-1),this.addQuad_(mt,Y,H,vt,_t,nt,st,bt,lt-1)}return}}if(bt){if(!this.canWrapXInSource_)return;this.wrapsXInSource_=!0}0==(11&Et)&&this.addTriangle_(q,H,et,it,st,ot),0==(14&Et)&&this.addTriangle_(q,H,Y,it,st,nt),Et&&(0==(13&Et)&&this.addTriangle_(Y,et,q,nt,ot,it),0==(7&Et)&&this.addTriangle_(Y,et,H,nt,ot,st))}calculateSourceExtent(){const q=(0,Xt.lJ)();return this.triangles_.forEach((function(Y,H,et){const it=Y.source;(0,Xt.Wj)(q,it[0]),(0,Xt.Wj)(q,it[1]),(0,Xt.Wj)(q,it[2])})),q}getTriangles(){return this.triangles_}};let Kn;const Hn=[];function fr(q,Y,H,et,it){q.beginPath(),q.moveTo(0,0),q.lineTo(Y,H),q.lineTo(et,it),q.closePath(),q.save(),q.clip(),q.fillRect(0,0,Math.max(Y,et)+1,Math.max(H,it)),q.restore()}function gr(q,Y){return Math.abs(q[4*Y]-210)>2||Math.abs(q[4*Y+3]-191.25)>2}function pr(q,Y,H,et){const it=(0,Vt.vs)(H,Y,q);let nt=(0,Vt._Q)(Y,et,H);const st=Y.getMetersPerUnit();void 0!==st&&(nt*=st);const ot=q.getMetersPerUnit();void 0!==ot&&(nt/=ot);const lt=q.getExtent();if(!lt||(0,Xt.b8)(lt,it)){const Y=(0,Vt._Q)(q,nt,it)/nt;isFinite(Y)&&Y>0&&(nt/=Y)}return nt}function mr(q,Y,H,et,it,nt,st,ot,lt,mt,_t,vt){const bt=(0,At.E4)(Math.round(H*q),Math.round(H*Y),Hn);if(vt||(bt.imageSmoothingEnabled=!1),0===lt.length)return bt.canvas;function f(q){return Math.round(q*H)/H}bt.scale(H,H),bt.globalCompositeOperation="lighter";const Mt=(0,Xt.lJ)();lt.forEach((function(q,Y,H){(0,Xt.l7)(Mt,q.extent)}));const Et=(0,Xt.dz)(Mt),Rt=(0,Xt.Cr)(Mt),It=(0,At.E4)(Math.round(H*Et/et),Math.round(H*Rt/et),Hn);vt||(It.imageSmoothingEnabled=!1);const Pt=H/et;lt.forEach((function(q,Y,H){const et=q.extent[0]-Mt[0],it=-(q.extent[3]-Mt[3]),nt=(0,Xt.dz)(q.extent),st=(0,Xt.Cr)(q.extent);q.image.width>0&&q.image.height>0&&It.drawImage(q.image,mt,mt,q.image.width-2*mt,q.image.height-2*mt,et*Pt,it*Pt,nt*Pt,st*Pt)}));const Tt=(0,Xt.rL)(st);return ot.getTriangles().forEach((function(q,Y,it){const st=q.source,ot=q.target;let lt=st[0][0],mt=st[0][1],_t=st[1][0],Et=st[1][1],Rt=st[2][0],Pt=st[2][1];const Ft=f((ot[0][0]-Tt[0])/nt),Lt=f(-(ot[0][1]-Tt[1])/nt),Nt=f((ot[1][0]-Tt[0])/nt),kt=f(-(ot[1][1]-Tt[1])/nt),Gt=f((ot[2][0]-Tt[0])/nt),jt=f(-(ot[2][1]-Tt[1])/nt),Dt=lt,zt=mt;lt=0,mt=0,_t-=Dt,Et-=zt,Rt-=Dt,Pt-=zt;const Bt=[[_t,Et,0,0,Nt-Ft],[Rt,Pt,0,0,Gt-Ft],[0,0,_t,Et,kt-Lt],[0,0,Rt,Pt,jt-Lt]],Ut=(0,_n.SV)(Bt);if(Ut){if(bt.save(),bt.beginPath(),function(){if(void 0===Kn){const q=(0,At.E4)(6,6,Hn);q.globalCompositeOperation="lighter",q.fillStyle="rgba(210, 0, 0, 0.75)",fr(q,4,5,4,0),fr(q,4,5,0,5);const Y=q.getImageData(0,0,3,3).data;Kn=gr(Y,0)||gr(Y,4)||gr(Y,8),(0,At.jy)(q),Hn.push(q.canvas)}return Kn}()||!vt){bt.moveTo(Nt,kt);const q=4,Y=Ft-Nt,H=Lt-kt;for(let et=0;et<q;et++)bt.lineTo(Nt+f((et+1)*Y/q),kt+f(et*H/(q-1))),et!=q-1&&bt.lineTo(Nt+f((et+1)*Y/q),kt+f((et+1)*H/(q-1)));bt.lineTo(Gt,jt)}else bt.moveTo(Nt,kt),bt.lineTo(Ft,Lt),bt.lineTo(Gt,jt);bt.clip(),bt.transform(Ut[0],Ut[2],Ut[1],Ut[3],Ft,Lt),bt.translate(Mt[0]-Dt,Mt[3]-zt),bt.scale(et/H,-et/H),bt.drawImage(It.canvas,0,0),bt.restore()}})),(0,At.jy)(It),Hn.push(It.canvas),_t&&(bt.save(),bt.globalCompositeOperation="source-over",bt.strokeStyle="black",bt.lineWidth=1,ot.getTriangles().forEach((function(q,Y,H){const et=q.target,it=(et[0][0]-Tt[0])/nt,st=-(et[0][1]-Tt[1])/nt,ot=(et[1][0]-Tt[0])/nt,lt=-(et[1][1]-Tt[1])/nt,mt=(et[2][0]-Tt[0])/nt,_t=-(et[2][1]-Tt[1])/nt;bt.beginPath(),bt.moveTo(ot,lt),bt.lineTo(it,st),bt.lineTo(mt,_t),bt.closePath(),bt.stroke()})),bt.restore()),bt.canvas}const Jn=class extends Yn{constructor(q,Y,H,et,it,nt,st,ot,lt,mt,_t,vt){super(it,0,{interpolate:!!vt}),this.renderEdges_=void 0!==_t&&_t,this.pixelRatio_=st,this.gutter_=ot,this.canvas_=null,this.sourceTileGrid_=Y,this.targetTileGrid_=et,this.wrappedTileCoord_=nt||it,this.sourceTiles_=[],this.sourcesListenerKeys_=null,this.sourceZ_=0;const bt=et.getTileCoordExtent(this.wrappedTileCoord_),Mt=this.targetTileGrid_.getExtent();let Et=this.sourceTileGrid_.getExtent();const Rt=Mt?(0,Xt.Ed)(bt,Mt):bt;if(0===(0,Xt.bg)(Rt))return void(this.state=4);const It=q.getExtent();It&&(Et=Et?(0,Xt.Ed)(Et,It):It);const Pt=et.getResolution(this.wrappedTileCoord_[0]),Tt=function(q,Y,H,et){const it=(0,Xt.qg)(H);let nt=pr(q,Y,it,et);return(!isFinite(nt)||nt<=0)&&(0,Xt.H6)(H,(function(H){return nt=pr(q,Y,H,et),isFinite(nt)&&nt>0})),nt}(q,H,Rt,Pt);if(!isFinite(Tt)||Tt<=0)return void(this.state=4);const Ft=void 0!==mt?mt:.5;if(this.triangulation_=new Vn(q,H,Rt,Et,Tt*Ft,Pt),0===this.triangulation_.getTriangles().length)return void(this.state=4);this.sourceZ_=Y.getZForResolution(Tt);let At=this.triangulation_.calculateSourceExtent();if(Et&&(q.canWrapX()?(At[1]=(0,_n.uZ)(At[1],Et[1],Et[3]),At[3]=(0,_n.uZ)(At[3],Et[1],Et[3])):At=(0,Xt.Ed)(At,Et)),(0,Xt.bg)(At)){const q=Y.getTileRangeForExtentAndZ(At,this.sourceZ_);for(let Y=q.minX;Y<=q.maxX;Y++)for(let H=q.minY;H<=q.maxY;H++){const q=lt(this.sourceZ_,Y,H,st);q&&this.sourceTiles_.push(q)}0===this.sourceTiles_.length&&(this.state=4)}else this.state=4}getImage(){return this.canvas_}reproject_(){const q=[];if(this.sourceTiles_.forEach((Y=>{Y&&2==Y.getState()&&q.push({extent:this.sourceTileGrid_.getTileCoordExtent(Y.tileCoord),image:Y.getImage()})})),this.sourceTiles_.length=0,0===q.length)this.state=3;else{const Y=this.wrappedTileCoord_[0],H=this.targetTileGrid_.getTileSize(Y),et="number"==typeof H?H:H[0],it="number"==typeof H?H:H[1],nt=this.targetTileGrid_.getResolution(Y),st=this.sourceTileGrid_.getResolution(this.sourceZ_),ot=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);this.canvas_=mr(et,it,this.pixelRatio_,st,this.sourceTileGrid_.getExtent(),nt,ot,this.triangulation_,q,this.gutter_,this.renderEdges_,this.interpolate),this.state=2}this.changed()}load(){if(0==this.state){this.state=1,this.changed();let q=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach((Y=>{const H=Y.getState();if(0==H||1==H){q++;const H=(0,Cn.oL)(Y,Sn.Z.CHANGE,(function(et){const it=Y.getState();2!=it&&3!=it&&4!=it||((0,Cn.bN)(H),q--,0===q&&(this.unlistenSources_(),this.reproject_()))}),this);this.sourcesListenerKeys_.push(H)}})),0===q?setTimeout(this.reproject_.bind(this),0):this.sourceTiles_.forEach((function(q,Y,H){0==q.getState()&&q.load()}))}}unlistenSources_(){this.sourcesListenerKeys_.forEach(Cn.bN),this.sourcesListenerKeys_=null}release(){this.canvas_&&((0,At.jy)(this.canvas_.getContext("2d")),Hn.push(this.canvas_),this.canvas_=null),super.release()}};class Qn{constructor(q,Y,H,et){this.minX=q,this.maxX=Y,this.minY=H,this.maxY=et}contains(q){return this.containsXY(q[1],q[2])}containsTileRange(q){return this.minX<=q.minX&&q.maxX<=this.maxX&&this.minY<=q.minY&&q.maxY<=this.maxY}containsXY(q,Y){return this.minX<=q&&q<=this.maxX&&this.minY<=Y&&Y<=this.maxY}equals(q){return this.minX==q.minX&&this.minY==q.minY&&this.maxX==q.maxX&&this.maxY==q.maxY}extend(q){q.minX<this.minX&&(this.minX=q.minX),q.maxX>this.maxX&&(this.maxX=q.maxX),q.minY<this.minY&&(this.minY=q.minY),q.maxY>this.maxY&&(this.maxY=q.maxY)}getHeight(){return this.maxY-this.minY+1}getSize(){return[this.getWidth(),this.getHeight()]}getWidth(){return this.maxX-this.minX+1}intersects(q){return this.minX<=q.maxX&&this.maxX>=q.minX&&this.minY<=q.maxY&&this.maxY>=q.minY}}function vr(q,Y,H,et,it){return void 0!==it?(it.minX=q,it.maxX=Y,it.minY=H,it.maxY=et,it):new Qn(q,Y,H,et)}const $n=Qn;var es=i(4307);const is=class extends Un{constructor(q){super(q),this.extentChanged=!0,this.renderedExtent_=null,this.renderedPixelRatio,this.renderedProjection=null,this.renderedRevision,this.renderedTiles=[],this.newTiles_=!1,this.tmpExtent=(0,Xt.lJ)(),this.tmpTileRange_=new $n(0,0,0,0)}isDrawableTile(q){const Y=this.getLayer(),H=q.getState(),et=Y.getUseInterimTilesOnError();return 2==H||4==H||3==H&&!et}getTile(q,Y,H,et){const it=et.pixelRatio,nt=et.viewState.projection,st=this.getLayer();let ot=st.getSource().getTile(q,Y,H,it,nt);return 3==ot.getState()&&st.getUseInterimTilesOnError()&&st.getPreload()>0&&(this.newTiles_=!0),this.isDrawableTile(ot)||(ot=ot.getInterimTile()),ot}getData(q){const Y=this.frameState;if(!Y)return null;const H=this.getLayer(),et=(0,Gn.nn)(Y.pixelToCoordinateTransform,q.slice()),it=H.getExtent();if(it&&!(0,Xt.b8)(it,et))return null;const nt=Y.pixelRatio,st=Y.viewState.projection,ot=Y.viewState,lt=H.getRenderSource(),mt=lt.getTileGridForProjection(ot.projection),_t=lt.getTilePixelRatio(Y.pixelRatio);for(let q=mt.getZForResolution(ot.resolution);q>=mt.getMinZoom();--q){const Y=mt.getTileCoordForCoordAndZ(et,q),H=lt.getTile(q,Y[1],Y[2],nt,st);if(!(H instanceof Xn||H instanceof Jn)||H instanceof Jn&&4===H.getState())return null;if(2!==H.getState())continue;const it=mt.getOrigin(q),vt=(0,es.Pq)(mt.getTileSize(q)),bt=mt.getResolution(q),Mt=Math.floor(_t*((et[0]-it[0])/bt-Y[1]*vt[0])),Et=Math.floor(_t*((it[1]-et[1])/bt-Y[2]*vt[1])),Rt=Math.round(_t*lt.getGutterForProjection(ot.projection));return this.getImageData(H.getImage(),Mt+Rt,Et+Rt)}return null}loadedTileCallback(q,Y,H){return!!this.isDrawableTile(H)&&super.loadedTileCallback(q,Y,H)}prepareFrame(q){return!!this.getLayer().getSource()}renderFrame(q,Y){const H=q.layerStatesArray[q.layerIndex],et=q.viewState,it=et.projection,nt=et.resolution,st=et.center,ot=et.rotation,lt=q.pixelRatio,mt=this.getLayer(),_t=mt.getSource(),vt=_t.getRevision(),bt=_t.getTileGridForProjection(it),Mt=bt.getZForResolution(nt,_t.zDirection),Et=bt.getResolution(Mt);let Rt=q.extent;const It=q.viewState.resolution,Pt=_t.getTilePixelRatio(lt),Tt=Math.round((0,Xt.dz)(Rt)/It*lt),Ft=Math.round((0,Xt.Cr)(Rt)/It*lt),At=H.extent&&(0,Vt.dY)(H.extent,it);At&&(Rt=(0,Xt.Ed)(Rt,(0,Vt.dY)(H.extent,it)));const Lt=Et*Tt/2/Pt,Nt=Et*Ft/2/Pt,kt=[st[0]-Lt,st[1]-Nt,st[0]+Lt,st[1]+Nt],Gt=bt.getTileRangeForExtentAndZ(Rt,Mt),jt={};jt[Mt]={};const Dt=this.createLoadedTileFinder(_t,it,jt),zt=this.tmpExtent,Bt=this.tmpTileRange_;this.newTiles_=!1;const Ut=ot?(0,Xt.dY)(et.center,It,ot,q.size):void 0;for(let Y=Gt.minX;Y<=Gt.maxX;++Y)for(let et=Gt.minY;et<=Gt.maxY;++et){if(ot&&!bt.tileCoordIntersectsViewport([Mt,Y,et],Ut))continue;const it=this.getTile(Mt,Y,et,q);if(this.isDrawableTile(it)){const Y=(0,mn.sq)(this);if(2==it.getState()){jt[Mt][it.tileCoord.toString()]=it;let q=it.inTransition(Y);q&&1!==H.opacity&&(it.endTransition(Y),q=!1),this.newTiles_||!q&&this.renderedTiles.includes(it)||(this.newTiles_=!0)}if(1===it.getAlpha(Y,q.time))continue}const nt=bt.getTileCoordChildTileRange(it.tileCoord,Bt,zt);let st=!1;nt&&(st=Dt(Mt+1,nt)),st||bt.forEachTileCoordParentTileRange(it.tileCoord,Dt,Bt,zt)}const qt=Et/nt*lt/Pt;(0,Gn.qC)(this.pixelTransform,q.size[0]/2,q.size[1]/2,1/lt,1/lt,ot,-Tt/2,-Ft/2);const Wt=(0,Gn.BB)(this.pixelTransform);this.useContainer(Y,Wt,this.getBackground(q));const Yt=this.context,Zt=Yt.canvas;(0,Gn.nb)(this.inversePixelTransform,this.pixelTransform),(0,Gn.qC)(this.tempTransform,Tt/2,Ft/2,qt,qt,0,-Tt/2,-Ft/2),Zt.width!=Tt||Zt.height!=Ft?(Zt.width=Tt,Zt.height=Ft):this.containerReused||Yt.clearRect(0,0,Tt,Ft),At&&this.clipUnrotated(Yt,q,At),_t.getInterpolate()||(Yt.imageSmoothingEnabled=!1),this.preRender(Yt,q),this.renderedTiles.length=0;let Kt,Ht,$t,te=Object.keys(jt).map(Number);te.sort(Dn.j2),1!==H.opacity||this.containerReused&&!_t.getOpaque(q.viewState.projection)?(Kt=[],Ht=[]):te=te.reverse();for(let Y=te.length-1;Y>=0;--Y){const H=te[Y],et=_t.getTilePixelSize(H,lt,it),nt=bt.getResolution(H)/Et,st=et[0]*nt*qt,ot=et[1]*nt*qt,mt=bt.getTileCoordForCoordAndZ((0,Xt.rL)(kt),H),vt=bt.getTileCoordExtent(mt),Rt=(0,Gn.nn)(this.tempTransform,[Pt*(vt[0]-kt[0])/Et,Pt*(kt[3]-vt[3])/Et]),It=Pt*_t.getGutterForProjection(it),Tt=jt[H];for(const Y in Tt){const et=Tt[Y],it=et.tileCoord,nt=mt[1]-it[1],lt=Math.round(Rt[0]-(nt-1)*st),vt=mt[2]-it[2],bt=Math.round(Rt[1]-(vt-1)*ot),Et=Math.round(Rt[0]-nt*st),Pt=Math.round(Rt[1]-vt*ot),Ft=lt-Et,At=bt-Pt,Lt=Mt===H,Nt=Lt&&1!==et.getAlpha((0,mn.sq)(this),q.time);let kt=!1;if(!Nt)if(Kt){$t=[Et,Pt,Et+Ft,Pt,Et+Ft,Pt+At,Et,Pt+At];for(let q=0,Y=Kt.length;q<Y;++q)if(Mt!==H&&H<Ht[q]){const Y=Kt[q];(0,Xt.kK)([Et,Pt,Et+Ft,Pt+At],[Y[0],Y[3],Y[4],Y[7]])&&(kt||(Yt.save(),kt=!0),Yt.beginPath(),Yt.moveTo($t[0],$t[1]),Yt.lineTo($t[2],$t[3]),Yt.lineTo($t[4],$t[5]),Yt.lineTo($t[6],$t[7]),Yt.moveTo(Y[6],Y[7]),Yt.lineTo(Y[4],Y[5]),Yt.lineTo(Y[2],Y[3]),Yt.lineTo(Y[0],Y[1]),Yt.clip())}Kt.push($t),Ht.push(H)}else Yt.clearRect(Et,Pt,Ft,At);this.drawTileImage(et,q,Et,Pt,Ft,At,It,Lt),Kt&&!Nt?(kt&&Yt.restore(),this.renderedTiles.unshift(et)):this.renderedTiles.push(et),this.updateUsedTiles(q.usedTiles,_t,et)}}return this.renderedRevision=vt,this.renderedResolution=Et,this.extentChanged=!this.renderedExtent_||!(0,Xt.fS)(this.renderedExtent_,kt),this.renderedExtent_=kt,this.renderedPixelRatio=lt,this.renderedProjection=it,this.manageTilePyramid(q,_t,bt,lt,it,Rt,Mt,mt.getPreload()),this.scheduleExpireCache(q,_t),this.postRender(Yt,q),H.extent&&Yt.restore(),Yt.imageSmoothingEnabled=!0,Wt!==Zt.style.transform&&(Zt.style.transform=Wt),this.container}drawTileImage(q,Y,H,et,it,nt,st,ot){const lt=this.getTileImage(q);if(!lt)return;const mt=(0,mn.sq)(this),_t=Y.layerStatesArray[Y.layerIndex],vt=_t.opacity*(ot?q.getAlpha(mt,Y.time):1),bt=vt!==this.context.globalAlpha;bt&&(this.context.save(),this.context.globalAlpha=vt),this.context.drawImage(lt,st,st,lt.width-2*st,lt.height-2*st,H,et,it,nt),bt&&this.context.restore(),vt!==_t.opacity?Y.animate=!0:ot&&q.endTransition(mt)}getImage(){const q=this.context;return q?q.canvas:null}getTileImage(q){return q.getImage()}scheduleExpireCache(q,Y){if(Y.canExpireCache()){const H=function(q,Y,H){const et=(0,mn.sq)(q);et in H.usedTiles&&q.expireCache(H.viewState.projection,H.usedTiles[et])}.bind(null,Y);q.postRenderFunctions.push(H)}}updateUsedTiles(q,Y,H){const et=(0,mn.sq)(Y);et in q||(q[et]={}),q[et][H.getKey()]=!0}manageTilePyramid(q,Y,H,et,it,nt,st,ot,lt){const mt=(0,mn.sq)(Y);mt in q.wantedTiles||(q.wantedTiles[mt]={});const _t=q.wantedTiles[mt],vt=q.tileQueue,bt=H.getMinZoom(),Mt=q.viewState.rotation,Et=Mt?(0,Xt.dY)(q.viewState.center,q.viewState.resolution,Mt,q.size):void 0;let Rt,It,Pt,Tt,Ft,At,Lt=0;for(At=bt;At<=st;++At)for(It=H.getTileRangeForExtentAndZ(nt,At,It),Pt=H.getResolution(At),Tt=It.minX;Tt<=It.maxX;++Tt)for(Ft=It.minY;Ft<=It.maxY;++Ft)Mt&&!H.tileCoordIntersectsViewport([At,Tt,Ft],Et)||(st-At<=ot?(++Lt,Rt=Y.getTile(At,Tt,Ft,et,it),0==Rt.getState()&&(_t[Rt.getKey()]=!0,vt.isKeyQueued(Rt.getKey())||vt.enqueue([Rt,mt,H.getTileCoordCenter(Rt.tileCoord),Pt])),void 0!==lt&&lt(Rt)):Y.useTile(At,Tt,Ft,it));Y.updateCacheSize(Lt,it)}},rs=class extends In{constructor(q){super(q)}createRenderer(){return new is(this)}},ns=class{constructor(q){this.highWaterMark=void 0!==q?q:2048,this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}canExpireCache(){return this.highWaterMark>0&&this.getCount()>this.highWaterMark}expireCache(q){for(;this.canExpireCache();)this.pop()}clear(){this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}containsKey(q){return this.entries_.hasOwnProperty(q)}forEach(q){let Y=this.oldest_;for(;Y;)q(Y.value_,Y.key_,this),Y=Y.newer}get(q,Y){const H=this.entries_[q];return(0,yn.h)(void 0!==H,15),H===this.newest_||(H===this.oldest_?(this.oldest_=this.oldest_.newer,this.oldest_.older=null):(H.newer.older=H.older,H.older.newer=H.newer),H.newer=null,H.older=this.newest_,this.newest_.newer=H,this.newest_=H),H.value_}remove(q){const Y=this.entries_[q];return(0,yn.h)(void 0!==Y,15),Y===this.newest_?(this.newest_=Y.older,this.newest_&&(this.newest_.newer=null)):Y===this.oldest_?(this.oldest_=Y.newer,this.oldest_&&(this.oldest_.older=null)):(Y.newer.older=Y.older,Y.older.newer=Y.newer),delete this.entries_[q],--this.count_,Y.value_}getCount(){return this.count_}getKeys(){const q=new Array(this.count_);let Y,H=0;for(Y=this.newest_;Y;Y=Y.older)q[H++]=Y.key_;return q}getValues(){const q=new Array(this.count_);let Y,H=0;for(Y=this.newest_;Y;Y=Y.older)q[H++]=Y.value_;return q}peekLast(){return this.oldest_.value_}peekLastKey(){return this.oldest_.key_}peekFirstKey(){return this.newest_.key_}peek(q){if(this.containsKey(q))return this.entries_[q].value_}pop(){const q=this.oldest_;return delete this.entries_[q.key_],q.newer&&(q.newer.older=null),this.oldest_=q.newer,this.oldest_||(this.newest_=null),--this.count_,q.value_}replace(q,Y){this.get(q),this.entries_[q].value_=Y}set(q,Y){(0,yn.h)(!(q in this.entries_),16);const H={key_:q,newer:null,older:this.newest_,value_:Y};this.newest_?this.newest_.newer=H:this.oldest_=H,this.newest_=H,this.entries_[q]=H,++this.count_}setSize(q){this.highWaterMark=q}};function Cr(q,Y,H,et){return void 0!==et?(et[0]=q,et[1]=Y,et[2]=H,et):[q,Y,H]}function Er(q,Y,H){return q+"/"+Y+"/"+H}function Rr(q){return Er(q[0],q[1],q[2])}function Or(q){return(q[1]<<q[0])+q[2]}const ss=class extends ns{clear(){for(;this.getCount()>0;)this.pop().release();super.clear()}expireCache(q){for(;this.canExpireCache()&&!(this.peekLast().getKey()in q);)this.pop().release()}pruneExceptNewestZ(){if(0===this.getCount())return;const q=this.peekFirstKey().split("/").map(Number)[0];this.forEach((Y=>{Y.tileCoord[0]!==q&&(this.remove(Rr(Y.tileCoord)),Y.release())}))}};class os extends rn.Z{constructor(q){super(),this.projection=(0,Vt.U2)(q.projection),this.attributions_=Tr(q.attributions),this.attributionsCollapsible_=void 0===q.attributionsCollapsible||q.attributionsCollapsible,this.loading=!1,this.state_=void 0!==q.state?q.state:"ready",this.wrapX_=void 0!==q.wrapX&&q.wrapX,this.interpolate_=!!q.interpolate,this.viewResolver=null,this.viewRejector=null;const Y=this;this.viewPromise_=new Promise((function(q,H){Y.viewResolver=q,Y.viewRejector=H}))}getAttributions(){return this.attributions_}getAttributionsCollapsible(){return this.attributionsCollapsible_}getProjection(){return this.projection}getResolutions(q){return null}getView(){return this.viewPromise_}getState(){return this.state_}getWrapX(){return this.wrapX_}getInterpolate(){return this.interpolate_}refresh(){this.changed()}setAttributions(q){this.attributions_=Tr(q),this.changed()}setState(q){this.state_=q,this.changed()}}function Tr(q){return q?Array.isArray(q)?function(Y){return q}:"function"==typeof q?q:function(Y){return[q]}:null}const hs=os;function Ar(q,Y,H,et,it){let nt;for(Y+=et;Y<H;Y+=et)if(nt=it(q.slice(Y-et,Y),q.slice(Y,Y+et)),nt)return nt;return!1}function Lr(q,Y,H,et,it){const nt=(0,Xt.H6)(it,(function(it){return!Nr(q,Y,H,et,it[0],it[1])}));return!nt}function Nr(q,Y,H,et,it,nt){let st=0,ot=q[H-et],lt=q[H-et+1];for(;Y<H;Y+=et){const H=q[Y],et=q[Y+1];lt<=nt?et>nt&&(H-ot)*(nt-lt)-(it-ot)*(et-lt)>0&&st++:et<=nt&&(H-ot)*(nt-lt)-(it-ot)*(et-lt)<0&&st--,ot=H,lt=et}return 0!==st}function kr(q,Y,H,et,it,nt){if(0===H.length)return!1;if(!Nr(q,Y,H[0],et,it,nt))return!1;for(let Y=1,st=H.length;Y<st;++Y)if(Nr(q,H[Y-1],H[Y],et,it,nt))return!1;return!0}function Gr(q,Y,H,et,it){const nt=(0,Xt.qP)((0,Xt.lJ)(),q,Y,H,et);return!!(0,Xt.kK)(it,nt)&&(!!(0,Xt.r4)(it,nt)||nt[0]>=it[0]&&nt[2]<=it[2]||nt[1]>=it[1]&&nt[3]<=it[3]||Ar(q,Y,H,et,(function(q,Y){return(0,Xt.I7)(it,q,Y)})))}function jr(q,Y,H,et,it){return!!(Gr(q,Y,H,et,it)||Nr(q,Y,H,et,it[0],it[1])||Nr(q,Y,H,et,it[0],it[3])||Nr(q,Y,H,et,it[2],it[1])||Nr(q,Y,H,et,it[2],it[3]))}function Dr(q,Y,H,et,it){if(!jr(q,Y,H[0],et,it))return!1;if(1===H.length)return!0;for(let Y=1,nt=H.length;Y<nt;++Y)if(Lr(q,H[Y-1],H[Y],et,it)&&!Gr(q,H[Y-1],H[Y],et,it))return!1;return!0}const ls=[0,0,0],cs=class{constructor(q){let Y;if(this.minZoom=void 0!==q.minZoom?q.minZoom:0,this.resolutions_=q.resolutions,(0,yn.h)((0,Dn.pT)(this.resolutions_,(function(q,Y){return Y-q}),!0),17),!q.origins)for(let q=0,H=this.resolutions_.length-1;q<H;++q)if(Y){if(this.resolutions_[q]/this.resolutions_[q+1]!==Y){Y=void 0;break}}else Y=this.resolutions_[q]/this.resolutions_[q+1];this.zoomFactor_=Y,this.maxZoom=this.resolutions_.length-1,this.origin_=void 0!==q.origin?q.origin:null,this.origins_=null,void 0!==q.origins&&(this.origins_=q.origins,(0,yn.h)(this.origins_.length==this.resolutions_.length,20));const H=q.extent;void 0===H||this.origin_||this.origins_||(this.origin_=(0,Xt.rL)(H)),(0,yn.h)(!this.origin_&&this.origins_||this.origin_&&!this.origins_,18),this.tileSizes_=null,void 0!==q.tileSizes&&(this.tileSizes_=q.tileSizes,(0,yn.h)(this.tileSizes_.length==this.resolutions_.length,19)),this.tileSize_=void 0!==q.tileSize?q.tileSize:this.tileSizes_?null:256,(0,yn.h)(!this.tileSize_&&this.tileSizes_||this.tileSize_&&!this.tileSizes_,22),this.extent_=void 0!==H?H:null,this.fullTileRanges_=null,this.tmpSize_=[0,0],this.tmpExtent_=[0,0,0,0],void 0!==q.sizes?this.fullTileRanges_=q.sizes.map((function(q,Y){const et=new $n(Math.min(0,q[0]),Math.max(q[0]-1,-1),Math.min(0,q[1]),Math.max(q[1]-1,-1));if(H){const q=this.getTileRangeForExtentAndZ(H,Y);et.minX=Math.max(q.minX,et.minX),et.maxX=Math.min(q.maxX,et.maxX),et.minY=Math.max(q.minY,et.minY),et.maxY=Math.min(q.maxY,et.maxY)}return et}),this):H&&this.calculateTileRanges_(H)}forEachTileCoord(q,Y,H){const et=this.getTileRangeForExtentAndZ(q,Y);for(let q=et.minX,it=et.maxX;q<=it;++q)for(let it=et.minY,nt=et.maxY;it<=nt;++it)H([Y,q,it])}forEachTileCoordParentTileRange(q,Y,H,et){let it,nt,st,ot=null,lt=q[0]-1;for(2===this.zoomFactor_?(nt=q[1],st=q[2]):ot=this.getTileCoordExtent(q,et);lt>=this.minZoom;){if(2===this.zoomFactor_?(nt=Math.floor(nt/2),st=Math.floor(st/2),it=vr(nt,nt,st,st,H)):it=this.getTileRangeForExtentAndZ(ot,lt,H),Y(lt,it))return!0;--lt}return!1}getExtent(){return this.extent_}getMaxZoom(){return this.maxZoom}getMinZoom(){return this.minZoom}getOrigin(q){return this.origin_?this.origin_:this.origins_[q]}getResolution(q){return this.resolutions_[q]}getResolutions(){return this.resolutions_}getTileCoordChildTileRange(q,Y,H){if(q[0]<this.maxZoom){if(2===this.zoomFactor_){const H=2*q[1],et=2*q[2];return vr(H,H+1,et,et+1,Y)}const et=this.getTileCoordExtent(q,H||this.tmpExtent_);return this.getTileRangeForExtentAndZ(et,q[0]+1,Y)}return null}getTileRangeForTileCoordAndZ(q,Y,H){if(Y>this.maxZoom||Y<this.minZoom)return null;const et=q[0],it=q[1],nt=q[2];if(Y===et)return vr(it,nt,it,nt,H);if(this.zoomFactor_){const q=Math.pow(this.zoomFactor_,Y-et),st=Math.floor(it*q),ot=Math.floor(nt*q);return Y<et?vr(st,st,ot,ot,H):vr(st,Math.floor(q*(it+1))-1,ot,Math.floor(q*(nt+1))-1,H)}const st=this.getTileCoordExtent(q,this.tmpExtent_);return this.getTileRangeForExtentAndZ(st,Y,H)}getTileRangeExtent(q,Y,H){const et=this.getOrigin(q),it=this.getResolution(q),nt=(0,es.Pq)(this.getTileSize(q),this.tmpSize_),st=et[0]+Y.minX*nt[0]*it,ot=et[0]+(Y.maxX+1)*nt[0]*it,lt=et[1]+Y.minY*nt[1]*it,mt=et[1]+(Y.maxY+1)*nt[1]*it;return(0,Xt.T9)(st,lt,ot,mt,H)}getTileRangeForExtentAndZ(q,Y,H){this.getTileCoordForXYAndZ_(q[0],q[3],Y,!1,ls);const et=ls[1],it=ls[2];return this.getTileCoordForXYAndZ_(q[2],q[1],Y,!0,ls),vr(et,ls[1],it,ls[2],H)}getTileCoordCenter(q){const Y=this.getOrigin(q[0]),H=this.getResolution(q[0]),et=(0,es.Pq)(this.getTileSize(q[0]),this.tmpSize_);return[Y[0]+(q[1]+.5)*et[0]*H,Y[1]-(q[2]+.5)*et[1]*H]}getTileCoordExtent(q,Y){const H=this.getOrigin(q[0]),et=this.getResolution(q[0]),it=(0,es.Pq)(this.getTileSize(q[0]),this.tmpSize_),nt=H[0]+q[1]*it[0]*et,st=H[1]-(q[2]+1)*it[1]*et,ot=nt+it[0]*et,lt=st+it[1]*et;return(0,Xt.T9)(nt,st,ot,lt,Y)}getTileCoordForCoordAndResolution(q,Y,H){return this.getTileCoordForXYAndResolution_(q[0],q[1],Y,!1,H)}getTileCoordForXYAndResolution_(q,Y,H,et,it){const nt=this.getZForResolution(H),st=H/this.getResolution(nt),ot=this.getOrigin(nt),lt=(0,es.Pq)(this.getTileSize(nt),this.tmpSize_);let mt=st*(q-ot[0])/H/lt[0],_t=st*(ot[1]-Y)/H/lt[1];return et?(mt=(0,_n.mD)(mt,5)-1,_t=(0,_n.mD)(_t,5)-1):(mt=(0,_n.GW)(mt,5),_t=(0,_n.GW)(_t,5)),Cr(nt,mt,_t,it)}getTileCoordForXYAndZ_(q,Y,H,et,it){const nt=this.getOrigin(H),st=this.getResolution(H),ot=(0,es.Pq)(this.getTileSize(H),this.tmpSize_);let lt=(q-nt[0])/st/ot[0],mt=(nt[1]-Y)/st/ot[1];return et?(lt=(0,_n.mD)(lt,5)-1,mt=(0,_n.mD)(mt,5)-1):(lt=(0,_n.GW)(lt,5),mt=(0,_n.GW)(mt,5)),Cr(H,lt,mt,it)}getTileCoordForCoordAndZ(q,Y,H){return this.getTileCoordForXYAndZ_(q[0],q[1],Y,!1,H)}getTileCoordResolution(q){return this.resolutions_[q[0]]}getTileSize(q){return this.tileSize_?this.tileSize_:this.tileSizes_[q]}getFullTileRange(q){return this.fullTileRanges_?this.fullTileRanges_[q]:this.extent_?this.getTileRangeForExtentAndZ(this.extent_,q):null}getZForResolution(q,Y){const H=(0,Dn.h7)(this.resolutions_,q,Y||0);return(0,_n.uZ)(H,this.minZoom,this.maxZoom)}tileCoordIntersectsViewport(q,Y){return jr(Y,0,Y.length,2,this.getTileCoordExtent(q))}calculateTileRanges_(q){const Y=this.resolutions_.length,H=new Array(Y);for(let et=this.minZoom;et<Y;++et)H[et]=this.getTileRangeForExtentAndZ(q,et);this.fullTileRanges_=H}};function Br(q){let Y=q.getDefaultTileGrid();return Y||(Y=function(q,Y,H,et){return function(q,Y,H,et){et=void 0!==et?et:"top-left";const it=Wr(q,void 0,H);return new cs({extent:q,origin:(0,Xt.g0)(q,et),resolutions:it,tileSize:H})}(qr(q),0,void 0,void 0)}(q),q.setDefaultTileGrid(Y)),Y}function Wr(q,Y,H,et){Y=void 0!==Y?Y:42,H=(0,es.Pq)(void 0!==H?H:256);const it=(0,Xt.Cr)(q),nt=(0,Xt.dz)(q);et=et>0?et:Math.max(nt/H[0],it/H[1]);const st=Y+1,ot=new Array(st);for(let q=0;q<st;++q)ot[q]=et/Math.pow(2,q);return ot}function qr(q){let Y=(q=(0,Vt.U2)(q)).getExtent();if(!Y){const H=180*Vt.Wm.degrees/q.getMetersPerUnit();Y=(0,Xt.T9)(-H,-H,H,H)}return Y}class ds extends Ln.ZP{constructor(q,Y){super(q),this.tile=Y}}const gs=class extends hs{constructor(q){super({attributions:q.attributions,attributionsCollapsible:q.attributionsCollapsible,projection:q.projection,state:q.state,wrapX:q.wrapX,interpolate:q.interpolate}),this.on,this.once,this.un,this.opaque_=void 0!==q.opaque&&q.opaque,this.tilePixelRatio_=void 0!==q.tilePixelRatio?q.tilePixelRatio:1,this.tileGrid=void 0!==q.tileGrid?q.tileGrid:null,this.tileGrid&&(0,es.Pq)(this.tileGrid.getTileSize(this.tileGrid.getMinZoom()),[256,256]),this.tileCache=new ss(q.cacheSize||0),this.tmpSize=[0,0],this.key_=q.key||"",this.tileOptions={transition:q.transition,interpolate:q.interpolate},this.zDirection=q.zDirection?q.zDirection:0}canExpireCache(){return this.tileCache.canExpireCache()}expireCache(q,Y){const H=this.getTileCacheForProjection(q);H&&H.expireCache(Y)}forEachLoadedTile(q,Y,H,et){const it=this.getTileCacheForProjection(q);if(!it)return!1;let nt,st,ot,lt=!0;for(let q=H.minX;q<=H.maxX;++q)for(let mt=H.minY;mt<=H.maxY;++mt)st=Er(Y,q,mt),ot=!1,it.containsKey(st)&&(nt=it.get(st),ot=2===nt.getState(),ot&&(ot=!1!==et(nt))),ot||(lt=!1);return lt}getGutterForProjection(q){return 0}getKey(){return this.key_}setKey(q){this.key_!==q&&(this.key_=q,this.changed())}getOpaque(q){return this.opaque_}getResolutions(q){const Y=q?this.getTileGridForProjection(q):this.tileGrid;return Y?Y.getResolutions():null}getTile(q,Y,H,et,it){return(0,mn.O3)()}getTileGrid(){return this.tileGrid}getTileGridForProjection(q){return this.tileGrid?this.tileGrid:Br(q)}getTileCacheForProjection(q){const Y=this.getProjection();return(0,yn.h)(null===Y||(0,Vt.OP)(Y,q),68),this.tileCache}getTilePixelRatio(q){return this.tilePixelRatio_}getTilePixelSize(q,Y,H){const et=this.getTileGridForProjection(H),it=this.getTilePixelRatio(Y),nt=(0,es.Pq)(et.getTileSize(q),this.tmpSize);return 1==it?nt:(0,es.bA)(nt,it,this.tmpSize)}getTileCoordForTileUrlFunction(q,Y){Y=void 0!==Y?Y:this.getProjection();const H=this.getTileGridForProjection(Y);return this.getWrapX()&&Y.isGlobal()&&(q=function(q,Y,H){const et=Y[0],it=q.getTileCoordCenter(Y),nt=qr(H);if(!(0,Xt.b8)(nt,it)){const Y=(0,Xt.dz)(nt),H=Math.ceil((nt[0]-it[0])/Y);return it[0]+=Y*H,q.getTileCoordForCoordAndZ(it,et)}return Y}(H,q,Y)),function(q,Y){const H=q[0],et=q[1],it=q[2];if(Y.getMinZoom()>H||H>Y.getMaxZoom())return!1;const nt=Y.getFullTileRange(H);return!nt||nt.containsXY(et,it)}(q,H)?q:null}clear(){this.tileCache.clear()}refresh(){this.clear(),super.refresh()}updateCacheSize(q,Y){const H=this.getTileCacheForProjection(Y);q>H.highWaterMark&&(H.highWaterMark=q)}useTile(q,Y,H,et){}};function Xr(q,Y){const H=/\{z\}/g,et=/\{x\}/g,it=/\{y\}/g,nt=/\{-y\}/g;return function(st,ot,lt){if(st)return q.replace(H,st[0].toString()).replace(et,st[1].toString()).replace(it,st[2].toString()).replace(nt,(function(){const q=st[0],H=Y.getFullTileRange(q);return(0,yn.h)(H,55),(H.getHeight()-st[2]-1).toString()}))}}function Vr(q){return 1===q.length?q[0]:function(Y,H,et){if(!Y)return;const it=Or(Y),nt=(0,_n.$W)(it,q.length);return q[nt](Y,H,et)}}function Kr(q){const Y=[];let H=/\{([a-z])-([a-z])\}/.exec(q);if(H){const et=H[1].charCodeAt(0),it=H[2].charCodeAt(0);let nt;for(nt=et;nt<=it;++nt)Y.push(q.replace(H[0],String.fromCharCode(nt)));return Y}if(H=/\{(\d+)-(\d+)\}/.exec(q),H){const et=parseInt(H[2],10);for(let it=parseInt(H[1],10);it<=et;it++)Y.push(q.replace(H[0],it.toString()));return Y}return Y.push(q),Y}class fs extends gs{constructor(q){super({attributions:q.attributions,cacheSize:q.cacheSize,opaque:q.opaque,projection:q.projection,state:q.state,tileGrid:q.tileGrid,tilePixelRatio:q.tilePixelRatio,wrapX:q.wrapX,transition:q.transition,interpolate:q.interpolate,key:q.key,attributionsCollapsible:q.attributionsCollapsible,zDirection:q.zDirection}),this.generateTileUrlFunction_=this.tileUrlFunction===fs.prototype.tileUrlFunction,this.tileLoadFunction=q.tileLoadFunction,q.tileUrlFunction&&(this.tileUrlFunction=q.tileUrlFunction),this.urls=null,q.urls?this.setUrls(q.urls):q.url&&this.setUrl(q.url),this.tileLoadingKeys_={}}getTileLoadFunction(){return this.tileLoadFunction}getTileUrlFunction(){return Object.getPrototypeOf(this).tileUrlFunction===this.tileUrlFunction?this.tileUrlFunction.bind(this):this.tileUrlFunction}getUrls(){return this.urls}handleTileChange(q){const Y=q.target,H=(0,mn.sq)(Y),et=Y.getState();let it;1==et?(this.tileLoadingKeys_[H]=!0,it="tileloadstart"):H in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[H],it=3==et?"tileloaderror":2==et?"tileloadend":void 0),null!=it&&this.dispatchEvent(new ds(it,Y))}setTileLoadFunction(q){this.tileCache.clear(),this.tileLoadFunction=q,this.changed()}setTileUrlFunction(q,Y){this.tileUrlFunction=q,this.tileCache.pruneExceptNewestZ(),void 0!==Y?this.setKey(Y):this.changed()}setUrl(q){const Y=Kr(q);this.urls=Y,this.setUrls(Y)}setUrls(q){this.urls=q;const Y=q.join("\n");this.generateTileUrlFunction_?this.setTileUrlFunction(function(q,Y){const H=q.length,et=new Array(H);for(let it=0;it<H;++it)et[it]=Xr(q[it],Y);return Vr(et)}(q,this.tileGrid),Y):this.setKey(Y)}tileUrlFunction(q,Y,H){}useTile(q,Y,H){const et=Er(q,Y,H);this.tileCache.containsKey(et)&&this.tileCache.get(et)}}const ps=fs;function Qr(q,Y){q.getImage().src=Y}const ms=class extends ps{constructor(q){super({attributions:q.attributions,cacheSize:q.cacheSize,opaque:q.opaque,projection:q.projection,state:q.state,tileGrid:q.tileGrid,tileLoadFunction:q.tileLoadFunction?q.tileLoadFunction:Qr,tilePixelRatio:q.tilePixelRatio,tileUrlFunction:q.tileUrlFunction,url:q.url,urls:q.urls,wrapX:q.wrapX,transition:q.transition,interpolate:void 0===q.interpolate||q.interpolate,key:q.key,attributionsCollapsible:q.attributionsCollapsible,zDirection:q.zDirection}),this.crossOrigin=void 0!==q.crossOrigin?q.crossOrigin:null,this.tileClass=void 0!==q.tileClass?q.tileClass:Xn,this.tileCacheForProjection={},this.tileGridForProjection={},this.reprojectionErrorThreshold_=q.reprojectionErrorThreshold,this.renderReprojectionEdges_=!1}canExpireCache(){if(this.tileCache.canExpireCache())return!0;for(const q in this.tileCacheForProjection)if(this.tileCacheForProjection[q].canExpireCache())return!0;return!1}expireCache(q,Y){const H=this.getTileCacheForProjection(q);this.tileCache.expireCache(this.tileCache==H?Y:{});for(const q in this.tileCacheForProjection){const et=this.tileCacheForProjection[q];et.expireCache(et==H?Y:{})}}getGutterForProjection(q){return this.getProjection()&&q&&!(0,Vt.OP)(this.getProjection(),q)?0:this.getGutter()}getGutter(){return 0}getKey(){let q=super.getKey();return this.getInterpolate()||(q+=":disable-interpolation"),q}getOpaque(q){return!(this.getProjection()&&q&&!(0,Vt.OP)(this.getProjection(),q))&&super.getOpaque(q)}getTileGridForProjection(q){const Y=this.getProjection();if(this.tileGrid&&(!Y||(0,Vt.OP)(Y,q)))return this.tileGrid;const H=(0,mn.sq)(q);return H in this.tileGridForProjection||(this.tileGridForProjection[H]=Br(q)),this.tileGridForProjection[H]}getTileCacheForProjection(q){const Y=this.getProjection();if(!Y||(0,Vt.OP)(Y,q))return this.tileCache;const H=(0,mn.sq)(q);return H in this.tileCacheForProjection||(this.tileCacheForProjection[H]=new ss(this.tileCache.highWaterMark)),this.tileCacheForProjection[H]}createTile_(q,Y,H,et,it,nt){const st=[q,Y,H],ot=this.getTileCoordForTileUrlFunction(st,it),lt=ot?this.tileUrlFunction(ot,et,it):void 0,mt=new this.tileClass(st,void 0!==lt?0:4,void 0!==lt?lt:"",this.crossOrigin,this.tileLoadFunction,this.tileOptions);return mt.key=nt,mt.addEventListener(Sn.Z.CHANGE,this.handleTileChange.bind(this)),mt}getTile(q,Y,H,et,it){const nt=this.getProjection();if(!nt||!it||(0,Vt.OP)(nt,it))return this.getTileInternal(q,Y,H,et,nt||it);const st=this.getTileCacheForProjection(it),ot=[q,Y,H];let lt;const mt=Rr(ot);st.containsKey(mt)&&(lt=st.get(mt));const _t=this.getKey();if(lt&&lt.key==_t)return lt;const vt=this.getTileGridForProjection(nt),bt=this.getTileGridForProjection(it),Mt=this.getTileCoordForTileUrlFunction(ot,it),Et=new Jn(nt,vt,it,bt,ot,Mt,this.getTilePixelRatio(et),this.getGutter(),((q,Y,H,et)=>this.getTileInternal(q,Y,H,et,nt)),this.reprojectionErrorThreshold_,this.renderReprojectionEdges_,this.getInterpolate());return Et.key=_t,lt?(Et.interimTile=lt,Et.refreshInterimChain(),st.replace(mt,Et)):st.set(mt,Et),Et}getTileInternal(q,Y,H,et,it){let nt=null;const st=Er(q,Y,H),ot=this.getKey();if(this.tileCache.containsKey(st)){if(nt=this.tileCache.get(st),nt.key!=ot){const lt=nt;nt=this.createTile_(q,Y,H,et,it,ot),0==lt.getState()?nt.interimTile=lt.interimTile:nt.interimTile=lt,nt.refreshInterimChain(),this.tileCache.replace(st,nt)}}else nt=this.createTile_(q,Y,H,et,it,ot),this.tileCache.set(st,nt);return nt}setRenderReprojectionEdges(q){if(this.renderReprojectionEdges_!=q){this.renderReprojectionEdges_=q;for(const q in this.tileCacheForProjection)this.tileCacheForProjection[q].clear();this.changed()}}setTileGridForProjection(q,Y){const H=(0,Vt.U2)(q);if(H){const q=(0,mn.sq)(H);q in this.tileGridForProjection||(this.tileGridForProjection[q]=Y)}}clear(){super.clear();for(const q in this.tileCacheForProjection)this.tileCacheForProjection[q].clear()}};function ts(q,Y){const H=[];Object.keys(Y).forEach((function(q){null!==Y[q]&&void 0!==Y[q]&&H.push(q+"="+encodeURIComponent(Y[q]))}));const et=H.join("&");return q=q.replace(/[?&]$/,""),(q+=q.includes("?")?"&":"?")+et}const bs=class extends ms{constructor(q){const Y=void 0!==q.requestEncoding?q.requestEncoding:"KVP",H=q.tileGrid;let et=q.urls;void 0===et&&void 0!==q.url&&(et=Kr(q.url)),super({attributions:q.attributions,attributionsCollapsible:q.attributionsCollapsible,cacheSize:q.cacheSize,crossOrigin:q.crossOrigin,interpolate:q.interpolate,projection:q.projection,reprojectionErrorThreshold:q.reprojectionErrorThreshold,tileClass:q.tileClass,tileGrid:H,tileLoadFunction:q.tileLoadFunction,tilePixelRatio:q.tilePixelRatio,urls:et,wrapX:void 0!==q.wrapX&&q.wrapX,transition:q.transition,zDirection:q.zDirection}),this.version_=void 0!==q.version?q.version:"1.0.0",this.format_=void 0!==q.format?q.format:"image/jpeg",this.dimensions_=void 0!==q.dimensions?q.dimensions:{},this.layer_=q.layer,this.matrixSet_=q.matrixSet,this.style_=q.style,this.requestEncoding_=Y,this.setKey(this.getKeyForDimensions_()),et&&et.length>0&&(this.tileUrlFunction=Vr(et.map(this.createFromWMTSTemplate.bind(this))))}setUrls(q){this.urls=q;const Y=q.join("\n");this.setTileUrlFunction(Vr(q.map(this.createFromWMTSTemplate.bind(this))),Y)}getDimensions(){return this.dimensions_}getFormat(){return this.format_}getLayer(){return this.layer_}getMatrixSet(){return this.matrixSet_}getRequestEncoding(){return this.requestEncoding_}getStyle(){return this.style_}getVersion(){return this.version_}getKeyForDimensions_(){const q=this.urls?this.urls.slice(0):[];for(const Y in this.dimensions_)q.push(Y+"-"+this.dimensions_[Y]);return q.join("/")}updateDimensions(q){Object.assign(this.dimensions_,q),this.setKey(this.getKeyForDimensions_())}createFromWMTSTemplate(q){const Y=this.requestEncoding_,H={layer:this.layer_,style:this.style_,tilematrixset:this.matrixSet_};"KVP"==Y&&Object.assign(H,{Service:"WMTS",Request:"GetTile",Version:this.version_,Format:this.format_}),q="KVP"==Y?ts(q,H):q.replace(/\{(\w+?)\}/g,(function(q,Y){return Y.toLowerCase()in H?H[Y.toLowerCase()]:q}));const et=this.tileGrid,it=this.dimensions_;return function(H,nt,st){if(!H)return;const ot={TileMatrix:et.getMatrixId(H[0]),TileCol:H[1],TileRow:H[2]};Object.assign(ot,it);let lt=q;return lt="KVP"==Y?ts(lt,ot):lt.replace(/\{(\w+?)\}/g,(function(q,Y){return ot[Y]})),lt}}},As=class extends ms{constructor(q){const Y=void 0!==(q=q||{}).projection?q.projection:"EPSG:3857",H=void 0!==q.tileGrid?q.tileGrid:function(q){const Y=q||{},H=Y.extent||(0,Vt.U2)("EPSG:3857").getExtent(),et={extent:H,minZoom:Y.minZoom,tileSize:Y.tileSize,resolutions:Wr(H,Y.maxZoom,Y.tileSize,Y.maxResolution)};return new cs(et)}({extent:qr(Y),maxResolution:q.maxResolution,maxZoom:q.maxZoom,minZoom:q.minZoom,tileSize:q.tileSize});super({attributions:q.attributions,cacheSize:q.cacheSize,crossOrigin:q.crossOrigin,interpolate:q.interpolate,opaque:q.opaque,projection:Y,reprojectionErrorThreshold:q.reprojectionErrorThreshold,tileGrid:H,tileLoadFunction:q.tileLoadFunction,tilePixelRatio:q.tilePixelRatio,tileUrlFunction:q.tileUrlFunction,url:q.url,urls:q.urls,wrapX:void 0===q.wrapX||q.wrapX,transition:q.transition,attributionsCollapsible:q.attributionsCollapsible,zDirection:q.zDirection}),this.gutter_=void 0!==q.gutter?q.gutter:0}getGutter(){return this.gutter_}};var Ls=i(1798);class Gs extends Ls.Z{constructor(q,Y,H,et,it,nt,st){const ot=q.getExtent(),lt=Y.getExtent(),mt=lt?(0,Xt.Ed)(H,lt):H,_t=pr(q,Y,(0,Xt.qg)(mt),et),vt=new Vn(q,Y,mt,ot,.5*_t,et),bt=nt(vt.calculateSourceExtent(),_t,it),Mt=bt?Pn.default.IDLE:Pn.default.EMPTY,Et=bt?bt.getPixelRatio():1;super(H,et,Et,Mt),this.targetProj_=Y,this.maxSourceExtent_=ot,this.triangulation_=vt,this.targetResolution_=et,this.targetExtent_=H,this.sourceImage_=bt,this.sourcePixelRatio_=Et,this.interpolate_=st,this.canvas_=null,this.sourceListenerKey_=null}disposeInternal(){this.state==Pn.default.LOADING&&this.unlistenSource_(),super.disposeInternal()}getImage(){return this.canvas_}getProjection(){return this.targetProj_}reproject_(){const q=this.sourceImage_.getState();if(q==Pn.default.LOADED){const q=(0,Xt.dz)(this.targetExtent_)/this.targetResolution_,Y=(0,Xt.Cr)(this.targetExtent_)/this.targetResolution_;this.canvas_=mr(q,Y,this.sourcePixelRatio_,this.sourceImage_.getResolution(),this.maxSourceExtent_,this.targetResolution_,this.targetExtent_,this.triangulation_,[{extent:this.sourceImage_.getExtent(),image:this.sourceImage_.getImage()}],0,void 0,this.interpolate_)}this.state=q,this.changed()}load(){if(this.state==Pn.default.IDLE){this.state=Pn.default.LOADING,this.changed();const q=this.sourceImage_.getState();q==Pn.default.LOADED||q==Pn.default.ERROR?this.reproject_():(this.sourceListenerKey_=(0,Cn.oL)(this.sourceImage_,Sn.Z.CHANGE,(function(q){const Y=this.sourceImage_.getState();Y!=Pn.default.LOADED&&Y!=Pn.default.ERROR||(this.unlistenSource_(),this.reproject_())}),this),this.sourceImage_.load())}}unlistenSource_(){(0,Cn.bN)(this.sourceListenerKey_),this.sourceListenerKey_=null}}const js=Gs;class Ds extends Ln.ZP{constructor(q,Y){super(q),this.image=Y}}function as(q,Y){q.getImage().src=Y}const zs=class extends hs{constructor(q){super({attributions:q.attributions,projection:q.projection,state:q.state,interpolate:void 0===q.interpolate||q.interpolate}),this.on,this.once,this.un,this.resolutions_=void 0!==q.resolutions?q.resolutions:null,this.reprojectedImage_=null,this.reprojectedRevision_=0}getResolutions(){return this.resolutions_}setResolutions(q){this.resolutions_=q}findNearestResolution(q){const Y=this.getResolutions();return Y&&(q=Y[(0,Dn.h7)(Y,q,0)]),q}getImage(q,Y,H,et){const it=this.getProjection();if(!it||!et||(0,Vt.OP)(it,et))return it&&(et=it),this.getImageInternal(q,Y,H,et);if(this.reprojectedImage_){if(this.reprojectedRevision_==this.getRevision()&&(0,Vt.OP)(this.reprojectedImage_.getProjection(),et)&&this.reprojectedImage_.getResolution()==Y&&(0,Xt.fS)(this.reprojectedImage_.getExtent(),q))return this.reprojectedImage_;this.reprojectedImage_.dispose(),this.reprojectedImage_=null}return this.reprojectedImage_=new js(it,et,q,Y,H,((q,Y,H)=>this.getImageInternal(q,Y,H,it)),this.getInterpolate()),this.reprojectedRevision_=this.getRevision(),this.reprojectedImage_}getImageInternal(q,Y,H,et){return(0,mn.O3)()}handleImageChange(q){const Y=q.target;let H;switch(Y.getState()){case Pn.default.LOADING:this.loading=!0,H="imageloadstart";break;case Pn.default.LOADED:this.loading=!1,H="imageloadend";break;case Pn.default.ERROR:this.loading=!1,H="imageloaderror";break;default:return}this.hasListener(H)&&this.dispatchEvent(new Ds(H,Y))}},Bs="1.3.0";function us(q,Y){const H=(""+q).split("."),et=(""+Y).split(".");for(let q=0;q<Math.max(H.length,et.length);q++){const Y=parseInt(H[q]||"0",10),it=parseInt(et[q]||"0",10);if(Y>it)return 1;if(it>Y)return-1}return 0}const Us=[101,101],Ws=class extends zs{constructor(q){super({attributions:(q=q||{}).attributions,interpolate:q.interpolate,projection:q.projection,resolutions:q.resolutions}),this.crossOrigin_=void 0!==q.crossOrigin?q.crossOrigin:null,this.url_=q.url,this.imageLoadFunction_=void 0!==q.imageLoadFunction?q.imageLoadFunction:as,this.params_=Object.assign({},q.params),this.v13_=!0,this.updateV13_(),this.serverType_=q.serverType,this.hidpi_=void 0===q.hidpi||q.hidpi,this.image_=null,this.imageSize_=[0,0],this.renderedRevision_=0,this.ratio_=void 0!==q.ratio?q.ratio:1.5}getFeatureInfoUrl(q,Y,H,et){if(void 0===this.url_)return;const it=(0,Vt.U2)(H),nt=this.getProjection();nt&&nt!==it&&(Y=pr(nt,it,q,Y),q=(0,Vt.vs)(q,it,nt));const st=(0,Xt.p8)(q,Y,0,Us),ot={SERVICE:"WMS",VERSION:Bs,REQUEST:"GetFeatureInfo",FORMAT:"image/png",TRANSPARENT:!0,QUERY_LAYERS:this.params_.LAYERS};Object.assign(ot,this.params_,et);const lt=(0,_n.GW)((q[0]-st[0])/Y,4),mt=(0,_n.GW)((st[3]-q[1])/Y,4);return ot[this.v13_?"I":"X"]=lt,ot[this.v13_?"J":"Y"]=mt,this.getRequestUrl_(st,Us,1,nt||it,ot)}getLegendUrl(q,Y){if(void 0===this.url_)return;const H={SERVICE:"WMS",VERSION:Bs,REQUEST:"GetLegendGraphic",FORMAT:"image/png"};if(void 0===Y||void 0===Y.LAYER){const q=this.params_.LAYERS;if(Array.isArray(q)&&1!==q.length)return;H.LAYER=q}if(void 0!==q){const Y=this.getProjection()?this.getProjection().getMetersPerUnit():1,et=28e-5;H.SCALE=q*Y/et}return Object.assign(H,Y),ts(this.url_,H)}getParams(){return this.params_}getImageInternal(q,Y,H,et){if(void 0===this.url_)return null;Y=this.findNearestResolution(Y),1==H||this.hidpi_&&void 0!==this.serverType_||(H=1);const it=Y/H,nt=(0,Xt.qg)(q),st=(0,_n.mD)((0,Xt.dz)(q)/it,4),ot=(0,_n.mD)((0,Xt.Cr)(q)/it,4),lt=(0,Xt.p8)(nt,it,0,[st,ot]),mt=(0,_n.mD)(this.ratio_*(0,Xt.dz)(q)/it,4),_t=(0,_n.mD)(this.ratio_*(0,Xt.Cr)(q)/it,4),vt=(0,Xt.p8)(nt,it,0,[mt,_t]),bt=this.image_;if(bt&&this.renderedRevision_==this.getRevision()&&bt.getResolution()==Y&&bt.getPixelRatio()==H&&(0,Xt.r4)(bt.getExtent(),lt))return bt;const Mt={SERVICE:"WMS",VERSION:Bs,REQUEST:"GetMap",FORMAT:"image/png",TRANSPARENT:!0};Object.assign(Mt,this.params_),this.imageSize_[0]=(0,_n.NM)((0,Xt.dz)(vt)/it,4),this.imageSize_[1]=(0,_n.NM)((0,Xt.Cr)(vt)/it,4);const Et=this.getRequestUrl_(vt,this.imageSize_,H,et,Mt);return this.image_=new Zn.Z(vt,Y,H,Et,this.crossOrigin_,this.imageLoadFunction_),this.renderedRevision_=this.getRevision(),this.image_.addEventListener(Sn.Z.CHANGE,this.handleImageChange.bind(this)),this.image_}getImageLoadFunction(){return this.imageLoadFunction_}getRequestUrl_(q,Y,H,et,it){if((0,yn.h)(void 0!==this.url_,9),it[this.v13_?"CRS":"SRS"]=et.getCode(),"STYLES"in this.params_||(it.STYLES=""),1!=H)switch(this.serverType_){case"geoserver":const q=90*H+.5|0;"FORMAT_OPTIONS"in it?it.FORMAT_OPTIONS+=";dpi:"+q:it.FORMAT_OPTIONS="dpi:"+q;break;case"mapserver":it.MAP_RESOLUTION=90*H;break;case"carmentaserver":case"qgis":it.DPI=90*H;break;default:(0,yn.h)(!1,8)}it.WIDTH=Y[0],it.HEIGHT=Y[1];const nt=et.getAxisOrientation();let st;return st=this.v13_&&"ne"==nt.substr(0,2)?[q[1],q[0],q[3],q[2]]:q,it.BBOX=st.join(","),ts(this.url_,it)}getUrl(){return this.url_}setImageLoadFunction(q){this.image_=null,this.imageLoadFunction_=q,this.changed()}setUrl(q){q!=this.url_&&(this.url_=q,this.image_=null,this.changed())}updateParams(q){Object.assign(this.params_,q),this.updateV13_(),this.image_=null,this.changed()}updateV13_(){const q=this.params_.VERSION||Bs;this.v13_=us(q,"1.3")>=0}},Hs=class extends ms{constructor(q){q=q||{};const Y=Object.assign({},q.params),H=!("TRANSPARENT"in Y)||Y.TRANSPARENT;super({attributions:q.attributions,attributionsCollapsible:q.attributionsCollapsible,cacheSize:q.cacheSize,crossOrigin:q.crossOrigin,interpolate:q.interpolate,opaque:!H,projection:q.projection,reprojectionErrorThreshold:q.reprojectionErrorThreshold,tileClass:q.tileClass,tileGrid:q.tileGrid,tileLoadFunction:q.tileLoadFunction,url:q.url,urls:q.urls,wrapX:void 0===q.wrapX||q.wrapX,transition:q.transition,zDirection:q.zDirection}),this.gutter_=void 0!==q.gutter?q.gutter:0,this.params_=Y,this.v13_=!0,this.serverType_=q.serverType,this.hidpi_=void 0===q.hidpi||q.hidpi,this.tmpExtent_=(0,Xt.lJ)(),this.updateV13_(),this.setKey(this.getKeyForParams_())}getFeatureInfoUrl(q,Y,H,et){const it=(0,Vt.U2)(H),nt=this.getProjection();let st=this.getTileGrid();st||(st=this.getTileGridForProjection(it));const ot=st.getZForResolution(Y,this.zDirection),lt=st.getTileCoordForCoordAndZ(q,ot);if(st.getResolutions().length<=lt[0])return;let mt=st.getResolution(lt[0]),_t=st.getTileCoordExtent(lt,this.tmpExtent_),vt=(0,es.Pq)(st.getTileSize(lt[0]),this.tmpSize);const bt=this.gutter_;0!==bt&&(vt=(0,es.f3)(vt,bt,this.tmpSize),_t=(0,Xt.f3)(_t,mt*bt,_t)),nt&&nt!==it&&(mt=pr(nt,it,q,mt),_t=(0,Vt.$A)(_t,it,nt),q=(0,Vt.vs)(q,it,nt));const Mt={SERVICE:"WMS",VERSION:Bs,REQUEST:"GetFeatureInfo",FORMAT:"image/png",TRANSPARENT:!0,QUERY_LAYERS:this.params_.LAYERS};Object.assign(Mt,this.params_,et);const Et=Math.floor((q[0]-_t[0])/mt),Rt=Math.floor((_t[3]-q[1])/mt);return Mt[this.v13_?"I":"X"]=Et,Mt[this.v13_?"J":"Y"]=Rt,this.getRequestUrl_(lt,vt,_t,1,nt||it,Mt)}getLegendUrl(q,Y){if(void 0===this.urls[0])return;const H={SERVICE:"WMS",VERSION:Bs,REQUEST:"GetLegendGraphic",FORMAT:"image/png"};if(void 0===Y||void 0===Y.LAYER){const q=this.params_.LAYERS;if(Array.isArray(q)&&1!==q.length)return;H.LAYER=q}if(void 0!==q){const Y=this.getProjection()?this.getProjection().getMetersPerUnit():1,et=28e-5;H.SCALE=q*Y/et}return Object.assign(H,Y),ts(this.urls[0],H)}getGutter(){return this.gutter_}getParams(){return this.params_}getRequestUrl_(q,Y,H,et,it,nt){const st=this.urls;if(!st)return;if(nt.WIDTH=Y[0],nt.HEIGHT=Y[1],nt[this.v13_?"CRS":"SRS"]=it.getCode(),"STYLES"in this.params_||(nt.STYLES=""),1!=et)switch(this.serverType_){case"geoserver":const q=90*et+.5|0;"FORMAT_OPTIONS"in nt?nt.FORMAT_OPTIONS+=";dpi:"+q:nt.FORMAT_OPTIONS="dpi:"+q;break;case"mapserver":nt.MAP_RESOLUTION=90*et;break;case"carmentaserver":case"qgis":nt.DPI=90*et;break;default:(0,yn.h)(!1,52)}const ot=it.getAxisOrientation(),lt=H;if(this.v13_&&"ne"==ot.substr(0,2)){let q;q=H[0],lt[0]=H[1],lt[1]=q,q=H[2],lt[2]=H[3],lt[3]=q}let mt;return nt.BBOX=lt.join(","),mt=1==st.length?st[0]:st[(0,_n.$W)(Or(q),st.length)],ts(mt,nt)}getTilePixelRatio(q){return this.hidpi_&&void 0!==this.serverType_?q:1}getKeyForParams_(){let q=0;const Y=[];for(const H in this.params_)Y[q++]=H+"-"+this.params_[H];return Y.join("/")}updateParams(q){Object.assign(this.params_,q),this.updateV13_(),this.setKey(this.getKeyForParams_())}updateV13_(){const q=this.params_.VERSION||Bs;this.v13_=us(q,"1.3")>=0}tileUrlFunction(q,Y,H){let et=this.getTileGrid();if(et||(et=this.getTileGridForProjection(H)),et.getResolutions().length<=q[0])return;1==Y||this.hidpi_&&void 0!==this.serverType_||(Y=1);const it=et.getResolution(q[0]);let nt=et.getTileCoordExtent(q,this.tmpExtent_),st=(0,es.Pq)(et.getTileSize(q[0]),this.tmpSize);const ot=this.gutter_;0!==ot&&(st=(0,es.f3)(st,ot,this.tmpSize),nt=(0,Xt.f3)(nt,it*ot,nt)),1!=Y&&(st=(0,es.bA)(st,Y,this.tmpSize));const lt={SERVICE:"WMS",VERSION:Bs,REQUEST:"GetMap",FORMAT:"image/png",TRANSPARENT:!0};return Object.assign(lt,this.params_),this.getRequestUrl_(q,st,nt,Y,H,lt)}};class Js extends rn.Z{constructor(q){if(super(),this.on,this.once,this.un,this.id_=void 0,this.geometryName_="geometry",this.style_=null,this.styleFunction_=void 0,this.geometryChangeKey_=null,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),q)if("function"==typeof q.getSimplifiedGeometry){const Y=q;this.setGeometry(Y)}else{const Y=q;this.setProperties(Y)}}clone(){const q=new Js(this.hasProperties()?this.getProperties():null);q.setGeometryName(this.getGeometryName());const Y=this.getGeometry();Y&&q.setGeometry(Y.clone());const H=this.getStyle();return H&&q.setStyle(H),q}getGeometry(){return this.get(this.geometryName_)}getId(){return this.id_}getGeometryName(){return this.geometryName_}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}handleGeometryChange_(){this.changed()}handleGeometryChanged_(){this.geometryChangeKey_&&((0,Cn.bN)(this.geometryChangeKey_),this.geometryChangeKey_=null);const q=this.getGeometry();q&&(this.geometryChangeKey_=(0,Cn.oL)(q,Sn.Z.CHANGE,this.handleGeometryChange_,this)),this.changed()}setGeometry(q){this.set(this.geometryName_,q)}setStyle(q){this.style_=q,this.styleFunction_=q?function(q){if("function"==typeof q)return q;let Y;return Array.isArray(q)?Y=q:((0,yn.h)("function"==typeof q.getZIndex,41),Y=[q]),function(){return Y}}(q):void 0,this.changed()}setId(q){this.id_=q,this.changed()}setGeometryName(q){this.removeChangeListener(this.geometryName_,this.handleGeometryChanged_),this.geometryName_=q,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),this.handleGeometryChanged_()}}const Qs=Js;var $s=i(2967);function ys(q,Y,H,et,it,nt,st){const ot=q[Y],lt=q[Y+1],mt=q[H]-ot,_t=q[H+1]-lt;let vt;if(0===mt&&0===_t)vt=Y;else{const bt=((it-ot)*mt+(nt-lt)*_t)/(mt*mt+_t*_t);if(bt>1)vt=H;else{if(bt>0){for(let it=0;it<et;++it)st[it]=(0,_n.t7)(q[Y+it],q[H+it],bt);return void(st.length=et)}vt=Y}}for(let Y=0;Y<et;++Y)st[Y]=q[vt+Y];st.length=et}function _s(q,Y,H,et,it){let nt=q[Y],st=q[Y+1];for(Y+=et;Y<H;Y+=et){const H=q[Y],et=q[Y+1],ot=(0,_n.bI)(nt,st,H,et);ot>it&&(it=ot),nt=H,st=et}return it}function vs(q,Y,H,et,it){for(let nt=0,st=H.length;nt<st;++nt){const st=H[nt];it=_s(q,Y,st,et,it),Y=st}return it}function xs(q,Y,H,et,it,nt,st,ot,lt,mt,_t){if(Y==H)return mt;let vt,bt;if(0===it){if(bt=(0,_n.bI)(st,ot,q[Y],q[Y+1]),bt<mt){for(vt=0;vt<et;++vt)lt[vt]=q[Y+vt];return lt.length=et,bt}return mt}_t=_t||[NaN,NaN];let Mt=Y+et;for(;Mt<H;)if(ys(q,Mt-et,Mt,et,st,ot,_t),bt=(0,_n.bI)(st,ot,_t[0],_t[1]),bt<mt){for(mt=bt,vt=0;vt<et;++vt)lt[vt]=_t[vt];lt.length=et,Mt+=et}else Mt+=et*Math.max((Math.sqrt(bt)-Math.sqrt(mt))/it|0,1);if(nt&&(ys(q,H-et,Y,et,st,ot,_t),bt=(0,_n.bI)(st,ot,_t[0],_t[1]),bt<mt)){for(mt=bt,vt=0;vt<et;++vt)lt[vt]=_t[vt];lt.length=et}return mt}function Ss(q,Y,H,et,it,nt,st,ot,lt,mt,_t){_t=_t||[NaN,NaN];for(let vt=0,bt=H.length;vt<bt;++vt){const bt=H[vt];mt=xs(q,Y,bt,et,it,nt,st,ot,lt,mt,_t),Y=bt}return mt}var to=i(8527);function Ms(q,Y,H,et,it,nt,st){const ot=(H-Y)/et;if(ot<3){for(;Y<H;Y+=et)nt[st++]=q[Y],nt[st++]=q[Y+1];return st}const lt=new Array(ot);lt[0]=1,lt[ot-1]=1;const mt=[Y,H-et];let _t=0;for(;mt.length>0;){const H=mt.pop(),nt=mt.pop();let st=0;const ot=q[nt],vt=q[nt+1],bt=q[H],Mt=q[H+1];for(let Y=nt+et;Y<H;Y+=et){const H=q[Y],et=q[Y+1],it=(0,_n.rU)(H,et,ot,vt,bt,Mt);it>st&&(_t=Y,st=it)}st>it&&(lt[(_t-Y)/et]=1,nt+et<_t&&mt.push(nt,_t),_t+et<H&&mt.push(_t,H))}for(let H=0;H<ot;++H)lt[H]&&(nt[st++]=q[Y+H*et],nt[st++]=q[Y+H*et+1]);return st}function ws(q,Y){return Y*Math.round(q/Y)}function Cs(q,Y,H,et,it,nt,st){if(Y==H)return st;let ot,lt,mt=ws(q[Y],it),_t=ws(q[Y+1],it);Y+=et,nt[st++]=mt,nt[st++]=_t;do{if(ot=ws(q[Y],it),lt=ws(q[Y+1],it),(Y+=et)==H)return nt[st++]=ot,nt[st++]=lt,st}while(ot==mt&&lt==_t);for(;Y<H;){const H=ws(q[Y],it),vt=ws(q[Y+1],it);if(Y+=et,H==ot&&vt==lt)continue;const bt=ot-mt,Mt=lt-_t,Et=H-mt,Rt=vt-_t;bt*Rt==Mt*Et&&(bt<0&&Et<bt||bt==Et||bt>0&&Et>bt)&&(Mt<0&&Rt<Mt||Mt==Rt||Mt>0&&Rt>Mt)?(ot=H,lt=vt):(nt[st++]=ot,nt[st++]=lt,mt=ot,_t=lt,ot=H,lt=vt)}return nt[st++]=ot,nt[st++]=lt,st}function Es(q,Y,H,et,it,nt,st,ot){for(let lt=0,mt=H.length;lt<mt;++lt){const mt=H[lt];st=Cs(q,Y,mt,et,it,nt,st),ot.push(st),Y=mt}return st}function Rs(q,Y,H,et,it){it=void 0!==it?it:[];let nt=0;for(let st=Y;st<H;st+=et)it[nt++]=q.slice(st,st+et);return it.length=nt,it}function Os(q,Y,H,et,it){it=void 0!==it?it:[];let nt=0;for(let st=0,ot=H.length;st<ot;++st){const ot=H[st];it[nt++]=Rs(q,Y,ot,et,it[nt]),Y=ot}return it.length=nt,it}function Ps(q,Y,H,et,it){it=void 0!==it?it:[];let nt=0;for(let st=0,ot=H.length;st<ot;++st){const ot=H[st];it[nt++]=1===ot.length&&ot[0]===Y?[]:Os(q,Y,ot,et,it[nt]),Y=ot[ot.length-1]}return it.length=nt,it}function Is(q,Y,H,et,it,nt,st){let ot,lt;const mt=(H-Y)/et;if(1===mt)ot=Y;else if(2===mt)ot=Y,lt=it;else if(0!==mt){let nt=q[Y],st=q[Y+1],mt=0;const _t=[0];for(let it=Y+et;it<H;it+=et){const Y=q[it],H=q[it+1];mt+=Math.sqrt((Y-nt)*(Y-nt)+(H-st)*(H-st)),_t.push(mt),nt=Y,st=H}const vt=it*mt,bt=(0,Dn.ry)(_t,vt);bt<0?(lt=(vt-_t[-bt-2])/(_t[-bt-1]-_t[-bt-2]),ot=Y+(-bt-2)*et):ot=Y+bt*et}st=st>1?st:2,nt=nt||new Array(st);for(let Y=0;Y<st;++Y)nt[Y]=void 0===ot?NaN:void 0===lt?q[ot+Y]:(0,_n.t7)(q[ot+Y],q[ot+et+Y],lt);return nt}function Ts(q,Y,H,et,it,nt){if(H==Y)return null;let st;if(it<q[Y+et-1])return nt?(st=q.slice(Y,Y+et),st[et-1]=it,st):null;if(q[H-1]<it)return nt?(st=q.slice(H-et,H),st[et-1]=it,st):null;if(it==q[Y+et-1])return q.slice(Y,Y+et);let ot=Y/et,lt=H/et;for(;ot<lt;){const Y=ot+lt>>1;it<q[(Y+1)*et-1]?lt=Y:ot=Y+1}const mt=q[ot*et-1];if(it==mt)return q.slice((ot-1)*et,(ot-1)*et+et);const _t=(it-mt)/(q[(ot+1)*et-1]-mt);st=[];for(let Y=0;Y<et-1;++Y)st.push((0,_n.t7)(q[(ot-1)*et+Y],q[ot*et+Y],_t));return st.push(it),st}function Fs(q,Y,H,et){let it=q[Y],nt=q[Y+1],st=0;for(let ot=Y+et;ot<H;ot+=et){const Y=q[ot],H=q[ot+1];st+=Math.sqrt((Y-it)*(Y-it)+(H-nt)*(H-nt)),it=Y,nt=H}return st}class no extends $s.ZP{constructor(q,Y){super(),this.flatMidpoint_=null,this.flatMidpointRevision_=-1,this.maxDelta_=-1,this.maxDeltaRevision_=-1,void 0===Y||Array.isArray(q[0])?this.setCoordinates(q,Y):this.setFlatCoordinates(Y,q)}appendCoordinate(q){this.flatCoordinates?(0,Dn.l7)(this.flatCoordinates,q):this.flatCoordinates=q.slice(),this.changed()}clone(){const q=new no(this.flatCoordinates.slice(),this.layout);return q.applyProperties(this),q}closestPointXY(q,Y,H,et){return et<(0,Xt.qf)(this.getExtent(),q,Y)?et:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(_s(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),xs(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!1,q,Y,H,et))}forEachSegment(q){return Ar(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,q)}getCoordinateAtM(q,Y){return"XYM"!=this.layout&&"XYZM"!=this.layout?null:(Y=void 0!==Y&&Y,Ts(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,q,Y))}getCoordinates(){return Rs(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinateAt(q,Y){return Is(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,q,Y,this.stride)}getLength(){return Fs(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getFlatMidpoint(){return this.flatMidpointRevision_!=this.getRevision()&&(this.flatMidpoint_=this.getCoordinateAt(.5,this.flatMidpoint_),this.flatMidpointRevision_=this.getRevision()),this.flatMidpoint_}getSimplifiedGeometryInternal(q){const Y=[];return Y.length=Ms(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,q,Y,0),new no(Y,"XY")}getType(){return"LineString"}intersectsExtent(q){return Gr(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,q)}setCoordinates(q,Y){this.setLayout(Y,q,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=(0,to.Sg)(this.flatCoordinates,0,q,this.stride),this.changed()}}const mo=no;function Ns(q,Y,H,et){let it=0,nt=q[H-et],st=q[H-et+1];for(;Y<H;Y+=et){const H=q[Y],et=q[Y+1];it+=st*H-nt*et,nt=H,st=et}return it/2}function ks(q,Y,H,et){let it=0;for(let nt=0,st=H.length;nt<st;++nt){const st=H[nt];it+=Ns(q,Y,st,et),Y=st}return it}class xo extends $s.ZP{constructor(q,Y){super(),this.maxDelta_=-1,this.maxDeltaRevision_=-1,void 0===Y||Array.isArray(q[0])?this.setCoordinates(q,Y):this.setFlatCoordinates(Y,q)}clone(){return new xo(this.flatCoordinates.slice(),this.layout)}closestPointXY(q,Y,H,et){return et<(0,Xt.qf)(this.getExtent(),q,Y)?et:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(_s(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),xs(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,q,Y,H,et))}getArea(){return Ns(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinates(){return Rs(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getSimplifiedGeometryInternal(q){const Y=[];return Y.length=Ms(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,q,Y,0),new xo(Y,"XY")}getType(){return"LinearRing"}intersectsExtent(q){return!1}setCoordinates(q,Y){this.setLayout(Y,q,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=(0,to.Sg)(this.flatCoordinates,0,q,this.stride),this.changed()}}const So=xo;class Mo extends $s.ZP{constructor(q,Y,H){if(super(),this.ends_=[],this.maxDelta_=-1,this.maxDeltaRevision_=-1,Array.isArray(q[0]))this.setCoordinates(q,Y);else if(void 0!==Y&&H)this.setFlatCoordinates(Y,q),this.ends_=H;else{let Y=this.getLayout();const H=q,et=[],it=[];for(let q=0,nt=H.length;q<nt;++q){const nt=H[q];0===q&&(Y=nt.getLayout()),(0,Dn.l7)(et,nt.getFlatCoordinates()),it.push(et.length)}this.setFlatCoordinates(Y,et),this.ends_=it}}appendLineString(q){this.flatCoordinates?(0,Dn.l7)(this.flatCoordinates,q.getFlatCoordinates().slice()):this.flatCoordinates=q.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){const q=new Mo(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return q.applyProperties(this),q}closestPointXY(q,Y,H,et){return et<(0,Xt.qf)(this.getExtent(),q,Y)?et:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(vs(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),Ss(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!1,q,Y,H,et))}getCoordinateAtM(q,Y,H){return"XYM"!=this.layout&&"XYZM"!=this.layout||0===this.flatCoordinates.length?null:(Y=void 0!==Y&&Y,H=void 0!==H&&H,function(q,Y,H,et,it,nt,st){if(st)return Ts(q,Y,H[H.length-1],et,it,nt);let ot;if(it<q[et-1])return nt?(ot=q.slice(0,et),ot[et-1]=it,ot):null;if(q[q.length-1]<it)return nt?(ot=q.slice(q.length-et),ot[et-1]=it,ot):null;for(let nt=0,st=H.length;nt<st;++nt){const st=H[nt];if(Y!=st){if(it<q[Y+et-1])return null;if(it<=q[st-1])return Ts(q,Y,st,et,it,!1);Y=st}}return null}(this.flatCoordinates,0,this.ends_,this.stride,q,Y,H))}getCoordinates(){return Os(this.flatCoordinates,0,this.ends_,this.stride)}getEnds(){return this.ends_}getLineString(q){return q<0||this.ends_.length<=q?null:new mo(this.flatCoordinates.slice(0===q?0:this.ends_[q-1],this.ends_[q]),this.layout)}getLineStrings(){const q=this.flatCoordinates,Y=this.ends_,H=this.layout,et=[];let it=0;for(let nt=0,st=Y.length;nt<st;++nt){const st=Y[nt],ot=new mo(q.slice(it,st),H);et.push(ot),it=st}return et}getFlatMidpoints(){const q=[],Y=this.flatCoordinates;let H=0;const et=this.ends_,it=this.stride;for(let nt=0,st=et.length;nt<st;++nt){const st=et[nt],ot=Is(Y,H,st,it,.5);(0,Dn.l7)(q,ot),H=st}return q}getSimplifiedGeometryInternal(q){const Y=[],H=[];return Y.length=function(q,Y,H,et,it,nt,st,ot){for(let lt=0,mt=H.length;lt<mt;++lt){const mt=H[lt];st=Ms(q,Y,mt,et,it,nt,st),ot.push(st),Y=mt}return st}(this.flatCoordinates,0,this.ends_,this.stride,q,Y,0,H),new Mo(Y,"XY",H)}getType(){return"MultiLineString"}intersectsExtent(q){return function(q,Y,H,et,it){for(let nt=0,st=H.length;nt<st;++nt){if(Gr(q,Y,H[nt],et,it))return!0;Y=H[nt]}return!1}(this.flatCoordinates,0,this.ends_,this.stride,q)}setCoordinates(q,Y){this.setLayout(Y,q,2),this.flatCoordinates||(this.flatCoordinates=[]);const H=(0,to._5)(this.flatCoordinates,0,q,this.stride,this.ends_);this.flatCoordinates.length=0===H.length?0:H[H.length-1],this.changed()}}const wo=Mo;var Co=i(188);class Eo extends $s.ZP{constructor(q,Y){super(),Y&&!Array.isArray(q[0])?this.setFlatCoordinates(Y,q):this.setCoordinates(q,Y)}appendPoint(q){this.flatCoordinates?(0,Dn.l7)(this.flatCoordinates,q.getFlatCoordinates()):this.flatCoordinates=q.getFlatCoordinates().slice(),this.changed()}clone(){const q=new Eo(this.flatCoordinates.slice(),this.layout);return q.applyProperties(this),q}closestPointXY(q,Y,H,et){if(et<(0,Xt.qf)(this.getExtent(),q,Y))return et;const it=this.flatCoordinates,nt=this.stride;for(let st=0,ot=it.length;st<ot;st+=nt){const ot=(0,_n.bI)(q,Y,it[st],it[st+1]);if(ot<et){et=ot;for(let q=0;q<nt;++q)H[q]=it[st+q];H.length=nt}}return et}getCoordinates(){return Rs(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getPoint(q){const Y=this.flatCoordinates?this.flatCoordinates.length/this.stride:0;return q<0||Y<=q?null:new Co.default(this.flatCoordinates.slice(q*this.stride,(q+1)*this.stride),this.layout)}getPoints(){const q=this.flatCoordinates,Y=this.layout,H=this.stride,et=[];for(let it=0,nt=q.length;it<nt;it+=H){const nt=new Co.default(q.slice(it,it+H),Y);et.push(nt)}return et}getType(){return"MultiPoint"}intersectsExtent(q){const Y=this.flatCoordinates,H=this.stride;for(let et=0,it=Y.length;et<it;et+=H){const H=Y[et],it=Y[et+1];if((0,Xt.jE)(q,H,it))return!0}return!1}setCoordinates(q,Y){this.setLayout(Y,q,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=(0,to.Sg)(this.flatCoordinates,0,q,this.stride),this.changed()}}const Ro=Eo;function qs(q,Y,H,et,it,nt,st){let ot,lt,mt,_t,vt,bt,Mt;const Et=it[nt+1],Rt=[];for(let it=0,nt=H.length;it<nt;++it){const nt=H[it];for(_t=q[nt-et],bt=q[nt-et+1],ot=Y;ot<nt;ot+=et)vt=q[ot],Mt=q[ot+1],(Et<=bt&&Mt<=Et||bt<=Et&&Et<=Mt)&&(mt=(Et-bt)/(Mt-bt)*(vt-_t)+_t,Rt.push(mt)),_t=vt,bt=Mt}let It=NaN,Pt=-1/0;for(Rt.sort(Dn.j2),_t=Rt[0],ot=1,lt=Rt.length;ot<lt;++ot){vt=Rt[ot];const it=Math.abs(vt-_t);it>Pt&&(mt=(_t+vt)/2,kr(q,Y,H,et,mt,Et)&&(It=mt,Pt=it)),_t=vt}return isNaN(It)&&(It=it[nt]),st?(st.push(It,Et,Pt),st):[It,Et,Pt]}function Ys(q,Y,H,et){for(;Y<H-et;){for(let it=0;it<et;++it){const nt=q[Y+it];q[Y+it]=q[H-et+it],q[H-et+it]=nt}Y+=et,H-=et}}function Zs(q,Y,H,et){let it=0,nt=q[H-et],st=q[H-et+1];for(;Y<H;Y+=et){const H=q[Y],et=q[Y+1];it+=(H-nt)*(et+st),nt=H,st=et}return 0===it?void 0:it>0}function Xs(q,Y,H,et,it){it=void 0!==it&&it;for(let nt=0,st=H.length;nt<st;++nt){const st=H[nt],ot=Zs(q,Y,st,et);if(0===nt){if(it&&ot||!it&&!ot)return!1}else if(it&&!ot||!it&&ot)return!1;Y=st}return!0}function Vs(q,Y,H,et,it){it=void 0!==it&&it;for(let nt=0,st=H.length;nt<st;++nt){const st=H[nt],ot=Zs(q,Y,st,et);(0===nt?it&&ot||!it&&!ot:it&&!ot||!it&&ot)&&Ys(q,Y,st,et),Y=st}return Y}function Ks(q,Y,H,et,it){for(let nt=0,st=H.length;nt<st;++nt)Y=Vs(q,Y,H[nt],et,it);return Y}class To extends $s.ZP{constructor(q,Y,H){super(),this.ends_=[],this.flatInteriorPointRevision_=-1,this.flatInteriorPoint_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,void 0!==Y&&H?(this.setFlatCoordinates(Y,q),this.ends_=H):this.setCoordinates(q,Y)}appendLinearRing(q){this.flatCoordinates?(0,Dn.l7)(this.flatCoordinates,q.getFlatCoordinates()):this.flatCoordinates=q.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){const q=new To(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return q.applyProperties(this),q}closestPointXY(q,Y,H,et){return et<(0,Xt.qf)(this.getExtent(),q,Y)?et:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(vs(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),Ss(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!0,q,Y,H,et))}containsXY(q,Y){return kr(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,q,Y)}getArea(){return ks(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)}getCoordinates(q){let Y;return void 0!==q?(Y=this.getOrientedFlatCoordinates().slice(),Vs(Y,0,this.ends_,this.stride,q)):Y=this.flatCoordinates,Os(Y,0,this.ends_,this.stride)}getEnds(){return this.ends_}getFlatInteriorPoint(){if(this.flatInteriorPointRevision_!=this.getRevision()){const q=(0,Xt.qg)(this.getExtent());this.flatInteriorPoint_=qs(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,q,0),this.flatInteriorPointRevision_=this.getRevision()}return this.flatInteriorPoint_}getInteriorPoint(){return new Co.default(this.getFlatInteriorPoint(),"XYM")}getLinearRingCount(){return this.ends_.length}getLinearRing(q){return q<0||this.ends_.length<=q?null:new So(this.flatCoordinates.slice(0===q?0:this.ends_[q-1],this.ends_[q]),this.layout)}getLinearRings(){const q=this.layout,Y=this.flatCoordinates,H=this.ends_,et=[];let it=0;for(let nt=0,st=H.length;nt<st;++nt){const st=H[nt],ot=new So(Y.slice(it,st),q);et.push(ot),it=st}return et}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){const q=this.flatCoordinates;Xs(q,0,this.ends_,this.stride)?this.orientedFlatCoordinates_=q:(this.orientedFlatCoordinates_=q.slice(),this.orientedFlatCoordinates_.length=Vs(this.orientedFlatCoordinates_,0,this.ends_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(q){const Y=[],H=[];return Y.length=Es(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(q),Y,0,H),new To(Y,"XY",H)}getType(){return"Polygon"}intersectsExtent(q){return Dr(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,q)}setCoordinates(q,Y){this.setLayout(Y,q,2),this.flatCoordinates||(this.flatCoordinates=[]);const H=(0,to._5)(this.flatCoordinates,0,q,this.stride,this.ends_);this.flatCoordinates.length=0===H.length?0:H[H.length-1],this.changed()}}const Fo=To;class Ao extends $s.ZP{constructor(q,Y,H){if(super(),this.endss_=[],this.flatInteriorPointsRevision_=-1,this.flatInteriorPoints_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,!H&&!Array.isArray(q[0])){let et=this.getLayout();const it=q,nt=[],st=[];for(let q=0,Y=it.length;q<Y;++q){const Y=it[q];0===q&&(et=Y.getLayout());const H=nt.length,ot=Y.getEnds();for(let q=0,Y=ot.length;q<Y;++q)ot[q]+=H;(0,Dn.l7)(nt,Y.getFlatCoordinates()),st.push(ot)}Y=et,q=nt,H=st}void 0!==Y&&H?(this.setFlatCoordinates(Y,q),this.endss_=H):this.setCoordinates(q,Y)}appendPolygon(q){let Y;if(this.flatCoordinates){const H=this.flatCoordinates.length;(0,Dn.l7)(this.flatCoordinates,q.getFlatCoordinates()),Y=q.getEnds().slice();for(let q=0,et=Y.length;q<et;++q)Y[q]+=H}else this.flatCoordinates=q.getFlatCoordinates().slice(),Y=q.getEnds().slice(),this.endss_.push();this.endss_.push(Y),this.changed()}clone(){const q=this.endss_.length,Y=new Array(q);for(let H=0;H<q;++H)Y[H]=this.endss_[H].slice();const H=new Ao(this.flatCoordinates.slice(),this.layout,Y);return H.applyProperties(this),H}closestPointXY(q,Y,H,et){return et<(0,Xt.qf)(this.getExtent(),q,Y)?et:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(function(q,Y,H,et,it){for(let nt=0,st=H.length;nt<st;++nt){const st=H[nt];it=vs(q,Y,st,et,it),Y=st[st.length-1]}return it}(this.flatCoordinates,0,this.endss_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),function(q,Y,H,et,it,nt,st,ot,lt,mt,_t){_t=_t||[NaN,NaN];for(let nt=0,vt=H.length;nt<vt;++nt){const vt=H[nt];mt=Ss(q,Y,vt,et,it,!0,st,ot,lt,mt,_t),Y=vt[vt.length-1]}return mt}(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,this.maxDelta_,0,q,Y,H,et))}containsXY(q,Y){return function(q,Y,H,et,it,nt){if(0===H.length)return!1;for(let st=0,ot=H.length;st<ot;++st){const ot=H[st];if(kr(q,Y,ot,et,it,nt))return!0;Y=ot[ot.length-1]}return!1}(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,q,Y)}getArea(){return function(q,Y,H,et){let it=0;for(let nt=0,st=H.length;nt<st;++nt){const st=H[nt];it+=ks(q,Y,st,et),Y=st[st.length-1]}return it}(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride)}getCoordinates(q){let Y;return void 0!==q?(Y=this.getOrientedFlatCoordinates().slice(),Ks(Y,0,this.endss_,this.stride,q)):Y=this.flatCoordinates,Ps(Y,0,this.endss_,this.stride)}getEndss(){return this.endss_}getFlatInteriorPoints(){if(this.flatInteriorPointsRevision_!=this.getRevision()){const q=function(q,Y,H,et){const it=[];let nt=(0,Xt.lJ)();for(let st=0,ot=H.length;st<ot;++st){const ot=H[st];nt=(0,Xt.GN)(q,Y,ot[0],et),it.push((nt[0]+nt[2])/2,(nt[1]+nt[3])/2),Y=ot[ot.length-1]}return it}(this.flatCoordinates,0,this.endss_,this.stride);this.flatInteriorPoints_=function(q,Y,H,et,it){let nt=[];for(let st=0,ot=H.length;st<ot;++st){const ot=H[st];nt=qs(q,Y,ot,et,it,2*st,nt),Y=ot[ot.length-1]}return nt}(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,q),this.flatInteriorPointsRevision_=this.getRevision()}return this.flatInteriorPoints_}getInteriorPoints(){return new Ro(this.getFlatInteriorPoints().slice(),"XYM")}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){const q=this.flatCoordinates;!function(q,Y,H,et,it){for(let it=0,nt=H.length;it<nt;++it){const nt=H[it];if(!Xs(q,Y,nt,et,void 0))return!1;nt.length&&(Y=nt[nt.length-1])}return!0}(q,0,this.endss_,this.stride)?(this.orientedFlatCoordinates_=q.slice(),this.orientedFlatCoordinates_.length=Ks(this.orientedFlatCoordinates_,0,this.endss_,this.stride)):this.orientedFlatCoordinates_=q,this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(q){const Y=[],H=[];return Y.length=function(q,Y,H,et,it,nt,st,ot){for(let lt=0,mt=H.length;lt<mt;++lt){const mt=H[lt],_t=[];st=Es(q,Y,mt,et,it,nt,st,_t),ot.push(_t),Y=mt[mt.length-1]}return st}(this.flatCoordinates,0,this.endss_,this.stride,Math.sqrt(q),Y,0,H),new Ao(Y,"XY",H)}getPolygon(q){if(q<0||this.endss_.length<=q)return null;let Y;if(0===q)Y=0;else{const H=this.endss_[q-1];Y=H[H.length-1]}const H=this.endss_[q].slice(),et=H[H.length-1];if(0!==Y)for(let q=0,et=H.length;q<et;++q)H[q]-=Y;return new Fo(this.flatCoordinates.slice(Y,et),this.layout,H)}getPolygons(){const q=this.layout,Y=this.flatCoordinates,H=this.endss_,et=[];let it=0;for(let nt=0,st=H.length;nt<st;++nt){const st=H[nt].slice(),ot=st[st.length-1];if(0!==it)for(let q=0,Y=st.length;q<Y;++q)st[q]-=it;const lt=new Fo(Y.slice(it,ot),q,st);et.push(lt),it=ot}return et}getType(){return"MultiPolygon"}intersectsExtent(q){return function(q,Y,H,et,it){for(let nt=0,st=H.length;nt<st;++nt){const st=H[nt];if(Dr(q,Y,st,et,it))return!0;Y=st[st.length-1]}return!1}(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,q)}setCoordinates(q,Y){this.setLayout(Y,q,3),this.flatCoordinates||(this.flatCoordinates=[]);const H=(0,to.QT)(this.flatCoordinates,0,q,this.stride,this.endss_);if(0===H.length)this.flatCoordinates.length=0;else{const q=H[H.length-1];this.flatCoordinates.length=0===q.length?0:q[q.length-1]}this.changed()}}const Lo=Ao,No=class{constructor(){this.dataProjection=void 0,this.defaultFeatureProjection=void 0,this.supportedMediaTypes=null}getReadOptions(q,Y){if(Y){let H=Y.dataProjection?(0,Vt.U2)(Y.dataProjection):this.readProjection(q);Y.extent&&H&&"tile-pixels"===H.getUnits()&&(H=(0,Vt.U2)(H),H.setWorldExtent(Y.extent)),Y={dataProjection:H,featureProjection:Y.featureProjection}}return this.adaptOptions(Y)}adaptOptions(q){return Object.assign({dataProjection:this.dataProjection,featureProjection:this.defaultFeatureProjection},q)}getType(){return(0,mn.O3)()}readFeature(q,Y){return(0,mn.O3)()}readFeatures(q,Y){return(0,mn.O3)()}readGeometry(q,Y){return(0,mn.O3)()}readProjection(q){return(0,mn.O3)()}writeFeature(q,Y){return(0,mn.O3)()}writeFeatures(q,Y){return(0,mn.O3)()}writeGeometry(q,Y){return(0,mn.O3)()}};function eo(q,Y,H){const et=H?(0,Vt.U2)(H.featureProjection):null,it=H?(0,Vt.U2)(H.dataProjection):null;let nt;if(nt=et&&it&&!(0,Vt.OP)(et,it)?(Y?q.clone():q).transform(Y?et:it,Y?it:et):q,Y&&H&&void 0!==H.decimals){const Y=Math.pow(10,H.decimals),n=function(q){for(let H=0,et=q.length;H<et;++H)q[H]=Math.round(q[H]*Y)/Y;return q};nt===q&&(nt=q.clone()),nt.applyTransform(n)}return nt}function io(q,Y){const H=Y?(0,Vt.U2)(Y.featureProjection):null,et=Y?(0,Vt.U2)(Y.dataProjection):null;return H&&et&&!(0,Vt.OP)(H,et)?(0,Vt.$A)(q,et,H):q}const ko="http://www.w3.org/2001/XMLSchema-instance";function ro(q,Y){return bo().createElementNS(q,Y)}function so(q,Y){return oo(q,Y,[]).join("")}function oo(q,Y,H){if(q.nodeType==Node.CDATA_SECTION_NODE||q.nodeType==Node.TEXT_NODE)Y?H.push(String(q.nodeValue).replace(/(\r\n|\r|\n)/g,"")):H.push(q.nodeValue);else{let et;for(et=q.firstChild;et;et=et.nextSibling)oo(et,Y,H)}return H}function ao(q){return"documentElement"in q}function ho(q){return(new DOMParser).parseFromString(q,"application/xml")}function lo(q,Y){return function(H,et){const it=q.call(void 0!==Y?Y:this,H,et);if(void 0!==it){const q=et[et.length-1];(0,Dn.l7)(q,it)}}}function uo(q,Y){return function(H,et){const it=q.call(void 0!==Y?Y:this,H,et);void 0!==it&&et[et.length-1].push(it)}}function co(q,Y){return function(H,et){const it=q.call(void 0!==Y?Y:this,H,et);void 0!==it&&(et[et.length-1]=it)}}function fo(q,Y,H){return function(et,it){const nt=q.call(void 0!==H?H:this,et,it);void 0!==nt&&(it[it.length-1][void 0!==Y?Y:et.localName]=nt)}}function go(q,Y){return function(H,et,it){q.call(void 0!==Y?Y:this,H,et,it),it[it.length-1].node.appendChild(H)}}function po(q,Y){return function(H,et,it){const nt=et[et.length-1].node;let st=q;return void 0===st&&(st=it),ro(void 0!==Y?Y:nt.namespaceURI,st)}}const Go=po();function yo(q,Y,H,et){let it;for(it=Y.firstElementChild;it;it=it.nextElementSibling){const Y=q[it.namespaceURI];if(void 0!==Y){const q=Y[it.localName];void 0!==q&&q.call(et,it,H)}}}function _o(q,Y,H,et,it){return et.push(q),yo(Y,H,et,it),et.pop()}function vo(q,Y,H,et,it,nt,st){return it.push(q),function(q,Y,H,et,it,nt){const st=(void 0!==it?it:H).length;let ot,lt;for(let mt=0;mt<st;++mt)ot=H[mt],void 0!==ot&&(lt=Y.call(void 0!==nt?nt:this,ot,et,void 0!==it?it[mt]:void 0),void 0!==lt&&q[lt.namespaceURI][lt.localName].call(nt,lt,ot,et))}(Y,H,et,it,nt,st),it.pop()}let jo,Do;function bo(){return void 0===Do&&"undefined"!=typeof document&&(Do=document.implementation.createDocument("","",null)),Do}const zo=class extends No{constructor(){super(),this.xmlSerializer_=(void 0===jo&&"undefined"!=typeof XMLSerializer&&(jo=new XMLSerializer),jo)}getType(){return"xml"}readFeature(q,Y){if(!q)return null;if("string"==typeof q){const H=ho(q);return this.readFeatureFromDocument(H,Y)}return ao(q)?this.readFeatureFromDocument(q,Y):this.readFeatureFromNode(q,Y)}readFeatureFromDocument(q,Y){const H=this.readFeaturesFromDocument(q,Y);return H.length>0?H[0]:null}readFeatureFromNode(q,Y){return null}readFeatures(q,Y){if(!q)return[];if("string"==typeof q){const H=ho(q);return this.readFeaturesFromDocument(H,Y)}return ao(q)?this.readFeaturesFromDocument(q,Y):this.readFeaturesFromNode(q,Y)}readFeaturesFromDocument(q,Y){const H=[];for(let et=q.firstChild;et;et=et.nextSibling)et.nodeType==Node.ELEMENT_NODE&&(0,Dn.l7)(H,this.readFeaturesFromNode(et,Y));return H}readFeaturesFromNode(q,Y){return(0,mn.O3)()}readGeometry(q,Y){if(!q)return null;if("string"==typeof q){const H=ho(q);return this.readGeometryFromDocument(H,Y)}return ao(q)?this.readGeometryFromDocument(q,Y):this.readGeometryFromNode(q,Y)}readGeometryFromDocument(q,Y){return null}readGeometryFromNode(q,Y){return null}readProjection(q){if(!q)return null;if("string"==typeof q){const Y=ho(q);return this.readProjectionFromDocument(Y)}return ao(q)?this.readProjectionFromDocument(q):this.readProjectionFromNode(q)}readProjectionFromDocument(q){return this.dataProjection}readProjectionFromNode(q){return this.dataProjection}writeFeature(q,Y){const H=this.writeFeatureNode(q,Y);return this.xmlSerializer_.serializeToString(H)}writeFeatureNode(q,Y){return null}writeFeatures(q,Y){const H=this.writeFeaturesNode(q,Y);return this.xmlSerializer_.serializeToString(H)}writeFeaturesNode(q,Y){return null}writeGeometry(q,Y){const H=this.writeGeometryNode(q,Y);return this.xmlSerializer_.serializeToString(H)}writeGeometryNode(q,Y){return null}},Bo="http://www.opengis.net/gml",Uo=/^\s*$/;class qo extends zo{constructor(q){super(),q=q||{},this.featureType=q.featureType,this.featureNS=q.featureNS,this.srsName=q.srsName,this.schemaLocation="",this.FEATURE_COLLECTION_PARSERS={},this.FEATURE_COLLECTION_PARSERS[this.namespace]={featureMember:uo(this.readFeaturesInternal),featureMembers:co(this.readFeaturesInternal)},this.supportedMediaTypes=["application/gml+xml"]}readFeaturesInternal(q,Y){const H=q.localName;let et=null;if("FeatureCollection"==H)et=_o([],this.FEATURE_COLLECTION_PARSERS,q,Y,this);else if("featureMembers"==H||"featureMember"==H||"member"==H){const it=Y[0];let nt=it.featureType,st=it.featureNS;const ot="p",lt="p0";if(!nt&&q.childNodes){nt=[],st={};for(let Y=0,H=q.childNodes.length;Y<H;++Y){const H=q.childNodes[Y];if(1===H.nodeType){const q=H.nodeName.split(":").pop();if(!nt.includes(q)){let Y="",et=0;const it=H.namespaceURI;for(const q in st){if(st[q]===it){Y=q;break}++et}Y||(Y=ot+et,st[Y]=it),nt.push(Y+":"+q)}}}"featureMember"!=H&&(it.featureType=nt,it.featureNS=st)}if("string"==typeof st){const q=st;st={},st[lt]=q}const mt={},_t=Array.isArray(nt)?nt:[nt];for(const q in st){const Y={};for(let et=0,it=_t.length;et<it;++et)(_t[et].includes(":")?_t[et].split(":")[0]:lt)===q&&(Y[_t[et].split(":").pop()]="featureMembers"==H?uo(this.readFeatureElement,this):co(this.readFeatureElement,this));mt[st[q]]=Y}et=_o("featureMember"==H||"member"==H?void 0:[],mt,q,Y)}return null===et&&(et=[]),et}readGeometryOrExtent(q,Y){const H=Y[0];return H.srsName=q.firstElementChild.getAttribute("srsName"),H.srsDimension=q.firstElementChild.getAttribute("srsDimension"),_o(null,this.GEOMETRY_PARSERS,q,Y,this)}readExtentElement(q,Y){const H=Y[0],et=this.readGeometryOrExtent(q,Y);return et?io(et,H):void 0}readGeometryElement(q,Y){const H=Y[0],et=this.readGeometryOrExtent(q,Y);return et?eo(et,!1,H):void 0}readFeatureElementInternal(q,Y,H){let et;const it={};for(let nt=q.firstElementChild;nt;nt=nt.nextElementSibling){let q;const st=nt.localName;0===nt.childNodes.length||1===nt.childNodes.length&&(3===nt.firstChild.nodeType||4===nt.firstChild.nodeType)?(q=so(nt,!1),Uo.test(q)&&(q=void 0)):(H&&(q="boundedBy"===st?this.readExtentElement(nt,Y):this.readGeometryElement(nt,Y)),q?"boundedBy"!==st&&(et=st):q=this.readFeatureElementInternal(nt,Y,!1));const ot=nt.attributes.length;if(ot>0){q={_content_:q};for(let Y=0;Y<ot;Y++)q[nt.attributes[Y].name]=nt.attributes[Y].value}it[st]?(it[st]instanceof Array||(it[st]=[it[st]]),it[st].push(q)):it[st]=q}if(!H)return it;const nt=new Qs(it);et&&nt.setGeometryName(et);const st=q.getAttribute("fid")||function(q,Y,H){return q.getAttributeNS(Y,"id")||""}(q,this.namespace);return st&&nt.setId(st),nt}readFeatureElement(q,Y){return this.readFeatureElementInternal(q,Y,!0)}readPoint(q,Y){const H=this.readFlatCoordinatesFromNode(q,Y);if(H)return new Co.default(H,"XYZ")}readMultiPoint(q,Y){const H=_o([],this.MULTIPOINT_PARSERS,q,Y,this);if(H)return new Ro(H)}readMultiLineString(q,Y){const H=_o([],this.MULTILINESTRING_PARSERS,q,Y,this);if(H)return new wo(H)}readMultiPolygon(q,Y){const H=_o([],this.MULTIPOLYGON_PARSERS,q,Y,this);if(H)return new Lo(H)}pointMemberParser(q,Y){yo(this.POINTMEMBER_PARSERS,q,Y,this)}lineStringMemberParser(q,Y){yo(this.LINESTRINGMEMBER_PARSERS,q,Y,this)}polygonMemberParser(q,Y){yo(this.POLYGONMEMBER_PARSERS,q,Y,this)}readLineString(q,Y){const H=this.readFlatCoordinatesFromNode(q,Y);if(H)return new mo(H,"XYZ")}readFlatLinearRing(q,Y){const H=_o(null,this.GEOMETRY_FLAT_COORDINATES_PARSERS,q,Y,this);if(H)return H}readLinearRing(q,Y){const H=this.readFlatCoordinatesFromNode(q,Y);if(H)return new So(H,"XYZ")}readPolygon(q,Y){const H=_o([null],this.FLAT_LINEAR_RINGS_PARSERS,q,Y,this);if(H&&H[0]){const q=H[0],Y=[q.length];let et,it;for(et=1,it=H.length;et<it;++et)(0,Dn.l7)(q,H[et]),Y.push(q.length);return new Fo(q,"XYZ",Y)}}readFlatCoordinatesFromNode(q,Y){return _o(null,this.GEOMETRY_FLAT_COORDINATES_PARSERS,q,Y,this)}readGeometryFromNode(q,Y){return this.readGeometryElement(q,[this.getReadOptions(q,Y||{})])||null}readFeaturesFromNode(q,Y){const H={featureType:this.featureType,featureNS:this.featureNS};return H&&Object.assign(H,this.getReadOptions(q,Y)),this.readFeaturesInternal(q,[H])||[]}readProjectionFromNode(q){return(0,Vt.U2)(this.srsName?this.srsName:q.firstElementChild.getAttribute("srsName"))}}qo.prototype.namespace=Bo,qo.prototype.FLAT_LINEAR_RINGS_PARSERS={"http://www.opengis.net/gml":{}},qo.prototype.GEOMETRY_FLAT_COORDINATES_PARSERS={"http://www.opengis.net/gml":{}},qo.prototype.GEOMETRY_PARSERS={"http://www.opengis.net/gml":{}},qo.prototype.MULTIPOINT_PARSERS={"http://www.opengis.net/gml":{pointMember:uo(qo.prototype.pointMemberParser),pointMembers:uo(qo.prototype.pointMemberParser)}},qo.prototype.MULTILINESTRING_PARSERS={"http://www.opengis.net/gml":{lineStringMember:uo(qo.prototype.lineStringMemberParser),lineStringMembers:uo(qo.prototype.lineStringMemberParser)}},qo.prototype.MULTIPOLYGON_PARSERS={"http://www.opengis.net/gml":{polygonMember:uo(qo.prototype.polygonMemberParser),polygonMembers:uo(qo.prototype.polygonMemberParser)}},qo.prototype.POINTMEMBER_PARSERS={"http://www.opengis.net/gml":{Point:uo(qo.prototype.readFlatCoordinatesFromNode)}},qo.prototype.LINESTRINGMEMBER_PARSERS={"http://www.opengis.net/gml":{LineString:uo(qo.prototype.readLineString)}},qo.prototype.POLYGONMEMBER_PARSERS={"http://www.opengis.net/gml":{Polygon:uo(qo.prototype.readPolygon)}},qo.prototype.RING_PARSERS={"http://www.opengis.net/gml":{LinearRing:co(qo.prototype.readFlatLinearRing)}};const Wo=qo;function Oo(q){return Po(so(q,!1))}function Po(q){const Y=/^\s*(\d+)\s*$/.exec(q);if(Y)return parseInt(Y[1],10)}function Io(q,Y){q.appendChild(bo().createTextNode(Y))}const Yo=Bo+" http://schemas.opengis.net/gml/2.1.2/feature.xsd",Zo={MultiLineString:"lineStringMember",MultiCurve:"curveMember",MultiPolygon:"polygonMember",MultiSurface:"surfaceMember"};class Xo extends Wo{constructor(q){super(q=q||{}),this.FEATURE_COLLECTION_PARSERS[Bo].featureMember=uo(this.readFeaturesInternal),this.schemaLocation=q.schemaLocation?q.schemaLocation:Yo}readFlatCoordinates(q,Y){const H=so(q,!1).replace(/^\s*|\s*$/g,""),et=Y[0].srsName;let it="enu";if(et){const q=(0,Vt.U2)(et);q&&(it=q.getAxisOrientation())}const nt=H.trim().split(/\s+/),st=[];for(let q=0,Y=nt.length;q<Y;q++){const Y=nt[q].split(/,+/),H=parseFloat(Y[0]),et=parseFloat(Y[1]),ot=3===Y.length?parseFloat(Y[2]):0;"en"===it.substr(0,2)?st.push(H,et,ot):st.push(et,H,ot)}return st}readBox(q,Y){const H=_o([null],this.BOX_PARSERS_,q,Y,this);return(0,Xt.T9)(H[1][0],H[1][1],H[1][3],H[1][4])}innerBoundaryIsParser(q,Y){const H=_o(void 0,this.RING_PARSERS,q,Y,this);H&&Y[Y.length-1].push(H)}outerBoundaryIsParser(q,Y){const H=_o(void 0,this.RING_PARSERS,q,Y,this);H&&(Y[Y.length-1][0]=H)}GEOMETRY_NODE_FACTORY_(q,Y,H){const et=Y[Y.length-1],it=et.multiSurface,nt=et.surface,st=et.multiCurve;return Array.isArray(q)?H="Envelope":"MultiPolygon"===(H=q.getType())&&!0===it?H="MultiSurface":"Polygon"===H&&!0===nt?H="Surface":"MultiLineString"===H&&!0===st&&(H="MultiCurve"),ro("http://www.opengis.net/gml",H)}writeFeatureElement(q,Y,H){const et=Y.getId();et&&q.setAttribute("fid",et);const it=H[H.length-1],nt=it.featureNS,st=Y.getGeometryName();it.serializers||(it.serializers={},it.serializers[nt]={});const ot=[],lt=[];if(Y.hasProperties()){const q=Y.getProperties();for(const Y in q){const H=q[Y];null!==H&&(ot.push(Y),lt.push(H),Y==st||"function"==typeof H.getSimplifiedGeometry?Y in it.serializers[nt]||(it.serializers[nt][Y]=go(this.writeGeometryElement,this)):Y in it.serializers[nt]||(it.serializers[nt][Y]=go(Io)))}}const mt=Object.assign({},it);mt.node=q,vo(mt,it.serializers,po(void 0,nt),lt,H,ot)}writeCurveOrLineString(q,Y,H){const et=H[H.length-1].srsName;if("LineStringSegment"!==q.nodeName&&et&&q.setAttribute("srsName",et),"LineString"===q.nodeName||"LineStringSegment"===q.nodeName){const et=this.createCoordinatesNode_(q.namespaceURI);q.appendChild(et),this.writeCoordinates_(et,Y,H)}else if("Curve"===q.nodeName){const et=ro(q.namespaceURI,"segments");q.appendChild(et),this.writeCurveSegments_(et,Y,H)}}writeLineStringOrCurveMember(q,Y,H){const et=this.GEOMETRY_NODE_FACTORY_(Y,H);et&&(q.appendChild(et),this.writeCurveOrLineString(et,Y,H))}writeMultiCurveOrLineString(q,Y,H){const et=H[H.length-1],it=et.hasZ,nt=et.srsName,st=et.curve;nt&&q.setAttribute("srsName",nt);const ot=Y.getLineStrings();vo({node:q,hasZ:it,srsName:nt,curve:st},this.LINESTRINGORCURVEMEMBER_SERIALIZERS,this.MULTIGEOMETRY_MEMBER_NODE_FACTORY_,ot,H,void 0,this)}writeGeometryElement(q,Y,H){const et=H[H.length-1],it=Object.assign({},et);let nt;it.node=q,nt=Array.isArray(Y)?io(Y,et):eo(Y,!0,et),vo(it,this.GEOMETRY_SERIALIZERS,this.GEOMETRY_NODE_FACTORY_,[nt],H,void 0,this)}createCoordinatesNode_(q){const Y=ro(q,"coordinates");return Y.setAttribute("decimal","."),Y.setAttribute("cs",","),Y.setAttribute("ts"," "),Y}writeCoordinates_(q,Y,H){const et=H[H.length-1],it=et.hasZ,nt=et.srsName,st=Y.getCoordinates(),ot=st.length,lt=new Array(ot);for(let q=0;q<ot;++q){const Y=st[q];lt[q]=this.getCoords_(Y,nt,it)}Io(q,lt.join(" "))}writeCurveSegments_(q,Y,H){const et=ro(q.namespaceURI,"LineStringSegment");q.appendChild(et),this.writeCurveOrLineString(et,Y,H)}writeSurfaceOrPolygon(q,Y,H){const et=H[H.length-1],it=et.hasZ,nt=et.srsName;if("PolygonPatch"!==q.nodeName&&nt&&q.setAttribute("srsName",nt),"Polygon"===q.nodeName||"PolygonPatch"===q.nodeName){const et=Y.getLinearRings();vo({node:q,hasZ:it,srsName:nt},this.RING_SERIALIZERS,this.RING_NODE_FACTORY_,et,H,void 0,this)}else if("Surface"===q.nodeName){const et=ro(q.namespaceURI,"patches");q.appendChild(et),this.writeSurfacePatches_(et,Y,H)}}RING_NODE_FACTORY_(q,Y,H){const et=Y[Y.length-1],it=et.node,nt=et.exteriorWritten;return void 0===nt&&(et.exteriorWritten=!0),ro(it.namespaceURI,void 0!==nt?"innerBoundaryIs":"outerBoundaryIs")}writeSurfacePatches_(q,Y,H){const et=ro(q.namespaceURI,"PolygonPatch");q.appendChild(et),this.writeSurfaceOrPolygon(et,Y,H)}writeRing(q,Y,H){const et=ro(q.namespaceURI,"LinearRing");q.appendChild(et),this.writeLinearRing(et,Y,H)}getCoords_(q,Y,H){let et="enu";Y&&(et=(0,Vt.U2)(Y).getAxisOrientation());let it="en"===et.substr(0,2)?q[0]+","+q[1]:q[1]+","+q[0];return H&&(it+=","+(q[2]||0)),it}writePoint(q,Y,H){const et=H[H.length-1],it=et.hasZ,nt=et.srsName;nt&&q.setAttribute("srsName",nt);const st=this.createCoordinatesNode_(q.namespaceURI);q.appendChild(st);const ot=Y.getCoordinates();Io(st,this.getCoords_(ot,nt,it))}writeMultiPoint(q,Y,H){const et=H[H.length-1],it=et.hasZ,nt=et.srsName;nt&&q.setAttribute("srsName",nt);const st=Y.getPoints();vo({node:q,hasZ:it,srsName:nt},this.POINTMEMBER_SERIALIZERS,po("pointMember"),st,H,void 0,this)}writePointMember(q,Y,H){const et=ro(q.namespaceURI,"Point");q.appendChild(et),this.writePoint(et,Y,H)}writeLinearRing(q,Y,H){const et=H[H.length-1].srsName;et&&q.setAttribute("srsName",et);const it=this.createCoordinatesNode_(q.namespaceURI);q.appendChild(it),this.writeCoordinates_(it,Y,H)}writeMultiSurfaceOrPolygon(q,Y,H){const et=H[H.length-1],it=et.hasZ,nt=et.srsName,st=et.surface;nt&&q.setAttribute("srsName",nt);const ot=Y.getPolygons();vo({node:q,hasZ:it,srsName:nt,surface:st},this.SURFACEORPOLYGONMEMBER_SERIALIZERS,this.MULTIGEOMETRY_MEMBER_NODE_FACTORY_,ot,H,void 0,this)}writeSurfaceOrPolygonMember(q,Y,H){const et=this.GEOMETRY_NODE_FACTORY_(Y,H);et&&(q.appendChild(et),this.writeSurfaceOrPolygon(et,Y,H))}writeEnvelope(q,Y,H){const et=H[H.length-1].srsName;et&&q.setAttribute("srsName",et);const it=[Y[0]+" "+Y[1],Y[2]+" "+Y[3]];vo({node:q},this.ENVELOPE_SERIALIZERS,Go,it,H,["lowerCorner","upperCorner"],this)}MULTIGEOMETRY_MEMBER_NODE_FACTORY_(q,Y,H){const et=Y[Y.length-1].node;return ro("http://www.opengis.net/gml",Zo[et.nodeName])}}Xo.prototype.GEOMETRY_FLAT_COORDINATES_PARSERS={"http://www.opengis.net/gml":{coordinates:co(Xo.prototype.readFlatCoordinates)}},Xo.prototype.FLAT_LINEAR_RINGS_PARSERS={"http://www.opengis.net/gml":{innerBoundaryIs:Xo.prototype.innerBoundaryIsParser,outerBoundaryIs:Xo.prototype.outerBoundaryIsParser}},Xo.prototype.BOX_PARSERS_={"http://www.opengis.net/gml":{coordinates:uo(Xo.prototype.readFlatCoordinates)}},Xo.prototype.GEOMETRY_PARSERS={"http://www.opengis.net/gml":{Point:co(Wo.prototype.readPoint),MultiPoint:co(Wo.prototype.readMultiPoint),LineString:co(Wo.prototype.readLineString),MultiLineString:co(Wo.prototype.readMultiLineString),LinearRing:co(Wo.prototype.readLinearRing),Polygon:co(Wo.prototype.readPolygon),MultiPolygon:co(Wo.prototype.readMultiPolygon),Box:co(Xo.prototype.readBox)}},Xo.prototype.GEOMETRY_SERIALIZERS={"http://www.opengis.net/gml":{Curve:go(Xo.prototype.writeCurveOrLineString),MultiCurve:go(Xo.prototype.writeMultiCurveOrLineString),Point:go(Xo.prototype.writePoint),MultiPoint:go(Xo.prototype.writeMultiPoint),LineString:go(Xo.prototype.writeCurveOrLineString),MultiLineString:go(Xo.prototype.writeMultiCurveOrLineString),LinearRing:go(Xo.prototype.writeLinearRing),Polygon:go(Xo.prototype.writeSurfaceOrPolygon),MultiPolygon:go(Xo.prototype.writeMultiSurfaceOrPolygon),Surface:go(Xo.prototype.writeSurfaceOrPolygon),MultiSurface:go(Xo.prototype.writeMultiSurfaceOrPolygon),Envelope:go(Xo.prototype.writeEnvelope)}},Xo.prototype.LINESTRINGORCURVEMEMBER_SERIALIZERS={"http://www.opengis.net/gml":{lineStringMember:go(Xo.prototype.writeLineStringOrCurveMember),curveMember:go(Xo.prototype.writeLineStringOrCurveMember)}},Xo.prototype.RING_SERIALIZERS={"http://www.opengis.net/gml":{outerBoundaryIs:go(Xo.prototype.writeRing),innerBoundaryIs:go(Xo.prototype.writeRing)}},Xo.prototype.POINTMEMBER_SERIALIZERS={"http://www.opengis.net/gml":{pointMember:go(Xo.prototype.writePointMember)}},Xo.prototype.SURFACEORPOLYGONMEMBER_SERIALIZERS={"http://www.opengis.net/gml":{surfaceMember:go(Xo.prototype.writeSurfaceOrPolygonMember),polygonMember:go(Xo.prototype.writeSurfaceOrPolygonMember)}},Xo.prototype.ENVELOPE_SERIALIZERS={"http://www.opengis.net/gml":{lowerCorner:go(Io),upperCorner:go(Io)}};const Vo=Xo,Ko=Bo+" http://schemas.opengis.net/gml/3.1.1/profiles/gmlsfProfile/1.0.0/gmlsf.xsd",Ho={MultiLineString:"lineStringMember",MultiCurve:"curveMember",MultiPolygon:"polygonMember",MultiSurface:"surfaceMember"};class Jo extends Wo{constructor(q){super(q=q||{}),this.surface_=void 0!==q.surface&&q.surface,this.curve_=void 0!==q.curve&&q.curve,this.multiCurve_=void 0===q.multiCurve||q.multiCurve,this.multiSurface_=void 0===q.multiSurface||q.multiSurface,this.schemaLocation=q.schemaLocation?q.schemaLocation:Ko,this.hasZ=void 0!==q.hasZ&&q.hasZ}readMultiCurve(q,Y){const H=_o([],this.MULTICURVE_PARSERS,q,Y,this);if(H)return new wo(H)}readFlatCurveRing(q,Y){const H=_o([],this.MULTICURVE_PARSERS,q,Y,this),et=[];for(let q=0,Y=H.length;q<Y;++q)(0,Dn.l7)(et,H[q].getFlatCoordinates());return et}readMultiSurface(q,Y){const H=_o([],this.MULTISURFACE_PARSERS,q,Y,this);if(H)return new Lo(H)}curveMemberParser(q,Y){yo(this.CURVEMEMBER_PARSERS,q,Y,this)}surfaceMemberParser(q,Y){yo(this.SURFACEMEMBER_PARSERS,q,Y,this)}readPatch(q,Y){return _o([null],this.PATCHES_PARSERS,q,Y,this)}readSegment(q,Y){return _o([],this.SEGMENTS_PARSERS,q,Y,this)}readPolygonPatch(q,Y){return _o([null],this.FLAT_LINEAR_RINGS_PARSERS,q,Y,this)}readLineStringSegment(q,Y){return _o([null],this.GEOMETRY_FLAT_COORDINATES_PARSERS,q,Y,this)}interiorParser(q,Y){const H=_o(void 0,this.RING_PARSERS,q,Y,this);H&&Y[Y.length-1].push(H)}exteriorParser(q,Y){const H=_o(void 0,this.RING_PARSERS,q,Y,this);H&&(Y[Y.length-1][0]=H)}readSurface(q,Y){const H=_o([null],this.SURFACE_PARSERS,q,Y,this);if(H&&H[0]){const q=H[0],Y=[q.length];let et,it;for(et=1,it=H.length;et<it;++et)(0,Dn.l7)(q,H[et]),Y.push(q.length);return new Fo(q,"XYZ",Y)}}readCurve(q,Y){const H=_o([null],this.CURVE_PARSERS,q,Y,this);if(H)return new mo(H,"XYZ")}readEnvelope(q,Y){const H=_o([null],this.ENVELOPE_PARSERS,q,Y,this);return(0,Xt.T9)(H[1][0],H[1][1],H[2][0],H[2][1])}readFlatPos(q,Y){let H=so(q,!1);const et=/^\s*([+\-]?\d*\.?\d+(?:[eE][+\-]?\d+)?)\s*/,it=[];let nt;for(;nt=et.exec(H);)it.push(parseFloat(nt[1])),H=H.substr(nt[0].length);if(""!==H)return;const st=Y[0].srsName;let ot="enu";if(st&&(ot=(0,Vt.U2)(st).getAxisOrientation()),"neu"===ot){let q,Y;for(q=0,Y=it.length;q<Y;q+=3){const Y=it[q],H=it[q+1];it[q]=H,it[q+1]=Y}}const lt=it.length;return 2==lt&&it.push(0),0!==lt?it:void 0}readFlatPosList(q,Y){const H=so(q,!1).replace(/^\s*|\s*$/g,""),et=Y[0],it=et.srsName,nt=et.srsDimension;let st="enu";it&&(st=(0,Vt.U2)(it).getAxisOrientation());const ot=H.split(/\s+/);let lt,mt,_t,vt=2;q.getAttribute("srsDimension")?vt=Po(q.getAttribute("srsDimension")):q.getAttribute("dimension")?vt=Po(q.getAttribute("dimension")):q.parentNode.getAttribute("srsDimension")?vt=Po(q.parentNode.getAttribute("srsDimension")):nt&&(vt=Po(nt));const bt=[];for(let q=0,Y=ot.length;q<Y;q+=vt)lt=parseFloat(ot[q]),mt=parseFloat(ot[q+1]),_t=3===vt?parseFloat(ot[q+2]):0,"en"===st.substr(0,2)?bt.push(lt,mt,_t):bt.push(mt,lt,_t);return bt}writePos_(q,Y,H){const et=H[H.length-1],it=et.hasZ,nt=it?"3":"2";q.setAttribute("srsDimension",nt);const st=et.srsName;let ot="enu";st&&(ot=(0,Vt.U2)(st).getAxisOrientation());const lt=Y.getCoordinates();let mt;mt="en"===ot.substr(0,2)?lt[0]+" "+lt[1]:lt[1]+" "+lt[0],it&&(mt+=" "+(lt[2]||0)),Io(q,mt)}getCoords_(q,Y,H){let et="enu";Y&&(et=(0,Vt.U2)(Y).getAxisOrientation());let it="en"===et.substr(0,2)?q[0]+" "+q[1]:q[1]+" "+q[0];return H&&(it+=" "+(q[2]||0)),it}writePosList_(q,Y,H){const et=H[H.length-1],it=et.hasZ,nt=it?"3":"2";q.setAttribute("srsDimension",nt);const st=et.srsName,ot=Y.getCoordinates(),lt=ot.length,mt=new Array(lt);let _t;for(let q=0;q<lt;++q)_t=ot[q],mt[q]=this.getCoords_(_t,st,it);Io(q,mt.join(" "))}writePoint(q,Y,H){const et=H[H.length-1].srsName;et&&q.setAttribute("srsName",et);const it=ro(q.namespaceURI,"pos");q.appendChild(it),this.writePos_(it,Y,H)}writeEnvelope(q,Y,H){const et=H[H.length-1].srsName;et&&q.setAttribute("srsName",et);const it=[Y[0]+" "+Y[1],Y[2]+" "+Y[3]];vo({node:q},this.ENVELOPE_SERIALIZERS,Go,it,H,["lowerCorner","upperCorner"],this)}writeLinearRing(q,Y,H){const et=H[H.length-1].srsName;et&&q.setAttribute("srsName",et);const it=ro(q.namespaceURI,"posList");q.appendChild(it),this.writePosList_(it,Y,H)}RING_NODE_FACTORY_(q,Y,H){const et=Y[Y.length-1],it=et.node,nt=et.exteriorWritten;return void 0===nt&&(et.exteriorWritten=!0),ro(it.namespaceURI,void 0!==nt?"interior":"exterior")}writeSurfaceOrPolygon(q,Y,H){const et=H[H.length-1],it=et.hasZ,nt=et.srsName;if("PolygonPatch"!==q.nodeName&&nt&&q.setAttribute("srsName",nt),"Polygon"===q.nodeName||"PolygonPatch"===q.nodeName){const et=Y.getLinearRings();vo({node:q,hasZ:it,srsName:nt},this.RING_SERIALIZERS,this.RING_NODE_FACTORY_,et,H,void 0,this)}else if("Surface"===q.nodeName){const et=ro(q.namespaceURI,"patches");q.appendChild(et),this.writeSurfacePatches_(et,Y,H)}}writeCurveOrLineString(q,Y,H){const et=H[H.length-1].srsName;if("LineStringSegment"!==q.nodeName&&et&&q.setAttribute("srsName",et),"LineString"===q.nodeName||"LineStringSegment"===q.nodeName){const et=ro(q.namespaceURI,"posList");q.appendChild(et),this.writePosList_(et,Y,H)}else if("Curve"===q.nodeName){const et=ro(q.namespaceURI,"segments");q.appendChild(et),this.writeCurveSegments_(et,Y,H)}}writeMultiSurfaceOrPolygon(q,Y,H){const et=H[H.length-1],it=et.hasZ,nt=et.srsName,st=et.surface;nt&&q.setAttribute("srsName",nt);const ot=Y.getPolygons();vo({node:q,hasZ:it,srsName:nt,surface:st},this.SURFACEORPOLYGONMEMBER_SERIALIZERS,this.MULTIGEOMETRY_MEMBER_NODE_FACTORY_,ot,H,void 0,this)}writeMultiPoint(q,Y,H){const et=H[H.length-1],it=et.srsName,nt=et.hasZ;it&&q.setAttribute("srsName",it);const st=Y.getPoints();vo({node:q,hasZ:nt,srsName:it},this.POINTMEMBER_SERIALIZERS,po("pointMember"),st,H,void 0,this)}writeMultiCurveOrLineString(q,Y,H){const et=H[H.length-1],it=et.hasZ,nt=et.srsName,st=et.curve;nt&&q.setAttribute("srsName",nt);const ot=Y.getLineStrings();vo({node:q,hasZ:it,srsName:nt,curve:st},this.LINESTRINGORCURVEMEMBER_SERIALIZERS,this.MULTIGEOMETRY_MEMBER_NODE_FACTORY_,ot,H,void 0,this)}writeRing(q,Y,H){const et=ro(q.namespaceURI,"LinearRing");q.appendChild(et),this.writeLinearRing(et,Y,H)}writeSurfaceOrPolygonMember(q,Y,H){const et=this.GEOMETRY_NODE_FACTORY_(Y,H);et&&(q.appendChild(et),this.writeSurfaceOrPolygon(et,Y,H))}writePointMember(q,Y,H){const et=ro(q.namespaceURI,"Point");q.appendChild(et),this.writePoint(et,Y,H)}writeLineStringOrCurveMember(q,Y,H){const et=this.GEOMETRY_NODE_FACTORY_(Y,H);et&&(q.appendChild(et),this.writeCurveOrLineString(et,Y,H))}writeSurfacePatches_(q,Y,H){const et=ro(q.namespaceURI,"PolygonPatch");q.appendChild(et),this.writeSurfaceOrPolygon(et,Y,H)}writeCurveSegments_(q,Y,H){const et=ro(q.namespaceURI,"LineStringSegment");q.appendChild(et),this.writeCurveOrLineString(et,Y,H)}writeGeometryElement(q,Y,H){const et=H[H.length-1],it=Object.assign({},et);let nt;it.node=q,nt=Array.isArray(Y)?io(Y,et):eo(Y,!0,et),vo(it,this.GEOMETRY_SERIALIZERS,this.GEOMETRY_NODE_FACTORY_,[nt],H,void 0,this)}writeFeatureElement(q,Y,H){const et=Y.getId();et&&q.setAttribute("fid",et);const it=H[H.length-1],nt=it.featureNS,st=Y.getGeometryName();it.serializers||(it.serializers={},it.serializers[nt]={});const ot=[],lt=[];if(Y.hasProperties()){const q=Y.getProperties();for(const Y in q){const H=q[Y];null!==H&&(ot.push(Y),lt.push(H),Y==st||"function"==typeof H.getSimplifiedGeometry?Y in it.serializers[nt]||(it.serializers[nt][Y]=go(this.writeGeometryElement,this)):Y in it.serializers[nt]||(it.serializers[nt][Y]=go(Io)))}}const mt=Object.assign({},it);mt.node=q,vo(mt,it.serializers,po(void 0,nt),lt,H,ot)}writeFeatureMembers_(q,Y,H){const et=H[H.length-1],it=et.featureType,nt=et.featureNS,st={};st[nt]={},st[nt][it]=go(this.writeFeatureElement,this);const ot=Object.assign({},et);ot.node=q,vo(ot,st,po(it,nt),Y,H)}MULTIGEOMETRY_MEMBER_NODE_FACTORY_(q,Y,H){const et=Y[Y.length-1].node;return ro(this.namespace,Ho[et.nodeName])}GEOMETRY_NODE_FACTORY_(q,Y,H){const et=Y[Y.length-1],it=et.multiSurface,nt=et.surface,st=et.curve,ot=et.multiCurve;return Array.isArray(q)?H="Envelope":"MultiPolygon"===(H=q.getType())&&!0===it?H="MultiSurface":"Polygon"===H&&!0===nt?H="Surface":"LineString"===H&&!0===st?H="Curve":"MultiLineString"===H&&!0===ot&&(H="MultiCurve"),ro(this.namespace,H)}writeGeometryNode(q,Y){Y=this.adaptOptions(Y);const H=ro(this.namespace,"geom"),et={node:H,hasZ:this.hasZ,srsName:this.srsName,curve:this.curve_,surface:this.surface_,multiSurface:this.multiSurface_,multiCurve:this.multiCurve_};return Y&&Object.assign(et,Y),this.writeGeometryElement(H,q,[et]),H}writeFeaturesNode(q,Y){Y=this.adaptOptions(Y);const H=ro(this.namespace,"featureMembers");H.setAttributeNS(ko,"xsi:schemaLocation",this.schemaLocation);const et={srsName:this.srsName,hasZ:this.hasZ,curve:this.curve_,surface:this.surface_,multiSurface:this.multiSurface_,multiCurve:this.multiCurve_,featureNS:this.featureNS,featureType:this.featureType};return Y&&Object.assign(et,Y),this.writeFeatureMembers_(H,q,[et]),H}}Jo.prototype.GEOMETRY_FLAT_COORDINATES_PARSERS={"http://www.opengis.net/gml":{pos:co(Jo.prototype.readFlatPos),posList:co(Jo.prototype.readFlatPosList),coordinates:co(Vo.prototype.readFlatCoordinates)}},Jo.prototype.FLAT_LINEAR_RINGS_PARSERS={"http://www.opengis.net/gml":{interior:Jo.prototype.interiorParser,exterior:Jo.prototype.exteriorParser}},Jo.prototype.GEOMETRY_PARSERS={"http://www.opengis.net/gml":{Point:co(Wo.prototype.readPoint),MultiPoint:co(Wo.prototype.readMultiPoint),LineString:co(Wo.prototype.readLineString),MultiLineString:co(Wo.prototype.readMultiLineString),LinearRing:co(Wo.prototype.readLinearRing),Polygon:co(Wo.prototype.readPolygon),MultiPolygon:co(Wo.prototype.readMultiPolygon),Surface:co(Jo.prototype.readSurface),MultiSurface:co(Jo.prototype.readMultiSurface),Curve:co(Jo.prototype.readCurve),MultiCurve:co(Jo.prototype.readMultiCurve),Envelope:co(Jo.prototype.readEnvelope)}},Jo.prototype.MULTICURVE_PARSERS={"http://www.opengis.net/gml":{curveMember:uo(Jo.prototype.curveMemberParser),curveMembers:uo(Jo.prototype.curveMemberParser)}},Jo.prototype.MULTISURFACE_PARSERS={"http://www.opengis.net/gml":{surfaceMember:uo(Jo.prototype.surfaceMemberParser),surfaceMembers:uo(Jo.prototype.surfaceMemberParser)}},Jo.prototype.CURVEMEMBER_PARSERS={"http://www.opengis.net/gml":{LineString:uo(Wo.prototype.readLineString),Curve:uo(Jo.prototype.readCurve)}},Jo.prototype.SURFACEMEMBER_PARSERS={"http://www.opengis.net/gml":{Polygon:uo(Wo.prototype.readPolygon),Surface:uo(Jo.prototype.readSurface)}},Jo.prototype.SURFACE_PARSERS={"http://www.opengis.net/gml":{patches:co(Jo.prototype.readPatch)}},Jo.prototype.CURVE_PARSERS={"http://www.opengis.net/gml":{segments:co(Jo.prototype.readSegment)}},Jo.prototype.ENVELOPE_PARSERS={"http://www.opengis.net/gml":{lowerCorner:uo(Jo.prototype.readFlatPosList),upperCorner:uo(Jo.prototype.readFlatPosList)}},Jo.prototype.PATCHES_PARSERS={"http://www.opengis.net/gml":{PolygonPatch:co(Jo.prototype.readPolygonPatch)}},Jo.prototype.SEGMENTS_PARSERS={"http://www.opengis.net/gml":{LineStringSegment:lo(Jo.prototype.readLineStringSegment)}},Wo.prototype.RING_PARSERS={"http://www.opengis.net/gml":{LinearRing:co(Wo.prototype.readFlatLinearRing),Ring:co(Jo.prototype.readFlatCurveRing)}},Jo.prototype.writeFeatures,Jo.prototype.RING_SERIALIZERS={"http://www.opengis.net/gml":{exterior:go(Jo.prototype.writeRing),interior:go(Jo.prototype.writeRing)}},Jo.prototype.ENVELOPE_SERIALIZERS={"http://www.opengis.net/gml":{lowerCorner:go(Io),upperCorner:go(Io)}},Jo.prototype.SURFACEORPOLYGONMEMBER_SERIALIZERS={"http://www.opengis.net/gml":{surfaceMember:go(Jo.prototype.writeSurfaceOrPolygonMember),polygonMember:go(Jo.prototype.writeSurfaceOrPolygonMember)}},Jo.prototype.POINTMEMBER_SERIALIZERS={"http://www.opengis.net/gml":{pointMember:go(Jo.prototype.writePointMember)}},Jo.prototype.LINESTRINGORCURVEMEMBER_SERIALIZERS={"http://www.opengis.net/gml":{lineStringMember:go(Jo.prototype.writeLineStringOrCurveMember),curveMember:go(Jo.prototype.writeLineStringOrCurveMember)}},Jo.prototype.GEOMETRY_SERIALIZERS={"http://www.opengis.net/gml":{Curve:go(Jo.prototype.writeCurveOrLineString),MultiCurve:go(Jo.prototype.writeMultiCurveOrLineString),Point:go(Jo.prototype.writePoint),MultiPoint:go(Jo.prototype.writeMultiPoint),LineString:go(Jo.prototype.writeCurveOrLineString),MultiLineString:go(Jo.prototype.writeMultiCurveOrLineString),LinearRing:go(Jo.prototype.writeLinearRing),Polygon:go(Jo.prototype.writeSurfaceOrPolygon),MultiPolygon:go(Jo.prototype.writeMultiSurfaceOrPolygon),Surface:go(Jo.prototype.writeSurfaceOrPolygon),MultiSurface:go(Jo.prototype.writeMultiSurfaceOrPolygon),Envelope:go(Jo.prototype.writeEnvelope)}};const Qo=Jo;class $o extends Qo{constructor(q){super(q=q||{}),this.schemaLocation=q.schemaLocation?q.schemaLocation:this.namespace+" http://schemas.opengis.net/gml/3.2.1/gml.xsd"}}$o.prototype.namespace="http://www.opengis.net/gml/3.2",$o.prototype.GEOMETRY_FLAT_COORDINATES_PARSERS={"http://www.opengis.net/gml/3.2":{pos:co(Qo.prototype.readFlatPos),posList:co(Qo.prototype.readFlatPosList),coordinates:co(Vo.prototype.readFlatCoordinates)}},$o.prototype.FLAT_LINEAR_RINGS_PARSERS={"http://www.opengis.net/gml/3.2":{interior:Qo.prototype.interiorParser,exterior:Qo.prototype.exteriorParser}},$o.prototype.GEOMETRY_PARSERS={"http://www.opengis.net/gml/3.2":{Point:co(Wo.prototype.readPoint),MultiPoint:co(Wo.prototype.readMultiPoint),LineString:co(Wo.prototype.readLineString),MultiLineString:co(Wo.prototype.readMultiLineString),LinearRing:co(Wo.prototype.readLinearRing),Polygon:co(Wo.prototype.readPolygon),MultiPolygon:co(Wo.prototype.readMultiPolygon),Surface:co($o.prototype.readSurface),MultiSurface:co(Qo.prototype.readMultiSurface),Curve:co($o.prototype.readCurve),MultiCurve:co(Qo.prototype.readMultiCurve),Envelope:co($o.prototype.readEnvelope)}},$o.prototype.MULTICURVE_PARSERS={"http://www.opengis.net/gml/3.2":{curveMember:uo(Qo.prototype.curveMemberParser),curveMembers:uo(Qo.prototype.curveMemberParser)}},$o.prototype.MULTISURFACE_PARSERS={"http://www.opengis.net/gml/3.2":{surfaceMember:uo(Qo.prototype.surfaceMemberParser),surfaceMembers:uo(Qo.prototype.surfaceMemberParser)}},$o.prototype.CURVEMEMBER_PARSERS={"http://www.opengis.net/gml/3.2":{LineString:uo(Wo.prototype.readLineString),Curve:uo(Qo.prototype.readCurve)}},$o.prototype.SURFACEMEMBER_PARSERS={"http://www.opengis.net/gml/3.2":{Polygon:uo(Wo.prototype.readPolygon),Surface:uo(Qo.prototype.readSurface)}},$o.prototype.SURFACE_PARSERS={"http://www.opengis.net/gml/3.2":{patches:co(Qo.prototype.readPatch)}},$o.prototype.CURVE_PARSERS={"http://www.opengis.net/gml/3.2":{segments:co(Qo.prototype.readSegment)}},$o.prototype.ENVELOPE_PARSERS={"http://www.opengis.net/gml/3.2":{lowerCorner:uo(Qo.prototype.readFlatPosList),upperCorner:uo(Qo.prototype.readFlatPosList)}},$o.prototype.PATCHES_PARSERS={"http://www.opengis.net/gml/3.2":{PolygonPatch:co(Qo.prototype.readPolygonPatch)}},$o.prototype.SEGMENTS_PARSERS={"http://www.opengis.net/gml/3.2":{LineStringSegment:lo(Qo.prototype.readLineStringSegment)}},$o.prototype.MULTIPOINT_PARSERS={"http://www.opengis.net/gml/3.2":{pointMember:uo(Wo.prototype.pointMemberParser),pointMembers:uo(Wo.prototype.pointMemberParser)}},$o.prototype.MULTILINESTRING_PARSERS={"http://www.opengis.net/gml/3.2":{lineStringMember:uo(Wo.prototype.lineStringMemberParser),lineStringMembers:uo(Wo.prototype.lineStringMemberParser)}},$o.prototype.MULTIPOLYGON_PARSERS={"http://www.opengis.net/gml/3.2":{polygonMember:uo(Wo.prototype.polygonMemberParser),polygonMembers:uo(Wo.prototype.polygonMemberParser)}},$o.prototype.POINTMEMBER_PARSERS={"http://www.opengis.net/gml/3.2":{Point:uo(Wo.prototype.readFlatCoordinatesFromNode)}},$o.prototype.LINESTRINGMEMBER_PARSERS={"http://www.opengis.net/gml/3.2":{LineString:uo(Wo.prototype.readLineString)}},$o.prototype.POLYGONMEMBER_PARSERS={"http://www.opengis.net/gml/3.2":{Polygon:uo(Wo.prototype.readPolygon)}},$o.prototype.RING_PARSERS={"http://www.opengis.net/gml/3.2":{LinearRing:co(Wo.prototype.readFlatLinearRing),Ring:co($o.prototype.readFlatCurveRing)}},$o.prototype.RING_SERIALIZERS={"http://www.opengis.net/gml/3.2":{exterior:go(Qo.prototype.writeRing),interior:go(Qo.prototype.writeRing)}},$o.prototype.ENVELOPE_SERIALIZERS={"http://www.opengis.net/gml/3.2":{lowerCorner:go(Io),upperCorner:go(Io)}},$o.prototype.SURFACEORPOLYGONMEMBER_SERIALIZERS={"http://www.opengis.net/gml/3.2":{surfaceMember:go(Qo.prototype.writeSurfaceOrPolygonMember),polygonMember:go(Qo.prototype.writeSurfaceOrPolygonMember)}},$o.prototype.POINTMEMBER_SERIALIZERS={"http://www.opengis.net/gml/3.2":{pointMember:go(Qo.prototype.writePointMember)}},$o.prototype.LINESTRINGORCURVEMEMBER_SERIALIZERS={"http://www.opengis.net/gml/3.2":{lineStringMember:go(Qo.prototype.writeLineStringOrCurveMember),curveMember:go(Qo.prototype.writeLineStringOrCurveMember)}},$o.prototype.GEOMETRY_SERIALIZERS={"http://www.opengis.net/gml/3.2":{Curve:go(Qo.prototype.writeCurveOrLineString),MultiCurve:go(Qo.prototype.writeMultiCurveOrLineString),Point:go($o.prototype.writePoint),MultiPoint:go(Qo.prototype.writeMultiPoint),LineString:go(Qo.prototype.writeCurveOrLineString),MultiLineString:go(Qo.prototype.writeMultiCurveOrLineString),LinearRing:go(Qo.prototype.writeLinearRing),Polygon:go(Qo.prototype.writeSurfaceOrPolygon),MultiPolygon:go(Qo.prototype.writeMultiSurfaceOrPolygon),Surface:go(Qo.prototype.writeSurfaceOrPolygon),MultiSurface:go(Qo.prototype.writeMultiSurfaceOrPolygon),Envelope:go(Qo.prototype.writeEnvelope)}};const ta=$o,ea=class{constructor(q){this.tagName_=q}getTagName(){return this.tagName_}},ia=class extends ea{constructor(q,Y){super(q),this.conditions=Y,(0,yn.h)(this.conditions.length>=2,57)}},sa=class extends ia{constructor(q){super("And",Array.prototype.slice.call(arguments))}},aa=class extends ea{constructor(q,Y,H){if(super("BBOX"),this.geometryName=q,this.extent=Y,4!==Y.length)throw new Error("Expected an extent with four values ([minX, minY, maxX, maxY])");this.srsName=H}},ma={"http://www.opengis.net/gml":{boundedBy:fo(Wo.prototype.readExtentElement,"bounds")},"http://www.opengis.net/wfs/2.0":{member:uo(Wo.prototype.readFeaturesInternal)}},La={"http://www.opengis.net/wfs":{totalInserted:fo(Oo),totalUpdated:fo(Oo),totalDeleted:fo(Oo)},"http://www.opengis.net/wfs/2.0":{totalInserted:fo(Oo),totalUpdated:fo(Oo),totalDeleted:fo(Oo)}},Na={"http://www.opengis.net/wfs":{TransactionSummary:fo(ra,"transactionSummary"),InsertResults:fo(ha,"insertIds")},"http://www.opengis.net/wfs/2.0":{TransactionSummary:fo(ra,"transactionSummary"),InsertResults:fo(ha,"insertIds")}},ka={"http://www.opengis.net/wfs":{PropertyName:go(Io)},"http://www.opengis.net/wfs/2.0":{PropertyName:go(Io)}},ja={"http://www.opengis.net/wfs":{Insert:go(la),Update:go(fa),Delete:go(da),Property:go(ga),Native:go(pa)},"http://www.opengis.net/wfs/2.0":{Insert:go(la),Update:go(fa),Delete:go(da),Property:go(ga),Native:go(pa)}},za="feature",Ua="http://www.w3.org/2000/xmlns/",qa={"2.0.0":"http://www.opengis.net/ogc/1.1","1.1.0":"http://www.opengis.net/ogc","1.0.0":"http://www.opengis.net/ogc"},Ya={"2.0.0":"http://www.opengis.net/wfs/2.0","1.1.0":"http://www.opengis.net/wfs","1.0.0":"http://www.opengis.net/wfs"},Za={"2.0.0":"http://www.opengis.net/fes/2.0","1.1.0":"http://www.opengis.net/fes","1.0.0":"http://www.opengis.net/fes"},Xa={"2.0.0":"http://www.opengis.net/wfs/2.0 http://schemas.opengis.net/wfs/2.0/wfs.xsd","1.1.0":"http://www.opengis.net/wfs http://schemas.opengis.net/wfs/1.1.0/wfs.xsd","1.0.0":"http://www.opengis.net/wfs http://schemas.opengis.net/wfs/1.0.0/wfs.xsd"},Va={"2.0.0":ta,"1.1.0":Qo,"1.0.0":Vo};function na(q,Y,H,et){vo(et,ja,po(q),Y,H)}function ra(q,Y){return _o({},La,q,Y)}const Ka={"http://www.opengis.net/ogc":{FeatureId:uo((function(q,Y){return q.getAttribute("fid")}))},"http://www.opengis.net/ogc/1.1":{FeatureId:uo((function(q,Y){return q.getAttribute("fid")}))}};function oa(q,Y){yo(Ka,q,Y)}const Ha={"http://www.opengis.net/wfs":{Feature:oa},"http://www.opengis.net/wfs/2.0":{Feature:oa}};function ha(q,Y){return _o([],Ha,q,Y)}function la(q,Y,H){const et=H[H.length-1],it=et.featureType,nt=et.featureNS,st=et.gmlVersion,ot=ro(nt,it);q.appendChild(ot),2===st?Vo.prototype.writeFeatureElement(ot,Y,H):3===st?Qo.prototype.writeFeatureElement(ot,Y,H):ta.prototype.writeFeatureElement(ot,Y,H)}function ua(q,Y,H){const et=H[H.length-1].version,it=qa[et],nt=ro(it,"Filter"),st=ro(it,"FeatureId");nt.appendChild(st),st.setAttribute("fid",Y),q.appendChild(nt)}function ca(q,Y){const H=(q=q||za)+":";return Y.startsWith(H)?Y:H+Y}function da(q,Y,H){const et=H[H.length-1];(0,yn.h)(void 0!==Y.getId(),26);const it=et.featureType,nt=et.featurePrefix,st=et.featureNS,ot=ca(nt,it);q.setAttribute("typeName",ot),q.setAttributeNS(Ua,"xmlns:"+nt,st);const lt=Y.getId();void 0!==lt&&ua(q,lt,H)}function fa(q,Y,H){const et=H[H.length-1];(0,yn.h)(void 0!==Y.getId(),27);const it=et.version,nt=et.featureType,st=et.featurePrefix,ot=et.featureNS,lt=ca(st,nt),mt=Y.getGeometryName();q.setAttribute("typeName",lt),q.setAttributeNS(Ua,"xmlns:"+st,ot);const _t=Y.getId();if(void 0!==_t){const nt=Y.getKeys(),st=[];for(let q=0,H=nt.length;q<H;q++){const H=Y.get(nt[q]);if(void 0!==H){let Y=nt[q];H&&"function"==typeof H.getSimplifiedGeometry&&(Y=mt),st.push({name:Y,value:H})}}vo({version:it,gmlVersion:et.gmlVersion,node:q,hasZ:et.hasZ,srsName:et.srsName},ja,po("Property"),st,H),ua(q,_t,H)}}function ga(q,Y,H){const et=H[H.length-1],it=et.version,nt=Ya[it],st=ro(nt,"Name"),ot=et.gmlVersion;if(q.appendChild(st),Io(st,Y.name),void 0!==Y.value&&null!==Y.value){const et=ro(nt,"Value");q.appendChild(et),Y.value&&"function"==typeof Y.value.getSimplifiedGeometry?2===ot?Vo.prototype.writeGeometryElement(et,Y.value,H):3===ot?Qo.prototype.writeGeometryElement(et,Y.value,H):ta.prototype.writeGeometryElement(et,Y.value,H):Io(et,Y.value)}}function pa(q,Y,H){Y.vendorId&&q.setAttribute("vendorId",Y.vendorId),void 0!==Y.safeToIgnore&&q.setAttribute("safeToIgnore",String(Y.safeToIgnore)),void 0!==Y.value&&Io(q,Y.value)}const Ja={"http://www.opengis.net/wfs":{Query:go(ya)},"http://www.opengis.net/wfs/2.0":{Query:go(ya)},"http://www.opengis.net/ogc":{During:go(Sa),And:go(ba),Or:go(ba),Not:go(Ma),BBOX:go(_a),Contains:go(va),Intersects:go(va),Within:go(va),DWithin:go(xa),PropertyIsEqualTo:go(wa),PropertyIsNotEqualTo:go(wa),PropertyIsLessThan:go(wa),PropertyIsLessThanOrEqualTo:go(wa),PropertyIsGreaterThan:go(wa),PropertyIsGreaterThanOrEqualTo:go(wa),PropertyIsNull:go(Ca),PropertyIsBetween:go(Ea),PropertyIsLike:go(Ra)},"http://www.opengis.net/fes/2.0":{During:go(Sa),And:go(ba),Or:go(ba),Not:go(Ma),BBOX:go(_a),Contains:go(va),Disjoint:go(va),Intersects:go(va),ResourceId:go((function(q,Y,H){q.setAttribute("rid",Y.rid)})),Within:go(va),DWithin:go(xa),PropertyIsEqualTo:go(wa),PropertyIsNotEqualTo:go(wa),PropertyIsLessThan:go(wa),PropertyIsLessThanOrEqualTo:go(wa),PropertyIsGreaterThan:go(wa),PropertyIsGreaterThanOrEqualTo:go(wa),PropertyIsNull:go(Ca),PropertyIsBetween:go(Ea),PropertyIsLike:go(Ra)}};function ya(q,Y,H){const et=H[H.length-1],it=et.version,nt=et.featurePrefix,st=et.featureNS,ot=et.propertyNames,lt=et.srsName;let mt,_t;mt=nt?ca(nt,Y):Y,_t="2.0.0"===it?"typeNames":"typeName",q.setAttribute(_t,mt),lt&&q.setAttribute("srsName",lt),st&&q.setAttributeNS(Ua,"xmlns:"+nt,st);const vt=Object.assign({},et);vt.node=q,vo(vt,ka,po("PropertyName"),ot,H);const bt=et.filter;if(bt){const Y=ro(Aa(it),"Filter");q.appendChild(Y),function(q,Y,H){const et=H[H.length-1],it={node:q};Object.assign(it,{context:et}),vo(it,Ja,po(Y.getTagName()),[Y],H)}(Y,bt,H)}}function _a(q,Y,H){const et=H[H.length-1],it=et.context.version;et.srsName=Y.srsName;const nt=Va[it];Ia(it,q,Y.geometryName),nt.prototype.writeGeometryElement(q,Y.extent,H)}function va(q,Y,H){const et=H[H.length-1],it=et.context.version;et.srsName=Y.srsName;const nt=Va[it];Ia(it,q,Y.geometryName),nt.prototype.writeGeometryElement(q,Y.geometry,H)}function xa(q,Y,H){const et=H[H.length-1].context.version;va(q,Y,H);const it=ro(Aa(et),"Distance");Io(it,Y.distance.toString()),"2.0.0"===et?it.setAttribute("uom",Y.unit):it.setAttribute("units",Y.unit),q.appendChild(it)}function Sa(q,Y,H){const et=H[H.length-1].context.version;Oa(Za[et],"ValueReference",q,Y.propertyName);const it=ro(Bo,"TimePeriod");q.appendChild(it);const nt=ro(Bo,"begin");it.appendChild(nt),Ta(nt,Y.begin);const st=ro(Bo,"end");it.appendChild(st),Ta(st,Y.end)}function ba(q,Y,H){const et=H[H.length-1].context,it={node:q};Object.assign(it,{context:et});const nt=Y.conditions;for(let q=0,Y=nt.length;q<Y;++q){const Y=nt[q];vo(it,Ja,po(Y.getTagName()),[Y],H)}}function Ma(q,Y,H){const et=H[H.length-1].context,it={node:q};Object.assign(it,{context:et});const nt=Y.condition;vo(it,Ja,po(nt.getTagName()),[nt],H)}function wa(q,Y,H){const et=H[H.length-1].context.version;void 0!==Y.matchCase&&q.setAttribute("matchCase",Y.matchCase.toString()),Ia(et,q,Y.propertyName),Pa(et,q,""+Y.expression)}function Ca(q,Y,H){Ia(H[H.length-1].context.version,q,Y.propertyName)}function Ea(q,Y,H){const et=H[H.length-1].context.version,it=Aa(et);Ia(et,q,Y.propertyName);const nt=ro(it,"LowerBoundary");q.appendChild(nt),Pa(et,nt,""+Y.lowerBoundary);const st=ro(it,"UpperBoundary");q.appendChild(st),Pa(et,st,""+Y.upperBoundary)}function Ra(q,Y,H){const et=H[H.length-1].context.version;q.setAttribute("wildCard",Y.wildCard),q.setAttribute("singleChar",Y.singleChar),q.setAttribute("escapeChar",Y.escapeChar),void 0!==Y.matchCase&&q.setAttribute("matchCase",Y.matchCase.toString()),Ia(et,q,Y.propertyName),Pa(et,q,""+Y.pattern)}function Oa(q,Y,H,et){const it=ro(q,Y);Io(it,et),H.appendChild(it)}function Pa(q,Y,H){Oa(Aa(q),"Literal",Y,H)}function Ia(q,Y,H){"2.0.0"===q?Oa(Za[q],"ValueReference",Y,H):Oa(qa[q],"PropertyName",Y,H)}function Ta(q,Y){const H=ro(Bo,"TimeInstant");q.appendChild(H);const et=ro(Bo,"timePosition");H.appendChild(et),Io(et,Y)}function Fa(q,Y,H){const et=H[H.length-1],it=Object.assign({},et);it.node=q,vo(it,Ja,po("Query"),Y,H)}function Aa(q){let Y;return Y="2.0.0"===q?Za[q]:qa[q],Y}const Qa=class extends zo{constructor(q){super(),q=q||{},this.version_=q.version?q.version:"1.1.0",this.featureType_=q.featureType,this.featureNS_=q.featureNS,this.gmlFormat_=q.gmlFormat?q.gmlFormat:new Va[this.version_],this.schemaLocation_=q.schemaLocation?q.schemaLocation:Xa[this.version_]}getFeatureType(){return this.featureType_}setFeatureType(q){this.featureType_=q}readFeaturesFromNode(q,Y){const H={node:q};Object.assign(H,{featureType:this.featureType_,featureNS:this.featureNS_}),Object.assign(H,this.getReadOptions(q,Y||{}));const et=[H];let it;it="2.0.0"===this.version_?ma:this.gmlFormat_.FEATURE_COLLECTION_PARSERS;let nt=_o([],it,q,et,this.gmlFormat_);return nt||(nt=[]),nt}readTransactionResponse(q){if(q){if("string"==typeof q){const Y=ho(q);return this.readTransactionResponseFromDocument(Y)}return ao(q)?this.readTransactionResponseFromDocument(q):this.readTransactionResponseFromNode(q)}}readFeatureCollectionMetadata(q){if(q){if("string"==typeof q){const Y=ho(q);return this.readFeatureCollectionMetadataFromDocument(Y)}return ao(q)?this.readFeatureCollectionMetadataFromDocument(q):this.readFeatureCollectionMetadataFromNode(q)}}readFeatureCollectionMetadataFromDocument(q){for(let Y=q.firstChild;Y;Y=Y.nextSibling)if(Y.nodeType==Node.ELEMENT_NODE)return this.readFeatureCollectionMetadataFromNode(Y)}readFeatureCollectionMetadataFromNode(q){const Y={},H=Po(q.getAttribute("numberOfFeatures"));return Y.numberOfFeatures=H,_o(Y,ma,q,[],this.gmlFormat_)}readTransactionResponseFromDocument(q){for(let Y=q.firstChild;Y;Y=Y.nextSibling)if(Y.nodeType==Node.ELEMENT_NODE)return this.readTransactionResponseFromNode(Y)}readTransactionResponseFromNode(q){return _o({},Na,q,[])}writeGetFeature(q){const Y=ro(Ya[this.version_],"GetFeature");Y.setAttribute("service","WFS"),Y.setAttribute("version",this.version_),q.handle&&Y.setAttribute("handle",q.handle),q.outputFormat&&Y.setAttribute("outputFormat",q.outputFormat),void 0!==q.maxFeatures&&Y.setAttribute("maxFeatures",String(q.maxFeatures)),q.resultType&&Y.setAttribute("resultType",q.resultType),void 0!==q.startIndex&&Y.setAttribute("startIndex",String(q.startIndex)),void 0!==q.count&&Y.setAttribute("count",String(q.count)),void 0!==q.viewParams&&Y.setAttribute("viewParams",q.viewParams),Y.setAttributeNS(ko,"xsi:schemaLocation",this.schemaLocation_);const H={node:Y};if(Object.assign(H,{version:this.version_,srsName:q.srsName,featureNS:q.featureNS?q.featureNS:this.featureNS_,featurePrefix:q.featurePrefix,propertyNames:q.propertyNames?q.propertyNames:[]}),(0,yn.h)(Array.isArray(q.featureTypes),11),"string"==typeof q.featureTypes[0]){let et=q.filter;q.bbox&&((0,yn.h)(q.geometryName,12),et=this.combineBboxAndFilter(q.geometryName,q.bbox,q.srsName,et)),Object.assign(H,{geometryName:q.geometryName,filter:et}),Fa(Y,q.featureTypes,[H])}else q.featureTypes.forEach((et=>{const it=this.combineBboxAndFilter(et.geometryName,et.bbox,q.srsName,q.filter);Object.assign(H,{geometryName:et.geometryName,filter:it}),Fa(Y,[et.name],[H])}));return Y}combineBboxAndFilter(q,Y,H,et){const it=function(q,Y,H){return new aa(q,Y,H)}(q,Y,H);return et?function(q){const Y=[null].concat(Array.prototype.slice.call(arguments));return new(Function.prototype.bind.apply(sa,Y))}(et,it):it}writeTransaction(q,Y,H,et){const it=[],nt=et.version?et.version:this.version_,st=ro(Ya[nt],"Transaction");let ot;st.setAttribute("service","WFS"),st.setAttribute("version",nt),et&&(ot=et.gmlOptions?et.gmlOptions:{},et.handle&&st.setAttribute("handle",et.handle)),st.setAttributeNS(ko,"xsi:schemaLocation",Xa[nt]);const lt=function(q,Y,H,et){const it=et.featurePrefix?et.featurePrefix:za;let nt;return"1.0.0"===H?nt=2:"1.1.0"===H?nt=3:"2.0.0"===H&&(nt=3.2),Object.assign({node:q},{version:H,featureNS:et.featureNS,featureType:et.featureType,featurePrefix:it,gmlVersion:nt,hasZ:et.hasZ,srsName:et.srsName},Y)}(st,ot,nt,et);return q&&na("Insert",q,it,lt),Y&&na("Update",Y,it,lt),H&&na("Delete",H,it,lt),et.nativeElements&&na("Native",et.nativeElements,it,lt),st}readProjectionFromDocument(q){for(let Y=q.firstChild;Y;Y=Y.nextSibling)if(Y.nodeType==Node.ELEMENT_NODE)return this.readProjectionFromNode(Y);return null}readProjectionFromNode(q){if(q.firstElementChild&&q.firstElementChild.firstElementChild)for(let Y=(q=q.firstElementChild.firstElementChild).firstElementChild;Y;Y=Y.nextElementSibling)if(0!==Y.childNodes.length&&(1!==Y.childNodes.length||3!==Y.firstChild.nodeType)){const q=[{}];return this.gmlFormat_.readGeometryElement(Y,q),(0,Vt.U2)(q.pop().srsName)}return null}};var $a=i(1694);class th extends $a.Z{constructor(q){super(),this.geometries_=q||null,this.changeEventsKeys_=[],this.listenGeometriesChange_()}unlistenGeometriesChange_(){this.changeEventsKeys_.forEach(Cn.bN),this.changeEventsKeys_.length=0}listenGeometriesChange_(){if(this.geometries_)for(let q=0,Y=this.geometries_.length;q<Y;++q)this.changeEventsKeys_.push((0,Cn.oL)(this.geometries_[q],Sn.Z.CHANGE,this.changed,this))}clone(){const q=new th(null);return q.setGeometries(this.geometries_),q.applyProperties(this),q}closestPointXY(q,Y,H,et){if(et<(0,Xt.qf)(this.getExtent(),q,Y))return et;const it=this.geometries_;for(let nt=0,st=it.length;nt<st;++nt)et=it[nt].closestPointXY(q,Y,H,et);return et}containsXY(q,Y){const H=this.geometries_;for(let et=0,it=H.length;et<it;++et)if(H[et].containsXY(q,Y))return!0;return!1}computeExtent(q){(0,Xt.YN)(q);const Y=this.geometries_;for(let H=0,et=Y.length;H<et;++H)(0,Xt.l7)(q,Y[H].getExtent());return q}getGeometries(){return Ga(this.geometries_)}getGeometriesArray(){return this.geometries_}getGeometriesArrayRecursive(){let q=[];const Y=this.geometries_;for(let H=0,et=Y.length;H<et;++H)Y[H].getType()===this.getType()?q=q.concat(Y[H].getGeometriesArrayRecursive()):q.push(Y[H]);return q}getSimplifiedGeometry(q){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),q<0||0!==this.simplifiedGeometryMaxMinSquaredTolerance&&q<this.simplifiedGeometryMaxMinSquaredTolerance)return this;const Y=[],H=this.geometries_;let et=!1;for(let it=0,nt=H.length;it<nt;++it){const nt=H[it],st=nt.getSimplifiedGeometry(q);Y.push(st),st!==nt&&(et=!0)}if(et){const q=new th(null);return q.setGeometriesArray(Y),q}return this.simplifiedGeometryMaxMinSquaredTolerance=q,this}getType(){return"GeometryCollection"}intersectsExtent(q){const Y=this.geometries_;for(let H=0,et=Y.length;H<et;++H)if(Y[H].intersectsExtent(q))return!0;return!1}isEmpty(){return 0===this.geometries_.length}rotate(q,Y){const H=this.geometries_;for(let et=0,it=H.length;et<it;++et)H[et].rotate(q,Y);this.changed()}scale(q,Y,H){H||(H=(0,Xt.qg)(this.getExtent()));const et=this.geometries_;for(let it=0,nt=et.length;it<nt;++it)et[it].scale(q,Y,H);this.changed()}setGeometries(q){this.setGeometriesArray(Ga(q))}setGeometriesArray(q){this.unlistenGeometriesChange_(),this.geometries_=q,this.listenGeometriesChange_(),this.changed()}applyTransform(q){const Y=this.geometries_;for(let H=0,et=Y.length;H<et;++H)Y[H].applyTransform(q);this.changed()}translate(q,Y){const H=this.geometries_;for(let et=0,it=H.length;et<it;++et)H[et].translate(q,Y);this.changed()}disposeInternal(){this.unlistenGeometriesChange_(),super.disposeInternal()}}function Ga(q){const Y=[];for(let H=0,et=q.length;H<et;++H)Y.push(q[H].clone());return Y}const eh=th;function Da(q){return"string"==typeof q?JSON.parse(q)||null:null!==q?q:null}const ih=class extends No{constructor(){super()}getType(){return"json"}readFeature(q,Y){return this.readFeatureFromObject(Da(q),this.getReadOptions(q,Y))}readFeatures(q,Y){return this.readFeaturesFromObject(Da(q),this.getReadOptions(q,Y))}readFeatureFromObject(q,Y){return(0,mn.O3)()}readFeaturesFromObject(q,Y){return(0,mn.O3)()}readGeometry(q,Y){return this.readGeometryFromObject(Da(q),this.getReadOptions(q,Y))}readGeometryFromObject(q,Y){return(0,mn.O3)()}readProjection(q){return this.readProjectionFromObject(Da(q))}readProjectionFromObject(q){return(0,mn.O3)()}writeFeature(q,Y){return JSON.stringify(this.writeFeatureObject(q,Y))}writeFeatureObject(q,Y){return(0,mn.O3)()}writeFeatures(q,Y){return JSON.stringify(this.writeFeaturesObject(q,Y))}writeFeaturesObject(q,Y){return(0,mn.O3)()}writeGeometry(q,Y){return JSON.stringify(this.writeGeometryObject(q,Y))}writeGeometryObject(q,Y){return(0,mn.O3)()}};var nh=i(9374);function Ba(q,Y){if(!q)return null;let H;switch(q.type){case"Point":H=function(q){return new Co.default(q.coordinates)}(q);break;case"LineString":H=function(q){return new mo(q.coordinates)}(q);break;case"Polygon":H=function(q){return new Fo(q.coordinates)}(q);break;case"MultiPoint":H=function(q){return new Ro(q.coordinates)}(q);break;case"MultiLineString":H=function(q){return new wo(q.coordinates)}(q);break;case"MultiPolygon":H=function(q){return new Lo(q.coordinates)}(q);break;case"GeometryCollection":H=function(q,Y){const H=q.geometries.map((function(q){return Ba(q,void 0)}));return new eh(H)}(q);break;default:throw new Error("Unsupported GeoJSON type: "+q.type)}return eo(H,!1,Y)}function Wa(q,Y){const H=(q=eo(q,!0,Y)).getType();let et;switch(H){case"Point":et=function(q,Y){return{type:"Point",coordinates:q.getCoordinates()}}(q);break;case"LineString":et=function(q,Y){return{type:"LineString",coordinates:q.getCoordinates()}}(q);break;case"Polygon":et=function(q,Y){let H;return Y&&(H=Y.rightHanded),{type:"Polygon",coordinates:q.getCoordinates(H)}}(q,Y);break;case"MultiPoint":et=function(q,Y){return{type:"MultiPoint",coordinates:q.getCoordinates()}}(q);break;case"MultiLineString":et=function(q,Y){return{type:"MultiLineString",coordinates:q.getCoordinates()}}(q);break;case"MultiPolygon":et=function(q,Y){let H;return Y&&(H=Y.rightHanded),{type:"MultiPolygon",coordinates:q.getCoordinates(H)}}(q,Y);break;case"GeometryCollection":et=function(q,Y){return delete(Y=Object.assign({},Y)).featureProjection,{type:"GeometryCollection",geometries:q.getGeometriesArray().map((function(q){return Wa(q,Y)}))}}(q,Y);break;case"Circle":et={type:"GeometryCollection",geometries:[]};break;default:throw new Error("Unsupported geometry type: "+H)}return et}const ah=class extends ih{constructor(q){q=q||{},super(),this.dataProjection=(0,Vt.U2)(q.dataProjection?q.dataProjection:"EPSG:4326"),q.featureProjection&&(this.defaultFeatureProjection=(0,Vt.U2)(q.featureProjection)),this.geometryName_=q.geometryName,this.extractGeometryName_=q.extractGeometryName,this.supportedMediaTypes=["application/geo+json","application/vnd.geo+json"]}readFeatureFromObject(q,Y){let H=null;H="Feature"===q.type?q:{type:"Feature",geometry:q,properties:null};const et=Ba(H.geometry,Y),it=new Qs;return this.geometryName_?it.setGeometryName(this.geometryName_):this.extractGeometryName_&&"geometry_name"in H!==void 0&&it.setGeometryName(H.geometry_name),it.setGeometry(et),"id"in H&&it.setId(H.id),H.properties&&it.setProperties(H.properties,!0),it}readFeaturesFromObject(q,Y){let H=null;if("FeatureCollection"===q.type){H=[];const et=q.features;for(let q=0,it=et.length;q<it;++q)H.push(this.readFeatureFromObject(et[q],Y))}else H=[this.readFeatureFromObject(q,Y)];return H}readGeometryFromObject(q,Y){return Ba(q,Y)}readProjectionFromObject(q){const Y=q.crs;let H;return Y?"name"==Y.type?H=(0,Vt.U2)(Y.properties.name):"EPSG"===Y.type?H=(0,Vt.U2)("EPSG:"+Y.properties.code):(0,yn.h)(!1,36):H=this.dataProjection,H}writeFeatureObject(q,Y){Y=this.adaptOptions(Y);const H={type:"Feature",geometry:null,properties:null},et=q.getId();if(void 0!==et&&(H.id=et),!q.hasProperties())return H;const it=q.getProperties(),nt=q.getGeometry();return nt&&(H.geometry=Wa(nt,Y),delete it[q.getGeometryName()]),(0,nh.x)(it)||(H.properties=it),H}writeFeaturesObject(q,Y){Y=this.adaptOptions(Y);const H=[];for(let et=0,it=q.length;et<it;++et)H.push(this.writeFeatureObject(q[et],Y));return{type:"FeatureCollection",features:H}}writeGeometryObject(q,Y){return Wa(q,this.adaptOptions(Y))}};var hh=i(6813);const lh="add",uh="remove",ch="length";class dh extends Ln.ZP{constructor(q,Y,H){super(q),this.element=Y,this.index=H}}class gh extends rn.Z{constructor(q,Y){if(super(),this.on,this.once,this.un,Y=Y||{},this.unique_=!!Y.unique,this.array_=q||[],this.unique_)for(let q=0,Y=this.array_.length;q<Y;++q)this.assertUnique_(this.array_[q],q);this.updateLength_()}clear(){for(;this.getLength()>0;)this.pop()}extend(q){for(let Y=0,H=q.length;Y<H;++Y)this.push(q[Y]);return this}forEach(q){const Y=this.array_;for(let H=0,et=Y.length;H<et;++H)q(Y[H],H,Y)}getArray(){return this.array_}item(q){return this.array_[q]}getLength(){return this.get(ch)}insertAt(q,Y){if(q<0||q>this.getLength())throw new Error("Index out of bounds: "+q);this.unique_&&this.assertUnique_(Y),this.array_.splice(q,0,Y),this.updateLength_(),this.dispatchEvent(new dh(lh,Y,q))}pop(){return this.removeAt(this.getLength()-1)}push(q){this.unique_&&this.assertUnique_(q);const Y=this.getLength();return this.insertAt(Y,q),this.getLength()}remove(q){const Y=this.array_;for(let H=0,et=Y.length;H<et;++H)if(Y[H]===q)return this.removeAt(H)}removeAt(q){if(q<0||q>=this.getLength())return;const Y=this.array_[q];return this.array_.splice(q,1),this.updateLength_(),this.dispatchEvent(new dh(uh,Y,q)),Y}setAt(q,Y){if(q>=this.getLength())return void this.insertAt(q,Y);if(q<0)throw new Error("Index out of bounds: "+q);this.unique_&&this.assertUnique_(Y,q);const H=this.array_[q];this.array_[q]=Y,this.dispatchEvent(new dh(uh,H,q)),this.dispatchEvent(new dh(lh,Y,q))}updateLength_(){this.set(ch,this.array_.length)}assertUnique_(q,Y){for(let H=0,et=this.array_.length;H<et;++H)if(this.array_[H]===q&&H!==Y)throw new hh.Z(58)}}const fh=gh;var ph=i(5990),mh=i(4331);const yh=class{constructor(q){this.rbush_=new mh(q),this.items_={}}insert(q,Y){const H={minX:q[0],minY:q[1],maxX:q[2],maxY:q[3],value:Y};this.rbush_.insert(H),this.items_[(0,mn.sq)(Y)]=H}load(q,Y){const H=new Array(Y.length);for(let et=0,it=Y.length;et<it;et++){const it=q[et],nt=Y[et],st={minX:it[0],minY:it[1],maxX:it[2],maxY:it[3],value:nt};H[et]=st,this.items_[(0,mn.sq)(nt)]=st}this.rbush_.load(H)}remove(q){const Y=(0,mn.sq)(q),H=this.items_[Y];return delete this.items_[Y],null!==this.rbush_.remove(H)}update(q,Y){const H=this.items_[(0,mn.sq)(Y)],et=[H.minX,H.minY,H.maxX,H.maxY];(0,Xt.fS)(et,q)||(this.remove(Y),this.insert(q,Y))}getAll(){return this.rbush_.all().map((function(q){return q.value}))}getInExtent(q){const Y={minX:q[0],minY:q[1],maxX:q[2],maxY:q[3]};return this.rbush_.search(Y).map((function(q){return q.value}))}forEach(q){return this.forEach_(this.getAll(),q)}forEachInExtent(q,Y){return this.forEach_(this.getInExtent(q),Y)}forEach_(q,Y){let H;for(let et=0,it=q.length;et<it;et++)if(H=Y(q[et]),H)return H;return H}isEmpty(){return(0,nh.x)(this.items_)}clear(){this.rbush_.clear(),this.items_={}}getExtent(q){const Y=this.rbush_.toJSON();return(0,Xt.T9)(Y.minX,Y.minY,Y.maxX,Y.maxY,q)}concat(q){this.rbush_.load(q.rbush_.all());for(const Y in q.items_)this.items_[Y]=q.items_[Y]}},_h="addfeature",wh="removefeature";var Ch=i(6885);function rh(q,Y){return[[-1/0,-1/0,1/0,1/0]]}function sh(q,Y){return[q]}function oh(q,Y){return function(H,et,it,nt,st){const ot=this;!function(q,Y,H,et,it,nt,st){const ot=new XMLHttpRequest;ot.open("GET","function"==typeof q?q(H,et,it):q,!0),"arraybuffer"==Y.getType()&&(ot.responseType="arraybuffer"),ot.withCredentials=!1,ot.onload=function(q){if(!ot.status||ot.status>=200&&ot.status<300){const q=Y.getType();let et;"json"==q||"text"==q?et=ot.responseText:"xml"==q?(et=ot.responseXML,et||(et=(new DOMParser).parseFromString(ot.responseText,"application/xml"))):"arraybuffer"==q&&(et=ot.response),et?nt(Y.readFeatures(et,{extent:H,featureProjection:it}),Y.readProjection(et)):st()}else st()},ot.onerror=st,ot.send()}(q,Y,H,et,it,(function(q,Y){ot.addFeatures(q),void 0!==nt&&nt(q)}),st||Ch.Zn)}}class Eh extends Ln.ZP{constructor(q,Y,H){super(q),this.feature=Y,this.features=H}}const Rh=class extends hs{constructor(q){super({attributions:(q=q||{}).attributions,interpolate:!0,projection:void 0,state:"ready",wrapX:void 0===q.wrapX||q.wrapX}),this.on,this.once,this.un,this.loader_=Ch.Zn,this.format_=q.format,this.overlaps_=void 0===q.overlaps||q.overlaps,this.url_=q.url,void 0!==q.loader?this.loader_=q.loader:void 0!==this.url_&&((0,yn.h)(this.format_,7),this.loader_=oh(this.url_,this.format_)),this.strategy_=void 0!==q.strategy?q.strategy:rh;const Y=void 0===q.useSpatialIndex||q.useSpatialIndex;let H,et;this.featuresRtree_=Y?new yh:null,this.loadedExtentsRtree_=new yh,this.loadingExtentsCount_=0,this.nullGeometryFeatures_={},this.idIndex_={},this.uidIndex_={},this.featureChangeKeys_={},this.featuresCollection_=null,Array.isArray(q.features)?et=q.features:q.features&&(H=q.features,et=H.getArray()),Y||void 0!==H||(H=new fh(et)),void 0!==et&&this.addFeaturesInternal(et),void 0!==H&&this.bindFeaturesCollection_(H)}addFeature(q){this.addFeatureInternal(q),this.changed()}addFeatureInternal(q){const Y=(0,mn.sq)(q);if(!this.addToIndex_(Y,q))return void(this.featuresCollection_&&this.featuresCollection_.remove(q));this.setupChangeEvents_(Y,q);const H=q.getGeometry();if(H){const Y=H.getExtent();this.featuresRtree_&&this.featuresRtree_.insert(Y,q)}else this.nullGeometryFeatures_[Y]=q;this.dispatchEvent(new Eh(_h,q))}setupChangeEvents_(q,Y){this.featureChangeKeys_[q]=[(0,Cn.oL)(Y,Sn.Z.CHANGE,this.handleFeatureChange_,this),(0,Cn.oL)(Y,ph.Z.PROPERTYCHANGE,this.handleFeatureChange_,this)]}addToIndex_(q,Y){let H=!0;const et=Y.getId();return void 0!==et&&(et.toString()in this.idIndex_?H=!1:this.idIndex_[et.toString()]=Y),H&&((0,yn.h)(!(q in this.uidIndex_),30),this.uidIndex_[q]=Y),H}addFeatures(q){this.addFeaturesInternal(q),this.changed()}addFeaturesInternal(q){const Y=[],H=[],et=[];for(let Y=0,et=q.length;Y<et;Y++){const et=q[Y],it=(0,mn.sq)(et);this.addToIndex_(it,et)&&H.push(et)}for(let q=0,it=H.length;q<it;q++){const it=H[q],nt=(0,mn.sq)(it);this.setupChangeEvents_(nt,it);const st=it.getGeometry();if(st){const q=st.getExtent();Y.push(q),et.push(it)}else this.nullGeometryFeatures_[nt]=it}if(this.featuresRtree_&&this.featuresRtree_.load(Y,et),this.hasListener(_h))for(let q=0,Y=H.length;q<Y;q++)this.dispatchEvent(new Eh(_h,H[q]))}bindFeaturesCollection_(q){let Y=!1;this.addEventListener(_h,(function(H){Y||(Y=!0,q.push(H.feature),Y=!1)})),this.addEventListener(wh,(function(H){Y||(Y=!0,q.remove(H.feature),Y=!1)})),q.addEventListener(lh,(q=>{Y||(Y=!0,this.addFeature(q.element),Y=!1)})),q.addEventListener(uh,(q=>{Y||(Y=!0,this.removeFeature(q.element),Y=!1)})),this.featuresCollection_=q}clear(q){if(q){for(const q in this.featureChangeKeys_)this.featureChangeKeys_[q].forEach(Cn.bN);this.featuresCollection_||(this.featureChangeKeys_={},this.idIndex_={},this.uidIndex_={})}else if(this.featuresRtree_){const t=q=>{this.removeFeatureInternal(q)};this.featuresRtree_.forEach(t);for(const q in this.nullGeometryFeatures_)this.removeFeatureInternal(this.nullGeometryFeatures_[q])}this.featuresCollection_&&this.featuresCollection_.clear(),this.featuresRtree_&&this.featuresRtree_.clear(),this.nullGeometryFeatures_={};const Y=new Eh("clear");this.dispatchEvent(Y),this.changed()}forEachFeature(q){if(this.featuresRtree_)return this.featuresRtree_.forEach(q);this.featuresCollection_&&this.featuresCollection_.forEach(q)}forEachFeatureAtCoordinateDirect(q,Y){const H=[q[0],q[1],q[0],q[1]];return this.forEachFeatureInExtent(H,(function(H){if(H.getGeometry().intersectsCoordinate(q))return Y(H)}))}forEachFeatureInExtent(q,Y){if(this.featuresRtree_)return this.featuresRtree_.forEachInExtent(q,Y);this.featuresCollection_&&this.featuresCollection_.forEach(Y)}forEachFeatureIntersectingExtent(q,Y){return this.forEachFeatureInExtent(q,(function(H){if(H.getGeometry().intersectsExtent(q)){const q=Y(H);if(q)return q}}))}getFeaturesCollection(){return this.featuresCollection_}getFeatures(){let q;return this.featuresCollection_?q=this.featuresCollection_.getArray().slice(0):this.featuresRtree_&&(q=this.featuresRtree_.getAll(),(0,nh.x)(this.nullGeometryFeatures_)||(0,Dn.l7)(q,Object.values(this.nullGeometryFeatures_))),q}getFeaturesAtCoordinate(q){const Y=[];return this.forEachFeatureAtCoordinateDirect(q,(function(q){Y.push(q)})),Y}getFeaturesInExtent(q,Y){if(this.featuresRtree_){if(!(Y&&Y.canWrapX()&&this.getWrapX()))return this.featuresRtree_.getInExtent(q);const H=(0,Xt.MV)(q,Y);return[].concat(...H.map((q=>this.featuresRtree_.getInExtent(q))))}return this.featuresCollection_?this.featuresCollection_.getArray().slice(0):[]}getClosestFeatureToCoordinate(q,Y){const H=q[0],et=q[1];let it=null;const nt=[NaN,NaN];let st=1/0;const ot=[-1/0,-1/0,1/0,1/0];return Y=Y||Ch.uX,this.featuresRtree_.forEachInExtent(ot,(function(q){if(Y(q)){const Y=q.getGeometry(),lt=st;if(st=Y.closestPointXY(H,et,nt,st),st<lt){it=q;const Y=Math.sqrt(st);ot[0]=H-Y,ot[1]=et-Y,ot[2]=H+Y,ot[3]=et+Y}}})),it}getExtent(q){return this.featuresRtree_.getExtent(q)}getFeatureById(q){const Y=this.idIndex_[q.toString()];return void 0!==Y?Y:null}getFeatureByUid(q){const Y=this.uidIndex_[q];return void 0!==Y?Y:null}getFormat(){return this.format_}getOverlaps(){return this.overlaps_}getUrl(){return this.url_}handleFeatureChange_(q){const Y=q.target,H=(0,mn.sq)(Y),et=Y.getGeometry();if(et){const q=et.getExtent();H in this.nullGeometryFeatures_?(delete this.nullGeometryFeatures_[H],this.featuresRtree_&&this.featuresRtree_.insert(q,Y)):this.featuresRtree_&&this.featuresRtree_.update(q,Y)}else H in this.nullGeometryFeatures_||(this.featuresRtree_&&this.featuresRtree_.remove(Y),this.nullGeometryFeatures_[H]=Y);const it=Y.getId();if(void 0!==it){const q=it.toString();this.idIndex_[q]!==Y&&(this.removeFromIdIndex_(Y),this.idIndex_[q]=Y)}else this.removeFromIdIndex_(Y),this.uidIndex_[H]=Y;this.changed(),this.dispatchEvent(new Eh("changefeature",Y))}hasFeature(q){const Y=q.getId();return void 0!==Y?Y in this.idIndex_:(0,mn.sq)(q)in this.uidIndex_}isEmpty(){return this.featuresRtree_?this.featuresRtree_.isEmpty()&&(0,nh.x)(this.nullGeometryFeatures_):!this.featuresCollection_||0===this.featuresCollection_.getLength()}loadFeatures(q,Y,H){const et=this.loadedExtentsRtree_,it=this.strategy_(q,Y,H);for(let q=0,nt=it.length;q<nt;++q){const nt=it[q];et.forEachInExtent(nt,(function(q){return(0,Xt.r4)(q.extent,nt)}))||(++this.loadingExtentsCount_,this.dispatchEvent(new Eh("featuresloadstart")),this.loader_.call(this,nt,Y,H,(q=>{--this.loadingExtentsCount_,this.dispatchEvent(new Eh("featuresloadend",void 0,q))}),(()=>{--this.loadingExtentsCount_,this.dispatchEvent(new Eh("featuresloaderror"))})),et.insert(nt,{extent:nt.slice()}))}this.loading=!(this.loader_.length<4)&&this.loadingExtentsCount_>0}refresh(){this.clear(!0),this.loadedExtentsRtree_.clear(),super.refresh()}removeLoadedExtent(q){const Y=this.loadedExtentsRtree_;let H;Y.forEachInExtent(q,(function(Y){if((0,Xt.fS)(Y.extent,q))return H=Y,!0})),H&&Y.remove(H)}removeFeature(q){if(!q)return;const Y=(0,mn.sq)(q);Y in this.nullGeometryFeatures_?delete this.nullGeometryFeatures_[Y]:this.featuresRtree_&&this.featuresRtree_.remove(q),this.removeFeatureInternal(q)&&this.changed()}removeFeatureInternal(q){const Y=(0,mn.sq)(q),H=this.featureChangeKeys_[Y];if(!H)return;H.forEach(Cn.bN),delete this.featureChangeKeys_[Y];const et=q.getId();return void 0!==et&&delete this.idIndex_[et.toString()],delete this.uidIndex_[Y],this.dispatchEvent(new Eh(wh,q)),q}removeFromIdIndex_(q){let Y=!1;for(const H in this.idIndex_)if(this.idIndex_[H]===q){delete this.idIndex_[H],Y=!0;break}return Y}setLoader(q){this.loader_=q}setUrl(q){(0,yn.h)(this.format_,7),this.url_=q,this.setLoader(oh(q,this.format_))}},Oh=class extends En{constructor(q){super(q=q||{})}},Ih=class extends Un{constructor(q){super(q),this.image_=null}getImage(){return this.image_?this.image_.getImage():null}prepareFrame(q){const Y=q.layerStatesArray[q.layerIndex],H=q.pixelRatio,et=q.viewState,it=et.resolution,nt=this.getLayer().getSource(),st=q.viewHints;let ot=q.extent;if(void 0!==Y.extent&&(ot=(0,Xt.Ed)(ot,(0,Vt.dY)(Y.extent,et.projection))),!st[0]&&!st[1]&&!(0,Xt.xb)(ot))if(nt){const q=et.projection,Y=nt.getImage(ot,it,H,q);Y&&(this.loadImage(Y)?this.image_=Y:Y.getState()===Pn.default.EMPTY&&(this.image_=null))}else this.image_=null;return!!this.image_}getData(q){const Y=this.frameState;if(!Y)return null;const H=this.getLayer(),et=(0,Gn.nn)(Y.pixelToCoordinateTransform,q.slice()),it=H.getExtent();if(it&&!(0,Xt.b8)(it,et))return null;const nt=this.image_.getExtent(),st=this.image_.getImage(),ot=(0,Xt.dz)(nt),lt=Math.floor(st.width*((et[0]-nt[0])/ot));if(lt<0||lt>=st.width)return null;const mt=(0,Xt.Cr)(nt),_t=Math.floor(st.height*((nt[3]-et[1])/mt));return _t<0||_t>=st.height?null:this.getImageData(st,lt,_t)}renderFrame(q,Y){const H=this.image_,et=H.getExtent(),it=H.getResolution(),nt=H.getPixelRatio(),st=q.layerStatesArray[q.layerIndex],ot=q.pixelRatio,lt=q.viewState,mt=lt.center,_t=ot*it/(lt.resolution*nt),vt=q.extent,bt=lt.resolution,Mt=lt.rotation,Et=Math.round((0,Xt.dz)(vt)/bt*ot),Rt=Math.round((0,Xt.Cr)(vt)/bt*ot);(0,Gn.qC)(this.pixelTransform,q.size[0]/2,q.size[1]/2,1/ot,1/ot,Mt,-Et/2,-Rt/2),(0,Gn.nb)(this.inversePixelTransform,this.pixelTransform);const It=(0,Gn.BB)(this.pixelTransform);this.useContainer(Y,It,this.getBackground(q));const Pt=this.context,Tt=Pt.canvas;Tt.width!=Et||Tt.height!=Rt?(Tt.width=Et,Tt.height=Rt):this.containerReused||Pt.clearRect(0,0,Et,Rt);let Ft=!1,At=!0;if(st.extent){const Y=(0,Vt.dY)(st.extent,lt.projection);At=(0,Xt.kK)(Y,q.extent),Ft=At&&!(0,Xt.r4)(Y,q.extent),Ft&&this.clipUnrotated(Pt,q,Y)}const Lt=H.getImage(),Nt=(0,Gn.qC)(this.tempTransform,Et/2,Rt/2,_t,_t,0,nt*(et[0]-mt[0])/it,nt*(mt[1]-et[3])/it);this.renderedResolution=it*ot/nt;const kt=Lt.width*Nt[0],Gt=Lt.height*Nt[3];if(this.getLayer().getSource().getInterpolate()||(Pt.imageSmoothingEnabled=!1),this.preRender(Pt,q),At&&kt>=.5&&Gt>=.5){const q=Nt[4],Y=Nt[5],H=st.opacity;let et;1!==H&&(et=Pt.globalAlpha,Pt.globalAlpha=H),Pt.drawImage(Lt,0,0,+Lt.width,+Lt.height,q,Y,kt,Gt),1!==H&&(Pt.globalAlpha=et)}return this.postRender(Pt,q),Ft&&Pt.restore(),Pt.imageSmoothingEnabled=!0,It!==Tt.style.transform&&(Tt.style.transform=It),this.container}},Ph=class extends Oh{constructor(q){super(q)}createRenderer(){return new Ih(this)}getData(q){return super.getData(q)}};var Th=i(7539),Fh=i(283),Ah=i(1345),Lh=i(4548),Nh=i(5393),kh=i(8958),Gh=i(1280);function vh(q){return new Th.default({fill:xh(q,""),stroke:Sh(q,""),text:bh(q),image:Mh(q)})}function xh(q,Y){const H=q[Y+"fill-color"];if(H)return new Ah.default({color:H})}function Sh(q,Y){const H=q[Y+"stroke-width"],et=q[Y+"stroke-color"];if(H||et)return new kh.default({width:H,color:et,lineCap:q[Y+"stroke-line-cap"],lineJoin:q[Y+"stroke-line-join"],lineDash:q[Y+"stroke-line-dash"],lineDashOffset:q[Y+"stroke-line-dash-offset"],miterLimit:q[Y+"stroke-miter-limit"]})}function bh(q){const Y=q["text-value"];if(Y)return new Gh.default({text:Y,font:q["text-font"],maxAngle:q["text-max-angle"],offsetX:q["text-offset-x"],offsetY:q["text-offset-y"],overflow:q["text-overflow"],placement:q["text-placement"],scale:q["text-scale"],rotateWithView:q["text-rotate-with-view"],rotation:q["text-rotation"],textAlign:q["text-align"],justify:q["text-justify"],textBaseline:q["text-baseline"],padding:q["text-padding"],fill:xh(q,"text-"),backgroundFill:xh(q,"text-background-"),stroke:Sh(q,"text-"),backgroundStroke:Sh(q,"text-background-")})}function Mh(q){const Y=q["icon-src"],H=q["icon-img"];if(Y||H)return new Lh.default({src:Y,img:H,imgSize:q["icon-img-size"],anchor:q["icon-anchor"],anchorOrigin:q["icon-anchor-origin"],anchorXUnits:q["icon-anchor-x-units"],anchorYUnits:q["icon-anchor-y-units"],color:q["icon-color"],crossOrigin:q["icon-cross-origin"],offset:q["icon-offset"],displacement:q["icon-displacement"],opacity:q["icon-opacity"],scale:q["icon-scale"],rotation:q["icon-rotation"],rotateWithView:q["icon-rotate-with-view"],size:q["icon-size"],declutterMode:q["icon-declutter-mode"]});const et=q["shape-points"];if(et){const Y="shape-";return new Nh.default({points:et,fill:xh(q,Y),stroke:Sh(q,Y),radius:q["shape-radius"],radius1:q["shape-radius1"],radius2:q["shape-radius2"],angle:q["shape-angle"],displacement:q["shape-displacement"],rotation:q["shape-rotation"],rotateWithView:q["shape-rotate-with-view"],scale:q["shape-scale"],declutterMode:q["shape-declutter-mode"]})}const it=q["circle-radius"];if(it){const Y="circle-";return new Fh.default({radius:it,fill:xh(q,Y),stroke:Sh(q,Y),displacement:q["circle-displacement"],scale:q["circle-scale"],rotation:q["circle-rotation"],rotateWithView:q["circle-rotate-with-view"],declutterMode:q["circle-declutter-mode"]})}}const jh="renderOrder",zh=class extends En{constructor(q){q=q||{};const Y=Object.assign({},q);delete Y.style,delete Y.renderBuffer,delete Y.updateWhileAnimating,delete Y.updateWhileInteracting,super(Y),this.declutter_=void 0!==q.declutter&&q.declutter,this.renderBuffer_=void 0!==q.renderBuffer?q.renderBuffer:100,this.style_=null,this.styleFunction_=void 0,this.setStyle(q.style),this.updateWhileAnimating_=void 0!==q.updateWhileAnimating&&q.updateWhileAnimating,this.updateWhileInteracting_=void 0!==q.updateWhileInteracting&&q.updateWhileInteracting}getDeclutter(){return this.declutter_}getFeatures(q){return super.getFeatures(q)}getRenderBuffer(){return this.renderBuffer_}getRenderOrder(){return this.get(jh)}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}getUpdateWhileAnimating(){return this.updateWhileAnimating_}getUpdateWhileInteracting(){return this.updateWhileInteracting_}renderDeclutter(q){q.declutterTree||(q.declutterTree=new mh(9)),this.getRenderer().renderDeclutter(q)}setRenderOrder(q){this.set(jh,q)}setStyle(q){let Y;if(void 0===q)Y=Th.createDefaultStyle;else if(null===q)Y=null;else if("function"==typeof q)Y=q;else if(q instanceof Th.default)Y=q;else if(Array.isArray(q)){const H=q.length,et=new Array(H);for(let Y=0;Y<H;++Y){const H=q[Y];H instanceof Th.default?et[Y]=H:et[Y]=vh(H)}Y=et}else Y=vh(q);this.style_=Y,this.styleFunction_=null===q?void 0:(0,Th.toFunction)(this.style_),this.changed()}},Bh={BEGIN_GEOMETRY:0,BEGIN_PATH:1,CIRCLE:2,CLOSE_PATH:3,CUSTOM:4,DRAW_CHARS:5,DRAW_IMAGE:6,END_GEOMETRY:7,FILL:8,MOVE_TO_LINE_TO:9,SET_FILL_STYLE:10,SET_STROKE_STYLE:11,STROKE:12},Uh=[Bh.FILL],Wh=[Bh.STROKE],Yh=[Bh.BEGIN_PATH],Zh=[Bh.CLOSE_PATH],Xh=Bh;var Vh=i(8716),Kh=i(5624),Jh=i(6620),tl=i(4778);class el extends Kh.Z{constructor(q,Y,H,et){super(),this.tolerance=q,this.maxExtent=Y,this.pixelRatio=et,this.maxLineWidth=0,this.resolution=H,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_=null,this.bufferedMaxExtent_=null,this.instructions=[],this.coordinates=[],this.tmpCoordinate_=[],this.hitDetectionInstructions=[],this.state={}}applyPixelRatio(q){const Y=this.pixelRatio;return 1==Y?q:q.map((function(q){return q*Y}))}appendFlatPointCoordinates(q,Y){const H=this.getBufferedMaxExtent(),et=this.tmpCoordinate_,it=this.coordinates;let nt=it.length;for(let st=0,ot=q.length;st<ot;st+=Y)et[0]=q[st],et[1]=q[st+1],(0,Xt.b8)(H,et)&&(it[nt++]=et[0],it[nt++]=et[1]);return nt}appendFlatLineCoordinates(q,Y,H,et,it,nt){const st=this.coordinates;let ot=st.length;const lt=this.getBufferedMaxExtent();nt&&(Y+=et);let mt=q[Y],_t=q[Y+1];const vt=this.tmpCoordinate_;let bt,Mt,Et,Rt=!0;for(bt=Y+et;bt<H;bt+=et)vt[0]=q[bt],vt[1]=q[bt+1],Et=(0,Xt.pX)(lt,vt),Et!==Mt?(Rt&&(st[ot++]=mt,st[ot++]=_t,Rt=!1),st[ot++]=vt[0],st[ot++]=vt[1]):Et===Vh.Z.INTERSECTING?(st[ot++]=vt[0],st[ot++]=vt[1],Rt=!1):Rt=!0,mt=vt[0],_t=vt[1],Mt=Et;return(it&&Rt||bt===Y+et)&&(st[ot++]=mt,st[ot++]=_t),ot}drawCustomCoordinates_(q,Y,H,et,it){for(let nt=0,st=H.length;nt<st;++nt){const st=H[nt],ot=this.appendFlatLineCoordinates(q,Y,st,et,!1,!1);it.push(ot),Y=st}return Y}drawCustom(q,Y,H,et){this.beginGeometry(q,Y);const it=q.getType(),nt=q.getStride(),st=this.coordinates.length;let ot,lt,mt,_t,vt;switch(it){case"MultiPolygon":ot=q.getOrientedFlatCoordinates(),_t=[];const Y=q.getEndss();vt=0;for(let q=0,H=Y.length;q<H;++q){const H=[];vt=this.drawCustomCoordinates_(ot,vt,Y[q],nt,H),_t.push(H)}this.instructions.push([Xh.CUSTOM,st,_t,q,H,Ps]),this.hitDetectionInstructions.push([Xh.CUSTOM,st,_t,q,et||H,Ps]);break;case"Polygon":case"MultiLineString":mt=[],ot="Polygon"==it?q.getOrientedFlatCoordinates():q.getFlatCoordinates(),vt=this.drawCustomCoordinates_(ot,0,q.getEnds(),nt,mt),this.instructions.push([Xh.CUSTOM,st,mt,q,H,Os]),this.hitDetectionInstructions.push([Xh.CUSTOM,st,mt,q,et||H,Os]);break;case"LineString":case"Circle":ot=q.getFlatCoordinates(),lt=this.appendFlatLineCoordinates(ot,0,ot.length,nt,!1,!1),this.instructions.push([Xh.CUSTOM,st,lt,q,H,Rs]),this.hitDetectionInstructions.push([Xh.CUSTOM,st,lt,q,et||H,Rs]);break;case"MultiPoint":ot=q.getFlatCoordinates(),lt=this.appendFlatPointCoordinates(ot,nt),lt>st&&(this.instructions.push([Xh.CUSTOM,st,lt,q,H,Rs]),this.hitDetectionInstructions.push([Xh.CUSTOM,st,lt,q,et||H,Rs]));break;case"Point":ot=q.getFlatCoordinates(),this.coordinates.push(ot[0],ot[1]),lt=this.coordinates.length,this.instructions.push([Xh.CUSTOM,st,lt,q,H]),this.hitDetectionInstructions.push([Xh.CUSTOM,st,lt,q,et||H])}this.endGeometry(Y)}beginGeometry(q,Y){this.beginGeometryInstruction1_=[Xh.BEGIN_GEOMETRY,Y,0,q],this.instructions.push(this.beginGeometryInstruction1_),this.beginGeometryInstruction2_=[Xh.BEGIN_GEOMETRY,Y,0,q],this.hitDetectionInstructions.push(this.beginGeometryInstruction2_)}finish(){return{instructions:this.instructions,hitDetectionInstructions:this.hitDetectionInstructions,coordinates:this.coordinates}}reverseHitDetectionInstructions(){const q=this.hitDetectionInstructions;let Y;q.reverse();const H=q.length;let et,it,nt=-1;for(Y=0;Y<H;++Y)et=q[Y],it=et[0],it==Xh.END_GEOMETRY?nt=Y:it==Xh.BEGIN_GEOMETRY&&(et[2]=Y,(0,Dn.FZ)(this.hitDetectionInstructions,nt,Y),nt=-1)}setFillStrokeStyle(q,Y){const H=this.state;if(q){const Y=q.getColor();H.fillStyle=(0,Jh.y)(Y||tl.bL)}else H.fillStyle=void 0;if(Y){const q=Y.getColor();H.strokeStyle=(0,Jh.y)(q||tl.Tx);const et=Y.getLineCap();H.lineCap=void 0!==et?et:tl.mb;const it=Y.getLineDash();H.lineDash=it?it.slice():tl.X9;const nt=Y.getLineDashOffset();H.lineDashOffset=nt||tl.He;const st=Y.getLineJoin();H.lineJoin=void 0!==st?st:tl.rc;const ot=Y.getWidth();H.lineWidth=void 0!==ot?ot:tl.yC;const lt=Y.getMiterLimit();H.miterLimit=void 0!==lt?lt:tl.V4,H.lineWidth>this.maxLineWidth&&(this.maxLineWidth=H.lineWidth,this.bufferedMaxExtent_=null)}else H.strokeStyle=void 0,H.lineCap=void 0,H.lineDash=null,H.lineDashOffset=void 0,H.lineJoin=void 0,H.lineWidth=void 0,H.miterLimit=void 0}createFill(q){const Y=q.fillStyle,H=[Xh.SET_FILL_STYLE,Y];return"string"!=typeof Y&&H.push(!0),H}applyStroke(q){this.instructions.push(this.createStroke(q))}createStroke(q){return[Xh.SET_STROKE_STYLE,q.strokeStyle,q.lineWidth*this.pixelRatio,q.lineCap,q.lineJoin,q.miterLimit,this.applyPixelRatio(q.lineDash),q.lineDashOffset*this.pixelRatio]}updateFillStyle(q,Y){const H=q.fillStyle;"string"==typeof H&&q.currentFillStyle==H||(void 0!==H&&this.instructions.push(Y.call(this,q)),q.currentFillStyle=H)}updateStrokeStyle(q,Y){const H=q.strokeStyle,et=q.lineCap,it=q.lineDash,nt=q.lineDashOffset,st=q.lineJoin,ot=q.lineWidth,lt=q.miterLimit;(q.currentStrokeStyle!=H||q.currentLineCap!=et||it!=q.currentLineDash&&!(0,Dn.fS)(q.currentLineDash,it)||q.currentLineDashOffset!=nt||q.currentLineJoin!=st||q.currentLineWidth!=ot||q.currentMiterLimit!=lt)&&(void 0!==H&&Y.call(this,q),q.currentStrokeStyle=H,q.currentLineCap=et,q.currentLineDash=it,q.currentLineDashOffset=nt,q.currentLineJoin=st,q.currentLineWidth=ot,q.currentMiterLimit=lt)}endGeometry(q){this.beginGeometryInstruction1_[2]=this.instructions.length,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_[2]=this.hitDetectionInstructions.length,this.beginGeometryInstruction2_=null;const Y=[Xh.END_GEOMETRY,q];this.instructions.push(Y),this.hitDetectionInstructions.push(Y)}getBufferedMaxExtent(){if(!this.bufferedMaxExtent_&&(this.bufferedMaxExtent_=(0,Xt.d9)(this.maxExtent),this.maxLineWidth>0)){const q=this.resolution*(this.maxLineWidth+1)/2;(0,Xt.f3)(this.bufferedMaxExtent_,q,this.bufferedMaxExtent_)}return this.bufferedMaxExtent_}}const il=el,rl=class extends il{constructor(q,Y,H,et){super(q,Y,H,et)}drawFlatCoordinatess_(q,Y,H,et){const it=this.state,nt=void 0!==it.fillStyle,st=void 0!==it.strokeStyle,ot=H.length;this.instructions.push(Yh),this.hitDetectionInstructions.push(Yh);for(let it=0;it<ot;++it){const nt=H[it],ot=this.coordinates.length,lt=this.appendFlatLineCoordinates(q,Y,nt,et,!0,!st),mt=[Xh.MOVE_TO_LINE_TO,ot,lt];this.instructions.push(mt),this.hitDetectionInstructions.push(mt),st&&(this.instructions.push(Zh),this.hitDetectionInstructions.push(Zh)),Y=nt}return nt&&(this.instructions.push(Uh),this.hitDetectionInstructions.push(Uh)),st&&(this.instructions.push(Wh),this.hitDetectionInstructions.push(Wh)),Y}drawCircle(q,Y){const H=this.state,et=H.fillStyle,it=H.strokeStyle;if(void 0===et&&void 0===it)return;this.setFillStrokeStyles_(),this.beginGeometry(q,Y),void 0!==H.fillStyle&&this.hitDetectionInstructions.push([Xh.SET_FILL_STYLE,tl.bL]),void 0!==H.strokeStyle&&this.hitDetectionInstructions.push([Xh.SET_STROKE_STYLE,H.strokeStyle,H.lineWidth,H.lineCap,H.lineJoin,H.miterLimit,H.lineDash,H.lineDashOffset]);const nt=q.getFlatCoordinates(),st=q.getStride(),ot=this.coordinates.length;this.appendFlatLineCoordinates(nt,0,nt.length,st,!1,!1);const lt=[Xh.CIRCLE,ot];this.instructions.push(Yh,lt),this.hitDetectionInstructions.push(Yh,lt),void 0!==H.fillStyle&&(this.instructions.push(Uh),this.hitDetectionInstructions.push(Uh)),void 0!==H.strokeStyle&&(this.instructions.push(Wh),this.hitDetectionInstructions.push(Wh)),this.endGeometry(Y)}drawPolygon(q,Y){const H=this.state,et=H.fillStyle,it=H.strokeStyle;if(void 0===et&&void 0===it)return;this.setFillStrokeStyles_(),this.beginGeometry(q,Y),void 0!==H.fillStyle&&this.hitDetectionInstructions.push([Xh.SET_FILL_STYLE,tl.bL]),void 0!==H.strokeStyle&&this.hitDetectionInstructions.push([Xh.SET_STROKE_STYLE,H.strokeStyle,H.lineWidth,H.lineCap,H.lineJoin,H.miterLimit,H.lineDash,H.lineDashOffset]);const nt=q.getEnds(),st=q.getOrientedFlatCoordinates(),ot=q.getStride();this.drawFlatCoordinatess_(st,0,nt,ot),this.endGeometry(Y)}drawMultiPolygon(q,Y){const H=this.state,et=H.fillStyle,it=H.strokeStyle;if(void 0===et&&void 0===it)return;this.setFillStrokeStyles_(),this.beginGeometry(q,Y),void 0!==H.fillStyle&&this.hitDetectionInstructions.push([Xh.SET_FILL_STYLE,tl.bL]),void 0!==H.strokeStyle&&this.hitDetectionInstructions.push([Xh.SET_STROKE_STYLE,H.strokeStyle,H.lineWidth,H.lineCap,H.lineJoin,H.miterLimit,H.lineDash,H.lineDashOffset]);const nt=q.getEndss(),st=q.getOrientedFlatCoordinates(),ot=q.getStride();let lt=0;for(let q=0,Y=nt.length;q<Y;++q)lt=this.drawFlatCoordinatess_(st,lt,nt[q],ot);this.endGeometry(Y)}finish(){this.reverseHitDetectionInstructions(),this.state=null;const q=this.tolerance;if(0!==q){const Y=this.coordinates;for(let H=0,et=Y.length;H<et;++H)Y[H]=ws(Y[H],q)}return super.finish()}setFillStrokeStyles_(){const q=this.state;void 0!==q.fillStyle&&this.updateFillStyle(q,this.createFill),void 0!==q.strokeStyle&&this.updateStrokeStyle(q,this.applyStroke)}};function Dh(q,Y,H,et,it){let nt,st,ot,lt,mt,_t,vt,bt,Mt,Et,Rt=H,It=H,Pt=0,Tt=0,Ft=H;for(st=H;st<et;st+=it){const H=Y[st],et=Y[st+1];void 0!==mt&&(Mt=H-mt,Et=et-_t,lt=Math.sqrt(Mt*Mt+Et*Et),void 0!==vt&&(Tt+=ot,nt=Math.acos((vt*Mt+bt*Et)/(ot*lt)),nt>q&&(Tt>Pt&&(Pt=Tt,Rt=Ft,It=st),Tt=0,Ft=st-it)),ot=lt,vt=Mt,bt=Et),mt=H,_t=et}return Tt+=lt,Tt>Pt?[Ft,st]:[Rt,It]}const nl={left:0,end:0,center:.5,right:1,start:1,top:0,middle:.5,hanging:.2,alphabetic:.8,ideographic:.8,bottom:1},sl={Circle:rl,Default:il,Image:class extends il{constructor(q,Y,H,et){super(q,Y,H,et),this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.anchorX_=void 0,this.anchorY_=void 0,this.height_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.scale_=void 0,this.width_=void 0,this.declutterMode_=void 0,this.declutterImageWithText_=void 0}drawPoint(q,Y){if(!this.image_)return;this.beginGeometry(q,Y);const H=q.getFlatCoordinates(),et=q.getStride(),it=this.coordinates.length,nt=this.appendFlatPointCoordinates(H,et);this.instructions.push([Xh.DRAW_IMAGE,it,nt,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([Xh.DRAW_IMAGE,it,nt,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(Y)}drawMultiPoint(q,Y){if(!this.image_)return;this.beginGeometry(q,Y);const H=q.getFlatCoordinates(),et=q.getStride(),it=this.coordinates.length,nt=this.appendFlatPointCoordinates(H,et);this.instructions.push([Xh.DRAW_IMAGE,it,nt,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([Xh.DRAW_IMAGE,it,nt,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(Y)}finish(){return this.reverseHitDetectionInstructions(),this.anchorX_=void 0,this.anchorY_=void 0,this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.height_=void 0,this.scale_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.width_=void 0,super.finish()}setImageStyle(q,Y){const H=q.getAnchor(),et=q.getSize(),it=q.getOrigin();this.imagePixelRatio_=q.getPixelRatio(this.pixelRatio),this.anchorX_=H[0],this.anchorY_=H[1],this.hitDetectionImage_=q.getHitDetectionImage(),this.image_=q.getImage(this.pixelRatio),this.height_=et[1],this.opacity_=q.getOpacity(),this.originX_=it[0],this.originY_=it[1],this.rotateWithView_=q.getRotateWithView(),this.rotation_=q.getRotation(),this.scale_=q.getScaleArray(),this.width_=et[0],this.declutterMode_=q.getDeclutterMode(),this.declutterImageWithText_=Y}},LineString:class extends il{constructor(q,Y,H,et){super(q,Y,H,et)}drawFlatCoordinates_(q,Y,H,et){const it=this.coordinates.length,nt=this.appendFlatLineCoordinates(q,Y,H,et,!1,!1),st=[Xh.MOVE_TO_LINE_TO,it,nt];return this.instructions.push(st),this.hitDetectionInstructions.push(st),H}drawLineString(q,Y){const H=this.state,et=H.strokeStyle,it=H.lineWidth;if(void 0===et||void 0===it)return;this.updateStrokeStyle(H,this.applyStroke),this.beginGeometry(q,Y),this.hitDetectionInstructions.push([Xh.SET_STROKE_STYLE,H.strokeStyle,H.lineWidth,H.lineCap,H.lineJoin,H.miterLimit,tl.X9,tl.He],Yh);const nt=q.getFlatCoordinates(),st=q.getStride();this.drawFlatCoordinates_(nt,0,nt.length,st),this.hitDetectionInstructions.push(Wh),this.endGeometry(Y)}drawMultiLineString(q,Y){const H=this.state,et=H.strokeStyle,it=H.lineWidth;if(void 0===et||void 0===it)return;this.updateStrokeStyle(H,this.applyStroke),this.beginGeometry(q,Y),this.hitDetectionInstructions.push([Xh.SET_STROKE_STYLE,H.strokeStyle,H.lineWidth,H.lineCap,H.lineJoin,H.miterLimit,H.lineDash,H.lineDashOffset],Yh);const nt=q.getEnds(),st=q.getFlatCoordinates(),ot=q.getStride();let lt=0;for(let q=0,Y=nt.length;q<Y;++q)lt=this.drawFlatCoordinates_(st,lt,nt[q],ot);this.hitDetectionInstructions.push(Wh),this.endGeometry(Y)}finish(){const q=this.state;return null!=q.lastStroke&&q.lastStroke!=this.coordinates.length&&this.instructions.push(Wh),this.reverseHitDetectionInstructions(),this.state=null,super.finish()}applyStroke(q){null!=q.lastStroke&&q.lastStroke!=this.coordinates.length&&(this.instructions.push(Wh),q.lastStroke=this.coordinates.length),q.lastStroke=0,super.applyStroke(q),this.instructions.push(Yh)}},Polygon:rl,Text:class extends il{constructor(q,Y,H,et){super(q,Y,H,et),this.labels_=null,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=void 0,this.textRotation_=0,this.textFillState_=null,this.fillStates={},this.textStrokeState_=null,this.strokeStates={},this.textState_={},this.textStates={},this.textKey_="",this.fillKey_="",this.strokeKey_="",this.declutterImageWithText_=void 0}finish(){const q=super.finish();return q.textStates=this.textStates,q.fillStates=this.fillStates,q.strokeStates=this.strokeStates,q}drawText(q,Y){const H=this.textFillState_,et=this.textStrokeState_,it=this.textState_;if(""===this.text_||!it||!H&&!et)return;const nt=this.coordinates;let st=nt.length;const ot=q.getType();let lt=null,mt=q.getStride();if("line"!==it.placement||"LineString"!=ot&&"MultiLineString"!=ot&&"Polygon"!=ot&&"MultiPolygon"!=ot){let H=it.overflow?null:[];switch(ot){case"Point":case"MultiPoint":lt=q.getFlatCoordinates();break;case"LineString":lt=q.getFlatMidpoint();break;case"Circle":lt=q.getCenter();break;case"MultiLineString":lt=q.getFlatMidpoints(),mt=2;break;case"Polygon":lt=q.getFlatInteriorPoint(),it.overflow||H.push(lt[2]/this.resolution),mt=3;break;case"MultiPolygon":const Y=q.getFlatInteriorPoints();lt=[];for(let q=0,et=Y.length;q<et;q+=3)it.overflow||H.push(Y[q+2]/this.resolution),lt.push(Y[q],Y[q+1]);if(0===lt.length)return;mt=2}const et=this.appendFlatPointCoordinates(lt,mt);if(et===st)return;if(H&&(et-st)/2!=lt.length/mt){let q=st/2;H=H.filter(((Y,H)=>{const et=nt[2*(q+H)]===lt[H*mt]&&nt[2*(q+H)+1]===lt[H*mt+1];return et||--q,et}))}this.saveTextStates_(),(it.backgroundFill||it.backgroundStroke)&&(this.setFillStrokeStyle(it.backgroundFill,it.backgroundStroke),it.backgroundFill&&(this.updateFillStyle(this.state,this.createFill),this.hitDetectionInstructions.push(this.createFill(this.state))),it.backgroundStroke&&(this.updateStrokeStyle(this.state,this.applyStroke),this.hitDetectionInstructions.push(this.createStroke(this.state)))),this.beginGeometry(q,Y);let _t=it.padding;if(_t!=tl.oB&&(it.scale[0]<0||it.scale[1]<0)){let q=it.padding[0],Y=it.padding[1],H=it.padding[2],et=it.padding[3];it.scale[0]<0&&(Y=-Y,et=-et),it.scale[1]<0&&(q=-q,H=-H),_t=[q,Y,H,et]}const vt=this.pixelRatio;this.instructions.push([Xh.DRAW_IMAGE,st,et,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[1,1],NaN,void 0,this.declutterImageWithText_,_t==tl.oB?tl.oB:_t.map((function(q){return q*vt})),!!it.backgroundFill,!!it.backgroundStroke,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,H]);const bt=1/vt;this.hitDetectionInstructions.push([Xh.DRAW_IMAGE,st,et,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[bt,bt],NaN,void 0,this.declutterImageWithText_,_t,!!it.backgroundFill,!!it.backgroundStroke,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,H]),this.endGeometry(Y)}else{if(!(0,Xt.kK)(this.getBufferedMaxExtent(),q.getExtent()))return;let H;if(lt=q.getFlatCoordinates(),"LineString"==ot)H=[lt.length];else if("MultiLineString"==ot)H=q.getEnds();else if("Polygon"==ot)H=q.getEnds().slice(0,1);else if("MultiPolygon"==ot){const Y=q.getEndss();H=[];for(let q=0,et=Y.length;q<et;++q)H.push(Y[q][0])}this.beginGeometry(q,Y);const et=it.textAlign;let _t,vt=0;for(let q=0,Y=H.length;q<Y;++q){if(null==et){const Y=Dh(it.maxAngle,lt,vt,H[q],mt);vt=Y[0],_t=Y[1]}else _t=H[q];for(let q=vt;q<_t;q+=mt)nt.push(lt[q],lt[q+1]);const Y=nt.length;vt=H[q],this.drawChars_(st,Y),st=Y}this.endGeometry(Y)}}saveTextStates_(){const q=this.textStrokeState_,Y=this.textState_,H=this.textFillState_,et=this.strokeKey_;q&&(et in this.strokeStates||(this.strokeStates[et]={strokeStyle:q.strokeStyle,lineCap:q.lineCap,lineDashOffset:q.lineDashOffset,lineWidth:q.lineWidth,lineJoin:q.lineJoin,miterLimit:q.miterLimit,lineDash:q.lineDash}));const it=this.textKey_;it in this.textStates||(this.textStates[it]={font:Y.font,textAlign:Y.textAlign||tl.PH,justify:Y.justify,textBaseline:Y.textBaseline||tl.ru,scale:Y.scale});const nt=this.fillKey_;H&&(nt in this.fillStates||(this.fillStates[nt]={fillStyle:H.fillStyle}))}drawChars_(q,Y){const H=this.textStrokeState_,et=this.textState_,it=this.strokeKey_,nt=this.textKey_,st=this.fillKey_;this.saveTextStates_();const ot=this.pixelRatio,lt=nl[et.textBaseline],mt=this.textOffsetY_*ot,_t=this.text_,vt=H?H.lineWidth*Math.abs(et.scale[0])/2:0;this.instructions.push([Xh.DRAW_CHARS,q,Y,lt,et.overflow,st,et.maxAngle,ot,mt,it,vt*ot,_t,nt,1]),this.hitDetectionInstructions.push([Xh.DRAW_CHARS,q,Y,lt,et.overflow,st,et.maxAngle,1,mt,it,vt,_t,nt,1/ot])}setTextStyle(q,Y){let H,et,it;if(q){const Y=q.getFill();Y?(et=this.textFillState_,et||(et={},this.textFillState_=et),et.fillStyle=(0,Jh.y)(Y.getColor()||tl.bL)):(et=null,this.textFillState_=et);const nt=q.getStroke();if(nt){it=this.textStrokeState_,it||(it={},this.textStrokeState_=it);const q=nt.getLineDash(),Y=nt.getLineDashOffset(),H=nt.getWidth(),et=nt.getMiterLimit();it.lineCap=nt.getLineCap()||tl.mb,it.lineDash=q?q.slice():tl.X9,it.lineDashOffset=void 0===Y?tl.He:Y,it.lineJoin=nt.getLineJoin()||tl.rc,it.lineWidth=void 0===H?tl.yC:H,it.miterLimit=void 0===et?tl.V4:et,it.strokeStyle=(0,Jh.y)(nt.getColor()||tl.Tx)}else it=null,this.textStrokeState_=it;H=this.textState_;const st=q.getFont()||tl.Df;(0,tl.Qx)(st);const ot=q.getScaleArray();H.overflow=q.getOverflow(),H.font=st,H.maxAngle=q.getMaxAngle(),H.placement=q.getPlacement(),H.textAlign=q.getTextAlign(),H.justify=q.getJustify(),H.textBaseline=q.getTextBaseline()||tl.ru,H.backgroundFill=q.getBackgroundFill(),H.backgroundStroke=q.getBackgroundStroke(),H.padding=q.getPadding()||tl.oB,H.scale=void 0===ot?[1,1]:ot;const lt=q.getOffsetX(),mt=q.getOffsetY(),_t=q.getRotateWithView(),vt=q.getRotation();this.text_=q.getText()||"",this.textOffsetX_=void 0===lt?0:lt,this.textOffsetY_=void 0===mt?0:mt,this.textRotateWithView_=void 0!==_t&&_t,this.textRotation_=void 0===vt?0:vt,this.strokeKey_=it?("string"==typeof it.strokeStyle?it.strokeStyle:(0,mn.sq)(it.strokeStyle))+it.lineCap+it.lineDashOffset+"|"+it.lineWidth+it.lineJoin+it.miterLimit+"["+it.lineDash.join()+"]":"",this.textKey_=H.font+H.scale+(H.textAlign||"?")+(H.justify||"?")+(H.textBaseline||"?"),this.fillKey_=et?"string"==typeof et.fillStyle?et.fillStyle:"|"+(0,mn.sq)(et.fillStyle):""}else this.text_="";this.declutterImageWithText_=Y}}},ol=class{constructor(q,Y,H,et){this.tolerance_=q,this.maxExtent_=Y,this.pixelRatio_=et,this.resolution_=H,this.buildersByZIndex_={}}finish(){const q={};for(const Y in this.buildersByZIndex_){q[Y]=q[Y]||{};const H=this.buildersByZIndex_[Y];for(const et in H){const it=H[et].finish();q[Y][et]=it}}return q}getBuilder(q,Y){const H=void 0!==q?q.toString():"0";let et=this.buildersByZIndex_[H];void 0===et&&(et={},this.buildersByZIndex_[H]=et);let it=et[Y];return void 0===it&&(it=new(0,sl[Y])(this.tolerance_,this.maxExtent_,this.resolution_,this.pixelRatio_),et[Y]=it),it}};var al=i(6442);function qh(q,Y,H,et,it,nt,st,ot,lt,mt,_t,vt){let bt=q[Y],Mt=q[Y+1],Et=0,Rt=0,It=0,Pt=0;function _(){Et=bt,Rt=Mt,bt=q[Y+=et],Mt=q[Y+1],Pt+=It,It=Math.sqrt((bt-Et)*(bt-Et)+(Mt-Rt)*(Mt-Rt))}do{_()}while(Y<H-et&&Pt+It<nt);let Tt=0===It?0:(nt-Pt)/It;const Ft=(0,_n.t7)(Et,bt,Tt),At=(0,_n.t7)(Rt,Mt,Tt),Lt=Y-et,Nt=Pt,kt=nt+ot*lt(mt,it,_t);for(;Y<H-et&&Pt+It<kt;)_();Tt=0===It?0:(kt-Pt)/It;const Gt=(0,_n.t7)(Et,bt,Tt),jt=(0,_n.t7)(Rt,Mt,Tt);let Dt;if(vt){const q=[Ft,At,Gt,jt];(0,al.U1)(q,0,4,2,vt,q,q),Dt=q[0]>q[2]}else Dt=Ft>Gt;const zt=Math.PI,Bt=[],Ut=Lt+et===Y;let qt;if(It=0,Pt=Nt,bt=q[Y=Lt],Mt=q[Y+1],Ut){_(),qt=Math.atan2(Mt-Rt,bt-Et),Dt&&(qt+=qt>0?-zt:zt);const q=(Gt+Ft)/2,Y=(jt+At)/2;return Bt[0]=[q,Y,(kt-nt)/2,qt,it],Bt}for(let q=0,vt=(it=it.replace(/\n/g," ")).length;q<vt;){_();let Ft=Math.atan2(Mt-Rt,bt-Et);if(Dt&&(Ft+=Ft>0?-zt:zt),void 0!==qt){let q=Ft-qt;if(q+=q>zt?-2*zt:q<-zt?2*zt:0,Math.abs(q)>st)return null}qt=Ft;const At=q;let Lt=0;for(;q<vt;++q){const st=ot*lt(mt,it[Dt?vt-q-1:q],_t);if(Y+et<H&&Pt+It<nt+Lt+st/2)break;Lt+=st}if(q===At)continue;const Nt=Dt?it.substring(vt-At,vt-q):it.substring(At,q);Tt=0===It?0:(nt+Lt/2-Pt)/It;const kt=(0,_n.t7)(Et,bt,Tt),Gt=(0,_n.t7)(Rt,Mt,Tt);Bt.push([kt,Gt,Lt/2,Ft,Nt]),nt+=Lt}return Bt}const hl=(0,Xt.lJ)(),ll=[],ul=[],cl=[],dl=[];function Hh(q){return q[3].declutterBox}const gl=new RegExp("["+String.fromCharCode(1425)+"-"+String.fromCharCode(2303)+String.fromCharCode(64285)+"-"+String.fromCharCode(65023)+String.fromCharCode(65136)+"-"+String.fromCharCode(65276)+String.fromCharCode(67584)+"-"+String.fromCharCode(69631)+String.fromCharCode(124928)+"-"+String.fromCharCode(126975)+"]");function Qh(q,Y){return"start"!==Y&&"end"!==Y||gl.test(q)||(Y="start"===Y?"left":"right"),nl[Y]}function $h(q,Y,H){return H>0&&q.push("\n",""),q.push(Y,""),q}const pl=class{constructor(q,Y,H,et){this.overlaps=H,this.pixelRatio=Y,this.resolution=q,this.alignFill_,this.instructions=et.instructions,this.coordinates=et.coordinates,this.coordinateCache_={},this.renderedTransform_=(0,Gn.Ue)(),this.hitDetectionInstructions=et.hitDetectionInstructions,this.pixelCoordinates_=null,this.viewRotation_=0,this.fillStates=et.fillStates||{},this.strokeStates=et.strokeStates||{},this.textStates=et.textStates||{},this.widths_={},this.labels_={}}createLabel(q,Y,H,et){const it=q+Y+H+et;if(this.labels_[it])return this.labels_[it];const nt=et?this.strokeStates[et]:null,st=H?this.fillStates[H]:null,ot=this.textStates[Y],lt=this.pixelRatio,mt=[ot.scale[0]*lt,ot.scale[1]*lt],_t=Array.isArray(q),vt=ot.justify?nl[ot.justify]:Qh(Array.isArray(q)?q[0]:q,ot.textAlign||tl.PH),bt=et&&nt.lineWidth?nt.lineWidth:0,Mt=_t?q:q.split("\n").reduce($h,[]),{width:Et,height:Rt,widths:It,heights:Pt,lineWidths:Tt}=(0,tl.Zw)(ot,Mt),Ft=Et+bt,At=[],Lt=(Ft+2)*mt[0],Nt=(Rt+bt)*mt[1],kt={width:Lt<0?Math.floor(Lt):Math.ceil(Lt),height:Nt<0?Math.floor(Nt):Math.ceil(Nt),contextInstructions:At};1==mt[0]&&1==mt[1]||At.push("scale",mt),et&&(At.push("strokeStyle",nt.strokeStyle),At.push("lineWidth",bt),At.push("lineCap",nt.lineCap),At.push("lineJoin",nt.lineJoin),At.push("miterLimit",nt.miterLimit),At.push("setLineDash",[nt.lineDash]),At.push("lineDashOffset",nt.lineDashOffset)),H&&At.push("fillStyle",st.fillStyle),At.push("textBaseline","middle"),At.push("textAlign","center");const Gt=.5-vt;let jt=vt*Ft+Gt*bt;const Dt=[],zt=[];let Bt,Ut=0,qt=0,Wt=0,Yt=0;for(let q=0,Y=Mt.length;q<Y;q+=2){const Y=Mt[q];if("\n"===Y){qt+=Ut,Ut=0,jt=vt*Ft+Gt*bt,++Yt;continue}const it=Mt[q+1]||ot.font;it!==Bt&&(et&&Dt.push("font",it),H&&zt.push("font",it),Bt=it),Ut=Math.max(Ut,Pt[Wt]);const nt=[Y,jt+Gt*It[Wt]+vt*(It[Wt]-Tt[Yt]),.5*(bt+Ut)+qt];jt+=It[Wt],et&&Dt.push("strokeText",nt),H&&zt.push("fillText",nt),++Wt}return Array.prototype.push.apply(At,Dt),Array.prototype.push.apply(At,zt),this.labels_[it]=kt,kt}replayTextBackground_(q,Y,H,et,it,nt,st){q.beginPath(),q.moveTo.apply(q,Y),q.lineTo.apply(q,H),q.lineTo.apply(q,et),q.lineTo.apply(q,it),q.lineTo.apply(q,Y),nt&&(this.alignFill_=nt[2],this.fill_(q)),st&&(this.setStrokeStyle_(q,st),q.stroke())}calculateImageOrLabelDimensions_(q,Y,H,et,it,nt,st,ot,lt,mt,_t,vt,bt,Mt,Et,Rt){let It=H-(st*=vt[0]),Pt=et-(ot*=vt[1]);const Tt=it+lt>q?q-lt:it,Ft=nt+mt>Y?Y-mt:nt,At=Mt[3]+Tt*vt[0]+Mt[1],Lt=Mt[0]+Ft*vt[1]+Mt[2],Nt=It-Mt[3],kt=Pt-Mt[0];let Gt;return(Et||0!==_t)&&(ll[0]=Nt,dl[0]=Nt,ll[1]=kt,ul[1]=kt,ul[0]=Nt+At,cl[0]=ul[0],cl[1]=kt+Lt,dl[1]=cl[1]),0!==_t?(Gt=(0,Gn.qC)((0,Gn.Ue)(),H,et,1,1,_t,-H,-et),(0,Gn.nn)(Gt,ll),(0,Gn.nn)(Gt,ul),(0,Gn.nn)(Gt,cl),(0,Gn.nn)(Gt,dl),(0,Xt.T9)(Math.min(ll[0],ul[0],cl[0],dl[0]),Math.min(ll[1],ul[1],cl[1],dl[1]),Math.max(ll[0],ul[0],cl[0],dl[0]),Math.max(ll[1],ul[1],cl[1],dl[1]),hl)):(0,Xt.T9)(Math.min(Nt,Nt+At),Math.min(kt,kt+Lt),Math.max(Nt,Nt+At),Math.max(kt,kt+Lt),hl),bt&&(It=Math.round(It),Pt=Math.round(Pt)),{drawImageX:It,drawImageY:Pt,drawImageW:Tt,drawImageH:Ft,originX:lt,originY:mt,declutterBox:{minX:hl[0],minY:hl[1],maxX:hl[2],maxY:hl[3],value:Rt},canvasTransform:Gt,scale:vt}}replayImageOrLabel_(q,Y,H,et,it,nt,st){const ot=!(!nt&&!st),lt=et.declutterBox,mt=q.canvas,_t=st?st[2]*et.scale[0]/2:0;return lt.minX-_t<=mt.width/Y&&lt.maxX+_t>=0&&lt.minY-_t<=mt.height/Y&&lt.maxY+_t>=0&&(ot&&this.replayTextBackground_(q,ll,ul,cl,dl,nt,st),(0,tl._f)(q,et.canvasTransform,it,H,et.originX,et.originY,et.drawImageW,et.drawImageH,et.drawImageX,et.drawImageY,et.scale)),!0}fill_(q){if(this.alignFill_){const Y=(0,Gn.nn)(this.renderedTransform_,[0,0]),H=512*this.pixelRatio;q.save(),q.translate(Y[0]%H,Y[1]%H),q.rotate(this.viewRotation_)}q.fill(),this.alignFill_&&q.restore()}setStrokeStyle_(q,Y){q.strokeStyle=Y[1],q.lineWidth=Y[2],q.lineCap=Y[3],q.lineJoin=Y[4],q.miterLimit=Y[5],q.lineDashOffset=Y[7],q.setLineDash(Y[6])}drawLabelWithPointPlacement_(q,Y,H,et){const it=this.textStates[Y],nt=this.createLabel(q,Y,et,H),st=this.strokeStates[H],ot=this.pixelRatio,lt=Qh(Array.isArray(q)?q[0]:q,it.textAlign||tl.PH),mt=nl[it.textBaseline||tl.ru],_t=st&&st.lineWidth?st.lineWidth:0;return{label:nt,anchorX:lt*(nt.width/ot-2*it.scale[0])+2*(.5-lt)*_t,anchorY:mt*nt.height/ot+2*(.5-mt)*_t}}execute_(q,Y,H,et,it,nt,st,ot){let lt;this.pixelCoordinates_&&(0,Dn.fS)(H,this.renderedTransform_)?lt=this.pixelCoordinates_:(this.pixelCoordinates_||(this.pixelCoordinates_=[]),lt=(0,al.vT)(this.coordinates,0,this.coordinates.length,2,H,this.pixelCoordinates_),(0,Gn.lk)(this.renderedTransform_,H));let mt=0;const _t=et.length;let vt,bt,Mt,Et,Rt,It,Pt,Tt,Ft,At,Lt,Nt,kt=0,Gt=0,jt=0,Dt=null,zt=null;const Bt=this.coordinateCache_,Ut=this.viewRotation_,qt=Math.round(1e12*Math.atan2(-H[1],H[0]))/1e12,Wt={context:q,pixelRatio:this.pixelRatio,resolution:this.resolution,rotation:Ut},Yt=this.instructions!=et||this.overlaps?0:200;let Zt,Vt,Kt,Ht;for(;mt<_t;){const H=et[mt];switch(H[0]){case Xh.BEGIN_GEOMETRY:Zt=H[1],Ht=H[3],Zt.getGeometry()?void 0===st||(0,Xt.kK)(st,Ht.getExtent())?++mt:mt=H[2]+1:mt=H[2];break;case Xh.BEGIN_PATH:Gt>Yt&&(this.fill_(q),Gt=0),jt>Yt&&(q.stroke(),jt=0),Gt||jt||(q.beginPath(),Et=NaN,Rt=NaN),++mt;break;case Xh.CIRCLE:kt=H[1];const et=lt[kt],_t=lt[kt+1],$t=lt[kt+2]-et,te=lt[kt+3]-_t,ee=Math.sqrt($t*$t+te*te);q.moveTo(et+ee,_t),q.arc(et,_t,ee,0,2*Math.PI,!0),++mt;break;case Xh.CLOSE_PATH:q.closePath(),++mt;break;case Xh.CUSTOM:kt=H[1],vt=H[2];const ie=H[3],ne=H[4],ue=6==H.length?H[5]:void 0;Wt.geometry=ie,Wt.feature=Zt,mt in Bt||(Bt[mt]=[]);const ce=Bt[mt];ue?ue(lt,kt,vt,2,ce):(ce[0]=lt[kt],ce[1]=lt[kt+1],ce.length=2),ne(ce,Wt),++mt;break;case Xh.DRAW_IMAGE:kt=H[1],vt=H[2],Tt=H[3],bt=H[4],Mt=H[5];let de=H[6];const xe=H[7],Se=H[8],be=H[9],we=H[10];let Ce=H[11];const Ee=H[12];let Re=H[13];const Oe=H[14],ke=H[15];if(!Tt&&H.length>=20){Ft=H[19],At=H[20],Lt=H[21],Nt=H[22];const q=this.drawLabelWithPointPlacement_(Ft,At,Lt,Nt);Tt=q.label,H[3]=Tt;const Y=H[23];bt=(q.anchorX-Y)*this.pixelRatio,H[4]=bt;const et=H[24];Mt=(q.anchorY-et)*this.pixelRatio,H[5]=Mt,de=Tt.height,H[6]=de,Re=Tt.width,H[13]=Re}let Xe,Je,Qe,$e;H.length>25&&(Xe=H[25]),H.length>17?(Je=H[16],Qe=H[17],$e=H[18]):(Je=tl.oB,Qe=!1,$e=!1),we&&qt?Ce+=Ut:we||qt||(Ce-=Ut);let ti=0;for(;kt<vt;kt+=2){if(Xe&&Xe[ti++]<Re/this.pixelRatio)continue;const H=this.calculateImageOrLabelDimensions_(Tt.width,Tt.height,lt[kt],lt[kt+1],Re,de,bt,Mt,Se,be,Ce,Ee,it,Je,Qe||$e,Zt),et=[q,Y,Tt,H,xe,Qe?Dt:null,$e?zt:null];if(ot){if("none"===Oe)continue;if("obstacle"===Oe){ot.insert(H.declutterBox);continue}{let q,Y;if(ke){const H=vt-kt;if(!ke[H]){ke[H]=et;continue}if(q=ke[H],delete ke[H],Y=Hh(q),ot.collides(Y))continue}if(ot.collides(H.declutterBox))continue;q&&(ot.insert(Y),this.replayImageOrLabel_.apply(this,q)),ot.insert(H.declutterBox)}}this.replayImageOrLabel_.apply(this,et)}++mt;break;case Xh.DRAW_CHARS:const ei=H[1],ii=H[2],di=H[3],gi=H[4];Nt=H[5];const fi=H[6],pi=H[7],vi=H[8];Lt=H[9];const wi=H[10];Ft=H[11],At=H[12];const Ci=[H[13],H[13]],Ri=this.textStates[At],Oi=Ri.font,Ii=[Ri.scale[0]*pi,Ri.scale[1]*pi];let Pi;Oi in this.widths_?Pi=this.widths_[Oi]:(Pi={},this.widths_[Oi]=Pi);const Ti=Fs(lt,ei,ii,2),Fi=Math.abs(Ii[0])*(0,tl.Kd)(Oi,Ft,Pi);if(gi||Fi<=Ti){const H=this.textStates[At].textAlign,et=qh(lt,ei,ii,2,Ft,(Ti-Fi)*nl[H],fi,Math.abs(Ii[0]),tl.Kd,Oi,Pi,qt?0:this.viewRotation_);t:if(et){const H=[];let it,nt,st,lt,mt;if(Lt)for(it=0,nt=et.length;it<nt;++it){mt=et[it],st=mt[4],lt=this.createLabel(st,At,"",Lt),bt=mt[2]+(Ii[0]<0?-wi:wi),Mt=di*lt.height+2*(.5-di)*wi*Ii[1]/Ii[0]-vi;const nt=this.calculateImageOrLabelDimensions_(lt.width,lt.height,mt[0],mt[1],lt.width,lt.height,bt,Mt,0,0,mt[3],Ci,!1,tl.oB,!1,Zt);if(ot&&ot.collides(nt.declutterBox))break t;H.push([q,Y,lt,nt,1,null,null])}if(Nt)for(it=0,nt=et.length;it<nt;++it){mt=et[it],st=mt[4],lt=this.createLabel(st,At,Nt,""),bt=mt[2],Mt=di*lt.height-vi;const nt=this.calculateImageOrLabelDimensions_(lt.width,lt.height,mt[0],mt[1],lt.width,lt.height,bt,Mt,0,0,mt[3],Ci,!1,tl.oB,!1,Zt);if(ot&&ot.collides(nt.declutterBox))break t;H.push([q,Y,lt,nt,1,null,null])}ot&&ot.load(H.map(Hh));for(let q=0,Y=H.length;q<Y;++q)this.replayImageOrLabel_.apply(this,H[q])}}++mt;break;case Xh.END_GEOMETRY:if(void 0!==nt){Zt=H[1];const q=nt(Zt,Ht);if(q)return q}++mt;break;case Xh.FILL:Yt?Gt++:this.fill_(q),++mt;break;case Xh.MOVE_TO_LINE_TO:for(kt=H[1],vt=H[2],Vt=lt[kt],Kt=lt[kt+1],It=Vt+.5|0,Pt=Kt+.5|0,It===Et&&Pt===Rt||(q.moveTo(Vt,Kt),Et=It,Rt=Pt),kt+=2;kt<vt;kt+=2)Vt=lt[kt],Kt=lt[kt+1],It=Vt+.5|0,Pt=Kt+.5|0,kt!=vt-2&&It===Et&&Pt===Rt||(q.lineTo(Vt,Kt),Et=It,Rt=Pt);++mt;break;case Xh.SET_FILL_STYLE:Dt=H,this.alignFill_=H[2],Gt&&(this.fill_(q),Gt=0,jt&&(q.stroke(),jt=0)),q.fillStyle=H[1],++mt;break;case Xh.SET_STROKE_STYLE:zt=H,jt&&(q.stroke(),jt=0),this.setStrokeStyle_(q,H),++mt;break;case Xh.STROKE:Yt?jt++:q.stroke(),++mt;break;default:++mt}}Gt&&this.fill_(q),jt&&q.stroke()}execute(q,Y,H,et,it,nt){this.viewRotation_=et,this.execute_(q,Y,H,this.instructions,it,void 0,void 0,nt)}executeHitDetection(q,Y,H,et,it){return this.viewRotation_=H,this.execute_(q,1,Y,this.hitDetectionInstructions,!0,et,it)}},ml=["Polygon","Circle","LineString","Image","Text","Default"],yl={},_l=class{constructor(q,Y,H,et,it,nt){this.maxExtent_=q,this.overlaps_=et,this.pixelRatio_=H,this.resolution_=Y,this.renderBuffer_=nt,this.executorsByZIndex_={},this.hitDetectionContext_=null,this.hitDetectionTransform_=(0,Gn.Ue)(),this.createExecutors_(it)}clip(q,Y){const H=this.getClipCoords(Y);q.beginPath(),q.moveTo(H[0],H[1]),q.lineTo(H[2],H[3]),q.lineTo(H[4],H[5]),q.lineTo(H[6],H[7]),q.clip()}createExecutors_(q){for(const Y in q){let H=this.executorsByZIndex_[Y];void 0===H&&(H={},this.executorsByZIndex_[Y]=H);const et=q[Y];for(const q in et){const Y=et[q];H[q]=new pl(this.resolution_,this.pixelRatio_,this.overlaps_,Y)}}}hasExecutors(q){for(const Y in this.executorsByZIndex_){const H=this.executorsByZIndex_[Y];for(let Y=0,et=q.length;Y<et;++Y)if(q[Y]in H)return!0}return!1}forEachFeatureAtCoordinate(q,Y,H,et,it,nt){const st=2*(et=Math.round(et))+1,ot=(0,Gn.qC)(this.hitDetectionTransform_,et+.5,et+.5,1/Y,-1/Y,-H,-q[0],-q[1]),lt=!this.hitDetectionContext_;lt&&(this.hitDetectionContext_=(0,At.E4)(st,st,void 0,{willReadFrequently:!0}));const mt=this.hitDetectionContext_;let _t;mt.canvas.width!==st||mt.canvas.height!==st?(mt.canvas.width=st,mt.canvas.height=st):lt||mt.clearRect(0,0,st,st),void 0!==this.renderBuffer_&&(_t=(0,Xt.lJ)(),(0,Xt.Wj)(_t,q),(0,Xt.f3)(_t,Y*(this.renderBuffer_+et),_t));const vt=function(q){if(void 0!==yl[q])return yl[q];const Y=2*q+1,H=q*q,et=new Array(H+1);for(let it=0;it<=q;++it)for(let nt=0;nt<=q;++nt){const st=it*it+nt*nt;if(st>H)break;let ot=et[st];ot||(ot=[],et[st]=ot),ot.push(4*((q+it)*Y+(q+nt))+3),it>0&&ot.push(4*((q-it)*Y+(q+nt))+3),nt>0&&(ot.push(4*((q+it)*Y+(q-nt))+3),it>0&&ot.push(4*((q-it)*Y+(q-nt))+3))}const it=[];for(let q=0,Y=et.length;q<Y;++q)et[q]&&it.push(...et[q]);return yl[q]=it,it}(et);let bt;function f(q,Y){const H=mt.getImageData(0,0,st,st).data;for(let ot=0,lt=vt.length;ot<lt;ot++)if(H[vt[ot]]>0){if(!nt||"Image"!==bt&&"Text"!==bt||nt.includes(q)){const H=(vt[ot]-3)/4,nt=et-H%st,lt=et-(H/st|0),mt=it(q,Y,nt*nt+lt*lt);if(mt)return mt}mt.clearRect(0,0,st,st);break}}const Mt=Object.keys(this.executorsByZIndex_).map(Number);let Et,Rt,It,Pt,Tt;for(Mt.sort(Dn.j2),Et=Mt.length-1;Et>=0;--Et){const q=Mt[Et].toString();for(It=this.executorsByZIndex_[q],Rt=ml.length-1;Rt>=0;--Rt)if(bt=ml[Rt],Pt=It[bt],void 0!==Pt&&(Tt=Pt.executeHitDetection(mt,ot,H,f,_t),Tt))return Tt}}getClipCoords(q){const Y=this.maxExtent_;if(!Y)return null;const H=Y[0],et=Y[1],it=Y[2],nt=Y[3],st=[H,et,H,nt,it,nt,it,et];return(0,al.vT)(st,0,8,2,q,st),st}isEmpty(){return(0,nh.x)(this.executorsByZIndex_)}execute(q,Y,H,et,it,nt,st){const ot=Object.keys(this.executorsByZIndex_).map(Number);let lt,mt,_t,vt,bt,Mt;for(ot.sort(Dn.j2),this.maxExtent_&&(q.save(),this.clip(q,H)),nt=nt||ml,st&&ot.reverse(),lt=0,mt=ot.length;lt<mt;++lt){const mt=ot[lt].toString();for(bt=this.executorsByZIndex_[mt],_t=0,vt=nt.length;_t<vt;++_t)Mt=bt[nt[_t]],void 0!==Mt&&Mt.execute(q,Y,H,et,it,st)}this.maxExtent_&&q.restore()}};var xl=i(5069);const Sl=.5;var Ml=i(6234),wl=i(1900);const El=class extends Un{constructor(q){super(q),this.boundHandleStyleImageChange_=this.handleStyleImageChange_.bind(this),this.animatingOrInteracting_,this.hitDetectionImageData_=null,this.renderedFeatures_=null,this.renderedRevision_=-1,this.renderedResolution_=NaN,this.renderedExtent_=(0,Xt.lJ)(),this.wrappedRenderedExtent_=(0,Xt.lJ)(),this.renderedRotation_,this.renderedCenter_=null,this.renderedProjection_=null,this.renderedRenderOrder_=null,this.replayGroup_=null,this.replayGroupChanged=!0,this.declutterExecutorGroup=null,this.clipping=!0,this.compositionContext_=null,this.opacity_=1}renderWorlds(q,Y,H){const et=Y.extent,it=Y.viewState,nt=it.center,st=it.resolution,ot=it.projection,lt=it.rotation,mt=ot.getExtent(),_t=this.getLayer().getSource(),vt=Y.pixelRatio,bt=Y.viewHints,Mt=!(bt[0]||bt[1]),Et=this.compositionContext_,Rt=Math.round(Y.size[0]*vt),It=Math.round(Y.size[1]*vt),Pt=_t.getWrapX()&&ot.canWrapX(),Tt=Pt?(0,Xt.dz)(mt):null,Ft=Pt?Math.ceil((et[2]-mt[2])/Tt)+1:1;let At=Pt?Math.floor((et[0]-mt[0])/Tt):0;do{const Y=this.getRenderTransform(nt,st,lt,vt,Rt,It,At*Tt);q.execute(Et,1,Y,lt,Mt,void 0,H)}while(++At<Ft)}setupCompositionContext_(){if(1!==this.opacity_){const q=(0,At.E4)(this.context.canvas.width,this.context.canvas.height,zn);this.compositionContext_=q}else this.compositionContext_=this.context}releaseCompositionContext_(){if(1!==this.opacity_){const q=this.context.globalAlpha;this.context.globalAlpha=this.opacity_,this.context.drawImage(this.compositionContext_.canvas,0,0),this.context.globalAlpha=q,(0,At.jy)(this.compositionContext_),zn.push(this.compositionContext_.canvas),this.compositionContext_=null}}renderDeclutter(q){this.declutterExecutorGroup&&(this.setupCompositionContext_(),this.renderWorlds(this.declutterExecutorGroup,q,q.declutterTree),this.releaseCompositionContext_())}renderFrame(q,Y){const H=q.pixelRatio,et=q.layerStatesArray[q.layerIndex];(0,Gn.n3)(this.pixelTransform,1/H,1/H),(0,Gn.nb)(this.inversePixelTransform,this.pixelTransform);const it=(0,Gn.BB)(this.pixelTransform);this.useContainer(Y,it,this.getBackground(q));const nt=this.context,st=nt.canvas,ot=this.replayGroup_,lt=this.declutterExecutorGroup;if((!ot||ot.isEmpty())&&(!lt||lt.isEmpty()))return null;const mt=Math.round(q.size[0]*H),_t=Math.round(q.size[1]*H);st.width!=mt||st.height!=_t?(st.width=mt,st.height=_t,st.style.transform!==it&&(st.style.transform=it)):this.containerReused||nt.clearRect(0,0,mt,_t),this.preRender(nt,q);const vt=q.viewState,bt=vt.projection;this.opacity_=et.opacity,this.setupCompositionContext_();let Mt=!1,Et=!0;if(et.extent&&this.clipping){const Y=(0,Vt.dY)(et.extent,bt);Et=(0,Xt.kK)(Y,q.extent),Mt=Et&&!(0,Xt.r4)(Y,q.extent),Mt&&this.clipUnrotated(this.compositionContext_,q,Y)}return Et&&this.renderWorlds(ot,q),Mt&&this.compositionContext_.restore(),this.releaseCompositionContext_(),this.postRender(nt,q),this.renderedRotation_!==vt.rotation&&(this.renderedRotation_=vt.rotation,this.hitDetectionImageData_=null),this.container}getFeatures(q){return new Promise((Y=>{if(!this.hitDetectionImageData_&&!this.animatingOrInteracting_){const q=[this.context.canvas.width,this.context.canvas.height];(0,Gn.nn)(this.pixelTransform,q);const Y=this.renderedCenter_,H=this.renderedResolution_,et=this.renderedRotation_,it=this.renderedProjection_,nt=this.wrappedRenderedExtent_,st=this.getLayer(),ot=[],lt=q[0]*Sl,mt=q[1]*Sl;ot.push(this.getRenderTransform(Y,H,et,Sl,lt,mt,0).slice());const _t=st.getSource(),vt=it.getExtent();if(_t.getWrapX()&&it.canWrapX()&&!(0,Xt.r4)(vt,nt)){let q=nt[0];const it=(0,Xt.dz)(vt);let st,_t=0;for(;q<vt[0];)--_t,st=it*_t,ot.push(this.getRenderTransform(Y,H,et,Sl,lt,mt,st).slice()),q+=it;for(_t=0,q=nt[2];q>vt[2];)++_t,st=it*_t,ot.push(this.getRenderTransform(Y,H,et,Sl,lt,mt,st).slice()),q-=it}this.hitDetectionImageData_=function(q,Y,H,et,it,nt,st){const ot=q[0]*Sl,lt=q[1]*Sl,mt=(0,At.E4)(ot,lt);mt.imageSmoothingEnabled=!1;const _t=mt.canvas,vt=new xl.Z(mt,Sl,it,null,st),bt=H.length,Mt=Math.floor(16777215/bt),Et={};for(let q=1;q<=bt;++q){const Y=H[q-1],st=Y.getStyleFunction()||et;if(!et)continue;let ot=st(Y,nt);if(!ot)continue;Array.isArray(ot)||(ot=[ot]);const lt=(q*Mt).toString(16).padStart(7,"#00000");for(let q=0,H=ot.length;q<H;++q){const H=ot[q],et=H.getGeometryFunction()(Y);if(!et||!(0,Xt.kK)(it,et.getExtent()))continue;const nt=H.clone(),st=nt.getFill();st&&st.setColor(lt);const mt=nt.getStroke();mt&&(mt.setColor(lt),mt.setLineDash(null)),nt.setText(void 0);const _t=H.getImage();if(_t&&0!==_t.getOpacity()){const q=_t.getImageSize();if(!q)continue;const Y=(0,At.E4)(q[0],q[1],void 0,{alpha:!1}),H=Y.canvas;Y.fillStyle=lt,Y.fillRect(0,0,H.width,H.height),nt.setImage(new Lh.default({img:H,imgSize:q,anchor:_t.getAnchor(),anchorXUnits:"pixels",anchorYUnits:"pixels",offset:_t.getOrigin(),opacity:1,size:_t.getSize(),scale:_t.getScale(),rotation:_t.getRotation(),rotateWithView:_t.getRotateWithView()}))}const vt=nt.getZIndex()||0;let bt=Et[vt];bt||(bt={},Et[vt]=bt,bt.Polygon=[],bt.Circle=[],bt.LineString=[],bt.Point=[]);const Mt=et.getType();if("GeometryCollection"===Mt){const q=et.getGeometriesArrayRecursive();for(let Y=0,H=q.length;Y<H;++Y){const H=q[Y];bt[H.getType().replace("Multi","")].push(H,nt)}}else bt[Mt.replace("Multi","")].push(et,nt)}}const Rt=Object.keys(Et).map(Number).sort(Dn.j2);for(let q=0,H=Rt.length;q<H;++q){const H=Et[Rt[q]];for(const q in H){const et=H[q];for(let q=0,H=et.length;q<H;q+=2){vt.setStyle(et[q+1]);for(let H=0,it=Y.length;H<it;++H)vt.setTransform(Y[H]),vt.drawGeometry(et[q])}}}return mt.getImageData(0,0,_t.width,_t.height)}(q,ot,this.renderedFeatures_,st.getStyleFunction(),nt,H,et)}Y(function(q,Y,H){const et=[];if(H){const it=Math.floor(Math.round(q[0])*Sl),nt=Math.floor(Math.round(q[1])*Sl),st=4*((0,_n.uZ)(it,0,H.width-1)+(0,_n.uZ)(nt,0,H.height-1)*H.width),ot=H.data[st],lt=H.data[st+1],mt=H.data[st+2]+256*(lt+256*ot),_t=Math.floor(16777215/Y.length);mt&&mt%_t==0&&et.push(Y[mt/_t-1])}return et}(q,this.renderedFeatures_,this.hitDetectionImageData_))}))}forEachFeatureAtCoordinate(q,Y,H,et,it){if(!this.replayGroup_)return;const nt=Y.viewState.resolution,st=Y.viewState.rotation,ot=this.getLayer(),lt={},l=function(q,Y,H){const nt=(0,mn.sq)(q),st=lt[nt];if(st){if(!0!==st&&H<st.distanceSq){if(0===H)return lt[nt]=!0,it.splice(it.lastIndexOf(st),1),et(q,ot,Y);st.geometry=Y,st.distanceSq=H}}else{if(0===H)return lt[nt]=!0,et(q,ot,Y);it.push(lt[nt]={feature:q,layer:ot,geometry:Y,distanceSq:H,callback:et})}};let mt;const _t=[this.replayGroup_];return this.declutterExecutorGroup&&_t.push(this.declutterExecutorGroup),_t.some((et=>mt=et.forEachFeatureAtCoordinate(q,nt,st,H,l,et===this.declutterExecutorGroup&&Y.declutterTree?Y.declutterTree.all().map((q=>q.value)):null))),mt}handleFontsChanged(){const q=this.getLayer();q.getVisible()&&this.replayGroup_&&q.changed()}handleStyleImageChange_(q){this.renderIfReadyAndVisible()}prepareFrame(q){const Y=this.getLayer(),H=Y.getSource();if(!H)return!1;const et=q.viewHints[0],it=q.viewHints[1],nt=Y.getUpdateWhileAnimating(),st=Y.getUpdateWhileInteracting();if(this.ready&&!nt&&et||!st&&it)return this.animatingOrInteracting_=!0,!0;this.animatingOrInteracting_=!1;const ot=q.extent,lt=q.viewState,mt=lt.projection,_t=lt.resolution,vt=q.pixelRatio,bt=Y.getRevision(),Mt=Y.getRenderBuffer();let Et=Y.getRenderOrder();void 0===Et&&(Et=Ml.eR);const Rt=lt.center.slice(),It=(0,Xt.f3)(ot,Mt*_t),Pt=It.slice(),Tt=[It.slice()],Ft=mt.getExtent();if(H.getWrapX()&&mt.canWrapX()&&!(0,Xt.r4)(Ft,q.extent)){const q=(0,Xt.dz)(Ft),Y=Math.max((0,Xt.dz)(It)/2,q);It[0]=Ft[0]-Y,It[2]=Ft[2]+Y,(0,wl.Cf)(Rt,mt);const H=(0,Xt.Cf)(Tt[0],mt);H[0]<Ft[0]&&H[2]<Ft[2]?Tt.push([H[0]+q,H[1],H[2]+q,H[3]]):H[0]>Ft[0]&&H[2]>Ft[2]&&Tt.push([H[0]-q,H[1],H[2]-q,H[3]])}if(this.ready&&this.renderedResolution_==_t&&this.renderedRevision_==bt&&this.renderedRenderOrder_==Et&&(0,Xt.r4)(this.wrappedRenderedExtent_,It))return(0,Dn.fS)(this.renderedExtent_,Pt)||(this.hitDetectionImageData_=null,this.renderedExtent_=Pt),this.renderedCenter_=Rt,this.replayGroupChanged=!1,!0;this.replayGroup_=null;const At=new ol((0,Ml.Qz)(_t,vt),It,_t,vt);let Lt;this.getLayer().getDeclutter()&&(Lt=new ol((0,Ml.Qz)(_t,vt),It,_t,vt));const Nt=(0,Vt.Cs)();let kt;if(Nt){for(let q=0,Y=Tt.length;q<Y;++q){const Y=Tt[q],et=(0,Vt.Fj)(Y,mt);H.loadFeatures(et,(0,Vt.on)(_t,mt),Nt)}kt=(0,Vt.WO)(Nt,mt)}else for(let q=0,Y=Tt.length;q<Y;++q)H.loadFeatures(Tt[q],_t,mt);const Gt=(0,Ml.se)(_t,vt);let jt=!0;const E=q=>{let H;const et=q.getStyleFunction()||Y.getStyleFunction();if(et&&(H=et(q,_t)),H){const Y=this.renderFeature(q,Gt,H,At,kt,Lt);jt=jt&&!Y}},Dt=(0,Vt.Fj)(It,mt),zt=H.getFeaturesInExtent(Dt);Et&&zt.sort(Et);for(let q=0,Y=zt.length;q<Y;++q)E(zt[q]);this.renderedFeatures_=zt,this.ready=jt;const Bt=At.finish(),Ut=new _l(It,_t,vt,H.getOverlaps(),Bt,Y.getRenderBuffer());return Lt&&(this.declutterExecutorGroup=new _l(It,_t,vt,H.getOverlaps(),Lt.finish(),Y.getRenderBuffer())),this.renderedResolution_=_t,this.renderedRevision_=bt,this.renderedRenderOrder_=Et,this.renderedExtent_=Pt,this.wrappedRenderedExtent_=It,this.renderedCenter_=Rt,this.renderedProjection_=mt,this.replayGroup_=Ut,this.hitDetectionImageData_=null,this.replayGroupChanged=!0,!0}renderFeature(q,Y,H,et,it,nt){if(!H)return!1;let st=!1;if(Array.isArray(H))for(let ot=0,lt=H.length;ot<lt;++ot)st=(0,Ml.Pn)(et,q,H[ot],Y,this.boundHandleStyleImageChange_,it,nt)||st;else st=(0,Ml.Pn)(et,q,H,Y,this.boundHandleStyleImageChange_,it,nt);return st}},Rl=class extends zh{constructor(q){super(q)}createRenderer(){return new El(this)}};var Ol=function(q){function e(Y,H){var et=q.call(this,Y,H)||this;return et.scheduler=Y,et.work=H,et.pending=!1,et}return m(e,q),e.prototype.schedule=function(q,Y){if(void 0===Y&&(Y=0),this.closed)return this;this.state=q;var H=this.id,et=this.scheduler;return null!=H&&(this.id=this.recycleAsyncId(et,H,Y)),this.pending=!0,this.delay=Y,this.id=this.id||this.requestAsyncId(et,this.id,Y),this},e.prototype.requestAsyncId=function(q,Y,H){return void 0===H&&(H=0),setInterval(q.flush.bind(q,this),H)},e.prototype.recycleAsyncId=function(q,Y,H){if(void 0===H&&(H=0),null!==H&&this.delay===H&&!1===this.pending)return Y;clearInterval(Y)},e.prototype.execute=function(q,Y){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var H=this._execute(q,Y);if(H)return H;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},e.prototype._execute=function(q,Y){var H=!1,et=void 0;try{this.work(q)}catch(q){H=!0,et=!!q&&q||new Error(q)}if(H)return this.unsubscribe(),et},e.prototype._unsubscribe=function(){var q=this.id,Y=this.scheduler,H=Y.actions,et=H.indexOf(this);this.work=null,this.state=null,this.pending=!1,this.scheduler=null,-1!==et&&H.splice(et,1),null!=q&&(this.id=this.recycleAsyncId(Y,q,null)),this.delay=null},e}(function(q){function e(Y,H){return q.call(this)||this}return m(e,q),e.prototype.schedule=function(q,Y){return void 0===Y&&(Y=0),this},e}(ot)),Tl=function(){function t(q,Y){void 0===Y&&(Y=t.now),this.SchedulerAction=q,this.now=Y}return t.prototype.schedule=function(q,Y,H){return void 0===Y&&(Y=0),new this.SchedulerAction(this,q).schedule(H,Y)},t.now=function(){return Date.now()},t}(),Fl=new(function(q){function e(Y,H){void 0===H&&(H=Tl.now);var et=q.call(this,Y,(function(){return e.delegate&&e.delegate!==et?e.delegate.now():H()}))||this;return et.actions=[],et.active=!1,et.scheduled=void 0,et}return m(e,q),e.prototype.schedule=function(Y,H,et){return void 0===H&&(H=0),e.delegate&&e.delegate!==this?e.delegate.schedule(Y,H,et):q.prototype.schedule.call(this,Y,H,et)},e.prototype.flush=function(q){var Y=this.actions;if(this.active)Y.push(q);else{var H;this.active=!0;do{if(H=q.execute(q.state,q.delay))break}while(q=Y.shift());if(this.active=!1,H){for(;q=Y.shift();)q.unsubscribe();throw H}}},e}(Tl))(Ol);function fl(q){var Y=q.subscriber,H=q.counter,et=q.period;Y.next(H),this.schedule({subscriber:Y,counter:H+1,period:et},et)}var Al=function(){function t(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}return t.prototype=Object.create(Error.prototype),t}(),Ll=function(q){function e(Y,H){var et=q.call(this)||this;return et.subject=Y,et.subscriber=H,et.closed=!1,et}return m(e,q),e.prototype.unsubscribe=function(){if(!this.closed){this.closed=!0;var q=this.subject,Y=q.observers;if(this.subject=null,Y&&0!==Y.length&&!q.isStopped&&!q.closed){var H=Y.indexOf(this.subscriber);-1!==H&&Y.splice(H,1)}}},e}(ot),kl=function(q){function e(Y){var H=q.call(this,Y)||this;return H.destination=Y,H}return m(e,q),e}(mt),Gl=function(q){function e(){var Y=q.call(this)||this;return Y.observers=[],Y.closed=!1,Y.isStopped=!1,Y.hasError=!1,Y.thrownError=null,Y}return m(e,q),e.prototype[lt]=function(){return new kl(this)},e.prototype.lift=function(q){var Y=new jl(this,this);return Y.operator=q,Y},e.prototype.next=function(q){if(this.closed)throw new Al;if(!this.isStopped)for(var Y=this.observers,H=Y.length,et=Y.slice(),it=0;it<H;it++)et[it].next(q)},e.prototype.error=function(q){if(this.closed)throw new Al;this.hasError=!0,this.thrownError=q,this.isStopped=!0;for(var Y=this.observers,H=Y.length,et=Y.slice(),it=0;it<H;it++)et[it].error(q);this.observers.length=0},e.prototype.complete=function(){if(this.closed)throw new Al;this.isStopped=!0;for(var q=this.observers,Y=q.length,H=q.slice(),et=0;et<Y;et++)H[et].complete();this.observers.length=0},e.prototype.unsubscribe=function(){this.isStopped=!0,this.closed=!0,this.observers=null},e.prototype._trySubscribe=function(Y){if(this.closed)throw new Al;return q.prototype._trySubscribe.call(this,Y)},e.prototype._subscribe=function(q){if(this.closed)throw new Al;return this.hasError?(q.error(this.thrownError),ot.EMPTY):this.isStopped?(q.complete(),ot.EMPTY):(this.observers.push(q),new Ll(this,q))},e.prototype.asObservable=function(){var q=new bt;return q.source=this,q},e.create=function(q,Y){return new jl(q,Y)},e}(bt),jl=function(q){function e(Y,H){var et=q.call(this)||this;return et.destination=Y,et.source=H,et}return m(e,q),e.prototype.next=function(q){var Y=this.destination;Y&&Y.next&&Y.next(q)},e.prototype.error=function(q){var Y=this.destination;Y&&Y.error&&this.destination.error(q)},e.prototype.complete=function(){var q=this.destination;q&&q.complete&&this.destination.complete()},e.prototype._subscribe=function(q){return this.source?this.source.subscribe(q):ot.EMPTY},e}(Gl);function vl(q,Y,H){return void 0===H&&(H=Number.POSITIVE_INFINITY),"function"==typeof Y?function(et){return et.pipe(vl((function(H,et){return St(q(H,et)).pipe(N((function(q,it){return Y(H,q,et,it)})))}),H))}:("number"==typeof Y&&(H=Y),function(Y){return Y.lift(new Dl(q,H))})}var Dl=function(){function t(q,Y){void 0===Y&&(Y=Number.POSITIVE_INFINITY),this.project=q,this.concurrent=Y}return t.prototype.call=function(q,Y){return Y.subscribe(new zl(q,this.project,this.concurrent))},t}(),zl=function(q){function e(Y,H,et){void 0===et&&(et=Number.POSITIVE_INFINITY);var it=q.call(this,Y)||this;return it.project=H,it.concurrent=et,it.hasCompleted=!1,it.buffer=[],it.active=0,it.index=0,it}return m(e,q),e.prototype._next=function(q){this.active<this.concurrent?this._tryNext(q):this.buffer.push(q)},e.prototype._tryNext=function(q){var Y,H=this.index++;try{Y=this.project(q,H)}catch(q){return void this.destination.error(q)}this.active++,this._innerSub(Y)},e.prototype._innerSub=function(q){var Y=new zt(this),H=this.destination;H.add(Y);var et=wt(q,Y);et!==Y&&H.add(et)},e.prototype._complete=function(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&this.destination.complete(),this.unsubscribe()},e.prototype.notifyNext=function(q){this.destination.next(q)},e.prototype.notifyComplete=function(){var q=this.buffer;this.active--,q.length>0?this._next(q.shift()):0===this.active&&this.hasCompleted&&this.destination.complete()},e}(Bt);function bl(q){return void 0===q&&(q=Number.POSITIVE_INFINITY),vl(T,q)}var Ul=function(q){function e(Y){var H=q.call(this)||this;return H._value=Y,H}return m(e,q),Object.defineProperty(e.prototype,"value",{get:function(){return this.getValue()},enumerable:!0,configurable:!0}),e.prototype._subscribe=function(Y){var H=q.prototype._subscribe.call(this,Y);return H&&!H.closed&&Y.next(this._value),H},e.prototype.getValue=function(){if(this.hasError)throw this.thrownError;if(this.closed)throw new Al;return this._value},e.prototype.next=function(Y){q.prototype.next.call(this,this._value=Y)},e}(Gl);function Cl(){for(var q=[],Y=0;Y<arguments.length;Y++)q[Y]=arguments[Y];return bl(1)(xt.apply(void 0,q))}var $l={leading:!0,trailing:!1},tu=function(){function t(q,Y,H,et){this.duration=q,this.scheduler=Y,this.leading=H,this.trailing=et}return t.prototype.call=function(q,Y){return Y.subscribe(new ru(q,this.duration,this.scheduler,this.leading,this.trailing))},t}(),ru=function(q){function e(Y,H,et,it,nt){var st=q.call(this,Y)||this;return st.duration=H,st.scheduler=et,st.leading=it,st.trailing=nt,st._hasTrailingValue=!1,st._trailingValue=null,st}return m(e,q),e.prototype._next=function(q){this.throttled?this.trailing&&(this._trailingValue=q,this._hasTrailingValue=!0):(this.add(this.throttled=this.scheduler.schedule(Pl,this.duration,{subscriber:this})),this.leading?this.destination.next(q):this.trailing&&(this._trailingValue=q,this._hasTrailingValue=!0))},e.prototype._complete=function(){this._hasTrailingValue?(this.destination.next(this._trailingValue),this.destination.complete()):this.destination.complete()},e.prototype.clearThrottle=function(){var q=this.throttled;q&&(this.trailing&&this._hasTrailingValue&&(this.destination.next(this._trailingValue),this._trailingValue=null,this._hasTrailingValue=!1),q.unsubscribe(),this.remove(q),this.throttled=null)},e}(mt);function Pl(q){q.subscriber.clearThrottle()}function Il(q,Y){return function(H){return H.lift(new nu(q,Y))}}var nu=function(){function t(q,Y){this.predicate=q,this.thisArg=Y}return t.prototype.call=function(q,Y){return Y.subscribe(new su(q,this.predicate,this.thisArg))},t}(),su=function(q){function e(Y,H,et){var it=q.call(this,Y)||this;return it.predicate=H,it.thisArg=et,it.count=0,it}return m(e,q),e.prototype._next=function(q){var Y;try{Y=this.predicate.call(this.thisArg,q,this.count++)}catch(q){return void this.destination.error(q)}Y&&this.destination.next(q)},e}(mt),ou=function(){function t(){return Error.call(this),this.message="argument out of range",this.name="ArgumentOutOfRangeError",this}return t.prototype=Object.create(Error.prototype),t}(),au=new bt((function(q){return q.complete()}));function Nl(q){return function(Y){return 0===q?au:Y.lift(new gu(q))}}var gu=function(){function t(q){if(this.total=q,this.total<0)throw new ou}return t.prototype.call=function(q,Y){return Y.subscribe(new fu(q,this.total))},t}(),fu=function(q){function e(Y,H){var et=q.call(this,Y)||this;return et.total=H,et.count=0,et}return m(e,q),e.prototype._next=function(q){var Y=this.total,H=++this.count;H<=Y&&(this.destination.next(q),H===Y&&(this.destination.complete(),this.unsubscribe()))},e}(mt);const pu=class extends cs{constructor(q){super({extent:q.extent,origin:q.origin,origins:q.origins,resolutions:q.resolutions,tileSize:q.tileSize,tileSizes:q.tileSizes,sizes:q.sizes}),this.matrixIds_=q.matrixIds}getMatrixId(q){return this.matrixIds_[q]}getMatrixIds(){return this.matrixIds_}},mu=1/0,bu=class{constructor(q,Y){this.priorityFunction_=q,this.keyFunction_=Y,this.elements_=[],this.priorities_=[],this.queuedElements_={}}clear(){this.elements_.length=0,this.priorities_.length=0,(0,nh.Z)(this.queuedElements_)}dequeue(){const q=this.elements_,Y=this.priorities_,H=q[0];1==q.length?(q.length=0,Y.length=0):(q[0]=q.pop(),Y[0]=Y.pop(),this.siftUp_(0));const et=this.keyFunction_(H);return delete this.queuedElements_[et],H}enqueue(q){(0,yn.h)(!(this.keyFunction_(q)in this.queuedElements_),31);const Y=this.priorityFunction_(q);return Y!=mu&&(this.elements_.push(q),this.priorities_.push(Y),this.queuedElements_[this.keyFunction_(q)]=!0,this.siftDown_(0,this.elements_.length-1),!0)}getCount(){return this.elements_.length}getLeftChildIndex_(q){return 2*q+1}getRightChildIndex_(q){return 2*q+2}getParentIndex_(q){return q-1>>1}heapify_(){let q;for(q=(this.elements_.length>>1)-1;q>=0;q--)this.siftUp_(q)}isEmpty(){return 0===this.elements_.length}isKeyQueued(q){return q in this.queuedElements_}isQueued(q){return this.isKeyQueued(this.keyFunction_(q))}siftUp_(q){const Y=this.elements_,H=this.priorities_,et=Y.length,it=Y[q],nt=H[q],st=q;for(;q<et>>1;){const it=this.getLeftChildIndex_(q),nt=this.getRightChildIndex_(q),st=nt<et&&H[nt]<H[it]?nt:it;Y[q]=Y[st],H[q]=H[st],q=st}Y[q]=it,H[q]=nt,this.siftDown_(st,q)}siftDown_(q,Y){const H=this.elements_,et=this.priorities_,it=H[Y],nt=et[Y];for(;Y>q;){const q=this.getParentIndex_(Y);if(!(et[q]>nt))break;H[Y]=H[q],et[Y]=et[q],Y=q}H[Y]=it,et[Y]=nt}reprioritize(){const q=this.priorityFunction_,Y=this.elements_,H=this.priorities_;let et=0;const it=Y.length;let nt,st,ot;for(st=0;st<it;++st)nt=Y[st],ot=q(nt),ot==mu?delete this.queuedElements_[this.keyFunction_(nt)]:(H[et]=ot,Y[et++]=nt);Y.length=et,H.length=et,this.heapify_()}},Cu=class extends bu{constructor(q,Y){super((function(Y){return q.apply(null,Y)}),(function(q){return q[0].getKey()})),this.boundHandleTileChange_=this.handleTileChange.bind(this),this.tileChangeCallback_=Y,this.tilesLoading_=0,this.tilesLoadingKeys_={}}enqueue(q){const Y=super.enqueue(q);return Y&&q[0].addEventListener(Sn.Z.CHANGE,this.boundHandleTileChange_),Y}getTilesLoading(){return this.tilesLoading_}handleTileChange(q){const Y=q.target,H=Y.getState();if(2===H||3===H||4===H){3!==H&&Y.removeEventListener(Sn.Z.CHANGE,this.boundHandleTileChange_);const q=Y.getKey();q in this.tilesLoadingKeys_&&(delete this.tilesLoadingKeys_[q],--this.tilesLoading_),this.tileChangeCallback_()}}loadMoreTiles(q,Y){let H,et,it,nt=0;for(;this.tilesLoading_<q&&nt<Y&&this.getCount()>0;)et=this.dequeue()[0],it=et.getKey(),H=et.getState(),0!==H||it in this.tilesLoadingKeys_||(this.tilesLoadingKeys_[it]=!0,++this.tilesLoading_,++nt,et.load())}};function Bl(q,Y){switch(q){case"in":return 1/Y;case"cm":return Zt/Y;case"mm":return 25.4/Y;case"m":return.0254/Y;case"px":return 1;default:throw new Error("Invalid real world unit: ".concat(q))}}function Wl(q,Y,H){return q/Bl(Y,H)}function ql(q,Y,H){var et=(0,Vt.U2)(q);return Y*Zt/H/et.getMetersPerUnit()/100}function Yl(q,Y){var H=Object.keys(q);if(Object.getOwnPropertySymbols){var et=Object.getOwnPropertySymbols(q);Y&&(et=et.filter((function(Y){return Object.getOwnPropertyDescriptor(q,Y).enumerable}))),H.push.apply(H,et)}return H}function Zl(q){for(var Y=1;Y<arguments.length;Y++){var H=null!=arguments[Y]?arguments[Y]:{};Y%2?Yl(Object(H),!0).forEach((function(Y){g(q,Y,H[Y])})):Object.getOwnPropertyDescriptors?Object.defineProperties(q,Object.getOwnPropertyDescriptors(H)):Yl(Object(H)).forEach((function(Y){Object.defineProperty(q,Y,Object.getOwnPropertyDescriptor(H,Y))}))}return q}function Xl(q){return Z()?St(q.convertToBlob()):new bt((function(Y){q.toBlob((function(q){Y.next(q),Y.complete()}),"image/png")}))}function Vl(q,Y){return Kl.apply(this,arguments)}function Kl(){return(Kl=tt(Ft().mark((function t(q,Y){var H,et,it,nt,st,ot,lt,mt;return Ft().wrap((function(_t){for(;;)switch(_t.prev=_t.next){case 0:if((H=(0,Vt.U2)(q.projection))||!q.projection.startsWith("EPSG:")){_t.next=11;break}return et=q.projection.split(":"),_t.next=5,bn(et[1]);case 5:it=_t.sent,nt=it.name,st=it.proj4def,ot=it.bbox,wn(nt,st,ot),H=(0,Vt.U2)(q.projection);case 11:return lt=ql(q.projection,q.scale,q.dpi),mt={center:(0,Vt.mi)(q.center,H),resolution:lt,projection:H,rotation:0,zoom:1},_t.abrupt("return",{animate:!1,coordinateToPixelTransform:[1,0,0,1,0,0],declutterTree:[],mapId:"",renderTargets:{},extent:(0,Xt.p8)(mt.center,mt.resolution,mt.rotation,Y),index:0,layerIndex:0,layerStatesArray:[],pixelRatio:1,pixelToCoordinateTransform:[1,0,0,1,0,0],postRenderFunctions:[],size:Y,time:Date.now(),usedTiles:{},viewState:mt,viewHints:[0,0],wantedTiles:{},tileQueue:null});case 14:case"end":return _t.stop()}}),t)})))).apply(this,arguments)}function Hl(q){var Y,H,et=q.size,it=q.dpi;if(!et[2]||"px"===et[2])return[et[0],et[1]];switch(et[2]){case"in":Y=it*et[0],H=it*et[1];break;case"cm":Y=it*et[0]/Zt,H=it*et[1]/Zt;break;case"mm":Y=it*et[0]/25.4,H=it*et[1]/25.4;break;case"m":Y=it*et[0]*100/Zt,H=it*et[1]*100/Zt;break;default:Y=et[0],H=et[1]}return[Math.round(Y),Math.round(H)]}function Jl(q,Y,H){var et=0,it=Zl(Zl({},q),{},{layerStatesArray:[{layer:Y,managed:!0,maxResolution:null,maxZoom:null,minResolution:0,minZoom:null,opacity:void 0!==H?H:1,sourceState:"",visible:!0,zIndex:0}],get time(){return et+=1e4}});return it.tileQueue=new Cu((function(q,Y,H,et){return function(q,Y,H,et,it){if(!q||!(H in q.wantedTiles))return mu;if(!q.wantedTiles[H][Y.getKey()])return mu;const nt=q.viewState.center,st=et[0]-nt[0],ot=et[1]-nt[1];return 65536*Math.log(it)+Math.sqrt(st*st+ot*ot)/it}(it,q,Y,H,et)}),(function(){})),it}function Ql(q){this.containerReused=!1,this.canvas=q.canvas,this.context=q,this.container={firstElementChild:q.canvas,style:{opacity:1}}}var Eu=i(3772),Ru=i.n(Eu);function eu(q,Y){var H=Object.keys(q);if(Object.getOwnPropertySymbols){var et=Object.getOwnPropertySymbols(q);Y&&(et=et.filter((function(Y){return Object.getOwnPropertyDescriptor(q,Y).enumerable}))),H.push.apply(H,et)}return H}function iu(q){for(var Y=1;Y<arguments.length;Y++){var H=null!=arguments[Y]?arguments[Y]:{};Y%2?eu(Object(H),!0).forEach((function(Y){g(q,Y,H[Y])})):Object.getOwnPropertyDescriptors?Object.defineProperties(q,Object.getOwnPropertyDescriptors(H)):eu(Object(H)).forEach((function(Y){Object.defineProperty(q,Y,Object.getOwnPropertyDescriptor(H,Y))}))}return q}var Ou,Iu,Pu,Tu=(void 0===(Ou=500)&&(Ou=0),void 0===Iu&&(Iu=Fl),(nt(Pu=Ou)||!(Pu-parseFloat(Pu)+1>=0)||Ou<0)&&(Ou=0),Iu&&"function"==typeof Iu.schedule||(Iu=Fl),new bt((function(q){return q.add(Iu.schedule(fl,Ou,{subscriber:q,counter:0,period:Ou})),q}))),Fu=new Gl;function hu(q,Y,H){switch(Y.type){case"XYZ":return function(q,Y,H){return lu(q,new As({crossOrigin:"anonymous",url:Y.url,transition:0}),H,Y.opacity)}(q,Y,H);case"WMS":return function(q,Y,H){if(Y.tiled)return lu(q,new Hs({crossOrigin:"anonymous",url:Y.url,params:uu(Y),transition:0}),H,Y.opacity);var et,it,nt,st=H.size[0],ot=H.size[1],lt=(0,At.E4)(st,ot);lt.canvas.style={};var mt=new Ul([0,null,void 0]),_t=new Ws({crossOrigin:"anonymous",url:Y.url,params:uu(Y),ratio:1});return it=new Ph({source:_t}),_t.setImageLoadFunction((function(Y,H){var et=Y.getImage();Z()&&et.hintImageSize(st,ot),Fu.pipe(Il((function(Y){return Y===q})),Nl(1),W((function(){mt.next([-1,null,void 0]),mt.complete(),et.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNkYAAAAAYAAjCB0C8AAAAASUVORK5CYII="}))).subscribe(),et.src=H})),et=Jl(H,it,Y.opacity),(nt=it.getRenderer()).useContainer=Ql.bind(nt,lt),it.getSource().once("imageloaderror",(function(q){var Y=q.target.getUrl();mt.next([1,lt.canvas,Y]),mt.complete()})),it.getSource().once("imageloadend",(function(){nt.prepareFrame(iu(iu({},et),{},{time:Date.now()})),nt.renderFrame(iu(iu({},et),{},{time:Date.now()}),lt.canvas),mt.next([1,lt.canvas,void 0]),mt.complete()})),nt.prepareFrame(iu(iu({},et),{},{time:Date.now()})),mt}(q,Y,H);case"WMTS":return function(q,Y,H){var et=Y.tileGrid,it=Y.projection,nt=et.resolutions,st=et.extent,ot=et.matrixIds;st=st||qr(it),ot=ot||Array(nt.length).fill(0).map((function(q,Y){return"".concat(Y)}));var lt=new pu(iu(iu({},et),{},{extent:st,matrixIds:ot}));return lu(q,new bs(iu(iu({},Y),{},{tileGrid:lt,projection:it,transition:0,crossOrigin:"anonymous"})),H,Y.opacity)}(q,Y,H);case"WFS":return function(q,Y,H){var et,it,nt=H.size[0],st=H.size[1],ot=(0,At.E4)(nt,st);ot.canvas.style={};var lt=Y.version||"1.1.0",mt="geojson"===Y.format?new ah:new Qa({version:lt}),_t=new Ul([0,null]),vt=new Rh({format:mt,loader:function(H,nt,st){var bt=st.getCode(),Mt=function(q,Y,H,et,it,nt){if("http"!==q.substring(0,4))return q;var st=new URL(q),ot="2.0.0"===Y?"typenames":"typename";return st.searchParams.set("SERVICE","WFS"),st.searchParams.set("version",Y),st.searchParams.set("request","GetFeature"),st.searchParams.set(ot,H),st.searchParams.set("srsName",it),st.searchParams.set("bbox","".concat(nt.join(","),",").concat(it)),"geojson"===et&&st.searchParams.set("outputFormat","application/json"),st.href}(Y.url,lt,Y.layer,Y.format,bt,H);fetch(Mt).then((function(q){if(q.status>=400)throw new Error;return q.text()})).then((function(q){vt.addFeatures(mt.readFeatures(q)),0!==vt.getFeatures().length&&(it.prepareFrame(iu(iu({},et),{},{time:Date.now()})),it.renderFrame(iu(iu({},et),{},{time:Date.now()}),ot.canvas)),_t.next([1,ot.canvas]),_t.complete()})).catch((function(){_t.next([1,ot.canvas,Y.url]),_t.complete()})),Fu.pipe(Il((function(Y){return Y===q})),Nl(1),W((function(){_t.next([-1,null]),_t.complete()}))).subscribe()},strategy:sh}),bt=new Rl({source:vt});return Y.style&&(new(Ru())).writeStyle(Y.style).then((function(q){var Y=q.output;return bt.setStyle(Y)})).catch((function(q){return console.log(q)})),et=Jl(H,bt),(it=bt.getRenderer()).useContainer=Ql.bind(it,ot),it.prepareFrame(iu(iu({},et),{},{time:Date.now()})),_t}(q,Y,H);case"GeoJSON":return function(q,Y){var H=Y.size[0],et=Y.size[1],it=(0,At.E4)(H,et);it.canvas.style={};var nt=new Rh({features:(new ah).readFeatures(q.geojson)}),st=new Rl({source:nt}),ot=Jl(Y,st),lt=st.getRenderer();lt.useContainer=Ql.bind(lt,it);var mt=new Ul([0,null]);return(q.style?(new(Ru())).writeStyle(q.style).then((function(q){var Y=q.output;return st.setStyle(Y)})).catch((function(q){return console.log(q)})):Promise.resolve()).then((function(){lt.prepareFrame(iu(iu({},ot),{},{time:Date.now()})),lt.renderFrame(iu(iu({},ot),{},{time:Date.now()}),it.canvas),mt.next([1,it.canvas]),mt.complete()})),mt}(Y,H)}}function lu(q,Y,H,et){var it,nt,st,ot,lt=H.size[0],mt=H.size[1],_t=(0,At.E4)(lt,mt);_t.canvas.style={},nt=new rs({source:Y}),Y.setTileLoadFunction((function(q,Y){var et=q.getImage();if(Z()){var it=nt.getSource().getTilePixelSize(0,H.pixelRatio,H.viewState.projection);et.hintImageSize(it[0],it[1])}et.src=Y})),nt.getSource().on("tileloaderror",(function(q){ot=q.target.getUrls()[0]})),it=Jl(H,nt,et),(st=nt.getRenderer()).useContainer=Ql.bind(st,_t),st.renderFrame(it,_t.canvas);var vt=Object.keys(it.tileQueue.queuedElements_).length,Mt=Tu.pipe(function(){for(var q=[],Y=0;Y<arguments.length;Y++)q[Y]=arguments[Y];var H=q[q.length-1];return rt(H)?(q.pop(),function(Y){return Cl(q,Y,H)}):function(Y){return Cl(q,Y)}}(!0),Ot((function(){return it.tileQueue.reprioritize(),it.tileQueue.loadMoreTiles(12,4),it.tileQueue.getTilesLoading()}),!0),N((function(){var q=1-Object.keys(it.tileQueue.queuedElements_).length/vt;return 1===q&&it.tileQueue.getTilesLoading()>0&&(q-=.001),1===q?(st.renderFrame(it,_t.canvas),[1,_t.canvas,ot]):[q,null,ot]})),function(q,Y,H){return void 0===Y&&(Y=Fl),void 0===H&&(H=$l),function(q){return q.lift(new tu(500,Y,H.leading,H.trailing))}}(0,void 0,{leading:!0,trailing:!0}));return function(){for(var q=[],Y=0;Y<arguments.length;Y++)q[Y]=arguments[Y];var H=Number.POSITIVE_INFINITY,et=null,it=q[q.length-1];return rt(it)?(et=q.pop(),q.length>1&&"number"==typeof q[q.length-1]&&(H=q.pop())):"number"==typeof it&&(H=q.pop()),null===et&&1===q.length&&q[0]instanceof bt?q[0]:bl(H)(pt(q,et))}(Mt,Fu.pipe(Il((function(Y){return Y===q})),N((function(){return[-1,null,void 0]})))).pipe(Ot((function(q){var Y=Q(q,1)[0];return-1!==Y&&1!==Y}),!0))}function uu(q){return q.tiled?iu({LAYERS:q.layer,VERSION:q.version||"1.3.0",TILED:!0},q.customParams):iu({LAYERS:q.layer,VERSION:q.version||"1.3.0"},q.customParams)}function cu(q,Y,H,et){var it=Y.split("-")[1],nt=Y.split("-")[0],st=Math.round(4*et/25.4);q.translate("left"===it?st:q.canvas.width-st-H[0],"top"===nt?st:q.canvas.height-st-H[1])}function du(q,Y){var H=Y.dpi/25.4;q.miterLimit=2,q.strokeStyle="#ffffff",q.fillStyle="#000000",q.lineWidth=1,q.lineJoin="round",q.lineCap="round",q.textBaseline="top",q.font="".concat(6,"px Arial");var et=function(q){return q.layers.filter((function(q){return!!q.attribution})).map((function(q){return q.attribution})).join(", ")||"Unknown source"}(Y);q.save(),cu(q,!0===Y.attributions?"bottom-right":Y.attributions,[q.measureText(et).width*H,6*H*.85],Y.dpi),q.scale(H,H),q.strokeText(et,0,0),q.fillText(et,0,0)}var Au=["M 12.940954,-48.296291 A 50,50 0 0 1 49.809735,-4.3577871","M -49.809735,-4.3577863 A 50,50 0 0 1 -12.940952,-48.296291","M -4.3577877,49.809735 A 50,50 0 0 1 -49.809735,4.3577867","M 49.809735,4.3577872 A 50,50 0 0 1 4.3577854,49.809735","M -5.2916667,-43.38024 V -56.609407 L 5.2916667,-43.38024 v -13.229167","M -21.166667,31.75 0,-31.75 21.166667,31.75 0,15.875 Z"],Lu=["M 0,-31.75 21.166667,31.75 0,15.875 Z"],Nu=["m 8,-50 a 8,8 0 0 1 -8,8 8,8 0 0 1 -8,-8 8,8 0 0 1 8,-8 8,8 0 0 1 8,8 z","M 50,0 A 50,50 0 0 1 0,50 50,50 0 0 1 -50,0 50,50 0 0 1 0,-50 50,50 0 0 1 50,0 Z"],ku=["M -21.166667,31.75 0,-31.75 21.166667,31.75 0,15.875 Z"];function yu(q,Y,H){var et=function(q){return Wl(30,"mm",q)}(H);q.save(),cu(q,!0===Y?"top-right":Y,[et,et],H),q.translate(et/2,et/2),q.scale(et/130,et/130),function(q){q.lineCap="round",q.lineJoin="round",q.fillStyle="rgb(255, 255, 255)",q.strokeStyle="rgb(255, 255, 255)",q.lineWidth=8,Nu.forEach((function(Y){q.stroke(new Path2D(Y))})),ku.forEach((function(Y){q.fill(new Path2D(Y))})),q.fillStyle="rgb(0, 0, 0)",q.strokeStyle="rgb(0, 0, 0)",q.lineWidth=3,Au.forEach((function(Y){q.stroke(new Path2D(Y))})),Lu.forEach((function(Y){q.fill(new Path2D(Y))}))}(q),q.restore()}function _u(q,Y){var H=function(q,Y){var H=Wl(40,"mm",q.dpi),et=[1,2,5],it="object"===e(q.scaleBar)&&q.scaleBar.units||"metric",nt=(0,Vt.mi)(q.center,q.projection),st=ql(q.projection,q.scale,q.dpi),ot="degrees"===it?it:"m",lt=(0,Vt._Q)(q.projection,st,nt,ot),mt=H*lt,_t="";if("degrees"===it){var vt=Vt.Wm[it];(mt*=vt)<vt/60?(_t="",lt*=3600):mt<vt?(_t="",lt*=60):_t=""}else"imperial"===it?mt<.9144?(_t="in",lt/=.0254):mt<1609.344?(_t="ft",lt/=.3048):(_t="mi",lt/=1609.344):"nautical"===it?(lt/=1852,_t="nm"):"metric"===it?mt<.001?(_t="m",lt*=1e6):mt<1?(_t="mm",lt*=1e3):mt<1e3?_t="m":(_t="km",lt/=1e3):"us"===it&&(mt<.9144?(_t="in",lt*=39.37):mt<1609.344?(_t="ft",lt/=.30480061):(_t="mi",lt/=1609.3472));for(var bt,Mt,Et,Rt,It,Pt=3*Math.floor(Math.log(H*lt)/Math.log(10));;){Et=Math.floor(Pt/3);var Tt=Math.pow(10,Et);if(bt=et[(Pt%3+3)%3]*Tt,Mt=Math.round(bt/lt),isNaN(Mt))return;if(Mt>=H)break;++Pt}return{widthMm:(Rt=Mt,"mm",It=q.dpi,Rt*Bl("mm",It)),scaleIndication:"".concat(bt," ").concat(_t)}}(Y),et="object"===e(Y.scaleBar)?Y.scaleBar.position:Y.scaleBar,it=Q(function(q,Y,H){H.font="".concat(6,"px Arial");var et=H.measureText(q.scaleIndication).width;return[Wl(q.widthMm+et+1,"mm",Y),Wl(11,"mm",Y)]}(H,Y.dpi,q),2),nt=it[0],st=it[1];q.save(),cu(q,"boolean"==typeof et?"bottom-left":et,[nt,st],Y.dpi);var ot=Wl(1,"mm",Y.dpi);q.scale(ot,ot),function(q,Y){var H=Y.widthMm,et="#FFFFFF";q.lineJoin="round",q.lineCap="round",q.lineWidth=1,q.font="".concat(6,"px Arial"),q.translate(.5,.5),q.textAlign="left",q.strokeStyle=et,q.fillStyle="#000000",q.textBaseline="top",q.strokeText("0",0,0),q.fillText("0",0,0),q.strokeText(Y.scaleIndication,H,0),q.fillText(Y.scaleIndication,H,0),q.translate(6*.3,7),q.strokeRect(0,0,H,3),q.fillRect(0,0,H,3),q.fillStyle=et,q.fillRect(.25*H,.5,.25*H,2),q.fillRect(.75*H,.5,.25*H-.5,2)}(q,H),q.restore()}function vu(q,Y){var H=Object.keys(q);if(Object.getOwnPropertySymbols){var et=Object.getOwnPropertySymbols(q);Y&&(et=et.filter((function(Y){return Object.getOwnPropertyDescriptor(q,Y).enumerable}))),H.push.apply(H,et)}return H}function xu(q){for(var Y=1;Y<arguments.length;Y++){var H=null!=arguments[Y]?arguments[Y]:{};Y%2?vu(Object(H),!0).forEach((function(Y){g(q,Y,H[Y])})):Object.getOwnPropertyDescriptors?Object.defineProperties(q,Object.getOwnPropertyDescriptors(H)):vu(Object(H)).forEach((function(Y){Object.defineProperty(q,Y,Object.getOwnPropertyDescriptor(H,Y))}))}return q}function Su(q,Y){(null==Y||Y>q.length)&&(Y=q.length);for(var H=0,et=new Array(Y);H<Y;H++)et[H]=q[H];return et}var Gu=0;function Mu(){return(Mu=tt(Ft().mark((function t(q){var Y,H,et,it;return Ft().wrap((function(nt){for(;;)switch(nt.prev=nt.next){case 0:return wu(q.projectionDefinitions),Y=Hl(q),nt.next=4,Vl(q,Y);case 4:H=nt.sent,et={id:Gu++,spec:q,status:"pending",progress:0,sourceLoadErrors:[]},it=(0,At.E4)(Y[0],Y[1]),(q.layers.length?yt(q.layers.map((function(q){return hu(et.id,q,H)}))):xt([])).pipe(Ct((function(Y){var H=Y.every((function(q){return 1===Q(q,1)[0]})),et=Y.some((function(q){return-1===Q(q,1)[0]})),nt=[];if(H){for(var st=0;st<Y.length;st++){var ot=Y[st][1],lt=Y[st][2];0!==ot.width&&0!==ot.height&&(it.drawImage(ot,0,0),lt&&nt.push({url:lt}))}return q.northArrow&&yu(it,q.northArrow,q.dpi),("object"===e(q.scaleBar)&&q.scaleBar.position||q.scaleBar)&&_u(it,q),q.attributions&&du(it,q),Xl(it.canvas).pipe(N((function(q){return[1,q,nt]})))}if(et)return xt([-1,null,nt]);var mt=Y.reduce((function(q,Y){return Q(Y,1)[0]+q}),0)/Y.length;return xt([Math.min(.999,parseFloat(mt.toFixed(4))),null,nt])})),N((function(q){var Y=Q(q,3),H=Y[0],it=Y[1],nt=Y[2];return xu(xu({},et),{},{progress:H,imageBlob:it,status:1===H?"finished":-1===H?"canceled":"ongoing",sourceLoadErrors:nt})})),Ot((function(q){return q.progress<1&&-1!==q.progress}),!0)).subscribe((function(q){return K("jobStatus",{status:q})}));case 9:case"end":return nt.stop()}}),t)})))).apply(this,arguments)}function wu(q){if(q){var Y,H=function(q,Y){var H="undefined"!=typeof Symbol&&q[Symbol.iterator]||q["@@iterator"];if(!H){if(Array.isArray(q)||(H=function(q,Y){if(q){if("string"==typeof q)return Su(q,Y);var H=Object.prototype.toString.call(q).slice(8,-1);return"Object"===H&&q.constructor&&(H=q.constructor.name),"Map"===H||"Set"===H?Array.from(q):"Arguments"===H||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(H)?Su(q,Y):void 0}}(q))){H&&(q=H);var et=0,r=function(){};return{s:r,n:function(){return et>=q.length?{done:!0}:{done:!1,value:q[et++]}},e:function(q){throw q},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var it,nt=!0,st=!1;return{s:function(){H=H.call(q)},n:function(){var q=H.next();return nt=q.done,q},e:function(q){st=!0,it=q},f:function(){try{nt||null==H.return||H.return()}finally{if(st)throw it}}}}(q);try{for(H.s();!(Y=H.n()).done;){var et=Y.value;wn(et.name,et.proj4,et.bbox)}}catch(q){H.e(q)}finally{H.f()}}}Pt.subscribe((function(q){switch(q.type){case"requestJob":!function(q){Mu.apply(this,arguments)}(q.spec);break;case"cancelJob":Y=q.jobId,Fu.next(Y);break;default:console.log("[inkmap] Unhandled message",q)}var Y})),self.addEventListener("install",(function(){console.log("[inkmap] Installing worker..."),self.skipWaiting()})),self.addEventListener("activate",(function(){console.log("[inkmap] Activated worker, claiming clients."),self.clients.claim()}))})()})();